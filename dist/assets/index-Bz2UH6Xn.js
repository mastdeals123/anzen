var WL=Object.defineProperty;var zL=(e,t,r)=>t in e?WL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Fr=(e,t,r)=>zL(e,typeof t!="symbol"?t+"":t,r);function XL(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var ii=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xk(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function YL(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var Yk={exports:{}},yx={},Jk={exports:{}},hr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _0=Symbol.for("react.element"),JL=Symbol.for("react.portal"),ZL=Symbol.for("react.fragment"),eO=Symbol.for("react.strict_mode"),tO=Symbol.for("react.profiler"),rO=Symbol.for("react.provider"),nO=Symbol.for("react.context"),aO=Symbol.for("react.forward_ref"),sO=Symbol.for("react.suspense"),iO=Symbol.for("react.memo"),oO=Symbol.for("react.lazy"),$5=Symbol.iterator;function lO(e){return e===null||typeof e!="object"?null:(e=$5&&e[$5]||e["@@iterator"],typeof e=="function"?e:null)}var Zk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e3=Object.assign,t3={};function LA(e,t,r){this.props=e,this.context=t,this.refs=t3,this.updater=r||Zk}LA.prototype.isReactComponent={};LA.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};LA.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function r3(){}r3.prototype=LA.prototype;function e2(e,t,r){this.props=e,this.context=t,this.refs=t3,this.updater=r||Zk}var t2=e2.prototype=new r3;t2.constructor=e2;e3(t2,LA.prototype);t2.isPureReactComponent=!0;var V5=Array.isArray,n3=Object.prototype.hasOwnProperty,r2={current:null},a3={key:!0,ref:!0,__self:!0,__source:!0};function s3(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)n3.call(t,n)&&!a3.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:_0,type:e,key:i,ref:o,props:s,_owner:r2.current}}function cO(e,t){return{$$typeof:_0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function n2(e){return typeof e=="object"&&e!==null&&e.$$typeof===_0}function uO(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var G5=/\/+/g;function H1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?uO(""+e.key):t.toString(36)}function Pm(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case _0:case JL:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+H1(o,0):n,V5(s)?(r="",e!=null&&(r=e.replace(G5,"$&/")+"/"),Pm(s,t,r,"",function(u){return u})):s!=null&&(n2(s)&&(s=cO(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(G5,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",V5(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+H1(i,l);o+=Pm(i,t,r,c,s)}else if(c=lO(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+H1(i,l++),o+=Pm(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function gp(e,t,r){if(e==null)return e;var n=[],s=0;return Pm(e,n,"","",function(i){return t.call(r,i,s++)}),n}function dO(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var js={current:null},Dm={transition:null},AO={ReactCurrentDispatcher:js,ReactCurrentBatchConfig:Dm,ReactCurrentOwner:r2};function i3(){throw Error("act(...) is not supported in production builds of React.")}hr.Children={map:gp,forEach:function(e,t,r){gp(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return gp(e,function(){t++}),t},toArray:function(e){return gp(e,function(t){return t})||[]},only:function(e){if(!n2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};hr.Component=LA;hr.Fragment=ZL;hr.Profiler=tO;hr.PureComponent=e2;hr.StrictMode=eO;hr.Suspense=sO;hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AO;hr.act=i3;hr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=e3({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=r2.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)n3.call(t,c)&&!a3.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:_0,type:e.type,key:s,ref:i,props:n,_owner:o}};hr.createContext=function(e){return e={$$typeof:nO,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rO,_context:e},e.Consumer=e};hr.createElement=s3;hr.createFactory=function(e){var t=s3.bind(null,e);return t.type=e,t};hr.createRef=function(){return{current:null}};hr.forwardRef=function(e){return{$$typeof:aO,render:e}};hr.isValidElement=n2;hr.lazy=function(e){return{$$typeof:oO,_payload:{_status:-1,_result:e},_init:dO}};hr.memo=function(e,t){return{$$typeof:iO,type:e,compare:t===void 0?null:t}};hr.startTransition=function(e){var t=Dm.transition;Dm.transition={};try{e()}finally{Dm.transition=t}};hr.unstable_act=i3;hr.useCallback=function(e,t){return js.current.useCallback(e,t)};hr.useContext=function(e){return js.current.useContext(e)};hr.useDebugValue=function(){};hr.useDeferredValue=function(e){return js.current.useDeferredValue(e)};hr.useEffect=function(e,t){return js.current.useEffect(e,t)};hr.useId=function(){return js.current.useId()};hr.useImperativeHandle=function(e,t,r){return js.current.useImperativeHandle(e,t,r)};hr.useInsertionEffect=function(e,t){return js.current.useInsertionEffect(e,t)};hr.useLayoutEffect=function(e,t){return js.current.useLayoutEffect(e,t)};hr.useMemo=function(e,t){return js.current.useMemo(e,t)};hr.useReducer=function(e,t,r){return js.current.useReducer(e,t,r)};hr.useRef=function(e){return js.current.useRef(e)};hr.useState=function(e){return js.current.useState(e)};hr.useSyncExternalStore=function(e,t,r){return js.current.useSyncExternalStore(e,t,r)};hr.useTransition=function(){return js.current.useTransition()};hr.version="18.3.1";Jk.exports=hr;var W=Jk.exports;const fO=Xk(W);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hO=W,pO=Symbol.for("react.element"),mO=Symbol.for("react.fragment"),gO=Object.prototype.hasOwnProperty,xO=hO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yO={key:!0,ref:!0,__self:!0,__source:!0};function o3(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)gO.call(t,n)&&!yO.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:pO,type:e,key:i,ref:o,props:s,_owner:xO.current}}yx.Fragment=mO;yx.jsx=o3;yx.jsxs=o3;Yk.exports=yx;var a=Yk.exports,l3={exports:{}},hi={},c3={exports:{}},u3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,H){var V=J.length;J.push(H);e:for(;0<V;){var K=V-1>>>1,B=J[K];if(0<s(B,H))J[K]=H,J[V]=B,V=K;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var H=J[0],V=J.pop();if(V!==H){J[0]=V;e:for(var K=0,B=J.length,L=B>>>1;K<L;){var U=2*(K+1)-1,D=J[U],Q=U+1,z=J[Q];if(0>s(D,V))Q<B&&0>s(z,D)?(J[K]=z,J[Q]=V,K=Q):(J[K]=D,J[U]=V,K=U);else if(Q<B&&0>s(z,V))J[K]=z,J[Q]=V,K=Q;else break e}}return H}function s(J,H){var V=J.sortIndex-H.sortIndex;return V!==0?V:J.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,A=!1,b=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(J){for(var H=r(u);H!==null;){if(H.callback===null)n(u);else if(H.startTime<=J)n(u),H.sortIndex=H.expirationTime,t(c,H);else break;H=r(u)}}function x(J){if(m=!1,y(J),!b)if(r(c)!==null)b=!0,P(w);else{var H=r(u);H!==null&&X(x,H.startTime-J)}}function w(J,H){b=!1,m&&(m=!1,p(C),C=-1),A=!0;var V=f;try{for(y(H),h=r(c);h!==null&&(!(h.expirationTime>H)||J&&!S());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var B=K(h.expirationTime<=H);H=e.unstable_now(),typeof B=="function"?h.callback=B:h===r(c)&&n(c),y(H)}else n(c);h=r(c)}if(h!==null)var L=!0;else{var U=r(u);U!==null&&X(x,U.startTime-H),L=!1}return L}finally{h=null,f=V,A=!1}}var N=!1,_=null,C=-1,j=5,E=-1;function S(){return!(e.unstable_now()-E<j)}function F(){if(_!==null){var J=e.unstable_now();E=J;var H=!0;try{H=_(!0,J)}finally{H?I():(N=!1,_=null)}}else N=!1}var I;if(typeof g=="function")I=function(){g(F)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,M=O.port2;O.port1.onmessage=F,I=function(){M.postMessage(null)}}else I=function(){v(F,0)};function P(J){_=J,N||(N=!0,I())}function X(J,H){C=v(function(){J(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){b||A||(b=!0,P(w))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(J){switch(f){case 1:case 2:case 3:var H=3;break;default:H=f}var V=f;f=H;try{return J()}finally{f=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,H){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var V=f;f=J;try{return H()}finally{f=V}},e.unstable_scheduleCallback=function(J,H,V){var K=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?K+V:K):V=K,J){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=V+B,J={id:d++,callback:H,priorityLevel:J,startTime:V,expirationTime:B,sortIndex:-1},V>K?(J.sortIndex=V,t(u,J),r(c)===null&&J===r(u)&&(m?(p(C),C=-1):m=!0,X(x,V-K))):(J.sortIndex=B,t(c,J),b||A||(b=!0,P(w))),J},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(J){var H=f;return function(){var V=f;f=H;try{return J.apply(this,arguments)}finally{f=V}}}})(u3);c3.exports=u3;var vO=c3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bO=W,di=vO;function yt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d3=new Set,Uh={};function Yu(e,t){bA(e,t),bA(e+"Capture",t)}function bA(e,t){for(Uh[e]=t,e=0;e<t.length;e++)d3.add(t[e])}var Cl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kv=Object.prototype.hasOwnProperty,wO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,W5={},z5={};function _O(e){return Kv.call(z5,e)?!0:Kv.call(W5,e)?!1:wO.test(e)?z5[e]=!0:(W5[e]=!0,!1)}function NO(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function jO(e,t,r,n){if(t===null||typeof t>"u"||NO(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Cs(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Qa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Qa[e]=new Cs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Qa[t]=new Cs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Qa[e]=new Cs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Qa[e]=new Cs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Qa[e]=new Cs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Qa[e]=new Cs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Qa[e]=new Cs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Qa[e]=new Cs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Qa[e]=new Cs(e,5,!1,e.toLowerCase(),null,!1,!1)});var a2=/[\-:]([a-z])/g;function s2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(a2,s2);Qa[t]=new Cs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(a2,s2);Qa[t]=new Cs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(a2,s2);Qa[t]=new Cs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Qa[e]=new Cs(e,1,!1,e.toLowerCase(),null,!1,!1)});Qa.xlinkHref=new Cs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Qa[e]=new Cs(e,1,!1,e.toLowerCase(),null,!0,!0)});function i2(e,t,r,n){var s=Qa.hasOwnProperty(t)?Qa[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(jO(t,r,s,n)&&(r=null),n||s===null?_O(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ll=bO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xp=Symbol.for("react.element"),qd=Symbol.for("react.portal"),Kd=Symbol.for("react.fragment"),o2=Symbol.for("react.strict_mode"),$v=Symbol.for("react.profiler"),A3=Symbol.for("react.provider"),f3=Symbol.for("react.context"),l2=Symbol.for("react.forward_ref"),Vv=Symbol.for("react.suspense"),Gv=Symbol.for("react.suspense_list"),c2=Symbol.for("react.memo"),oc=Symbol.for("react.lazy"),h3=Symbol.for("react.offscreen"),X5=Symbol.iterator;function jf(e){return e===null||typeof e!="object"?null:(e=X5&&e[X5]||e["@@iterator"],typeof e=="function"?e:null)}var xn=Object.assign,q1;function Gf(e){if(q1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);q1=t&&t[1]||""}return`
`+q1+e}var K1=!1;function $1(e,t){if(!e||K1)return"";K1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{K1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Gf(e):""}function CO(e){switch(e.tag){case 5:return Gf(e.type);case 16:return Gf("Lazy");case 13:return Gf("Suspense");case 19:return Gf("SuspenseList");case 0:case 2:case 15:return e=$1(e.type,!1),e;case 11:return e=$1(e.type.render,!1),e;case 1:return e=$1(e.type,!0),e;default:return""}}function Wv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Kd:return"Fragment";case qd:return"Portal";case $v:return"Profiler";case o2:return"StrictMode";case Vv:return"Suspense";case Gv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case f3:return(e.displayName||"Context")+".Consumer";case A3:return(e._context.displayName||"Context")+".Provider";case l2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case c2:return t=e.displayName||null,t!==null?t:Wv(e.type)||"Memo";case oc:t=e._payload,e=e._init;try{return Wv(e(t))}catch{}}return null}function BO(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wv(t);case 8:return t===o2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Tc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function p3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kO(e){var t=p3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yp(e){e._valueTracker||(e._valueTracker=kO(e))}function m3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=p3(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ig(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zv(e,t){var r=t.checked;return xn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Y5(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Tc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function g3(e,t){t=t.checked,t!=null&&i2(e,"checked",t,!1)}function Xv(e,t){g3(e,t);var r=Tc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Yv(e,t.type,r):t.hasOwnProperty("defaultValue")&&Yv(e,t.type,Tc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function J5(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Yv(e,t,r){(t!=="number"||ig(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Wf=Array.isArray;function aA(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Tc(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Jv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(yt(91));return xn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Z5(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(yt(92));if(Wf(r)){if(1<r.length)throw Error(yt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Tc(r)}}function x3(e,t){var r=Tc(t.value),n=Tc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function eN(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function y3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?y3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var vp,v3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(vp=vp||document.createElement("div"),vp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=vp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ph(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var lh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},SO=["Webkit","ms","Moz","O"];Object.keys(lh).forEach(function(e){SO.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),lh[t]=lh[e]})});function b3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||lh.hasOwnProperty(e)&&lh[e]?(""+t).trim():t+"px"}function w3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=b3(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var EO=xn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function eb(e,t){if(t){if(EO[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(yt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(yt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(yt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(yt(62))}}function tb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rb=null;function u2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nb=null,sA=null,iA=null;function tN(e){if(e=C0(e)){if(typeof nb!="function")throw Error(yt(280));var t=e.stateNode;t&&(t=Nx(t),nb(e.stateNode,e.type,t))}}function _3(e){sA?iA?iA.push(e):iA=[e]:sA=e}function N3(){if(sA){var e=sA,t=iA;if(iA=sA=null,tN(e),t)for(e=0;e<t.length;e++)tN(t[e])}}function j3(e,t){return e(t)}function C3(){}var V1=!1;function B3(e,t,r){if(V1)return e(t,r);V1=!0;try{return j3(e,t,r)}finally{V1=!1,(sA!==null||iA!==null)&&(C3(),N3())}}function Dh(e,t){var r=e.stateNode;if(r===null)return null;var n=Nx(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(yt(231,t,typeof r));return r}var ab=!1;if(Cl)try{var Cf={};Object.defineProperty(Cf,"passive",{get:function(){ab=!0}}),window.addEventListener("test",Cf,Cf),window.removeEventListener("test",Cf,Cf)}catch{ab=!1}function FO(e,t,r,n,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var ch=!1,og=null,lg=!1,sb=null,TO={onError:function(e){ch=!0,og=e}};function IO(e,t,r,n,s,i,o,l,c){ch=!1,og=null,FO.apply(TO,arguments)}function LO(e,t,r,n,s,i,o,l,c){if(IO.apply(this,arguments),ch){if(ch){var u=og;ch=!1,og=null}else throw Error(yt(198));lg||(lg=!0,sb=u)}}function Ju(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function k3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function rN(e){if(Ju(e)!==e)throw Error(yt(188))}function OO(e){var t=e.alternate;if(!t){if(t=Ju(e),t===null)throw Error(yt(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return rN(s),e;if(i===n)return rN(s),t;i=i.sibling}throw Error(yt(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(yt(189))}}if(r.alternate!==n)throw Error(yt(190))}if(r.tag!==3)throw Error(yt(188));return r.stateNode.current===r?e:t}function S3(e){return e=OO(e),e!==null?E3(e):null}function E3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=E3(e);if(t!==null)return t;e=e.sibling}return null}var F3=di.unstable_scheduleCallback,nN=di.unstable_cancelCallback,UO=di.unstable_shouldYield,PO=di.unstable_requestPaint,Pn=di.unstable_now,DO=di.unstable_getCurrentPriorityLevel,d2=di.unstable_ImmediatePriority,T3=di.unstable_UserBlockingPriority,cg=di.unstable_NormalPriority,RO=di.unstable_LowPriority,I3=di.unstable_IdlePriority,vx=null,Ro=null;function QO(e){if(Ro&&typeof Ro.onCommitFiberRoot=="function")try{Ro.onCommitFiberRoot(vx,e,void 0,(e.current.flags&128)===128)}catch{}}var uo=Math.clz32?Math.clz32:qO,MO=Math.log,HO=Math.LN2;function qO(e){return e>>>=0,e===0?32:31-(MO(e)/HO|0)|0}var bp=64,wp=4194304;function zf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ug(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=zf(l):(i&=o,i!==0&&(n=zf(i)))}else o=r&~s,o!==0?n=zf(o):i!==0&&(n=zf(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-uo(t),s=1<<r,n|=e[r],t&=~s;return n}function KO(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $O(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-uo(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=KO(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function ib(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function L3(){var e=bp;return bp<<=1,!(bp&4194240)&&(bp=64),e}function G1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function N0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-uo(t),e[t]=r}function VO(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-uo(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function A2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-uo(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Ur=0;function O3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var U3,f2,P3,D3,R3,ob=!1,_p=[],bc=null,wc=null,_c=null,Rh=new Map,Qh=new Map,uc=[],GO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function aN(e,t){switch(e){case"focusin":case"focusout":bc=null;break;case"dragenter":case"dragleave":wc=null;break;case"mouseover":case"mouseout":_c=null;break;case"pointerover":case"pointerout":Rh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qh.delete(t.pointerId)}}function Bf(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=C0(t),t!==null&&f2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function WO(e,t,r,n,s){switch(t){case"focusin":return bc=Bf(bc,e,t,r,n,s),!0;case"dragenter":return wc=Bf(wc,e,t,r,n,s),!0;case"mouseover":return _c=Bf(_c,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Rh.set(i,Bf(Rh.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Qh.set(i,Bf(Qh.get(i)||null,e,t,r,n,s)),!0}return!1}function Q3(e){var t=wu(e.target);if(t!==null){var r=Ju(t);if(r!==null){if(t=r.tag,t===13){if(t=k3(r),t!==null){e.blockedOn=t,R3(e.priority,function(){P3(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Rm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=lb(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);rb=n,r.target.dispatchEvent(n),rb=null}else return t=C0(r),t!==null&&f2(t),e.blockedOn=r,!1;t.shift()}return!0}function sN(e,t,r){Rm(e)&&r.delete(t)}function zO(){ob=!1,bc!==null&&Rm(bc)&&(bc=null),wc!==null&&Rm(wc)&&(wc=null),_c!==null&&Rm(_c)&&(_c=null),Rh.forEach(sN),Qh.forEach(sN)}function kf(e,t){e.blockedOn===t&&(e.blockedOn=null,ob||(ob=!0,di.unstable_scheduleCallback(di.unstable_NormalPriority,zO)))}function Mh(e){function t(s){return kf(s,e)}if(0<_p.length){kf(_p[0],e);for(var r=1;r<_p.length;r++){var n=_p[r];n.blockedOn===e&&(n.blockedOn=null)}}for(bc!==null&&kf(bc,e),wc!==null&&kf(wc,e),_c!==null&&kf(_c,e),Rh.forEach(t),Qh.forEach(t),r=0;r<uc.length;r++)n=uc[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<uc.length&&(r=uc[0],r.blockedOn===null);)Q3(r),r.blockedOn===null&&uc.shift()}var oA=Ll.ReactCurrentBatchConfig,dg=!0;function XO(e,t,r,n){var s=Ur,i=oA.transition;oA.transition=null;try{Ur=1,h2(e,t,r,n)}finally{Ur=s,oA.transition=i}}function YO(e,t,r,n){var s=Ur,i=oA.transition;oA.transition=null;try{Ur=4,h2(e,t,r,n)}finally{Ur=s,oA.transition=i}}function h2(e,t,r,n){if(dg){var s=lb(e,t,r,n);if(s===null)ny(e,t,n,Ag,r),aN(e,n);else if(WO(s,e,t,r,n))n.stopPropagation();else if(aN(e,n),t&4&&-1<GO.indexOf(e)){for(;s!==null;){var i=C0(s);if(i!==null&&U3(i),i=lb(e,t,r,n),i===null&&ny(e,t,n,Ag,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else ny(e,t,n,null,r)}}var Ag=null;function lb(e,t,r,n){if(Ag=null,e=u2(n),e=wu(e),e!==null)if(t=Ju(e),t===null)e=null;else if(r=t.tag,r===13){if(e=k3(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ag=e,null}function M3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(DO()){case d2:return 1;case T3:return 4;case cg:case RO:return 16;case I3:return 536870912;default:return 16}default:return 16}}var fc=null,p2=null,Qm=null;function H3(){if(Qm)return Qm;var e,t=p2,r=t.length,n,s="value"in fc?fc.value:fc.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return Qm=s.slice(e,1<n?1-n:void 0)}function Mm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Np(){return!0}function iN(){return!1}function pi(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Np:iN,this.isPropagationStopped=iN,this}return xn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Np)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Np)},persist:function(){},isPersistent:Np}),t}var OA={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},m2=pi(OA),j0=xn({},OA,{view:0,detail:0}),JO=pi(j0),W1,z1,Sf,bx=xn({},j0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:g2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sf&&(Sf&&e.type==="mousemove"?(W1=e.screenX-Sf.screenX,z1=e.screenY-Sf.screenY):z1=W1=0,Sf=e),W1)},movementY:function(e){return"movementY"in e?e.movementY:z1}}),oN=pi(bx),ZO=xn({},bx,{dataTransfer:0}),eU=pi(ZO),tU=xn({},j0,{relatedTarget:0}),X1=pi(tU),rU=xn({},OA,{animationName:0,elapsedTime:0,pseudoElement:0}),nU=pi(rU),aU=xn({},OA,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sU=pi(aU),iU=xn({},OA,{data:0}),lN=pi(iU),oU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uU(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cU[e])?!!t[e]:!1}function g2(){return uU}var dU=xn({},j0,{key:function(e){if(e.key){var t=oU[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Mm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?lU[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:g2,charCode:function(e){return e.type==="keypress"?Mm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Mm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),AU=pi(dU),fU=xn({},bx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cN=pi(fU),hU=xn({},j0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:g2}),pU=pi(hU),mU=xn({},OA,{propertyName:0,elapsedTime:0,pseudoElement:0}),gU=pi(mU),xU=xn({},bx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yU=pi(xU),vU=[9,13,27,32],x2=Cl&&"CompositionEvent"in window,uh=null;Cl&&"documentMode"in document&&(uh=document.documentMode);var bU=Cl&&"TextEvent"in window&&!uh,q3=Cl&&(!x2||uh&&8<uh&&11>=uh),uN=" ",dN=!1;function K3(e,t){switch(e){case"keyup":return vU.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $d=!1;function wU(e,t){switch(e){case"compositionend":return $3(t);case"keypress":return t.which!==32?null:(dN=!0,uN);case"textInput":return e=t.data,e===uN&&dN?null:e;default:return null}}function _U(e,t){if($d)return e==="compositionend"||!x2&&K3(e,t)?(e=H3(),Qm=p2=fc=null,$d=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return q3&&t.locale!=="ko"?null:t.data;default:return null}}var NU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!NU[e.type]:t==="textarea"}function V3(e,t,r,n){_3(n),t=fg(t,"onChange"),0<t.length&&(r=new m2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var dh=null,Hh=null;function jU(e){nS(e,0)}function wx(e){var t=Wd(e);if(m3(t))return e}function CU(e,t){if(e==="change")return t}var G3=!1;if(Cl){var Y1;if(Cl){var J1="oninput"in document;if(!J1){var fN=document.createElement("div");fN.setAttribute("oninput","return;"),J1=typeof fN.oninput=="function"}Y1=J1}else Y1=!1;G3=Y1&&(!document.documentMode||9<document.documentMode)}function hN(){dh&&(dh.detachEvent("onpropertychange",W3),Hh=dh=null)}function W3(e){if(e.propertyName==="value"&&wx(Hh)){var t=[];V3(t,Hh,e,u2(e)),B3(jU,t)}}function BU(e,t,r){e==="focusin"?(hN(),dh=t,Hh=r,dh.attachEvent("onpropertychange",W3)):e==="focusout"&&hN()}function kU(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wx(Hh)}function SU(e,t){if(e==="click")return wx(t)}function EU(e,t){if(e==="input"||e==="change")return wx(t)}function FU(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mo=typeof Object.is=="function"?Object.is:FU;function qh(e,t){if(mo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Kv.call(t,s)||!mo(e[s],t[s]))return!1}return!0}function pN(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function mN(e,t){var r=pN(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=pN(r)}}function z3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?z3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function X3(){for(var e=window,t=ig();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ig(e.document)}return t}function y2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function TU(e){var t=X3(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&z3(r.ownerDocument.documentElement,r)){if(n!==null&&y2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=mN(r,i);var o=mN(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var IU=Cl&&"documentMode"in document&&11>=document.documentMode,Vd=null,cb=null,Ah=null,ub=!1;function gN(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ub||Vd==null||Vd!==ig(n)||(n=Vd,"selectionStart"in n&&y2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ah&&qh(Ah,n)||(Ah=n,n=fg(cb,"onSelect"),0<n.length&&(t=new m2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Vd)))}function jp(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Gd={animationend:jp("Animation","AnimationEnd"),animationiteration:jp("Animation","AnimationIteration"),animationstart:jp("Animation","AnimationStart"),transitionend:jp("Transition","TransitionEnd")},Z1={},Y3={};Cl&&(Y3=document.createElement("div").style,"AnimationEvent"in window||(delete Gd.animationend.animation,delete Gd.animationiteration.animation,delete Gd.animationstart.animation),"TransitionEvent"in window||delete Gd.transitionend.transition);function _x(e){if(Z1[e])return Z1[e];if(!Gd[e])return e;var t=Gd[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Y3)return Z1[e]=t[r];return e}var J3=_x("animationend"),Z3=_x("animationiteration"),eS=_x("animationstart"),tS=_x("transitionend"),rS=new Map,xN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qc(e,t){rS.set(e,t),Yu(t,[e])}for(var ey=0;ey<xN.length;ey++){var ty=xN[ey],LU=ty.toLowerCase(),OU=ty[0].toUpperCase()+ty.slice(1);Qc(LU,"on"+OU)}Qc(J3,"onAnimationEnd");Qc(Z3,"onAnimationIteration");Qc(eS,"onAnimationStart");Qc("dblclick","onDoubleClick");Qc("focusin","onFocus");Qc("focusout","onBlur");Qc(tS,"onTransitionEnd");bA("onMouseEnter",["mouseout","mouseover"]);bA("onMouseLeave",["mouseout","mouseover"]);bA("onPointerEnter",["pointerout","pointerover"]);bA("onPointerLeave",["pointerout","pointerover"]);Yu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Yu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Yu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Yu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Yu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Yu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UU=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xf));function yN(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,LO(n,t,void 0,e),e.currentTarget=null}function nS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;yN(s,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;yN(s,l,u),i=c}}}if(lg)throw e=sb,lg=!1,sb=null,e}function Jr(e,t){var r=t[pb];r===void 0&&(r=t[pb]=new Set);var n=e+"__bubble";r.has(n)||(aS(t,e,2,!1),r.add(n))}function ry(e,t,r){var n=0;t&&(n|=4),aS(r,e,n,t)}var Cp="_reactListening"+Math.random().toString(36).slice(2);function Kh(e){if(!e[Cp]){e[Cp]=!0,d3.forEach(function(r){r!=="selectionchange"&&(UU.has(r)||ry(r,!1,e),ry(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Cp]||(t[Cp]=!0,ry("selectionchange",!1,t))}}function aS(e,t,r,n){switch(M3(t)){case 1:var s=XO;break;case 4:s=YO;break;default:s=h2}r=s.bind(null,t,r,e),s=void 0,!ab||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function ny(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=wu(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}B3(function(){var u=i,d=u2(r),h=[];e:{var f=rS.get(e);if(f!==void 0){var A=m2,b=e;switch(e){case"keypress":if(Mm(r)===0)break e;case"keydown":case"keyup":A=AU;break;case"focusin":b="focus",A=X1;break;case"focusout":b="blur",A=X1;break;case"beforeblur":case"afterblur":A=X1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=oN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=eU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=pU;break;case J3:case Z3:case eS:A=nU;break;case tS:A=gU;break;case"scroll":A=JO;break;case"wheel":A=yU;break;case"copy":case"cut":case"paste":A=sU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=cN}var m=(t&4)!==0,v=!m&&e==="scroll",p=m?f!==null?f+"Capture":null:f;m=[];for(var g=u,y;g!==null;){y=g;var x=y.stateNode;if(y.tag===5&&x!==null&&(y=x,p!==null&&(x=Dh(g,p),x!=null&&m.push($h(g,x,y)))),v)break;g=g.return}0<m.length&&(f=new A(f,b,null,r,d),h.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",A=e==="mouseout"||e==="pointerout",f&&r!==rb&&(b=r.relatedTarget||r.fromElement)&&(wu(b)||b[Bl]))break e;if((A||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,A?(b=r.relatedTarget||r.toElement,A=u,b=b?wu(b):null,b!==null&&(v=Ju(b),b!==v||b.tag!==5&&b.tag!==6)&&(b=null)):(A=null,b=u),A!==b)){if(m=oN,x="onMouseLeave",p="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(m=cN,x="onPointerLeave",p="onPointerEnter",g="pointer"),v=A==null?f:Wd(A),y=b==null?f:Wd(b),f=new m(x,g+"leave",A,r,d),f.target=v,f.relatedTarget=y,x=null,wu(d)===u&&(m=new m(p,g+"enter",b,r,d),m.target=y,m.relatedTarget=v,x=m),v=x,A&&b)t:{for(m=A,p=b,g=0,y=m;y;y=xd(y))g++;for(y=0,x=p;x;x=xd(x))y++;for(;0<g-y;)m=xd(m),g--;for(;0<y-g;)p=xd(p),y--;for(;g--;){if(m===p||p!==null&&m===p.alternate)break t;m=xd(m),p=xd(p)}m=null}else m=null;A!==null&&vN(h,f,A,m,!1),b!==null&&v!==null&&vN(h,v,b,m,!0)}}e:{if(f=u?Wd(u):window,A=f.nodeName&&f.nodeName.toLowerCase(),A==="select"||A==="input"&&f.type==="file")var w=CU;else if(AN(f))if(G3)w=EU;else{w=kU;var N=BU}else(A=f.nodeName)&&A.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(w=SU);if(w&&(w=w(e,u))){V3(h,w,r,d);break e}N&&N(e,f,u),e==="focusout"&&(N=f._wrapperState)&&N.controlled&&f.type==="number"&&Yv(f,"number",f.value)}switch(N=u?Wd(u):window,e){case"focusin":(AN(N)||N.contentEditable==="true")&&(Vd=N,cb=u,Ah=null);break;case"focusout":Ah=cb=Vd=null;break;case"mousedown":ub=!0;break;case"contextmenu":case"mouseup":case"dragend":ub=!1,gN(h,r,d);break;case"selectionchange":if(IU)break;case"keydown":case"keyup":gN(h,r,d)}var _;if(x2)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else $d?K3(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(q3&&r.locale!=="ko"&&($d||C!=="onCompositionStart"?C==="onCompositionEnd"&&$d&&(_=H3()):(fc=d,p2="value"in fc?fc.value:fc.textContent,$d=!0)),N=fg(u,C),0<N.length&&(C=new lN(C,e,null,r,d),h.push({event:C,listeners:N}),_?C.data=_:(_=$3(r),_!==null&&(C.data=_)))),(_=bU?wU(e,r):_U(e,r))&&(u=fg(u,"onBeforeInput"),0<u.length&&(d=new lN("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=_))}nS(h,t)})}function $h(e,t,r){return{instance:e,listener:t,currentTarget:r}}function fg(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Dh(e,r),i!=null&&n.unshift($h(e,i,s)),i=Dh(e,t),i!=null&&n.push($h(e,i,s))),e=e.return}return n}function xd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vN(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Dh(r,i),c!=null&&o.unshift($h(r,c,l))):s||(c=Dh(r,i),c!=null&&o.push($h(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var PU=/\r\n?/g,DU=/\u0000|\uFFFD/g;function bN(e){return(typeof e=="string"?e:""+e).replace(PU,`
`).replace(DU,"")}function Bp(e,t,r){if(t=bN(t),bN(e)!==t&&r)throw Error(yt(425))}function hg(){}var db=null,Ab=null;function fb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hb=typeof setTimeout=="function"?setTimeout:void 0,RU=typeof clearTimeout=="function"?clearTimeout:void 0,wN=typeof Promise=="function"?Promise:void 0,QU=typeof queueMicrotask=="function"?queueMicrotask:typeof wN<"u"?function(e){return wN.resolve(null).then(e).catch(MU)}:hb;function MU(e){setTimeout(function(){throw e})}function ay(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Mh(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Mh(t)}function Nc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function _N(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var UA=Math.random().toString(36).slice(2),Uo="__reactFiber$"+UA,Vh="__reactProps$"+UA,Bl="__reactContainer$"+UA,pb="__reactEvents$"+UA,HU="__reactListeners$"+UA,qU="__reactHandles$"+UA;function wu(e){var t=e[Uo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Bl]||r[Uo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=_N(e);e!==null;){if(r=e[Uo])return r;e=_N(e)}return t}e=r,r=e.parentNode}return null}function C0(e){return e=e[Uo]||e[Bl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(yt(33))}function Nx(e){return e[Vh]||null}var mb=[],zd=-1;function Mc(e){return{current:e}}function rn(e){0>zd||(e.current=mb[zd],mb[zd]=null,zd--)}function zr(e,t){zd++,mb[zd]=e.current,e.current=t}var Ic={},is=Mc(Ic),Is=Mc(!1),Pu=Ic;function wA(e,t){var r=e.type.contextTypes;if(!r)return Ic;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ls(e){return e=e.childContextTypes,e!=null}function pg(){rn(Is),rn(is)}function NN(e,t,r){if(is.current!==Ic)throw Error(yt(168));zr(is,t),zr(Is,r)}function sS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(yt(108,BO(e)||"Unknown",s));return xn({},r,n)}function mg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ic,Pu=is.current,zr(is,e),zr(Is,Is.current),!0}function jN(e,t,r){var n=e.stateNode;if(!n)throw Error(yt(169));r?(e=sS(e,t,Pu),n.__reactInternalMemoizedMergedChildContext=e,rn(Is),rn(is),zr(is,e)):rn(Is),zr(Is,r)}var ml=null,jx=!1,sy=!1;function iS(e){ml===null?ml=[e]:ml.push(e)}function KU(e){jx=!0,iS(e)}function Hc(){if(!sy&&ml!==null){sy=!0;var e=0,t=Ur;try{var r=ml;for(Ur=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ml=null,jx=!1}catch(s){throw ml!==null&&(ml=ml.slice(e+1)),F3(d2,Hc),s}finally{Ur=t,sy=!1}}return null}var Xd=[],Yd=0,gg=null,xg=0,ki=[],Si=0,Du=null,xl=1,yl="";function du(e,t){Xd[Yd++]=xg,Xd[Yd++]=gg,gg=e,xg=t}function oS(e,t,r){ki[Si++]=xl,ki[Si++]=yl,ki[Si++]=Du,Du=e;var n=xl;e=yl;var s=32-uo(n)-1;n&=~(1<<s),r+=1;var i=32-uo(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,xl=1<<32-uo(t)+s|r<<s|n,yl=i+e}else xl=1<<i|r<<s|n,yl=e}function v2(e){e.return!==null&&(du(e,1),oS(e,1,0))}function b2(e){for(;e===gg;)gg=Xd[--Yd],Xd[Yd]=null,xg=Xd[--Yd],Xd[Yd]=null;for(;e===Du;)Du=ki[--Si],ki[Si]=null,yl=ki[--Si],ki[Si]=null,xl=ki[--Si],ki[Si]=null}var ci=null,oi=null,cn=!1,io=null;function lS(e,t){var r=Ti(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function CN(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ci=e,oi=Nc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ci=e,oi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Du!==null?{id:xl,overflow:yl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ti(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ci=e,oi=null,!0):!1;default:return!1}}function gb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function xb(e){if(cn){var t=oi;if(t){var r=t;if(!CN(e,t)){if(gb(e))throw Error(yt(418));t=Nc(r.nextSibling);var n=ci;t&&CN(e,t)?lS(n,r):(e.flags=e.flags&-4097|2,cn=!1,ci=e)}}else{if(gb(e))throw Error(yt(418));e.flags=e.flags&-4097|2,cn=!1,ci=e}}}function BN(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ci=e}function kp(e){if(e!==ci)return!1;if(!cn)return BN(e),cn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fb(e.type,e.memoizedProps)),t&&(t=oi)){if(gb(e))throw cS(),Error(yt(418));for(;t;)lS(e,t),t=Nc(t.nextSibling)}if(BN(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(yt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){oi=Nc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}oi=null}}else oi=ci?Nc(e.stateNode.nextSibling):null;return!0}function cS(){for(var e=oi;e;)e=Nc(e.nextSibling)}function _A(){oi=ci=null,cn=!1}function w2(e){io===null?io=[e]:io.push(e)}var $U=Ll.ReactCurrentBatchConfig;function Ef(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(yt(309));var n=r.stateNode}if(!n)throw Error(yt(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(yt(284));if(!r._owner)throw Error(yt(290,e))}return e}function Sp(e,t){throw e=Object.prototype.toString.call(t),Error(yt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function kN(e){var t=e._init;return t(e._payload)}function uS(e){function t(p,g){if(e){var y=p.deletions;y===null?(p.deletions=[g],p.flags|=16):y.push(g)}}function r(p,g){if(!e)return null;for(;g!==null;)t(p,g),g=g.sibling;return null}function n(p,g){for(p=new Map;g!==null;)g.key!==null?p.set(g.key,g):p.set(g.index,g),g=g.sibling;return p}function s(p,g){return p=kc(p,g),p.index=0,p.sibling=null,p}function i(p,g,y){return p.index=y,e?(y=p.alternate,y!==null?(y=y.index,y<g?(p.flags|=2,g):y):(p.flags|=2,g)):(p.flags|=1048576,g)}function o(p){return e&&p.alternate===null&&(p.flags|=2),p}function l(p,g,y,x){return g===null||g.tag!==6?(g=Ay(y,p.mode,x),g.return=p,g):(g=s(g,y),g.return=p,g)}function c(p,g,y,x){var w=y.type;return w===Kd?d(p,g,y.props.children,x,y.key):g!==null&&(g.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===oc&&kN(w)===g.type)?(x=s(g,y.props),x.ref=Ef(p,g,y),x.return=p,x):(x=Wm(y.type,y.key,y.props,null,p.mode,x),x.ref=Ef(p,g,y),x.return=p,x)}function u(p,g,y,x){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=fy(y,p.mode,x),g.return=p,g):(g=s(g,y.children||[]),g.return=p,g)}function d(p,g,y,x,w){return g===null||g.tag!==7?(g=Su(y,p.mode,x,w),g.return=p,g):(g=s(g,y),g.return=p,g)}function h(p,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Ay(""+g,p.mode,y),g.return=p,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case xp:return y=Wm(g.type,g.key,g.props,null,p.mode,y),y.ref=Ef(p,null,g),y.return=p,y;case qd:return g=fy(g,p.mode,y),g.return=p,g;case oc:var x=g._init;return h(p,x(g._payload),y)}if(Wf(g)||jf(g))return g=Su(g,p.mode,y,null),g.return=p,g;Sp(p,g)}return null}function f(p,g,y,x){var w=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return w!==null?null:l(p,g,""+y,x);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case xp:return y.key===w?c(p,g,y,x):null;case qd:return y.key===w?u(p,g,y,x):null;case oc:return w=y._init,f(p,g,w(y._payload),x)}if(Wf(y)||jf(y))return w!==null?null:d(p,g,y,x,null);Sp(p,y)}return null}function A(p,g,y,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return p=p.get(y)||null,l(g,p,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case xp:return p=p.get(x.key===null?y:x.key)||null,c(g,p,x,w);case qd:return p=p.get(x.key===null?y:x.key)||null,u(g,p,x,w);case oc:var N=x._init;return A(p,g,y,N(x._payload),w)}if(Wf(x)||jf(x))return p=p.get(y)||null,d(g,p,x,w,null);Sp(g,x)}return null}function b(p,g,y,x){for(var w=null,N=null,_=g,C=g=0,j=null;_!==null&&C<y.length;C++){_.index>C?(j=_,_=null):j=_.sibling;var E=f(p,_,y[C],x);if(E===null){_===null&&(_=j);break}e&&_&&E.alternate===null&&t(p,_),g=i(E,g,C),N===null?w=E:N.sibling=E,N=E,_=j}if(C===y.length)return r(p,_),cn&&du(p,C),w;if(_===null){for(;C<y.length;C++)_=h(p,y[C],x),_!==null&&(g=i(_,g,C),N===null?w=_:N.sibling=_,N=_);return cn&&du(p,C),w}for(_=n(p,_);C<y.length;C++)j=A(_,p,C,y[C],x),j!==null&&(e&&j.alternate!==null&&_.delete(j.key===null?C:j.key),g=i(j,g,C),N===null?w=j:N.sibling=j,N=j);return e&&_.forEach(function(S){return t(p,S)}),cn&&du(p,C),w}function m(p,g,y,x){var w=jf(y);if(typeof w!="function")throw Error(yt(150));if(y=w.call(y),y==null)throw Error(yt(151));for(var N=w=null,_=g,C=g=0,j=null,E=y.next();_!==null&&!E.done;C++,E=y.next()){_.index>C?(j=_,_=null):j=_.sibling;var S=f(p,_,E.value,x);if(S===null){_===null&&(_=j);break}e&&_&&S.alternate===null&&t(p,_),g=i(S,g,C),N===null?w=S:N.sibling=S,N=S,_=j}if(E.done)return r(p,_),cn&&du(p,C),w;if(_===null){for(;!E.done;C++,E=y.next())E=h(p,E.value,x),E!==null&&(g=i(E,g,C),N===null?w=E:N.sibling=E,N=E);return cn&&du(p,C),w}for(_=n(p,_);!E.done;C++,E=y.next())E=A(_,p,C,E.value,x),E!==null&&(e&&E.alternate!==null&&_.delete(E.key===null?C:E.key),g=i(E,g,C),N===null?w=E:N.sibling=E,N=E);return e&&_.forEach(function(F){return t(p,F)}),cn&&du(p,C),w}function v(p,g,y,x){if(typeof y=="object"&&y!==null&&y.type===Kd&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case xp:e:{for(var w=y.key,N=g;N!==null;){if(N.key===w){if(w=y.type,w===Kd){if(N.tag===7){r(p,N.sibling),g=s(N,y.props.children),g.return=p,p=g;break e}}else if(N.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===oc&&kN(w)===N.type){r(p,N.sibling),g=s(N,y.props),g.ref=Ef(p,N,y),g.return=p,p=g;break e}r(p,N);break}else t(p,N);N=N.sibling}y.type===Kd?(g=Su(y.props.children,p.mode,x,y.key),g.return=p,p=g):(x=Wm(y.type,y.key,y.props,null,p.mode,x),x.ref=Ef(p,g,y),x.return=p,p=x)}return o(p);case qd:e:{for(N=y.key;g!==null;){if(g.key===N)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){r(p,g.sibling),g=s(g,y.children||[]),g.return=p,p=g;break e}else{r(p,g);break}else t(p,g);g=g.sibling}g=fy(y,p.mode,x),g.return=p,p=g}return o(p);case oc:return N=y._init,v(p,g,N(y._payload),x)}if(Wf(y))return b(p,g,y,x);if(jf(y))return m(p,g,y,x);Sp(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(r(p,g.sibling),g=s(g,y),g.return=p,p=g):(r(p,g),g=Ay(y,p.mode,x),g.return=p,p=g),o(p)):r(p,g)}return v}var NA=uS(!0),dS=uS(!1),yg=Mc(null),vg=null,Jd=null,_2=null;function N2(){_2=Jd=vg=null}function j2(e){var t=yg.current;rn(yg),e._currentValue=t}function yb(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function lA(e,t){vg=e,_2=Jd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ts=!0),e.firstContext=null)}function Pi(e){var t=e._currentValue;if(_2!==e)if(e={context:e,memoizedValue:t,next:null},Jd===null){if(vg===null)throw Error(yt(308));Jd=e,vg.dependencies={lanes:0,firstContext:e}}else Jd=Jd.next=e;return t}var _u=null;function C2(e){_u===null?_u=[e]:_u.push(e)}function AS(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,C2(t)):(r.next=s.next,s.next=r),t.interleaved=r,kl(e,n)}function kl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var lc=!1;function B2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function bl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function jc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,vr&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,kl(e,r)}return s=n.interleaved,s===null?(t.next=t,C2(n)):(t.next=s.next,s.next=t),n.interleaved=t,kl(e,r)}function Hm(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,A2(e,r)}}function SN(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function bg(e,t,r,n){var s=e.updateQueue;lc=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,A=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:A,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=e,m=l;switch(f=t,A=r,m.tag){case 1:if(b=m.payload,typeof b=="function"){h=b.call(A,h,f);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=m.payload,f=typeof b=="function"?b.call(A,h,f):b,f==null)break e;h=xn({},h,f);break e;case 2:lc=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else A={eventTime:A,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=A,c=h):d=d.next=A,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Qu|=o,e.lanes=o,e.memoizedState=h}}function EN(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(yt(191,s));s.call(n)}}}var B0={},Qo=Mc(B0),Gh=Mc(B0),Wh=Mc(B0);function Nu(e){if(e===B0)throw Error(yt(174));return e}function k2(e,t){switch(zr(Wh,t),zr(Gh,e),zr(Qo,B0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zv(t,e)}rn(Qo),zr(Qo,t)}function jA(){rn(Qo),rn(Gh),rn(Wh)}function hS(e){Nu(Wh.current);var t=Nu(Qo.current),r=Zv(t,e.type);t!==r&&(zr(Gh,e),zr(Qo,r))}function S2(e){Gh.current===e&&(rn(Qo),rn(Gh))}var hn=Mc(0);function wg(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var iy=[];function E2(){for(var e=0;e<iy.length;e++)iy[e]._workInProgressVersionPrimary=null;iy.length=0}var qm=Ll.ReactCurrentDispatcher,oy=Ll.ReactCurrentBatchConfig,Ru=0,gn=null,ua=null,ya=null,_g=!1,fh=!1,zh=0,VU=0;function qa(){throw Error(yt(321))}function F2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!mo(e[r],t[r]))return!1;return!0}function T2(e,t,r,n,s,i){if(Ru=i,gn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,qm.current=e===null||e.memoizedState===null?XU:YU,e=r(n,s),fh){i=0;do{if(fh=!1,zh=0,25<=i)throw Error(yt(301));i+=1,ya=ua=null,t.updateQueue=null,qm.current=JU,e=r(n,s)}while(fh)}if(qm.current=Ng,t=ua!==null&&ua.next!==null,Ru=0,ya=ua=gn=null,_g=!1,t)throw Error(yt(300));return e}function I2(){var e=zh!==0;return zh=0,e}function Oo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ya===null?gn.memoizedState=ya=e:ya=ya.next=e,ya}function Di(){if(ua===null){var e=gn.alternate;e=e!==null?e.memoizedState:null}else e=ua.next;var t=ya===null?gn.memoizedState:ya.next;if(t!==null)ya=t,ua=e;else{if(e===null)throw Error(yt(310));ua=e,e={memoizedState:ua.memoizedState,baseState:ua.baseState,baseQueue:ua.baseQueue,queue:ua.queue,next:null},ya===null?gn.memoizedState=ya=e:ya=ya.next=e}return ya}function Xh(e,t){return typeof t=="function"?t(e):t}function ly(e){var t=Di(),r=t.queue;if(r===null)throw Error(yt(311));r.lastRenderedReducer=e;var n=ua,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Ru&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,gn.lanes|=d,Qu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,mo(n,t.memoizedState)||(Ts=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,gn.lanes|=i,Qu|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function cy(e){var t=Di(),r=t.queue;if(r===null)throw Error(yt(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);mo(i,t.memoizedState)||(Ts=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function pS(){}function mS(e,t){var r=gn,n=Di(),s=t(),i=!mo(n.memoizedState,s);if(i&&(n.memoizedState=s,Ts=!0),n=n.queue,L2(yS.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||ya!==null&&ya.memoizedState.tag&1){if(r.flags|=2048,Yh(9,xS.bind(null,r,n,s,t),void 0,null),_a===null)throw Error(yt(349));Ru&30||gS(r,t,s)}return s}function gS(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gn.updateQueue,t===null?(t={lastEffect:null,stores:null},gn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function xS(e,t,r,n){t.value=r,t.getSnapshot=n,vS(t)&&bS(e)}function yS(e,t,r){return r(function(){vS(t)&&bS(e)})}function vS(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!mo(e,r)}catch{return!0}}function bS(e){var t=kl(e,1);t!==null&&Ao(t,e,1,-1)}function FN(e){var t=Oo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xh,lastRenderedState:e},t.queue=e,e=e.dispatch=zU.bind(null,gn,e),[t.memoizedState,e]}function Yh(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=gn.updateQueue,t===null?(t={lastEffect:null,stores:null},gn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function wS(){return Di().memoizedState}function Km(e,t,r,n){var s=Oo();gn.flags|=e,s.memoizedState=Yh(1|t,r,void 0,n===void 0?null:n)}function Cx(e,t,r,n){var s=Di();n=n===void 0?null:n;var i=void 0;if(ua!==null){var o=ua.memoizedState;if(i=o.destroy,n!==null&&F2(n,o.deps)){s.memoizedState=Yh(t,r,i,n);return}}gn.flags|=e,s.memoizedState=Yh(1|t,r,i,n)}function TN(e,t){return Km(8390656,8,e,t)}function L2(e,t){return Cx(2048,8,e,t)}function _S(e,t){return Cx(4,2,e,t)}function NS(e,t){return Cx(4,4,e,t)}function jS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function CS(e,t,r){return r=r!=null?r.concat([e]):null,Cx(4,4,jS.bind(null,t,e),r)}function O2(){}function BS(e,t){var r=Di();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&F2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function kS(e,t){var r=Di();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&F2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function SS(e,t,r){return Ru&21?(mo(r,t)||(r=L3(),gn.lanes|=r,Qu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ts=!0),e.memoizedState=r)}function GU(e,t){var r=Ur;Ur=r!==0&&4>r?r:4,e(!0);var n=oy.transition;oy.transition={};try{e(!1),t()}finally{Ur=r,oy.transition=n}}function ES(){return Di().memoizedState}function WU(e,t,r){var n=Bc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},FS(e))TS(t,r);else if(r=AS(e,t,r,n),r!==null){var s=vs();Ao(r,e,n,s),IS(r,t,n)}}function zU(e,t,r){var n=Bc(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(FS(e))TS(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,mo(l,o)){var c=t.interleaved;c===null?(s.next=s,C2(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=AS(e,t,s,n),r!==null&&(s=vs(),Ao(r,e,n,s),IS(r,t,n))}}function FS(e){var t=e.alternate;return e===gn||t!==null&&t===gn}function TS(e,t){fh=_g=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function IS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,A2(e,r)}}var Ng={readContext:Pi,useCallback:qa,useContext:qa,useEffect:qa,useImperativeHandle:qa,useInsertionEffect:qa,useLayoutEffect:qa,useMemo:qa,useReducer:qa,useRef:qa,useState:qa,useDebugValue:qa,useDeferredValue:qa,useTransition:qa,useMutableSource:qa,useSyncExternalStore:qa,useId:qa,unstable_isNewReconciler:!1},XU={readContext:Pi,useCallback:function(e,t){return Oo().memoizedState=[e,t===void 0?null:t],e},useContext:Pi,useEffect:TN,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Km(4194308,4,jS.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Km(4194308,4,e,t)},useInsertionEffect:function(e,t){return Km(4,2,e,t)},useMemo:function(e,t){var r=Oo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Oo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=WU.bind(null,gn,e),[n.memoizedState,e]},useRef:function(e){var t=Oo();return e={current:e},t.memoizedState=e},useState:FN,useDebugValue:O2,useDeferredValue:function(e){return Oo().memoizedState=e},useTransition:function(){var e=FN(!1),t=e[0];return e=GU.bind(null,e[1]),Oo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gn,s=Oo();if(cn){if(r===void 0)throw Error(yt(407));r=r()}else{if(r=t(),_a===null)throw Error(yt(349));Ru&30||gS(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,TN(yS.bind(null,n,i,e),[e]),n.flags|=2048,Yh(9,xS.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Oo(),t=_a.identifierPrefix;if(cn){var r=yl,n=xl;r=(n&~(1<<32-uo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=zh++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=VU++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},YU={readContext:Pi,useCallback:BS,useContext:Pi,useEffect:L2,useImperativeHandle:CS,useInsertionEffect:_S,useLayoutEffect:NS,useMemo:kS,useReducer:ly,useRef:wS,useState:function(){return ly(Xh)},useDebugValue:O2,useDeferredValue:function(e){var t=Di();return SS(t,ua.memoizedState,e)},useTransition:function(){var e=ly(Xh)[0],t=Di().memoizedState;return[e,t]},useMutableSource:pS,useSyncExternalStore:mS,useId:ES,unstable_isNewReconciler:!1},JU={readContext:Pi,useCallback:BS,useContext:Pi,useEffect:L2,useImperativeHandle:CS,useInsertionEffect:_S,useLayoutEffect:NS,useMemo:kS,useReducer:cy,useRef:wS,useState:function(){return cy(Xh)},useDebugValue:O2,useDeferredValue:function(e){var t=Di();return ua===null?t.memoizedState=e:SS(t,ua.memoizedState,e)},useTransition:function(){var e=cy(Xh)[0],t=Di().memoizedState;return[e,t]},useMutableSource:pS,useSyncExternalStore:mS,useId:ES,unstable_isNewReconciler:!1};function ro(e,t){if(e&&e.defaultProps){t=xn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function vb(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:xn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Bx={isMounted:function(e){return(e=e._reactInternals)?Ju(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=vs(),s=Bc(e),i=bl(n,s);i.payload=t,r!=null&&(i.callback=r),t=jc(e,i,s),t!==null&&(Ao(t,e,s,n),Hm(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=vs(),s=Bc(e),i=bl(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=jc(e,i,s),t!==null&&(Ao(t,e,s,n),Hm(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=vs(),n=Bc(e),s=bl(r,n);s.tag=2,t!=null&&(s.callback=t),t=jc(e,s,n),t!==null&&(Ao(t,e,n,r),Hm(t,e,n))}};function IN(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!qh(r,n)||!qh(s,i):!0}function LS(e,t,r){var n=!1,s=Ic,i=t.contextType;return typeof i=="object"&&i!==null?i=Pi(i):(s=Ls(t)?Pu:is.current,n=t.contextTypes,i=(n=n!=null)?wA(e,s):Ic),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bx,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function LN(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Bx.enqueueReplaceState(t,t.state,null)}function bb(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},B2(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Pi(i):(i=Ls(t)?Pu:is.current,s.context=wA(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(vb(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Bx.enqueueReplaceState(s,s.state,null),bg(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function CA(e,t){try{var r="",n=t;do r+=CO(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function uy(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function wb(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ZU=typeof WeakMap=="function"?WeakMap:Map;function OS(e,t,r){r=bl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Cg||(Cg=!0,Tb=n),wb(e,t)},r}function US(e,t,r){r=bl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){wb(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){wb(e,t),typeof n!="function"&&(Cc===null?Cc=new Set([this]):Cc.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function ON(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ZU;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=fP.bind(null,e,t,r),t.then(e,e))}function UN(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function PN(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=bl(-1,1),t.tag=2,jc(r,t,1))),r.lanes|=1),e)}var eP=Ll.ReactCurrentOwner,Ts=!1;function ms(e,t,r,n){t.child=e===null?dS(t,null,r,n):NA(t,e.child,r,n)}function DN(e,t,r,n,s){r=r.render;var i=t.ref;return lA(t,s),n=T2(e,t,r,n,i,s),r=I2(),e!==null&&!Ts?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Sl(e,t,s)):(cn&&r&&v2(t),t.flags|=1,ms(e,t,n,s),t.child)}function RN(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!q2(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,PS(e,t,i,n,s)):(e=Wm(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:qh,r(o,n)&&e.ref===t.ref)return Sl(e,t,s)}return t.flags|=1,e=kc(i,n),e.ref=t.ref,e.return=t,t.child=e}function PS(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(qh(i,n)&&e.ref===t.ref)if(Ts=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Ts=!0);else return t.lanes=e.lanes,Sl(e,t,s)}return _b(e,t,r,n,s)}function DS(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},zr(eA,Zs),Zs|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,zr(eA,Zs),Zs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,zr(eA,Zs),Zs|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,zr(eA,Zs),Zs|=n;return ms(e,t,s,r),t.child}function RS(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function _b(e,t,r,n,s){var i=Ls(r)?Pu:is.current;return i=wA(t,i),lA(t,s),r=T2(e,t,r,n,i,s),n=I2(),e!==null&&!Ts?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Sl(e,t,s)):(cn&&n&&v2(t),t.flags|=1,ms(e,t,r,s),t.child)}function QN(e,t,r,n,s){if(Ls(r)){var i=!0;mg(t)}else i=!1;if(lA(t,s),t.stateNode===null)$m(e,t),LS(t,r,n),bb(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Pi(u):(u=Ls(r)?Pu:is.current,u=wA(t,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&LN(t,o,n,u),lc=!1;var f=t.memoizedState;o.state=f,bg(t,n,o,s),c=t.memoizedState,l!==n||f!==c||Is.current||lc?(typeof d=="function"&&(vb(t,r,d,n),c=t.memoizedState),(l=lc||IN(t,r,l,n,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,fS(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:ro(t.type,l),o.props=u,h=t.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Pi(c):(c=Ls(r)?Pu:is.current,c=wA(t,c));var A=r.getDerivedStateFromProps;(d=typeof A=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&LN(t,o,n,c),lc=!1,f=t.memoizedState,o.state=f,bg(t,n,o,s);var b=t.memoizedState;l!==h||f!==b||Is.current||lc?(typeof A=="function"&&(vb(t,r,A,n),b=t.memoizedState),(u=lc||IN(t,r,u,n,f,b,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,b,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=b),o.props=n,o.state=b,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Nb(e,t,r,n,i,s)}function Nb(e,t,r,n,s,i){RS(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&jN(t,r,!1),Sl(e,t,i);n=t.stateNode,eP.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=NA(t,e.child,null,i),t.child=NA(t,null,l,i)):ms(e,t,l,i),t.memoizedState=n.state,s&&jN(t,r,!0),t.child}function QS(e){var t=e.stateNode;t.pendingContext?NN(e,t.pendingContext,t.pendingContext!==t.context):t.context&&NN(e,t.context,!1),k2(e,t.containerInfo)}function MN(e,t,r,n,s){return _A(),w2(s),t.flags|=256,ms(e,t,r,n),t.child}var jb={dehydrated:null,treeContext:null,retryLane:0};function Cb(e){return{baseLanes:e,cachePool:null,transitions:null}}function MS(e,t,r){var n=t.pendingProps,s=hn.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),zr(hn,s&1),e===null)return xb(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ex(o,n,0,null),e=Su(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Cb(r),t.memoizedState=jb,e):U2(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return tP(e,t,o,n,l,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=kc(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=kc(l,i):(i=Su(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Cb(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=jb,n}return i=e.child,e=i.sibling,n=kc(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function U2(e,t){return t=Ex({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ep(e,t,r,n){return n!==null&&w2(n),NA(t,e.child,null,r),e=U2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tP(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=uy(Error(yt(422))),Ep(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Ex({mode:"visible",children:n.children},s,0,null),i=Su(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&NA(t,e.child,null,o),t.child.memoizedState=Cb(o),t.memoizedState=jb,i);if(!(t.mode&1))return Ep(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(yt(419)),n=uy(i,n,void 0),Ep(e,t,o,n)}if(l=(o&e.childLanes)!==0,Ts||l){if(n=_a,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,kl(e,s),Ao(n,e,s,-1))}return H2(),n=uy(Error(yt(421))),Ep(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=hP.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,oi=Nc(s.nextSibling),ci=t,cn=!0,io=null,e!==null&&(ki[Si++]=xl,ki[Si++]=yl,ki[Si++]=Du,xl=e.id,yl=e.overflow,Du=t),t=U2(t,n.children),t.flags|=4096,t)}function HN(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),yb(e.return,t,r)}function dy(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function HS(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(ms(e,t,n.children,r),n=hn.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&HN(e,r,t);else if(e.tag===19)HN(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(zr(hn,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&wg(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),dy(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&wg(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}dy(t,!0,r,null,i);break;case"together":dy(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $m(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Sl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Qu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(yt(153));if(t.child!==null){for(e=t.child,r=kc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=kc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function rP(e,t,r){switch(t.tag){case 3:QS(t),_A();break;case 5:hS(t);break;case 1:Ls(t.type)&&mg(t);break;case 4:k2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;zr(yg,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(zr(hn,hn.current&1),t.flags|=128,null):r&t.child.childLanes?MS(e,t,r):(zr(hn,hn.current&1),e=Sl(e,t,r),e!==null?e.sibling:null);zr(hn,hn.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return HS(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),zr(hn,hn.current),n)break;return null;case 22:case 23:return t.lanes=0,DS(e,t,r)}return Sl(e,t,r)}var qS,Bb,KS,$S;qS=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Bb=function(){};KS=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Nu(Qo.current);var i=null;switch(r){case"input":s=zv(e,s),n=zv(e,n),i=[];break;case"select":s=xn({},s,{value:void 0}),n=xn({},n,{value:void 0}),i=[];break;case"textarea":s=Jv(e,s),n=Jv(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=hg)}eb(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Uh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Uh.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Jr("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};$S=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ff(e,t){if(!cn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ka(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function nP(e,t,r){var n=t.pendingProps;switch(b2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ka(t),null;case 1:return Ls(t.type)&&pg(),Ka(t),null;case 3:return n=t.stateNode,jA(),rn(Is),rn(is),E2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(kp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,io!==null&&(Ob(io),io=null))),Bb(e,t),Ka(t),null;case 5:S2(t);var s=Nu(Wh.current);if(r=t.type,e!==null&&t.stateNode!=null)KS(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(yt(166));return Ka(t),null}if(e=Nu(Qo.current),kp(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Uo]=t,n[Vh]=i,e=(t.mode&1)!==0,r){case"dialog":Jr("cancel",n),Jr("close",n);break;case"iframe":case"object":case"embed":Jr("load",n);break;case"video":case"audio":for(s=0;s<Xf.length;s++)Jr(Xf[s],n);break;case"source":Jr("error",n);break;case"img":case"image":case"link":Jr("error",n),Jr("load",n);break;case"details":Jr("toggle",n);break;case"input":Y5(n,i),Jr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Jr("invalid",n);break;case"textarea":Z5(n,i),Jr("invalid",n)}eb(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Bp(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Bp(n.textContent,l,e),s=["children",""+l]):Uh.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Jr("scroll",n)}switch(r){case"input":yp(n),J5(n,i,!0);break;case"textarea":yp(n),eN(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=hg)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=y3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Uo]=t,e[Vh]=n,qS(e,t,!1,!1),t.stateNode=e;e:{switch(o=tb(r,n),r){case"dialog":Jr("cancel",e),Jr("close",e),s=n;break;case"iframe":case"object":case"embed":Jr("load",e),s=n;break;case"video":case"audio":for(s=0;s<Xf.length;s++)Jr(Xf[s],e);s=n;break;case"source":Jr("error",e),s=n;break;case"img":case"image":case"link":Jr("error",e),Jr("load",e),s=n;break;case"details":Jr("toggle",e),s=n;break;case"input":Y5(e,n),s=zv(e,n),Jr("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=xn({},n,{value:void 0}),Jr("invalid",e);break;case"textarea":Z5(e,n),s=Jv(e,n),Jr("invalid",e);break;default:s=n}eb(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?w3(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&v3(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Ph(e,c):typeof c=="number"&&Ph(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Uh.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Jr("scroll",e):c!=null&&i2(e,i,c,o))}switch(r){case"input":yp(e),J5(e,n,!1);break;case"textarea":yp(e),eN(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Tc(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?aA(e,!!n.multiple,i,!1):n.defaultValue!=null&&aA(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=hg)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ka(t),null;case 6:if(e&&t.stateNode!=null)$S(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(yt(166));if(r=Nu(Wh.current),Nu(Qo.current),kp(t)){if(n=t.stateNode,r=t.memoizedProps,n[Uo]=t,(i=n.nodeValue!==r)&&(e=ci,e!==null))switch(e.tag){case 3:Bp(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bp(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Uo]=t,t.stateNode=n}return Ka(t),null;case 13:if(rn(hn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(cn&&oi!==null&&t.mode&1&&!(t.flags&128))cS(),_A(),t.flags|=98560,i=!1;else if(i=kp(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(yt(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(yt(317));i[Uo]=t}else _A(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ka(t),i=!1}else io!==null&&(Ob(io),io=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||hn.current&1?fa===0&&(fa=3):H2())),t.updateQueue!==null&&(t.flags|=4),Ka(t),null);case 4:return jA(),Bb(e,t),e===null&&Kh(t.stateNode.containerInfo),Ka(t),null;case 10:return j2(t.type._context),Ka(t),null;case 17:return Ls(t.type)&&pg(),Ka(t),null;case 19:if(rn(hn),i=t.memoizedState,i===null)return Ka(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Ff(i,!1);else{if(fa!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=wg(e),o!==null){for(t.flags|=128,Ff(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return zr(hn,hn.current&1|2),t.child}e=e.sibling}i.tail!==null&&Pn()>BA&&(t.flags|=128,n=!0,Ff(i,!1),t.lanes=4194304)}else{if(!n)if(e=wg(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ff(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!cn)return Ka(t),null}else 2*Pn()-i.renderingStartTime>BA&&r!==1073741824&&(t.flags|=128,n=!0,Ff(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Pn(),t.sibling=null,r=hn.current,zr(hn,n?r&1|2:r&1),t):(Ka(t),null);case 22:case 23:return M2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Zs&1073741824&&(Ka(t),t.subtreeFlags&6&&(t.flags|=8192)):Ka(t),null;case 24:return null;case 25:return null}throw Error(yt(156,t.tag))}function aP(e,t){switch(b2(t),t.tag){case 1:return Ls(t.type)&&pg(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return jA(),rn(Is),rn(is),E2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return S2(t),null;case 13:if(rn(hn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(yt(340));_A()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return rn(hn),null;case 4:return jA(),null;case 10:return j2(t.type._context),null;case 22:case 23:return M2(),null;case 24:return null;default:return null}}var Fp=!1,ts=!1,sP=typeof WeakSet=="function"?WeakSet:Set,Et=null;function Zd(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nn(e,t,n)}else r.current=null}function kb(e,t,r){try{r()}catch(n){Nn(e,t,n)}}var qN=!1;function iP(e,t){if(db=dg,e=X3(),y2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var A;h!==r||s!==0&&h.nodeType!==3||(l=o+s),h!==i||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(A=h.firstChild)!==null;)f=h,h=A;for(;;){if(h===e)break t;if(f===r&&++u===s&&(l=o),f===i&&++d===n&&(c=o),(A=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=A}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ab={focusedElem:e,selectionRange:r},dg=!1,Et=t;Et!==null;)if(t=Et,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Et=e;else for(;Et!==null;){t=Et;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var m=b.memoizedProps,v=b.memoizedState,p=t.stateNode,g=p.getSnapshotBeforeUpdate(t.elementType===t.type?m:ro(t.type,m),v);p.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(yt(163))}}catch(x){Nn(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,Et=e;break}Et=t.return}return b=qN,qN=!1,b}function hh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&kb(t,r,i)}s=s.next}while(s!==n)}}function kx(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Sb(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function VS(e){var t=e.alternate;t!==null&&(e.alternate=null,VS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Uo],delete t[Vh],delete t[pb],delete t[HU],delete t[qU])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function GS(e){return e.tag===5||e.tag===3||e.tag===4}function KN(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||GS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Eb(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=hg));else if(n!==4&&(e=e.child,e!==null))for(Eb(e,t,r),e=e.sibling;e!==null;)Eb(e,t,r),e=e.sibling}function Fb(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Fb(e,t,r),e=e.sibling;e!==null;)Fb(e,t,r),e=e.sibling}var Ia=null,ao=!1;function ec(e,t,r){for(r=r.child;r!==null;)WS(e,t,r),r=r.sibling}function WS(e,t,r){if(Ro&&typeof Ro.onCommitFiberUnmount=="function")try{Ro.onCommitFiberUnmount(vx,r)}catch{}switch(r.tag){case 5:ts||Zd(r,t);case 6:var n=Ia,s=ao;Ia=null,ec(e,t,r),Ia=n,ao=s,Ia!==null&&(ao?(e=Ia,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ia.removeChild(r.stateNode));break;case 18:Ia!==null&&(ao?(e=Ia,r=r.stateNode,e.nodeType===8?ay(e.parentNode,r):e.nodeType===1&&ay(e,r),Mh(e)):ay(Ia,r.stateNode));break;case 4:n=Ia,s=ao,Ia=r.stateNode.containerInfo,ao=!0,ec(e,t,r),Ia=n,ao=s;break;case 0:case 11:case 14:case 15:if(!ts&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&kb(r,t,o),s=s.next}while(s!==n)}ec(e,t,r);break;case 1:if(!ts&&(Zd(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Nn(r,t,l)}ec(e,t,r);break;case 21:ec(e,t,r);break;case 22:r.mode&1?(ts=(n=ts)||r.memoizedState!==null,ec(e,t,r),ts=n):ec(e,t,r);break;default:ec(e,t,r)}}function $N(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new sP),t.forEach(function(n){var s=pP.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Xi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ia=l.stateNode,ao=!1;break e;case 3:Ia=l.stateNode.containerInfo,ao=!0;break e;case 4:Ia=l.stateNode.containerInfo,ao=!0;break e}l=l.return}if(Ia===null)throw Error(yt(160));WS(i,o,s),Ia=null,ao=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Nn(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zS(t,e),t=t.sibling}function zS(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Xi(t,e),Bo(e),n&4){try{hh(3,e,e.return),kx(3,e)}catch(m){Nn(e,e.return,m)}try{hh(5,e,e.return)}catch(m){Nn(e,e.return,m)}}break;case 1:Xi(t,e),Bo(e),n&512&&r!==null&&Zd(r,r.return);break;case 5:if(Xi(t,e),Bo(e),n&512&&r!==null&&Zd(r,r.return),e.flags&32){var s=e.stateNode;try{Ph(s,"")}catch(m){Nn(e,e.return,m)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&g3(s,i),tb(l,o);var u=tb(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?w3(s,h):d==="dangerouslySetInnerHTML"?v3(s,h):d==="children"?Ph(s,h):i2(s,d,h,u)}switch(l){case"input":Xv(s,i);break;case"textarea":x3(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var A=i.value;A!=null?aA(s,!!i.multiple,A,!1):f!==!!i.multiple&&(i.defaultValue!=null?aA(s,!!i.multiple,i.defaultValue,!0):aA(s,!!i.multiple,i.multiple?[]:"",!1))}s[Vh]=i}catch(m){Nn(e,e.return,m)}}break;case 6:if(Xi(t,e),Bo(e),n&4){if(e.stateNode===null)throw Error(yt(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(m){Nn(e,e.return,m)}}break;case 3:if(Xi(t,e),Bo(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Mh(t.containerInfo)}catch(m){Nn(e,e.return,m)}break;case 4:Xi(t,e),Bo(e);break;case 13:Xi(t,e),Bo(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(R2=Pn())),n&4&&$N(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(ts=(u=ts)||d,Xi(t,e),ts=u):Xi(t,e),Bo(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Et=e,d=e.child;d!==null;){for(h=Et=d;Et!==null;){switch(f=Et,A=f.child,f.tag){case 0:case 11:case 14:case 15:hh(4,f,f.return);break;case 1:Zd(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(m){Nn(n,r,m)}}break;case 5:Zd(f,f.return);break;case 22:if(f.memoizedState!==null){GN(h);continue}}A!==null?(A.return=f,Et=A):GN(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=b3("display",o))}catch(m){Nn(e,e.return,m)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Nn(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Xi(t,e),Bo(e),n&4&&$N(e);break;case 21:break;default:Xi(t,e),Bo(e)}}function Bo(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(GS(r)){var n=r;break e}r=r.return}throw Error(yt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Ph(s,""),n.flags&=-33);var i=KN(e);Fb(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=KN(e);Eb(e,l,o);break;default:throw Error(yt(161))}}catch(c){Nn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function oP(e,t,r){Et=e,XS(e)}function XS(e,t,r){for(var n=(e.mode&1)!==0;Et!==null;){var s=Et,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Fp;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||ts;l=Fp;var u=ts;if(Fp=o,(ts=c)&&!u)for(Et=s;Et!==null;)o=Et,c=o.child,o.tag===22&&o.memoizedState!==null?WN(s):c!==null?(c.return=o,Et=c):WN(s);for(;i!==null;)Et=i,XS(i),i=i.sibling;Et=s,Fp=l,ts=u}VN(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Et=i):VN(e)}}function VN(e){for(;Et!==null;){var t=Et;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ts||kx(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ts)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ro(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&EN(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}EN(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Mh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(yt(163))}ts||t.flags&512&&Sb(t)}catch(f){Nn(t,t.return,f)}}if(t===e){Et=null;break}if(r=t.sibling,r!==null){r.return=t.return,Et=r;break}Et=t.return}}function GN(e){for(;Et!==null;){var t=Et;if(t===e){Et=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Et=r;break}Et=t.return}}function WN(e){for(;Et!==null;){var t=Et;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{kx(4,t)}catch(c){Nn(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Nn(t,s,c)}}var i=t.return;try{Sb(t)}catch(c){Nn(t,i,c)}break;case 5:var o=t.return;try{Sb(t)}catch(c){Nn(t,o,c)}}}catch(c){Nn(t,t.return,c)}if(t===e){Et=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Et=l;break}Et=t.return}}var lP=Math.ceil,jg=Ll.ReactCurrentDispatcher,P2=Ll.ReactCurrentOwner,Oi=Ll.ReactCurrentBatchConfig,vr=0,_a=null,Jn=null,Da=0,Zs=0,eA=Mc(0),fa=0,Jh=null,Qu=0,Sx=0,D2=0,ph=null,Fs=null,R2=0,BA=1/0,hl=null,Cg=!1,Tb=null,Cc=null,Tp=!1,hc=null,Bg=0,mh=0,Ib=null,Vm=-1,Gm=0;function vs(){return vr&6?Pn():Vm!==-1?Vm:Vm=Pn()}function Bc(e){return e.mode&1?vr&2&&Da!==0?Da&-Da:$U.transition!==null?(Gm===0&&(Gm=L3()),Gm):(e=Ur,e!==0||(e=window.event,e=e===void 0?16:M3(e.type)),e):1}function Ao(e,t,r,n){if(50<mh)throw mh=0,Ib=null,Error(yt(185));N0(e,r,n),(!(vr&2)||e!==_a)&&(e===_a&&(!(vr&2)&&(Sx|=r),fa===4&&dc(e,Da)),Os(e,n),r===1&&vr===0&&!(t.mode&1)&&(BA=Pn()+500,jx&&Hc()))}function Os(e,t){var r=e.callbackNode;$O(e,t);var n=ug(e,e===_a?Da:0);if(n===0)r!==null&&nN(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&nN(r),t===1)e.tag===0?KU(zN.bind(null,e)):iS(zN.bind(null,e)),QU(function(){!(vr&6)&&Hc()}),r=null;else{switch(O3(n)){case 1:r=d2;break;case 4:r=T3;break;case 16:r=cg;break;case 536870912:r=I3;break;default:r=cg}r=aE(r,YS.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function YS(e,t){if(Vm=-1,Gm=0,vr&6)throw Error(yt(327));var r=e.callbackNode;if(cA()&&e.callbackNode!==r)return null;var n=ug(e,e===_a?Da:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=kg(e,n);else{t=n;var s=vr;vr|=2;var i=ZS();(_a!==e||Da!==t)&&(hl=null,BA=Pn()+500,ku(e,t));do try{dP();break}catch(l){JS(e,l)}while(!0);N2(),jg.current=i,vr=s,Jn!==null?t=0:(_a=null,Da=0,t=fa)}if(t!==0){if(t===2&&(s=ib(e),s!==0&&(n=s,t=Lb(e,s))),t===1)throw r=Jh,ku(e,0),dc(e,n),Os(e,Pn()),r;if(t===6)dc(e,n);else{if(s=e.current.alternate,!(n&30)&&!cP(s)&&(t=kg(e,n),t===2&&(i=ib(e),i!==0&&(n=i,t=Lb(e,i))),t===1))throw r=Jh,ku(e,0),dc(e,n),Os(e,Pn()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(yt(345));case 2:Au(e,Fs,hl);break;case 3:if(dc(e,n),(n&130023424)===n&&(t=R2+500-Pn(),10<t)){if(ug(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){vs(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=hb(Au.bind(null,e,Fs,hl),t);break}Au(e,Fs,hl);break;case 4:if(dc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-uo(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=Pn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lP(n/1960))-n,10<n){e.timeoutHandle=hb(Au.bind(null,e,Fs,hl),n);break}Au(e,Fs,hl);break;case 5:Au(e,Fs,hl);break;default:throw Error(yt(329))}}}return Os(e,Pn()),e.callbackNode===r?YS.bind(null,e):null}function Lb(e,t){var r=ph;return e.current.memoizedState.isDehydrated&&(ku(e,t).flags|=256),e=kg(e,t),e!==2&&(t=Fs,Fs=r,t!==null&&Ob(t)),e}function Ob(e){Fs===null?Fs=e:Fs.push.apply(Fs,e)}function cP(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!mo(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function dc(e,t){for(t&=~D2,t&=~Sx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-uo(t),n=1<<r;e[r]=-1,t&=~n}}function zN(e){if(vr&6)throw Error(yt(327));cA();var t=ug(e,0);if(!(t&1))return Os(e,Pn()),null;var r=kg(e,t);if(e.tag!==0&&r===2){var n=ib(e);n!==0&&(t=n,r=Lb(e,n))}if(r===1)throw r=Jh,ku(e,0),dc(e,t),Os(e,Pn()),r;if(r===6)throw Error(yt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Au(e,Fs,hl),Os(e,Pn()),null}function Q2(e,t){var r=vr;vr|=1;try{return e(t)}finally{vr=r,vr===0&&(BA=Pn()+500,jx&&Hc())}}function Mu(e){hc!==null&&hc.tag===0&&!(vr&6)&&cA();var t=vr;vr|=1;var r=Oi.transition,n=Ur;try{if(Oi.transition=null,Ur=1,e)return e()}finally{Ur=n,Oi.transition=r,vr=t,!(vr&6)&&Hc()}}function M2(){Zs=eA.current,rn(eA)}function ku(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,RU(r)),Jn!==null)for(r=Jn.return;r!==null;){var n=r;switch(b2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&pg();break;case 3:jA(),rn(Is),rn(is),E2();break;case 5:S2(n);break;case 4:jA();break;case 13:rn(hn);break;case 19:rn(hn);break;case 10:j2(n.type._context);break;case 22:case 23:M2()}r=r.return}if(_a=e,Jn=e=kc(e.current,null),Da=Zs=t,fa=0,Jh=null,D2=Sx=Qu=0,Fs=ph=null,_u!==null){for(t=0;t<_u.length;t++)if(r=_u[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}_u=null}return e}function JS(e,t){do{var r=Jn;try{if(N2(),qm.current=Ng,_g){for(var n=gn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}_g=!1}if(Ru=0,ya=ua=gn=null,fh=!1,zh=0,P2.current=null,r===null||r.return===null){fa=1,Jh=t,Jn=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Da,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var A=UN(o);if(A!==null){A.flags&=-257,PN(A,o,l,i,t),A.mode&1&&ON(i,u,t),t=A,c=u;var b=t.updateQueue;if(b===null){var m=new Set;m.add(c),t.updateQueue=m}else b.add(c);break e}else{if(!(t&1)){ON(i,u,t),H2();break e}c=Error(yt(426))}}else if(cn&&l.mode&1){var v=UN(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),PN(v,o,l,i,t),w2(CA(c,l));break e}}i=c=CA(c,l),fa!==4&&(fa=2),ph===null?ph=[i]:ph.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var p=OS(i,c,t);SN(i,p);break e;case 1:l=c;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Cc===null||!Cc.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var x=US(i,l,t);SN(i,x);break e}}i=i.return}while(i!==null)}tE(r)}catch(w){t=w,Jn===r&&r!==null&&(Jn=r=r.return);continue}break}while(!0)}function ZS(){var e=jg.current;return jg.current=Ng,e===null?Ng:e}function H2(){(fa===0||fa===3||fa===2)&&(fa=4),_a===null||!(Qu&268435455)&&!(Sx&268435455)||dc(_a,Da)}function kg(e,t){var r=vr;vr|=2;var n=ZS();(_a!==e||Da!==t)&&(hl=null,ku(e,t));do try{uP();break}catch(s){JS(e,s)}while(!0);if(N2(),vr=r,jg.current=n,Jn!==null)throw Error(yt(261));return _a=null,Da=0,fa}function uP(){for(;Jn!==null;)eE(Jn)}function dP(){for(;Jn!==null&&!UO();)eE(Jn)}function eE(e){var t=nE(e.alternate,e,Zs);e.memoizedProps=e.pendingProps,t===null?tE(e):Jn=t,P2.current=null}function tE(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=aP(r,t),r!==null){r.flags&=32767,Jn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{fa=6,Jn=null;return}}else if(r=nP(r,t,Zs),r!==null){Jn=r;return}if(t=t.sibling,t!==null){Jn=t;return}Jn=t=e}while(t!==null);fa===0&&(fa=5)}function Au(e,t,r){var n=Ur,s=Oi.transition;try{Oi.transition=null,Ur=1,AP(e,t,r,n)}finally{Oi.transition=s,Ur=n}return null}function AP(e,t,r,n){do cA();while(hc!==null);if(vr&6)throw Error(yt(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(yt(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(VO(e,i),e===_a&&(Jn=_a=null,Da=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Tp||(Tp=!0,aE(cg,function(){return cA(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Oi.transition,Oi.transition=null;var o=Ur;Ur=1;var l=vr;vr|=4,P2.current=null,iP(e,r),zS(r,e),TU(Ab),dg=!!db,Ab=db=null,e.current=r,oP(r),PO(),vr=l,Ur=o,Oi.transition=i}else e.current=r;if(Tp&&(Tp=!1,hc=e,Bg=s),i=e.pendingLanes,i===0&&(Cc=null),QO(r.stateNode),Os(e,Pn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Cg)throw Cg=!1,e=Tb,Tb=null,e;return Bg&1&&e.tag!==0&&cA(),i=e.pendingLanes,i&1?e===Ib?mh++:(mh=0,Ib=e):mh=0,Hc(),null}function cA(){if(hc!==null){var e=O3(Bg),t=Oi.transition,r=Ur;try{if(Oi.transition=null,Ur=16>e?16:e,hc===null)var n=!1;else{if(e=hc,hc=null,Bg=0,vr&6)throw Error(yt(331));var s=vr;for(vr|=4,Et=e.current;Et!==null;){var i=Et,o=i.child;if(Et.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Et=u;Et!==null;){var d=Et;switch(d.tag){case 0:case 11:case 15:hh(8,d,i)}var h=d.child;if(h!==null)h.return=d,Et=h;else for(;Et!==null;){d=Et;var f=d.sibling,A=d.return;if(VS(d),d===u){Et=null;break}if(f!==null){f.return=A,Et=f;break}Et=A}}}var b=i.alternate;if(b!==null){var m=b.child;if(m!==null){b.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}Et=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Et=o;else e:for(;Et!==null;){if(i=Et,i.flags&2048)switch(i.tag){case 0:case 11:case 15:hh(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,Et=p;break e}Et=i.return}}var g=e.current;for(Et=g;Et!==null;){o=Et;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,Et=y;else e:for(o=g;Et!==null;){if(l=Et,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:kx(9,l)}}catch(w){Nn(l,l.return,w)}if(l===o){Et=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,Et=x;break e}Et=l.return}}if(vr=s,Hc(),Ro&&typeof Ro.onPostCommitFiberRoot=="function")try{Ro.onPostCommitFiberRoot(vx,e)}catch{}n=!0}return n}finally{Ur=r,Oi.transition=t}}return!1}function XN(e,t,r){t=CA(r,t),t=OS(e,t,1),e=jc(e,t,1),t=vs(),e!==null&&(N0(e,1,t),Os(e,t))}function Nn(e,t,r){if(e.tag===3)XN(e,e,r);else for(;t!==null;){if(t.tag===3){XN(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Cc===null||!Cc.has(n))){e=CA(r,e),e=US(t,e,1),t=jc(t,e,1),e=vs(),t!==null&&(N0(t,1,e),Os(t,e));break}}t=t.return}}function fP(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=vs(),e.pingedLanes|=e.suspendedLanes&r,_a===e&&(Da&r)===r&&(fa===4||fa===3&&(Da&130023424)===Da&&500>Pn()-R2?ku(e,0):D2|=r),Os(e,t)}function rE(e,t){t===0&&(e.mode&1?(t=wp,wp<<=1,!(wp&130023424)&&(wp=4194304)):t=1);var r=vs();e=kl(e,t),e!==null&&(N0(e,t,r),Os(e,r))}function hP(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),rE(e,r)}function pP(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(yt(314))}n!==null&&n.delete(t),rE(e,r)}var nE;nE=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Is.current)Ts=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ts=!1,rP(e,t,r);Ts=!!(e.flags&131072)}else Ts=!1,cn&&t.flags&1048576&&oS(t,xg,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;$m(e,t),e=t.pendingProps;var s=wA(t,is.current);lA(t,r),s=T2(null,t,n,e,s,r);var i=I2();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ls(n)?(i=!0,mg(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,B2(t),s.updater=Bx,t.stateNode=s,s._reactInternals=t,bb(t,n,e,r),t=Nb(null,t,n,!0,i,r)):(t.tag=0,cn&&i&&v2(t),ms(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch($m(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=gP(n),e=ro(n,e),s){case 0:t=_b(null,t,n,e,r);break e;case 1:t=QN(null,t,n,e,r);break e;case 11:t=DN(null,t,n,e,r);break e;case 14:t=RN(null,t,n,ro(n.type,e),r);break e}throw Error(yt(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ro(n,s),_b(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ro(n,s),QN(e,t,n,s,r);case 3:e:{if(QS(t),e===null)throw Error(yt(387));n=t.pendingProps,i=t.memoizedState,s=i.element,fS(e,t),bg(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=CA(Error(yt(423)),t),t=MN(e,t,n,r,s);break e}else if(n!==s){s=CA(Error(yt(424)),t),t=MN(e,t,n,r,s);break e}else for(oi=Nc(t.stateNode.containerInfo.firstChild),ci=t,cn=!0,io=null,r=dS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_A(),n===s){t=Sl(e,t,r);break e}ms(e,t,n,r)}t=t.child}return t;case 5:return hS(t),e===null&&xb(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,fb(n,s)?o=null:i!==null&&fb(n,i)&&(t.flags|=32),RS(e,t),ms(e,t,o,r),t.child;case 6:return e===null&&xb(t),null;case 13:return MS(e,t,r);case 4:return k2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=NA(t,null,n,r):ms(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ro(n,s),DN(e,t,n,s,r);case 7:return ms(e,t,t.pendingProps,r),t.child;case 8:return ms(e,t,t.pendingProps.children,r),t.child;case 12:return ms(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,zr(yg,n._currentValue),n._currentValue=o,i!==null)if(mo(i.value,o)){if(i.children===s.children&&!Is.current){t=Sl(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=bl(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),yb(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(yt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),yb(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ms(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,lA(t,r),s=Pi(s),n=n(s),t.flags|=1,ms(e,t,n,r),t.child;case 14:return n=t.type,s=ro(n,t.pendingProps),s=ro(n.type,s),RN(e,t,n,s,r);case 15:return PS(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ro(n,s),$m(e,t),t.tag=1,Ls(n)?(e=!0,mg(t)):e=!1,lA(t,r),LS(t,n,s),bb(t,n,s,r),Nb(null,t,n,!0,e,r);case 19:return HS(e,t,r);case 22:return DS(e,t,r)}throw Error(yt(156,t.tag))};function aE(e,t){return F3(e,t)}function mP(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ti(e,t,r,n){return new mP(e,t,r,n)}function q2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function gP(e){if(typeof e=="function")return q2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===l2)return 11;if(e===c2)return 14}return 2}function kc(e,t){var r=e.alternate;return r===null?(r=Ti(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Wm(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")q2(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Kd:return Su(r.children,s,i,t);case o2:o=8,s|=8;break;case $v:return e=Ti(12,r,t,s|2),e.elementType=$v,e.lanes=i,e;case Vv:return e=Ti(13,r,t,s),e.elementType=Vv,e.lanes=i,e;case Gv:return e=Ti(19,r,t,s),e.elementType=Gv,e.lanes=i,e;case h3:return Ex(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case A3:o=10;break e;case f3:o=9;break e;case l2:o=11;break e;case c2:o=14;break e;case oc:o=16,n=null;break e}throw Error(yt(130,e==null?e:typeof e,""))}return t=Ti(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Su(e,t,r,n){return e=Ti(7,e,n,t),e.lanes=r,e}function Ex(e,t,r,n){return e=Ti(22,e,n,t),e.elementType=h3,e.lanes=r,e.stateNode={isHidden:!1},e}function Ay(e,t,r){return e=Ti(6,e,null,t),e.lanes=r,e}function fy(e,t,r){return t=Ti(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function xP(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=G1(0),this.expirationTimes=G1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G1(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function K2(e,t,r,n,s,i,o,l,c){return e=new xP(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ti(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},B2(i),e}function yP(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qd,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function sE(e){if(!e)return Ic;e=e._reactInternals;e:{if(Ju(e)!==e||e.tag!==1)throw Error(yt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ls(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(yt(171))}if(e.tag===1){var r=e.type;if(Ls(r))return sS(e,r,t)}return t}function iE(e,t,r,n,s,i,o,l,c){return e=K2(r,n,!0,e,s,i,o,l,c),e.context=sE(null),r=e.current,n=vs(),s=Bc(r),i=bl(n,s),i.callback=t??null,jc(r,i,s),e.current.lanes=s,N0(e,s,n),Os(e,n),e}function Fx(e,t,r,n){var s=t.current,i=vs(),o=Bc(s);return r=sE(r),t.context===null?t.context=r:t.pendingContext=r,t=bl(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=jc(s,t,o),e!==null&&(Ao(e,s,o,i),Hm(e,s,o)),o}function Sg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function YN(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function $2(e,t){YN(e,t),(e=e.alternate)&&YN(e,t)}function vP(){return null}var oE=typeof reportError=="function"?reportError:function(e){console.error(e)};function V2(e){this._internalRoot=e}Tx.prototype.render=V2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(yt(409));Fx(e,t,null,null)};Tx.prototype.unmount=V2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Mu(function(){Fx(null,e,null,null)}),t[Bl]=null}};function Tx(e){this._internalRoot=e}Tx.prototype.unstable_scheduleHydration=function(e){if(e){var t=D3();e={blockedOn:null,target:e,priority:t};for(var r=0;r<uc.length&&t!==0&&t<uc[r].priority;r++);uc.splice(r,0,e),r===0&&Q3(e)}};function G2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ix(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function JN(){}function bP(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=Sg(o);i.call(u)}}var o=iE(t,n,e,0,null,!1,!1,"",JN);return e._reactRootContainer=o,e[Bl]=o.current,Kh(e.nodeType===8?e.parentNode:e),Mu(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=Sg(c);l.call(u)}}var c=K2(e,0,!1,null,null,!1,!1,"",JN);return e._reactRootContainer=c,e[Bl]=c.current,Kh(e.nodeType===8?e.parentNode:e),Mu(function(){Fx(t,c,r,n)}),c}function Lx(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Sg(o);l.call(c)}}Fx(t,o,e,s)}else o=bP(r,t,e,s,n);return Sg(o)}U3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=zf(t.pendingLanes);r!==0&&(A2(t,r|1),Os(t,Pn()),!(vr&6)&&(BA=Pn()+500,Hc()))}break;case 13:Mu(function(){var n=kl(e,1);if(n!==null){var s=vs();Ao(n,e,1,s)}}),$2(e,1)}};f2=function(e){if(e.tag===13){var t=kl(e,134217728);if(t!==null){var r=vs();Ao(t,e,134217728,r)}$2(e,134217728)}};P3=function(e){if(e.tag===13){var t=Bc(e),r=kl(e,t);if(r!==null){var n=vs();Ao(r,e,t,n)}$2(e,t)}};D3=function(){return Ur};R3=function(e,t){var r=Ur;try{return Ur=e,t()}finally{Ur=r}};nb=function(e,t,r){switch(t){case"input":if(Xv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Nx(n);if(!s)throw Error(yt(90));m3(n),Xv(n,s)}}}break;case"textarea":x3(e,r);break;case"select":t=r.value,t!=null&&aA(e,!!r.multiple,t,!1)}};j3=Q2;C3=Mu;var wP={usingClientEntryPoint:!1,Events:[C0,Wd,Nx,_3,N3,Q2]},Tf={findFiberByHostInstance:wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_P={bundleType:Tf.bundleType,version:Tf.version,rendererPackageName:Tf.rendererPackageName,rendererConfig:Tf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ll.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=S3(e),e===null?null:e.stateNode},findFiberByHostInstance:Tf.findFiberByHostInstance||vP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ip=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ip.isDisabled&&Ip.supportsFiber)try{vx=Ip.inject(_P),Ro=Ip}catch{}}hi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wP;hi.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!G2(t))throw Error(yt(200));return yP(e,t,null,r)};hi.createRoot=function(e,t){if(!G2(e))throw Error(yt(299));var r=!1,n="",s=oE;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=K2(e,1,!1,null,null,r,!1,n,s),e[Bl]=t.current,Kh(e.nodeType===8?e.parentNode:e),new V2(t)};hi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(yt(188)):(e=Object.keys(e).join(","),Error(yt(268,e)));return e=S3(t),e=e===null?null:e.stateNode,e};hi.flushSync=function(e){return Mu(e)};hi.hydrate=function(e,t,r){if(!Ix(t))throw Error(yt(200));return Lx(null,e,t,!0,r)};hi.hydrateRoot=function(e,t,r){if(!G2(e))throw Error(yt(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=oE;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=iE(t,null,e,1,r??null,s,!1,i,o),e[Bl]=t.current,Kh(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Tx(t)};hi.render=function(e,t,r){if(!Ix(t))throw Error(yt(200));return Lx(null,e,t,!1,r)};hi.unmountComponentAtNode=function(e){if(!Ix(e))throw Error(yt(40));return e._reactRootContainer?(Mu(function(){Lx(null,null,e,!1,function(){e._reactRootContainer=null,e[Bl]=null})}),!0):!1};hi.unstable_batchedUpdates=Q2;hi.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ix(r))throw Error(yt(200));if(e==null||e._reactInternals===void 0)throw Error(yt(38));return Lx(e,t,r,!1,n)};hi.version="18.3.1-next-f1338f8080-20240426";function lE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lE)}catch(e){console.error(e)}}lE(),l3.exports=hi;var cE=l3.exports,uE,ZN=cE;uE=ZN.createRoot,ZN.hydrateRoot;var Ub=function(e,t){return Ub=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Ub(e,t)};function dE(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ub(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Eg=function(){return Eg=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Eg.apply(this,arguments)};function PA(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function AE(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,r,i):o(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i}function fE(e,t){return function(r,n){t(r,n,e)}}function hE(e,t,r,n,s,i){function o(p){if(p!==void 0&&typeof p!="function")throw new TypeError("Function expected");return p}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),h,f=!1,A=r.length-1;A>=0;A--){var b={};for(var m in n)b[m]=m==="access"?{}:n[m];for(var m in n.access)b.access[m]=n.access[m];b.addInitializer=function(p){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(p||null))};var v=(0,r[A])(l==="accessor"?{get:d.get,set:d.set}:d[c],b);if(l==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(h=o(v.get))&&(d.get=h),(h=o(v.set))&&(d.set=h),(h=o(v.init))&&s.unshift(h)}else(h=o(v))&&(l==="field"?s.unshift(h):d[c]=h)}u&&Object.defineProperty(u,n.name,d),f=!0}function pE(e,t,r){for(var n=arguments.length>2,s=0;s<t.length;s++)r=n?t[s].call(e,r):t[s].call(e);return n?r:void 0}function mE(e){return typeof e=="symbol"?e:"".concat(e)}function gE(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function xE(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Dt(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(h){o(h)}}function c(d){try{u(n.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}function yE(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Ox=Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function vE(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Ox(t,e,r)}function Fg(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function W2(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function bE(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(W2(arguments[t]));return e}function wE(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,l=i.length;o<l;o++,s++)n[s]=i[o];return n}function _E(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function kA(e){return this instanceof kA?(this.v=e,this):new kA(e)}function NE(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(A){return function(b){return Promise.resolve(b).then(A,h)}}function l(A,b){n[A]&&(s[A]=function(m){return new Promise(function(v,p){i.push([A,m,v,p])>1||c(A,m)})},b&&(s[A]=b(s[A])))}function c(A,b){try{u(n[A](b))}catch(m){f(i[0][3],m)}}function u(A){A.value instanceof kA?Promise.resolve(A.value.v).then(d,h):f(i[0][2],A)}function d(A){c("next",A)}function h(A){c("throw",A)}function f(A,b){A(b),i.shift(),i.length&&c(i[0][0],i[0][1])}}function jE(e){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,i){t[s]=e[s]?function(o){return(r=!r)?{value:kA(e[s](o)),done:!1}:i?i(o):o}:i}}function CE(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Fg=="function"?Fg(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(o){return new Promise(function(l,c){o=e[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}function BE(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var NP=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Pb=function(e){return Pb=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Pb(e)};function kE(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Pb(e),n=0;n<r.length;n++)r[n]!=="default"&&Ox(t,e,r[n]);return NP(t,e),t}function SE(e){return e&&e.__esModule?e:{default:e}}function EE(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function FE(e,t,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(e,r):s?s.value=r:t.set(e,r),r}function TE(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function IE(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var jP=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function LE(e){function t(i){e.error=e.hasError?new jP(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}var r,n=0;function s(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(s,function(o){return t(o),s()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}function OE(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,s,i,o){return n?t?".jsx":".js":s&&(!i||!o)?r:s+i+"."+o.toLowerCase()+"js"}):e}const CP={__extends:dE,__assign:Eg,__rest:PA,__decorate:AE,__param:fE,__esDecorate:hE,__runInitializers:pE,__propKey:mE,__setFunctionName:gE,__metadata:xE,__awaiter:Dt,__generator:yE,__createBinding:Ox,__exportStar:vE,__values:Fg,__read:W2,__spread:bE,__spreadArrays:wE,__spreadArray:_E,__await:kA,__asyncGenerator:NE,__asyncDelegator:jE,__asyncValues:CE,__makeTemplateObject:BE,__importStar:kE,__importDefault:SE,__classPrivateFieldGet:EE,__classPrivateFieldSet:FE,__classPrivateFieldIn:TE,__addDisposableResource:IE,__disposeResources:LE,__rewriteRelativeImportExtension:OE},BP=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:IE,get __assign(){return Eg},__asyncDelegator:jE,__asyncGenerator:NE,__asyncValues:CE,__await:kA,__awaiter:Dt,__classPrivateFieldGet:EE,__classPrivateFieldIn:TE,__classPrivateFieldSet:FE,__createBinding:Ox,__decorate:AE,__disposeResources:LE,__esDecorate:hE,__exportStar:vE,__extends:dE,__generator:yE,__importDefault:SE,__importStar:kE,__makeTemplateObject:BE,__metadata:xE,__param:fE,__propKey:mE,__read:W2,__rest:PA,__rewriteRelativeImportExtension:OE,__runInitializers:pE,__setFunctionName:gE,__spread:bE,__spreadArray:_E,__spreadArrays:wE,__values:Fg,default:CP},Symbol.toStringTag,{value:"Module"})),kP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class z2 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class SP extends z2{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class e4 extends z2{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class t4 extends z2{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Db;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Db||(Db={}));class EP{constructor(t,{headers:r={},customFetch:n,region:s=Db.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=kP(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Dt(this,arguments,void 0,function*(r,n={}){var s;let i,o;try{const{headers:l,method:c,body:u,signal:d,timeout:h}=n;let f={},{region:A}=n;A||(A=this.region);const b=new URL(`${this.url}/${r}`);A&&A!=="any"&&(f["x-region"]=A,b.searchParams.set("forceFunctionRegion",A));let m;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=u):typeof u=="string"?(f["Content-Type"]="text/plain",m=u):typeof FormData<"u"&&u instanceof FormData?m=u:(f["Content-Type"]="application/json",m=JSON.stringify(u)):m=u;let v=d;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),d?(v=o.signal,d.addEventListener("abort",()=>o.abort())):v=o.signal);const p=yield this.fetch(b.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:m,signal:v}).catch(w=>{throw new SP(w)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new e4(p);if(!p.ok)throw new t4(p);let y=((s=p.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),x;return y==="application/json"?x=yield p.json():y==="application/octet-stream"||y==="application/pdf"?x=yield p.blob():y==="text/event-stream"?x=p:y==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(l){return{data:null,error:l,response:l instanceof t4||l instanceof e4?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var ys={};const DA=YL(BP);var Lp={},Op={},Up={},Pp={},Dp={},Rp={},r4;function UE(){if(r4)return Rp;r4=1,Object.defineProperty(Rp,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Rp.default=e,Rp}var n4;function PE(){if(n4)return Dp;n4=1,Object.defineProperty(Dp,"__esModule",{value:!0});const t=DA.__importDefault(UE());class r{constructor(s){var i,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(i=s.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=new Headers(this.headers),this.headers.set(s,i),this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,h,f;let A=null,b=null,m=null,v=c.status,p=c.statusText;if(c.ok){if(this.method!=="HEAD"){const w=await c.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?b=w:b=JSON.parse(w))}const y=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),x=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");y&&x&&x.length>1&&(m=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(A={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,m=null,v=406,p="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const y=await c.text();try{A=JSON.parse(y),Array.isArray(A)&&c.status===404&&(b=[],A=null,v=200,p="OK")}catch{c.status===404&&y===""?(v=204,p="No Content"):A={message:y}}if(A&&this.isMaybeSingle&&(!((f=A==null?void 0:A.details)===null||f===void 0)&&f.includes("0 rows"))&&(A=null,v=200,p="OK"),A&&this.shouldThrowOnError)throw new t.default(A)}return{error:A,data:b,count:m,status:v,statusText:p}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,h,f,A,b;let m="";const v=c==null?void 0:c.cause;if(v){const p=(u=v==null?void 0:v.message)!==null&&u!==void 0?u:"",g=(d=v==null?void 0:v.code)!==null&&d!==void 0?d:"";m=`${(h=c==null?void 0:c.name)!==null&&h!==void 0?h:"FetchError"}: ${c==null?void 0:c.message}`,m+=`

Caused by: ${(f=v==null?void 0:v.name)!==null&&f!==void 0?f:"Error"}: ${p}`,g&&(m+=` (${g})`),v!=null&&v.stack&&(m+=`
${v.stack}`)}else m=(A=c==null?void 0:c.stack)!==null&&A!==void 0?A:"";return{error:{message:`${(b=c==null?void 0:c.name)!==null&&b!==void 0?b:"FetchError"}: ${c==null?void 0:c.message}`,details:m,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(s,i)}returns(){return this}overrideTypes(){return this}}return Dp.default=r,Dp}var a4;function DE(){if(a4)return Pp;a4=1,Object.defineProperty(Pp,"__esModule",{value:!0});const t=DA.__importDefault(PE());class r extends t.default{select(s){let i=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(u,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${f}"; options=${h};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Pp.default=r,Pp}var s4;function X2(){if(s4)return Up;s4=1,Object.defineProperty(Up,"__esModule",{value:!0});const t=DA.__importDefault(DE()),r=new RegExp("[,()]");class n extends t.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}regexMatch(i,o){return this.url.searchParams.append(i,`match.${o}`),this}regexIMatch(i,o){return this.url.searchParams.append(i,`imatch.${o}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}isDistinct(i,o){return this.url.searchParams.append(i,`isdistinct.${o}`),this}in(i,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${u}fts${d}.${o}`),this}match(i){return Object.entries(i).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(i,o,l){return this.url.searchParams.append(i,`not.${o}.${l}`),this}or(i,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,o,l){return this.url.searchParams.append(i,`${o}.${l}`),this}}return Up.default=n,Up}var i4;function RE(){if(i4)return Op;i4=1,Object.defineProperty(Op,"__esModule",{value:!0});const t=DA.__importDefault(X2());class r{constructor(s,{headers:i={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(i),this.schema=o,this.fetch=l}select(s,i){const{head:o=!1,count:l}=i??{},c=o?"HEAD":"GET";let u=!1;const d=(s??"*").split("").map(h=>/\s/.test(h)&&!u?"":(h==='"'&&(u=!u),h)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:o=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const u=s.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const h=s.reduce((f,A)=>f.concat(Object.keys(A)),[]);if(h.length>0){const f=[...new Set(h)].map(A=>`"${A}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(s,{count:i}={}){var o;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var i;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return Op.default=r,Op}var o4;function FP(){if(o4)return Lp;o4=1,Object.defineProperty(Lp,"__esModule",{value:!0});const e=DA,t=e.__importDefault(RE()),r=e.__importDefault(X2());class n{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(i){if(!i||typeof i!="string"||i.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${i}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:u}={}){var d;let h;const f=new URL(`${this.url}/rpc/${i}`);let A;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([m,v])=>v!==void 0).map(([m,v])=>[m,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([m,v])=>{f.searchParams.append(m,v)})):(h="POST",A=o);const b=new Headers(this.headers);return u&&b.set("Prefer",`count=${u}`),new r.default({method:h,url:f,headers:b,schema:this.schemaName,body:A,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Lp.default=n,Lp}Object.defineProperty(ys,"__esModule",{value:!0});var QE=ys.PostgrestError=XE=ys.PostgrestBuilder=WE=ys.PostgrestTransformBuilder=VE=ys.PostgrestFilterBuilder=KE=ys.PostgrestQueryBuilder=HE=ys.PostgrestClient=void 0;const RA=DA,ME=RA.__importDefault(FP());var HE=ys.PostgrestClient=ME.default;const qE=RA.__importDefault(RE());var KE=ys.PostgrestQueryBuilder=qE.default;const $E=RA.__importDefault(X2());var VE=ys.PostgrestFilterBuilder=$E.default;const GE=RA.__importDefault(DE());var WE=ys.PostgrestTransformBuilder=GE.default;const zE=RA.__importDefault(PE());var XE=ys.PostgrestBuilder=zE.default;const YE=RA.__importDefault(UE());QE=ys.PostgrestError=YE.default;var JE=ys.default={PostgrestClient:ME.default,PostgrestQueryBuilder:qE.default,PostgrestFilterBuilder:$E.default,PostgrestTransformBuilder:GE.default,PostgrestBuilder:zE.default,PostgrestError:YE.default};const TP=XL({__proto__:null,get PostgrestBuilder(){return XE},get PostgrestClient(){return HE},get PostgrestError(){return QE},get PostgrestFilterBuilder(){return VE},get PostgrestQueryBuilder(){return KE},get PostgrestTransformBuilder(){return WE},default:JE},[ys]),{PostgrestClient:IP,PostgrestQueryBuilder:bfe,PostgrestFilterBuilder:wfe,PostgrestTransformBuilder:_fe,PostgrestBuilder:Nfe,PostgrestError:jfe}=JE||TP;class LP{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const OP="2.84.0",UP=`realtime-js/${OP}`,ZE="1.0.0",PP="2.0.0",l4=ZE,Rb=1e4,DP=1e3,RP=100;var mu;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(mu||(mu={}));var ca;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ca||(ca={}));var so;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(so||(so={}));var Qb;(function(e){e.websocket="websocket"})(Qb||(Qb={}));var gu;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(gu||(gu={}));class QP{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast"}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n,s,i;const o=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(n=t.join_ref)!==null&&n!==void 0?n:"",u=t.payload.event,d=(i=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&i!==void 0?i:new ArrayBuffer(0),h=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length,f=new ArrayBuffer(this.HEADER_LENGTH+h);let A=new DataView(f),b=0;A.setUint8(b++,this.KINDS.userBroadcastPush),A.setUint8(b++,c.length),A.setUint8(b++,l.length),A.setUint8(b++,o.length),A.setUint8(b++,u.length),A.setUint8(b++,this.BINARY_ENCODING),Array.from(c,v=>A.setUint8(b++,v.charCodeAt(0))),Array.from(l,v=>A.setUint8(b++,v.charCodeAt(0))),Array.from(o,v=>A.setUint8(b++,v.charCodeAt(0))),Array.from(u,v=>A.setUint8(b++,v.charCodeAt(0)));var m=new Uint8Array(f.byteLength+d.byteLength);return m.set(new Uint8Array(f),0),m.set(new Uint8Array(d),f.byteLength),m.buffer}_encodeJsonUserBroadcastPush(t){var r,n,s,i;const o=t.topic,l=(r=t.ref)!==null&&r!==void 0?r:"",c=(n=t.join_ref)!==null&&n!==void 0?n:"",u=t.payload.event,d=(i=(s=t.payload)===null||s===void 0?void 0:s.payload)!==null&&i!==void 0?i:{},f=new TextEncoder().encode(JSON.stringify(d)).buffer,A=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length,b=new ArrayBuffer(this.HEADER_LENGTH+A);let m=new DataView(b),v=0;m.setUint8(v++,this.KINDS.userBroadcastPush),m.setUint8(v++,c.length),m.setUint8(v++,l.length),m.setUint8(v++,o.length),m.setUint8(v++,u.length),m.setUint8(v++,this.JSON_ENCODING),Array.from(c,g=>m.setUint8(v++,g.charCodeAt(0))),Array.from(l,g=>m.setUint8(v++,g.charCodeAt(0))),Array.from(o,g=>m.setUint8(v++,g.charCodeAt(0))),Array.from(u,g=>m.setUint8(v++,g.charCodeAt(0)));var p=new Uint8Array(b.byteLength+f.byteLength);return p.set(new Uint8Array(b),0),p.set(new Uint8Array(f),b.byteLength),p.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[s,i,o,l,c]=n;return r({join_ref:s,ref:i,topic:o,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(t.slice(c,c+s));c=c+s;const d=n.decode(t.slice(c,c+i));c=c+i;const h=n.decode(t.slice(c,c+o));c=c+o;const f=t.slice(c,t.byteLength),A=l===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,b={type:this.BROADCAST_EVENT,event:d,payload:A};return o>0&&(b.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class eF{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Gr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Gr||(Gr={}));const c4=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=MP(o,e,t,s),i),{}):{}},MP=(e,t,r,n)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,o=r[e];return i&&!n.includes(i)?tF(i,o):Mb(o)},tF=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return $P(t,r)}switch(e){case Gr.bool:return HP(t);case Gr.float4:case Gr.float8:case Gr.int2:case Gr.int4:case Gr.int8:case Gr.numeric:case Gr.oid:return qP(t);case Gr.json:case Gr.jsonb:return KP(t);case Gr.timestamp:return VP(t);case Gr.abstime:case Gr.date:case Gr.daterange:case Gr.int4range:case Gr.int8range:case Gr.money:case Gr.reltime:case Gr.text:case Gr.time:case Gr.timestamptz:case Gr.timetz:case Gr.tsrange:case Gr.tstzrange:return Mb(t);default:return Mb(t)}},Mb=e=>e,HP=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},qP=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},KP=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},$P=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>tF(t,l))}return e},VP=e=>typeof e=="string"?e.replace(" ","T"):e,rF=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class hy{constructor(t,r,n={},s=Rb){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var u4;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(u4||(u4={}));class gh{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gh.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=gh.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=gh.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(v=>v.presence_ref),A=h.map(v=>v.presence_ref),b=d.filter(v=>A.indexOf(v.presence_ref)<0),m=h.filter(v=>f.indexOf(v.presence_ref)<0);b.length>0&&(l[u]=b),m.length>0&&(c[u]=m)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const h=t[l].map(A=>A.presence_ref),f=d.filter(A=>h.indexOf(A.presence_ref)<0);t[l].unshift(...f)}n(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var d4;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(d4||(d4={}));var xh;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(xh||(xh={}));var pl;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(pl||(pl={}));class Y2{constructor(t,r={config:{}},n){var s,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=ca.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new hy(this,so.join,this.params,this.timeout),this.rejoinTimer=new eF(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ca.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ca.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ca.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ca.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ca.errored,this.rejoinTimer.scheduleTimeout())}),this._on(so.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new gh(this),this.broadcastEndpointURL=rF(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==ca.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(A=>A.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[xh.PRESENCE]&&this.bindings[xh.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(A=>t==null?void 0:t(pl.CHANNEL_ERROR,A)),this._onClose(()=>t==null?void 0:t(pl.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:A})=>{var b;if(this.socket.setAuth(),A===void 0){t==null||t(pl.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(b=m==null?void 0:m.length)!==null&&b!==void 0?b:0,p=[];for(let g=0;g<v;g++){const y=m[g],{filter:{event:x,schema:w,table:N,filter:_}}=y,C=A&&A[g];if(C&&C.event===x&&C.schema===w&&C.table===N&&C.filter===_)p.push(Object.assign(Object.assign({},y),{id:C.id}));else{this.unsubscribe(),this.state=ca.errored,t==null||t(pl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,t&&t(pl.SUBSCRIBED);return}}).receive("error",A=>{this.state=ca.errored,t==null||t(pl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(A).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===ca.joined&&t===xh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ca.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(so.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new hy(this,so.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ca.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new hy(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>RP){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=so;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(A=>{var b,m,v;return((b=A.filter)===null||b===void 0?void 0:b.event)==="*"||((v=(m=A.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(A=>A.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(A=>{var b,m,v,p,g,y;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in A){const x=A.id,w=(b=A.filter)===null||b===void 0?void 0:b.event;return x&&((m=r.ids)===null||m===void 0?void 0:m.includes(x))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const x=(g=(p=A==null?void 0:A.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return x==="*"||x===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return A.type.toLocaleLowerCase()===o}).map(A=>{if(typeof f=="object"&&"ids"in f){const b=f.data,{schema:m,table:v,commit_timestamp:p,type:g,errors:y}=b;f=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:p,eventType:g,new:{},old:{},errors:y}),this._getPayloadRecords(b))}A.callback(f,n)})}_isClosed(){return this.state===ca.closed}_isJoined(){return this.state===ca.joined}_isJoining(){return this.state===ca.joining}_isLeaving(){return this.state===ca.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Y2.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(so.close,{},t)}_onError(t){this._on(so.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ca.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=c4(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=c4(t.columns,t.old_record)),r}}const py=()=>{},Qp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},GP=[1e3,2e3,5e3,1e4],WP=1e4,zP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class XP{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Rb,this.transport=null,this.heartbeatIntervalMs=Qp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=py,this.ref=0,this.reconnectTimer=null,this.vsn=l4,this.logger=py,this.conn=null,this.sendBuffer=[],this.serializer=new QP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Qb.websocket}`,this.httpEndpoint=rF(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=LP.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case mu.connecting:return gu.Connecting;case mu.open:return gu.Open;case mu.closing:return gu.Closing;default:return gu.Closed}}isConnected(){return this.connectionState()===gu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Y2(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(DP,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Qp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===mu.open||this.conn.readyState===mu.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(so.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([zP],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:UP};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(so.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new eF(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Qp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,i,o,l,c,u,d,h,f,A;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Rb,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Qp.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:py,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:l4,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:b=>GP[b-1]||WP,this.vsn){case ZE:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(b,m)=>m(JSON.stringify(b)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(b,m)=>m(JSON.parse(b));break;case PP:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(A=t==null?void 0:t.decode)!==null&&A!==void 0?A:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class J2 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function fn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class YP extends J2{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Hb extends J2{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const Z2=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),JP=()=>Response,qb=e=>{if(Array.isArray(e))return e.map(r=>qb(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=qb(n)}),t},ZP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},my=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},eD=(e,t,r)=>Dt(void 0,void 0,void 0,function*(){const n=yield JP();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const i=e.status||500,o=(s==null?void 0:s.statusCode)||i+"";t(new YP(my(s),i,o))}).catch(s=>{t(new Hb(my(s),s))}):t(new Hb(my(e),e))}),tD=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(ZP(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function k0(e,t,r,n,s,i){return Dt(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,tD(t,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>eD(c,l,n))})})}function Zh(e,t,r,n){return Dt(this,void 0,void 0,function*(){return k0(e,"GET",t,r,n)})}function no(e,t,r,n,s){return Dt(this,void 0,void 0,function*(){return k0(e,"POST",t,n,s,r)})}function Kb(e,t,r,n,s){return Dt(this,void 0,void 0,function*(){return k0(e,"PUT",t,n,s,r)})}function rD(e,t,r,n){return Dt(this,void 0,void 0,function*(){return k0(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function e_(e,t,r,n,s){return Dt(this,void 0,void 0,function*(){return k0(e,"DELETE",t,n,s,r)})}class nD{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Dt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fn(t))return{data:null,error:t};throw t}})}}var nF;class aD{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[nF]="BlobDownloadBuilder",this.promise=null}asStream(){return new nD(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Dt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(fn(t))return{data:null,error:t};throw t}})}}nF=Symbol.toStringTag;const sD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},A4={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class iD{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=Z2(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return Dt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},A4),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),h=yield(t=="PUT"?Kb:no)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(fn(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Dt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Dt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:A4.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield Kb(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(fn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Dt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield no(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new J2("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fn(n))return{data:null,error:n};throw n}})}update(t,r,n){return Dt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Dt(this,void 0,void 0,function*(){try{return{data:yield no(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fn(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Dt(this,void 0,void 0,function*(){try{return{data:{path:(yield no(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fn(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Dt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield no(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fn(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Dt(this,void 0,void 0,function*(){try{const s=yield no(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fn(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"",l=this._getFinalPath(t),c=()=>Zh(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new aD(c,this.shouldThrowOnError)}info(t){return Dt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Zh(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:qb(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fn(n))return{data:null,error:n};throw n}})}exists(t){return Dt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield rD(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fn(n)&&n instanceof Hb){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield e_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}list(t,r,n){return Dt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},sD),r),{prefix:t||""});return{data:yield no(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fn(s))return{data:null,error:s};throw s}})}listV2(t,r){return Dt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield no(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fn(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const aF="2.84.0",sF={"X-Client-Info":`storage-js/${aF}`};class oD{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},sF),r),this.fetch=Z2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Dt(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield Zh(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}getBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield Zh(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}createBucket(t){return Dt(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield no(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fn(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return Dt(this,void 0,void 0,function*(){try{return{data:yield Kb(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield no(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield e_(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class lD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},sF),r),this.fetch=Z2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield no(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}listBuckets(t){return Dt(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield Zh(this.fetch,s,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield e_(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}}const t_={"X-Client-Info":`storage-js/${aF}`,"Content-Type":"application/json"};class iF extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ri(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class gy extends iF{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class cD extends iF{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var f4;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(f4||(f4={}));const r_=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),uD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},h4=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),dD=(e,t,r)=>Dt(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e.status||500,i=e;if(typeof i.json=="function")i.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||s+"";t(new gy(h4(o),s,l))}).catch(()=>{const o=s+"",l=i.statusText||`HTTP ${s} error`;t(new gy(l,s,o))});else{const o=s+"",l=i.statusText||`HTTP ${s} error`;t(new gy(l,s,o))}}else t(new cD(h4(e),e))}),AD=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(uD(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r)):s};function fD(e,t,r,n,s,i){return Dt(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,AD(t,n,s,i)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>dD(c,l,n))})})}function ni(e,t,r,n,s){return Dt(this,void 0,void 0,function*(){return fD(e,"POST",t,n,s,r)})}class hD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t_),r),this.fetch=r_(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Dt(this,void 0,void 0,function*(){try{return{data:(yield ni(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Dt(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ri(n))return{data:null,error:n};throw n}})}listIndexes(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Dt(this,void 0,void 0,function*(){try{return{data:(yield ni(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ri(n))return{data:null,error:n};throw n}})}}class pD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t_),r),this.fetch=r_(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Dt(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ni(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}getVectors(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}listVectors(t){return Dt(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield ni(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}queryVectors(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Dt(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ni(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}}class mD{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},t_),r),this.fetch=r_(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:(yield ni(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}getBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}listBuckets(){return Dt(this,arguments,void 0,function*(t={}){try{return{data:yield ni(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Dt(this,void 0,void 0,function*(){try{return{data:(yield ni(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ri(r))return{data:null,error:r};throw r}})}}class gD extends mD{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new xD(this.url,this.headers,t,this.fetch)}}class xD extends hD{constructor(t,r,n,s){super(t,r,s),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Dt(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Dt(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Dt(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Dt(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new yD(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class yD extends pD{constructor(t,r,n,s,i){super(t,r,i),this.vectorBucketName=n,this.indexName=s}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Dt(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Dt(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Dt(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Dt(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Dt(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vD extends oD{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new iD(this.url,this.headers,t,this.fetch)}get vectors(){return new gD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new lD(this.url+"/iceberg",this.headers,this.fetch)}}const bD="2.84.0";let Yf="";typeof Deno<"u"?Yf="deno":typeof document<"u"?Yf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yf="react-native":Yf="node";const wD={"X-Client-Info":`supabase-js-${Yf}/${bD}`},_D={headers:wD},ND={schema:"public"},jD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},CD={},BD=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),kD=()=>Headers,SD=(e,t,r)=>{const n=BD(r),s=kD();return async(i,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},o),{headers:u}))}};function ED(e){return e.endsWith("/")?e:e+"/"}function FD(e,t){var r,n;const{db:s,auth:i,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:h}=t,f={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function TD(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ED(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const oF="2.84.0",Ud=30*1e3,$b=3,xy=$b*Ud,ID="http://localhost:9999",LD="supabase.auth.token",OD={"X-Client-Info":`gotrue-js/${oF}`},Vb="X-Supabase-Api-Version",lF={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},UD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,PD=10*60*1e3;class e0 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Mt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class DD extends e0{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function RD(e){return Mt(e)&&e.name==="AuthApiError"}class xu extends e0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class qc extends e0{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Ys extends qc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function QD(e){return Mt(e)&&e.name==="AuthSessionMissingError"}class yd extends qc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mp extends qc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Hp extends qc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function MD(e){return Mt(e)&&e.name==="AuthImplicitGrantRedirectError"}class p4 extends qc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Gb extends qc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function yy(e){return Mt(e)&&e.name==="AuthRetryableFetchError"}class m4 extends qc{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Wb extends qc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Tg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),g4=` 	
\r=`.split(""),HD=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<g4.length;t+=1)e[g4[t].charCodeAt(0)]=-2;for(let t=0;t<Tg.length;t+=1)e[Tg[t].charCodeAt(0)]=t;return e})();function x4(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Tg[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Tg[n]),t.queuedBits-=6}}function cF(e,t,r){const n=HD[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function y4(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{$D(o,n,r)};for(let o=0;o<e.length;o+=1)cF(e.charCodeAt(o),s,i);return t.join("")}function qD(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function KD(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}qD(n,t)}}function $D(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function uA(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)cF(e.charCodeAt(s),r,n);return new Uint8Array(t)}function VD(e){const t=[];return KD(e,r=>t.push(r)),new Uint8Array(t)}function ju(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>x4(s,r,n)),x4(null,r,n),t.join("")}function GD(e){return Math.round(Date.now()/1e3)+e}function WD(){return Symbol("auth-callback")}const Fa=()=>typeof window<"u"&&typeof document<"u",lu={tested:!1,writable:!1},uF=()=>{if(!Fa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(lu.tested)return lu.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),lu.tested=!0,lu.writable=!0}catch{lu.tested=!0,lu.writable=!1}return lu.writable};function zD(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const dF=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),XD=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Pd=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},cu=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},tc=async(e,t)=>{await e.removeItem(t)};class Ux{constructor(){this.promise=new Ux.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ux.promiseConstructor=Promise;function vy(e){const t=e.split(".");if(t.length!==3)throw new Wb("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!UD.test(t[n]))throw new Wb("JWT not in base64url format");return{header:JSON.parse(y4(t[0])),payload:JSON.parse(y4(t[1])),signature:uA(t[2]),raw:{header:t[0],payload:t[1]}}}async function YD(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function JD(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function ZD(e){return("0"+e.toString(16)).substr(-2)}function e7(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,ZD).join("")}async function t7(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function r7(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await t7(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vd(e,t,r=!1){const n=e7();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Pd(e,`${t}-code-verifier`,s);const i=await r7(n);return[i,n===i?"plain":"s256"]}const n7=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function a7(e){const t=e.headers.get(Vb);if(!t||!t.match(n7))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function s7(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function i7(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const o7=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function bd(e){if(!o7.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function by(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function l7(e,t){return new Proxy(e,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,s)}})}function v4(e){return JSON.parse(JSON.stringify(e))}const fu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),c7=[502,503,504];async function b4(e){var t;if(!XD(e))throw new Gb(fu(e),0);if(c7.includes(e.status))throw new Gb(fu(e),e.status);let r;try{r=await e.json()}catch(i){throw new xu(fu(i),i)}let n;const s=a7(e);if(s&&s.getTime()>=lF["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new m4(fu(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ys}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new m4(fu(r),e.status,r.weak_password.reasons);throw new DD(fu(r),e.status||500,n)}const u7=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Kt(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Vb]||(i[Vb]=lF["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await d7(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function d7(e,t,r,n,s,i){const o=u7(t,n,s,i);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new Gb(fu(c),0)}if(l.ok||await b4(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await b4(c)}}function Zi(e){var t;let r=null;h7(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=GD(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function w4(e){const t=Zi(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ac(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function A7(e){return{data:e,error:null}}function f7(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,o=PA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function _4(e){return e}function h7(e){return e.access_token&&e.refresh_token&&e.expires_in}const wy=["global","local","others"];class p7{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=dF(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=wy[0]){if(wy.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wy.join(", ")}`);try{return await Kt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Mt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Kt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ac})}catch(n){if(Mt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=PA(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Kt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:f7,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Mt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Kt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ac})}catch(r){if(Mt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Kt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:_4});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,A=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return A.length>0&&(A.forEach(b=>{const m=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(b.split(";")[1].split("=")[1]);u[`${v}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Mt(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){bd(t);try{return await Kt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ac})}catch(r){if(Mt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){bd(t);try{return await Kt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ac})}catch(n){if(Mt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){bd(t);try{return await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ac})}catch(n){if(Mt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){bd(t.userId);try{const{data:r,error:n}=await Kt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){bd(t.userId),bd(t.id);try{return{data:await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Kt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:_4});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,A=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return A.length>0&&(A.forEach(b=>{const m=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(b.split(";")[1].split("=")[1]);u[`${v}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Mt(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await Kt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Kt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Kt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Mt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Kt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Kt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Mt(r))return{data:null,error:r};throw r}}}function N4(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const wd={debug:!!(globalThis&&uF()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class AF extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class m7 extends AF{}async function g7(e,t,r){wd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),wd.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){wd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{wd.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw wd.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new m7(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wd.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function x7(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function fF(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function y7(e){return parseInt(e,16)}function v7(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function b7(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:d,uri:h,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const A=fF(e.address),b=d?`${d}://${n}`:n,m=e.statement?`${e.statement}
`:"",v=`${b} wants you to sign in with your Ethereum account:
${A}

${m}`;let p=`URI: ${h}
Version: ${f}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(p+=`
Expiration Time: ${s.toISOString()}`),l&&(p+=`
Not Before: ${l.toISOString()}`),c&&(p+=`
Request ID: ${c}`),u){let g=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);g+=`
- ${y}`}p+=g}return`${v}
${p}`}class Xn extends Error{constructor({message:t,code:r,cause:n,name:s}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=s??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Ig extends Xn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function w7({error:e,options:t}){var r,n,s;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Xn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Xn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Xn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Xn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Xn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Xn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Xn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(hF(o)){if(i.rp.id!==o)return new Xn({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Xn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Xn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function _7({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Xn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(hF(n)){if(r.rpId!==n)return new Xn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Xn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class N7{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const j7=new N7;function C7(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=PA(e,["challenge","user","excludeCredentials"]),i=uA(t).buffer,o=Object.assign(Object.assign({},r),{id:uA(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:i,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:uA(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function B7(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=PA(e,["challenge","allowCredentials"]),s=uA(t).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:uA(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function k7(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ju(new Uint8Array(e.response.attestationObject)),clientDataJSON:ju(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function S7(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ju(new Uint8Array(s.authenticatorData)),clientDataJSON:ju(new Uint8Array(s.clientDataJSON)),signature:ju(new Uint8Array(s.signature)),userHandle:s.userHandle?ju(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function hF(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function j4(){var e,t;return!!(Fa()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function E7(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ig("Browser returned unexpected credential type",t)}:{data:null,error:new Ig("Empty credential response",t)}}catch(t){return{data:null,error:w7({error:t,options:e})}}}async function F7(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ig("Browser returned unexpected credential type",t)}:{data:null,error:new Ig("Empty credential response",t)}}catch(t){return{data:null,error:_7({error:t,options:e})}}}const T7={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},I7={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Lg(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(r(o))n[i]=o;else if(t(o)){const l=n[i];t(l)?n[i]=Lg(l,o):n[i]=Lg(o)}else n[i]=o}return n}function L7(e,t){return Lg(T7,e,t||{})}function O7(e,t){return Lg(I7,e,t||{})}class U7{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=s??j7.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=L7(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:d,error:h}=await E7({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const u=O7(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:d,error:h}=await F7(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(o){return Mt(o)?{data:null,error:o}:{data:null,error:new xu("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new e0("rpId is required for WebAuthn authentication")};try{if(!j4())return{data:null,error:new xu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return Mt(o)?{data:null,error:o}:{data:null,error:new xu("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new e0("rpId is required for WebAuthn registration")};try{if(!j4())return{data:null,error:new xu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Mt(o)?{data:null,error:o}:{data:null,error:new xu("Unexpected error in register",o)}}}}x7();const P7={url:ID,storageKey:LD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:OD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function C4(e,t,r){return await r()}const _d={};class t0{get jwks(){var t,r;return(r=(t=_d[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){_d[this.storageKey]=Object.assign(Object.assign({},_d[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=_d[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){_d[this.storageKey]=Object.assign(Object.assign({},_d[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},P7),t);if(this.storageKey=i.storageKey,this.instanceID=(r=t0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,t0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Fa()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new p7({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=dF(i.fetch),this.lock=i.lock||C4,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:Fa()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=g7:this.lock=C4,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new U7(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:uF()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=N4(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=N4(this.memoryStorage)),Fa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${oF}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(Fa()&&(r=zD(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Fa()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),MD(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Mt(r)?this._returnResult({error:r}):this._returnResult({error:new xu("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Zi}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(Mt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let A=null,b=null;this.flowType==="pkce"&&([A,b]=await vd(this.storage,this.storageKey)),i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:A,code_challenge_method:b},xform:Zi})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Zi})}else throw new Mp("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(Mt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:w4})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:w4})}else throw new Mp("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const i=new yd;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,i,o,l,c,u,d,h,f;let A,b;if("message"in t)A=t.message,b=t.signature;else{const{chain:m,wallet:v,statement:p,options:g}=t;let y;if(Fa())if(typeof v=="object")y=v;else{const j=window;if("ethereum"in j&&typeof j.ethereum=="object"&&"request"in j.ethereum&&typeof j.ethereum.request=="function")y=j.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=v}const x=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href),w=await y.request({method:"eth_requestAccounts"}).then(j=>j).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!w||w.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const N=fF(w[0]);let _=(n=g==null?void 0:g.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!_){const j=await y.request({method:"eth_chainId"});_=y7(j)}const C={domain:x.host,address:N,statement:p,uri:x.href,version:"1",chainId:_,nonce:(s=g==null?void 0:g.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=g==null?void 0:g.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=g==null?void 0:g.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=g==null?void 0:g.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=g==null?void 0:g.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=g==null?void 0:g.signInWithEthereum)===null||d===void 0?void 0:d.resources};A=b7(C),b=await y.request({method:"personal_sign",params:[v7(A),N]})}try{const{data:m,error:v}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:A,signature:b},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Zi});if(v)throw v;if(!m||!m.session||!m.user){const p=new yd;return this._returnResult({data:{user:null,session:null},error:p})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:v})}catch(m){if(Mt(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,s,i,o,l,c,u,d,h,f,A;let b,m;if("message"in t)b=t.message,m=t.signature;else{const{chain:v,wallet:p,statement:g,options:y}=t;let x;if(Fa())if(typeof p=="object")x=p;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))x=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=p}const w=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in x&&x.signIn){const N=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),g?{statement:g}:null));let _;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")_=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)_=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)b=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),m=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${w.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(s=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((h=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...y.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const N=await x.signMessage(new TextEncoder().encode(b),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=N}}try{const{data:v,error:p}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:ju(m)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(A=t.options)===null||A===void 0?void 0:A.captchaToken}}:null),xform:Zi});if(p)throw p;if(!v||!v.session||!v.user){const g=new yd;return this._returnResult({data:{user:null,session:null},error:g})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:p})}catch(v){if(Mt(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(t){const r=await cu(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Zi});if(await tc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new yd;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(Mt(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=t,l=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Zi}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new yd;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,s,i,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await vd(this.storage,this.storageKey));const{error:h}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new Mp("You must provide either an email or phone number.")}catch(l){if(Mt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await Kt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Zi});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(Mt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,n,s,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await vd(this.storage,this.storageKey));const u=await Kt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:A7});return!((i=u.data)===null||i===void 0)&&i.url&&Fa()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(Mt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ys;const{error:s}=await Kt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(Mt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:o}=await Kt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:o,error:l}=await Kt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Mp("You must provide either an email or phone number and a type")}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await cu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<xy:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await cu(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=by()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=l7(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ac}):await this._useSession(async r=>{var n,s,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ys}:await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ac})})}catch(r){if(Mt(r))return QD(r)&&(await this._removeSession(),await tc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Ys;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await vd(this.storage,this.storageKey));const{data:u,error:d}=await Kt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ac});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(Mt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ys;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=vy(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Mt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ys;const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Fa())throw new Hp("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Hp(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new p4("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Hp("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new p4("No code detected.");const{data:g,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!o||!u)throw new Hp("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const A=f-d;A*1e3<=Ud&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${A}s, should have been closer to ${h}s`);const b=f-h;d-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,f,d):d-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,f,d);const{data:m,error:v}=await this._getUser(i);if(v)throw v;const p={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:p,redirectType:t.type},error:null})}catch(n){if(Mt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await cu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({error:i});const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(RD(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await tc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=WD(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await vd(this.storage,this.storageKey,!0));try{return await Kt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Mt(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:f}=i;if(f)throw f;const A=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Kt(this.fetch,"GET",A,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Fa()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Mt(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:i}}=r;if(s)throw s;const{options:o,provider:l,token:c,access_token:u,nonce:d}=t,h=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Zi}),{data:f,error:A}=h;return A?this._returnResult({data:{user:null,session:null},error:A}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new yd}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:A}))}catch(s){if(Mt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await Kt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await JD(async s=>(s>0&&await YD(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Kt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Zi})),(s,i)=>{const o=200*Math.pow(2,s);return i&&yy(i)&&Date.now()+o-n<Ud})}catch(n){if(this._debug(r,"error",n),Mt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Fa()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await cu(this.storage,this.storageKey);if(s&&this.userStorage){let o=await cu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Pd(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:by()}else if(s&&!s.user&&!s.user){const o=await cu(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await tc(this.storage,this.storageKey+"-user"),await Pd(this.storage,this.storageKey,s)):s.user=by()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<xy;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${xy}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),yy(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ys;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ux;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Ys;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Mt(i)){const o={data:null,error:i};return yy(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Pd(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=v4(s);await Pd(this.storage,this.storageKey,i)}else{const s=v4(r);await Pd(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await tc(this.storage,this.storageKey),await tc(this.storage,this.storageKey+"-code-verifier"),await tc(this.storage,this.storageKey+"-user"),this.userStorage&&await tc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Fa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ud);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Ud);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ud}ms, refresh threshold is ${$b} ticks`),s<=$b&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof AF)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Fa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await vd(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?this._returnResult({data:null,error:i}):await Kt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await Kt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?k7(t.webauthn.credential_response):S7(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await Kt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await Kt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:C7(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:B7(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=vy(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await Kt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ys})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Ys});const o=await Kt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Fa()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Mt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Ys});const o=await Kt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Fa()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Mt(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Kt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ys})})}catch(t){if(Mt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await Kt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new Ys})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+PD>s)return n;const{data:i,error:o}=await Kt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:A,error:b}=await this.getSession();if(b||!A.session)return this._returnResult({data:null,error:b});n=A.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=vy(n);r!=null&&r.allowExpired||s7(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:A}=await this.getUser(n);if(A)throw A;return{data:{claims:i,header:s,signature:o},error:null}}const d=i7(s.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,VD(`${l}.${c}`)))throw new Wb("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(Mt(n))return this._returnResult({data:null,error:n});throw n}}}t0.nextInstanceID={};const D7=t0;class R7 extends D7{constructor(t){super(t)}}class Q7{constructor(t,r,n){var s,i,o;this.supabaseUrl=t,this.supabaseKey=r;const l=TD(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:ND,realtime:CD,auth:Object.assign(Object.assign({},jD),{storageKey:c}),global:_D},d=FD(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=SD(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new IP(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new vD(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new EP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:o,flowType:l,lock:c,debug:u,throwOnError:d},h,f){const A={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new R7({url:this.authUrl.href,headers:Object.assign(Object.assign({},A),h),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:l,lock:c,debug:u,throwOnError:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new XP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const M7=(e,t,r)=>new Q7(e,t,r);function H7(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}H7()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const q7="https://dkrtsqienlhpouohmfki.supabase.co",K7="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY",ae=M7(q7,K7),pF=W.createContext(void 0);function $7({children:e}){const[t,r]=W.useState(null),[n,s]=W.useState(null),[i,o]=W.useState(!0);W.useEffect(()=>{ae.auth.getSession().then(({data:{session:f}})=>{r((f==null?void 0:f.user)??null),f!=null&&f.user?l(f.user.id):o(!1)});const{data:{subscription:h}}=ae.auth.onAuthStateChange((f,A)=>{r((A==null?void 0:A.user)??null),A!=null&&A.user?l(A.user.id):(s(null),o(!1))});return()=>h.unsubscribe()},[]);const l=async h=>{try{const{data:f,error:A}=await ae.from("user_profiles").select("*").eq("id",h).maybeSingle();if(A)throw A;s(f)}catch(f){console.error("Error loading profile:",f)}finally{o(!1)}},c=async(h,f)=>{let A=h;if(!h.includes("@")){const{data:m,error:v}=await ae.from("user_profiles").select("email, username, is_active").eq("username",h.toLowerCase()).maybeSingle();if(v)throw new Error("Invalid username or password");if(!m)throw new Error("Invalid username or password");if(!m.is_active)throw new Error("Account is inactive. Please contact administrator.");A=m.email}const{error:b}=await ae.auth.signInWithPassword({email:A,password:f});if(b)throw b},u=async(h,f,A,b)=>{const{data:m,error:v}=await ae.auth.signUp({email:h,password:f});if(v)throw v;if(m.user){const{error:p}=await ae.from("user_profiles").insert({id:m.user.id,email:h,full_name:A,role:b,language:"en",is_active:!0});if(p)throw p}},d=async()=>{const{error:h}=await ae.auth.signOut();if(h)throw h};return a.jsx(pF.Provider,{value:{user:t,profile:n,loading:i,signIn:c,signUp:u,signOut:d},children:e})}function jr(){const e=W.useContext(pF);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const V7={en:{common:{search:"Search",filter:"Filter",export:"Export",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",close:"Close",submit:"Submit",actions:"Actions",loading:"Loading...",noData:"No data available",confirm:"Confirm",yes:"Yes",no:"No",success:"Success",error:"Error",warning:"Warning"},auth:{login:"Login",logout:"Logout",email:"Email",password:"Password",signIn:"Sign In",signOut:"Sign Out",welcomeBack:"Welcome Back",enterCredentials:"Enter your credentials to continue"},nav:{dashboard:"Dashboard",products:"Products",stock:"Stock",batches:"Batches",inventory:"Inventory",customers:"Customers",crm:"CRM",deliveryChallan:"Delivery Challan",sales:"Sales",finance:"Finance",materialReturns:"Material Returns",stockRejections:"Stock Rejections",approvals:"Approvals",settings:"Settings",users:"Users"},commandCenter:{title:"CRM Command Center",subtitle:"Ultra-fast inquiry processing with AI automation",emailList:"Email Inbox",inquiryForm:"Inquiry Form",quickActions:"Quick Actions",todaysActions:"Today's Actions",parseEmail:"Parse Email",parsing:"Parsing...",autoFilled:"Auto-filled by AI",confidence:"Confidence",saveInquiry:"Save Inquiry",saving:"Saving...",sendPrice:"Send Price",sendCOA:"Send COA",sendMSDS:"Send MSDS",sendSample:"Send Sample",logActivity:"Log Activity",noEmailSelected:"Select an email to parse",noInquirySelected:"Select an inquiry for quick actions",selectEmail:"Select an email from the list",emailFrom:"From",emailDate:"Date",requestedItems:"Requested",priority:"Priority",activityType:"Activity Type",activityOutcome:"Outcome",activityNotes:"Notes",dueReminders:"Due Reminders",upcomingFollowups:"Upcoming Follow-ups",recentActivity:"Recent Activity",viewAll:"View All",noReminders:"No due reminders",noFollowups:"No upcoming follow-ups",noActivity:"No recent activity",priorities:{low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},statuses:{new:"New Inquiry",price_quoted:"Price Quoted",coa_pending:"COA Pending",sample_sent:"Sample Sent",negotiation:"Negotiation",po_received:"PO Received",won:"Won",lost:"Lost"},activities:{email_sent:"Email Sent",phone_call:"Phone Call",meeting:"Meeting",document_sent:"Document Sent",follow_up:"Follow-up",note:"Note"},outcomes:{positive:"Positive",neutral:"Neutral",negative:"Negative",pending:"Pending Response"}},dashboard:{title:"Dashboard",totalProducts:"Total Products",lowStock:"Low Stock Items",nearExpiry:"Near Expiry",totalCustomers:"Total Customers",salesThisMonth:"Sales This Month",revenueThisMonth:"Revenue This Month",profitThisMonth:"Profit This Month",pendingFollowUps:"Pending Follow-ups"},products:{title:"Products",addProduct:"Add Product",editProduct:"Edit Product",productName:"Product Name",productCode:"Product Code",hsnCode:"HSN Code",category:"Category",unit:"Unit",packagingType:"Packaging Type",defaultSupplier:"Default Supplier",description:"Description",uploadFiles:"Upload Files",categories:{api:"API",excipient:"Excipient",solvent:"Solvent",other:"Other"},units:{kg:"Kilogram",litre:"Litre",ton:"Ton",piece:"Piece"}},batches:{title:"Batches",addBatch:"Add Batch",editBatch:"Edit Batch",batchNumber:"Batch Number",product:"Product",importDate:"Import Date",importQuantity:"Import Quantity",currentStock:"Current Stock",packagingDetails:"Packaging Details",importPrice:"Import Price",dutyCharges:"Duty Charges",freightCharges:"Freight Charges",otherCharges:"Other Charges",totalCost:"Total Cost",costPerUnit:"Cost Per Unit",expiryDate:"Expiry Date",warehouseLocation:"Warehouse Location",uploadDocuments:"Upload Documents"},inventory:{title:"Inventory",stockSummary:"Stock Summary",batchWiseStock:"Batch-wise Stock",lowStockAlert:"Low Stock Alert",expiryAlert:"Expiry Alert",stockMovement:"Stock Movement",adjustStock:"Adjust Stock"},customers:{title:"Customers",addCustomer:"Add Customer",editCustomer:"Edit Customer",customerName:"Customer Name",companyName:"Company Name",npwp:"NPWP (Tax ID)",address:"Address",city:"City",country:"Country",contactPerson:"Contact Person",email:"Email",phone:"Phone",gstVatType:"GST/VAT Type",paymentTerms:"Payment Terms"},crm:{title:"CRM",leads:"Leads",activities:"Activities",addLead:"Add Lead",editLead:"Edit Lead",companyName:"Company Name",contactPerson:"Contact Person",productInterest:"Product Interest",quantityInterest:"Quantity Interest",leadSource:"Lead Source",status:"Status",assignedTo:"Assigned To",expectedCloseDate:"Expected Close Date",estimatedValue:"Estimated Value",addActivity:"Add Activity",followUp:"Follow-up",statuses:{inquiry:"Inquiry",quotation:"Quotation",negotiation:"Negotiation",won:"Won",lost:"Lost"}},sales:{title:"Sales",invoices:"Invoices",createInvoice:"Create Invoice",invoiceNumber:"Invoice Number",customer:"Customer",invoiceDate:"Invoice Date",dueDate:"Due Date",items:"Items",addItem:"Add Item",quantity:"Quantity",unitPrice:"Unit Price",taxRate:"Tax Rate",subtotal:"Subtotal",tax:"Tax",discount:"Discount",total:"Total",paymentStatus:"Payment Status",deliveryChallan:"Delivery Challan",generatePDF:"Generate PDF",sendEmail:"Send Email"},salesOrders:{title:"Sales Orders",createSalesOrder:"Create Sales Order",customerPoNumber:"Customer PO Number",customerPoDate:"Customer PO Date",soDate:"Sales Order Date",expectedDeliveryDate:"Expected Delivery Date",uploadPo:"Upload Customer PO",product:"Product",freeStock:"Free Stock",discountPercent:"Discount %",taxPercent:"Tax %",lineTotal:"Line Total",itemDeliveryDate:"Item Delivery Date",notes:"Notes",grandTotal:"Grand Total",saveAsDraft:"Save as Draft",submitForApproval:"Submit for Approval"},finance:{title:"Finance",dashboard:"Dashboard",expenses:"Expenses",reports:"Reports",importCosts:"Import Costs",salesRevenue:"Sales Revenue",grossProfit:"Gross Profit",profitMargin:"Profit Margin",addExpense:"Add Expense",expenseCategory:"Category",amount:"Amount",expenseDate:"Date"},settings:{title:"Settings",companyProfile:"Company Profile",taxSettings:"Tax Settings",emailSettings:"Email Settings",systemSettings:"System Settings",companyName:"Company Name",companyAddress:"Company Address",companyPhone:"Company Phone",companyEmail:"Company Email",companyTaxId:"Company Tax ID",defaultTaxRate:"Default Tax Rate",invoicePrefix:"Invoice Prefix",lowStockThreshold:"Low Stock Threshold",expiryAlertDays:"Expiry Alert Days"}},id:{common:{search:"Cari",filter:"Filter",export:"Ekspor",add:"Tambah",edit:"Edit",delete:"Hapus",save:"Simpan",cancel:"Batal",close:"Tutup",submit:"Kirim",actions:"Aksi",loading:"Memuat...",noData:"Tidak ada data",confirm:"Konfirmasi",yes:"Ya",no:"Tidak",success:"Berhasil",error:"Error",warning:"Peringatan"},auth:{login:"Masuk",logout:"Keluar",email:"Email",password:"Kata Sandi",signIn:"Masuk",signOut:"Keluar",welcomeBack:"Selamat Datang Kembali",enterCredentials:"Masukkan kredensial Anda untuk melanjutkan"},nav:{dashboard:"Dasbor",products:"Produk",stock:"Stok",batches:"Batch",inventory:"Inventaris",customers:"Pelanggan",crm:"CRM",deliveryChallan:"Surat Jalan",sales:"Penjualan",finance:"Keuangan",materialReturns:"Pengembalian Material",stockRejections:"Penolakan Stok",approvals:"Persetujuan",settings:"Pengaturan",users:"Pengguna"},commandCenter:{title:"Pusat Komando CRM",subtitle:"Pemrosesan pertanyaan ultra-cepat dengan otomasi AI",emailList:"Kotak Masuk Email",inquiryForm:"Formulir Pertanyaan",quickActions:"Aksi Cepat",todaysActions:"Aksi Hari Ini",parseEmail:"Parse Email",parsing:"Memproses...",autoFilled:"Diisi otomatis oleh AI",confidence:"Kepercayaan",saveInquiry:"Simpan Pertanyaan",saving:"Menyimpan...",sendPrice:"Kirim Harga",sendCOA:"Kirim COA",sendMSDS:"Kirim MSDS",sendSample:"Kirim Sample",logActivity:"Catat Aktivitas",noEmailSelected:"Pilih email untuk diproses",noInquirySelected:"Pilih pertanyaan untuk aksi cepat",selectEmail:"Pilih email dari daftar",emailFrom:"Dari",emailDate:"Tanggal",requestedItems:"Diminta",priority:"Prioritas",activityType:"Jenis Aktivitas",activityOutcome:"Hasil",activityNotes:"Catatan",dueReminders:"Pengingat Jatuh Tempo",upcomingFollowups:"Tindak Lanjut Mendatang",recentActivity:"Aktivitas Terbaru",viewAll:"Lihat Semua",noReminders:"Tidak ada pengingat jatuh tempo",noFollowups:"Tidak ada tindak lanjut mendatang",noActivity:"Tidak ada aktivitas terbaru",priorities:{low:"Rendah",medium:"Sedang",high:"Tinggi",urgent:"Mendesak"},statuses:{new:"Pertanyaan Baru",price_quoted:"Harga Dikutip",coa_pending:"COA Tertunda",sample_sent:"Sample Terkirim",negotiation:"Negosiasi",po_received:"PO Diterima",won:"Menang",lost:"Kalah"},activities:{email_sent:"Email Terkirim",phone_call:"Panggilan Telepon",meeting:"Pertemuan",document_sent:"Dokumen Terkirim",follow_up:"Tindak Lanjut",note:"Catatan"},outcomes:{positive:"Positif",neutral:"Netral",negative:"Negatif",pending:"Menunggu Respons"}},dashboard:{title:"Dasbor",totalProducts:"Total Produk",lowStock:"Stok Rendah",nearExpiry:"Mendekati Kadaluarsa",totalCustomers:"Total Pelanggan",salesThisMonth:"Penjualan Bulan Ini",revenueThisMonth:"Pendapatan Bulan Ini",profitThisMonth:"Laba Bulan Ini",pendingFollowUps:"Follow-up Tertunda"},products:{title:"Produk",addProduct:"Tambah Produk",editProduct:"Edit Produk",productName:"Nama Produk",productCode:"Kode Produk",hsnCode:"Kode HSN",category:"Kategori",unit:"Satuan",packagingType:"Jenis Kemasan",defaultSupplier:"Pemasok Default",description:"Deskripsi",uploadFiles:"Unggah File",categories:{api:"API",excipient:"Excipient",solvent:"Pelarut",other:"Lainnya"},units:{kg:"Kilogram",litre:"Liter",ton:"Ton",piece:"Buah"}},batches:{title:"Batch",addBatch:"Tambah Batch",editBatch:"Edit Batch",batchNumber:"Nomor Batch",product:"Produk",importDate:"Tanggal Impor",importQuantity:"Jumlah Impor",currentStock:"Stok Saat Ini",packagingDetails:"Detail Kemasan",importPrice:"Harga Impor",dutyCharges:"Biaya Bea",freightCharges:"Biaya Pengiriman",otherCharges:"Biaya Lainnya",totalCost:"Total Biaya",costPerUnit:"Biaya Per Unit",expiryDate:"Tanggal Kadaluarsa",warehouseLocation:"Lokasi Gudang",uploadDocuments:"Unggah Dokumen"},inventory:{title:"Inventaris",stockSummary:"Ringkasan Stok",batchWiseStock:"Stok Per Batch",lowStockAlert:"Peringatan Stok Rendah",expiryAlert:"Peringatan Kadaluarsa",stockMovement:"Pergerakan Stok",adjustStock:"Sesuaikan Stok"},customers:{title:"Pelanggan",addCustomer:"Tambah Pelanggan",editCustomer:"Edit Pelanggan",customerName:"Nama Pelanggan",companyName:"Nama Perusahaan",npwp:"NPWP",address:"Alamat",city:"Kota",country:"Negara",contactPerson:"Orang yang Dihubungi",email:"Email",phone:"Telepon",gstVatType:"Jenis GST/VAT",paymentTerms:"Syarat Pembayaran"},crm:{title:"CRM",leads:"Prospek",activities:"Aktivitas",addLead:"Tambah Prospek",editLead:"Edit Prospek",companyName:"Nama Perusahaan",contactPerson:"Orang yang Dihubungi",productInterest:"Produk yang Diminati",quantityInterest:"Jumlah yang Diminati",leadSource:"Sumber Prospek",status:"Status",assignedTo:"Ditugaskan Kepada",expectedCloseDate:"Tanggal Penutupan yang Diharapkan",estimatedValue:"Nilai Perkiraan",addActivity:"Tambah Aktivitas",followUp:"Tindak Lanjut",statuses:{inquiry:"Pertanyaan",quotation:"Penawaran",negotiation:"Negosiasi",won:"Menang",lost:"Kalah"}},sales:{title:"Penjualan",invoices:"Faktur",createInvoice:"Buat Faktur",invoiceNumber:"Nomor Faktur",customer:"Pelanggan",invoiceDate:"Tanggal Faktur",dueDate:"Tanggal Jatuh Tempo",items:"Item",addItem:"Tambah Item",quantity:"Jumlah",unitPrice:"Harga Satuan",taxRate:"Tarif Pajak",subtotal:"Subtotal",tax:"Pajak",discount:"Diskon",total:"Total",paymentStatus:"Status Pembayaran",deliveryChallan:"Surat Jalan",generatePDF:"Buat PDF",sendEmail:"Kirim Email"},salesOrders:{title:"Sales Order",createSalesOrder:"Buat Sales Order",customerPoNumber:"Nomor PO Pelanggan",customerPoDate:"Tanggal PO Pelanggan",soDate:"Tanggal Sales Order",expectedDeliveryDate:"Tanggal Pengiriman Diharapkan",uploadPo:"Unggah PO Pelanggan",product:"Produk",freeStock:"Stok Tersedia",discountPercent:"Diskon %",taxPercent:"Pajak %",lineTotal:"Total Baris",itemDeliveryDate:"Tanggal Pengiriman Item",notes:"Catatan",grandTotal:"Total Keseluruhan",saveAsDraft:"Simpan sebagai Draft",submitForApproval:"Kirim untuk Persetujuan"},finance:{title:"Keuangan",dashboard:"Dasbor",expenses:"Pengeluaran",reports:"Laporan",importCosts:"Biaya Impor",salesRevenue:"Pendapatan Penjualan",grossProfit:"Laba Kotor",profitMargin:"Margin Laba",addExpense:"Tambah Pengeluaran",expenseCategory:"Kategori",amount:"Jumlah",expenseDate:"Tanggal"},settings:{title:"Pengaturan",companyProfile:"Profil Perusahaan",taxSettings:"Pengaturan Pajak",emailSettings:"Pengaturan Email",systemSettings:"Pengaturan Sistem",companyName:"Nama Perusahaan",companyAddress:"Alamat Perusahaan",companyPhone:"Telepon Perusahaan",companyEmail:"Email Perusahaan",companyTaxId:"ID Pajak Perusahaan",defaultTaxRate:"Tarif Pajak Default",invoicePrefix:"Awalan Faktur",lowStockThreshold:"Ambang Stok Rendah",expiryAlertDays:"Hari Peringatan Kadaluarsa"}}},mF=W.createContext(void 0);function G7({children:e}){const[t,r]=W.useState("en");W.useEffect(()=>{const i=localStorage.getItem("language");i&&(i==="en"||i==="id")&&r(i)},[]);const n=i=>{r(i),localStorage.setItem("language",i)},s=i=>{const o=i.split(".");let l=V7[t];for(const c of o)if(l&&typeof l=="object"&&c in l)l=l[c];else return i;return typeof l=="string"?l:i};return a.jsx(mF.Provider,{value:{language:t,setLanguage:n,t:s},children:e})}function kn(){const e=W.useContext(mF);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e}const gF=W.createContext(void 0);function W7({children:e}){const[t,r]=W.useState("dashboard"),[n,s]=W.useState(null),[i,o]=W.useState(!1),l=()=>s(null);return a.jsx(gF.Provider,{value:{currentPage:t,setCurrentPage:r,navigationData:n,setNavigationData:s,clearNavigationData:l,sidebarCollapsed:i,setSidebarCollapsed:o},children:e})}function Ho(){const e=W.useContext(gF);if(e===void 0)throw new Error("useNavigation must be used within a NavigationProvider");return e}const xF="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='48.8745mm'%20height='48.2317mm'%20version='1.1'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%2015686.55%2015480.24'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xmlns:xodm='http://www.corel.com/coreldraw/odm/2003'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.fil1%20{fill:%23FD6D26}%20.fil0%20{fill:%23FDB763}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='Layer_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_105553262742272'%3e%3cpath%20class='fil0'%20d='M69.94%2010438.12l10353.39%200%200%20-1798.67%201665.92%200%200%201868.6%200%20320.44%200%204552.28c0,38.48%20-31.45,69.94%20-69.94,69.94l-11949.38%200c-38.48,0%20-69.94,-31.45%20-69.94,-69.94l0%20-4872.72c0,-38.48%2031.45,-69.94%2069.94,-69.94zm1605.9%201710.15l8737.57%200c13.58,0%2024.68,11.11%2024.68,24.68l0%201719.84c0,13.58%20-11.11,24.68%20-24.68,24.68l-8737.57%200c-13.58,0%20-24.68,-11.11%20-24.68,-24.68l0%20-1719.84c0,-13.58%2011.11,-24.68%2024.68,-24.68z'/%3e%3cpath%20class='fil0'%20d='M15587.15%205136.67l-10353.49%200%200%201822.07%20-1665.92%200%200%20-1892.9%200%20-324.61%200%20-4611.43c0,-39%2031.45,-70.87%2069.94,-70.87l11949.47%200c38.48,0%2069.94,31.87%2069.94,70.87l0%204936.04c0,39%20-31.45,70.83%20-69.94,70.83zm-1605.9%20-1732.36l-8737.67%200c-13.58,0%20-24.68,-11.27%20-24.68,-25l0%20-1742.21c0,-13.74%2011.11,-25%2024.68,-25l8737.67%200c13.58,0%2024.68,11.27%2024.68,25l0%201742.21c0,13.74%20-11.11,25%20-24.68,25z'/%3e%3cpolygon%20class='fil1'%20points='-0,0%201651.16,0%201651.16,6929.27%2015657.09,6929.27%2015657.09,6958.74%2015686.55,6958.74%2015686.55,15480.24%2014022.85,15480.24%2014022.85,8639.45%201651.16,8639.45%20-0,8639.45%20-0,6929.27%20'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";function z7(){const[e,t]=W.useState(""),[r,n]=W.useState(""),[s,i]=W.useState(!1),[o,l]=W.useState(""),{signIn:c}=jr(),{t:u}=kn(),d=async h=>{h.preventDefault(),l(""),i(!0);try{await c(e,r)}catch{l("Invalid username or password")}finally{i(!1)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-8",children:[a.jsxs("div",{className:"flex flex-col items-center mb-8",children:[a.jsx("div",{className:"mb-4",children:a.jsx("img",{src:xF,alt:"Company Logo",className:"h-24 w-24 mx-auto"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center",children:"PT. SHUBHAM ANZEN"}),a.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:"PHARMA JAYA"})]}),a.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-2",children:u("auth.welcomeBack")}),a.jsx("p",{className:"text-gray-600 text-center mb-8",children:u("auth.enterCredentials")}),a.jsxs("form",{onSubmit:d,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),a.jsx("input",{id:"username",type:"text",value:e,onChange:h=>t(h.target.value),required:!0,autoComplete:"username",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"username"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your username (e.g., admin, kunal, sales)"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:u("auth.password")}),a.jsx("input",{id:"password",type:"password",value:r,onChange:h=>n(h.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:""})]}),o&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),a.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:u(s?"common.loading":"auth.signIn")})]})]})})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var X7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y7=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ft=(e,t)=>{const r=W.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...u},d)=>W.createElement("svg",{ref:d,...X7,width:s,height:s,stroke:n,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Y7(e)}`,l].join(" "),...u},[...t.map(([h,f])=>W.createElement(h,f)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J7=ft("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=ft("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=ft("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=ft("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=ft("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z7=ft("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=ft("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=ft("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=ft("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=ft("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=ft("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=ft("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=ft("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=ft("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=ft("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=ft("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=ft("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=ft("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=ft("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=ft("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=ft("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=ft("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=ft("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=ft("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=ft("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=ft("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=ft("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=ft("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=ft("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=ft("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=ft("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=ft("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=ft("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=ft("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=ft("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=ft("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ai=ft("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=ft("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=ft("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=ft("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=ft("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=ft("FileOutput",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4 7V4a2 2 0 0 1 2-2 2 2 0 0 0-2 2",key:"1vk7w2"}],["path",{d:"M4.063 20.999a2 2 0 0 0 2 1L18 22a2 2 0 0 0 2-2V7l-5-5H6",key:"1jink5"}],["path",{d:"m5 11-3 3",key:"1dgrs4"}],["path",{d:"m5 17-3-3h10",key:"1mvvaf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=ft("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=ft("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=ft("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=ft("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=ft("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=ft("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T4=ft("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=ft("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n_=ft("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=ft("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=ft("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=ft("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=ft("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=ft("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=ft("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=ft("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=ft("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=ft("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=ft("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=ft("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=ft("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=ft("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=ft("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=ft("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=ft("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=ft("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=ft("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=ft("PackageX",[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=ft("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=ft("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=ft("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=ft("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=ft("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=ft("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=ft("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=ft("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=ft("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=ft("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=ft("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=ft("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=ft("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=ft("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=ft("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=ft("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dA=ft("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=ft("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cy=ft("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=ft("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=ft("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=ft("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=ft("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=ft("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=ft("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=ft("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=ft("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=ft("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=ft("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=ft("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=ft("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=ft("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=ft("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=ft("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=ft("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=ft("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=ft("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function jR(){const[e,t]=W.useState(!1),[r,n]=W.useState([]),[s,i]=W.useState(0),{user:o}=jr();W.useEffect(()=>{if(o){l();const f=setInterval(l,6e4);return()=>clearInterval(f)}},[o]);const l=async()=>{try{const{data:f,error:A}=await ae.from("notifications").select("*").eq("user_id",o==null?void 0:o.id).order("created_at",{ascending:!1}).limit(10);if(A)throw A;n(f||[]),i((f==null?void 0:f.filter(b=>!b.is_read).length)||0)}catch(f){console.error("Error loading notifications:",f)}},c=async f=>{try{const{error:A}=await ae.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",f);if(A)throw A;l()}catch(A){console.error("Error marking notification as read:",A)}},u=async()=>{try{const{error:f}=await ae.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("user_id",o==null?void 0:o.id).eq("is_read",!1);if(f)throw f;l()}catch(f){console.error("Error marking all as read:",f)}},d=f=>{switch(f){case"low_stock":return a.jsx(as,{className:"w-5 h-5 text-orange-600"});case"near_expiry":return a.jsx(Ra,{className:"w-5 h-5 text-red-600"});case"pending_invoice":return a.jsx(sr,{className:"w-5 h-5 text-blue-600"});case"follow_up":return a.jsx(_y,{className:"w-5 h-5 text-purple-600"});case"task_assigned":return a.jsx(n0,{className:"w-5 h-5 text-blue-600"});case"task_mention":return a.jsx(tR,{className:"w-5 h-5 text-purple-600"});case"task_comment":return a.jsx(S0,{className:"w-5 h-5 text-green-600"});case"task_status_change":return a.jsx(n0,{className:"w-5 h-5 text-orange-600"});case"task_deadline":return a.jsx(Ra,{className:"w-5 h-5 text-red-600"});default:return a.jsx(Ps,{className:"w-5 h-5 text-gray-600"})}},h=f=>{const A=new Date(f),m=new Date().getTime()-A.getTime(),v=Math.floor(m/6e4),p=Math.floor(m/36e5),g=Math.floor(m/864e5);return v<1?"Just now":v<60?`${v}m ago`:p<24?`${p}h ago`:g<7?`${g}d ago`:A.toLocaleDateString()};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>t(!e),className:"p-2 rounded hover:bg-gray-100 relative",children:[a.jsx(_y,{className:"w-5 h-5 text-gray-600"}),s>0&&a.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center font-semibold",children:s>9?"9+":s})]}),e&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>t(!1)}),a.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-40",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),a.jsxs("div",{className:"flex items-center gap-2",children:[s>0&&a.jsxs("button",{onClick:u,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[a.jsx(sR,{className:"w-4 h-4"}),"Mark all read"]}),a.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Kr,{className:"w-5 h-5"})})]})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx(_y,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No notifications"})]}):r.map(f=>a.jsx("div",{className:`p-4 border-b hover:bg-gray-50 cursor-pointer transition ${f.is_read?"":"bg-blue-50"}`,onClick:()=>{f.is_read||c(f.id)},children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-1",children:d(f.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx("p",{className:`text-sm font-medium ${f.is_read?"text-gray-700":"text-gray-900"}`,children:f.title}),!f.is_read&&a.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0 mt-1.5"})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f.message}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:h(f.created_at)})]})]})},f.id))}),r.length>0&&a.jsx("div",{className:"p-3 border-t bg-gray-50 text-center",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Showing last ",r.length," notifications"]})})]})]})]})}function Zn({children:e}){const[t,r]=W.useState(!1),{profile:n,signOut:s}=jr(),{language:i,setLanguage:o,t:l}=kn(),{currentPage:c,setCurrentPage:u,sidebarCollapsed:d,setSidebarCollapsed:h}=Ho(),A=["crm","command-center","finance"].includes(c);W.useEffect(()=>{A&&!d&&h(!0)},[c,A,d,h]);const m=[{id:"dashboard",label:l("nav.dashboard"),icon:hR,roles:["admin","accounts","sales","warehouse"]},{id:"products",label:l("nav.products"),icon:Ps,roles:["admin","sales","warehouse"]},{id:"batches",label:l("nav.batches"),icon:rR,roles:["admin","warehouse","accounts"]},{id:"stock",label:l("nav.stock"),icon:P4,roles:["admin","sales","warehouse","accounts"]},{id:"customers",label:l("nav.customers"),icon:Hu,roles:["admin","accounts","sales"]},{id:"sales-orders",label:"Sales Orders",icon:sr,roles:["admin","accounts","sales"]},{id:"delivery-challan",label:l("nav.deliveryChallan"),icon:TF,roles:["admin","accounts","sales","warehouse"]},{id:"sales",label:l("nav.sales"),icon:_R,roles:["admin","accounts","sales"]},{id:"import-requirements",label:"Import Requirements",icon:ui,roles:["admin","warehouse","sales"]},{id:"finance",label:l("nav.finance"),icon:El,roles:["admin","accounts"]},{id:"crm",label:l("nav.crm"),icon:oR,roles:["admin","sales"]},{id:"command-center",label:"Command Center",icon:LF,roles:["admin","sales"]},{id:"tasks",label:"Tasks",icon:n0,roles:["admin","accounts","sales","warehouse"]},{id:"inventory",label:l("nav.inventory"),icon:P4,roles:["admin","warehouse"]},{id:"settings",label:l("nav.settings"),icon:SF,roles:["admin"]}].filter(p=>n&&p.roles.includes(n.role)),v=()=>{o(i==="en"?"id":"en")};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&a.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 z-20 lg:hidden transition-opacity",onClick:()=>r(!1)}),a.jsxs("aside",{className:`fixed top-0 left-0 z-30 h-full bg-white border-r border-gray-200 transform transition-all lg:translate-x-0 ${t?"translate-x-0":"-translate-x-full"} ${d&&A?"w-16":"w-64"} flex flex-col`,children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:xF,alt:"Logo",className:"h-8 w-8 flex-shrink-0"}),!(d&&A)&&a.jsxs("div",{className:"flex flex-col leading-tight",children:[a.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PT. SHUBHAM ANZEN"}),a.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PHARMA JAYA"})]})]}),a.jsx("button",{onClick:()=>r(!1),className:"lg:hidden p-1 rounded hover:bg-gray-100",children:a.jsx(Kr,{className:"w-5 h-5"})})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto p-3 space-y-1",children:m.map(p=>{const g=p.icon,y=c===p.id;return a.jsxs("button",{onClick:()=>{u(p.id),r(!1)},className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg transition relative group ${y?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50"} ${d&&A?"justify-center":""}`,title:d&&A?p.label:"",children:[a.jsx(g,{className:"w-5 h-5 flex-shrink-0"}),!(d&&A)&&a.jsx("span",{className:"font-medium text-sm",children:p.label}),d&&A&&a.jsx("span",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity z-50",children:p.label})]},p.id)})})]}),a.jsxs("div",{className:`transition-all ${d&&A?"lg:pl-16":"lg:pl-64"}`,children:[a.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>r(!0),className:"lg:hidden p-2 rounded hover:bg-gray-100",children:a.jsx(L4,{className:"w-6 h-6"})}),A&&a.jsx("button",{onClick:()=>h(!d),className:"hidden lg:block p-2 rounded hover:bg-gray-100",title:d?"Expand sidebar":"Collapse sidebar",children:a.jsx(L4,{className:"w-6 h-6"})})]}),a.jsx("div",{className:"flex-1"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(jR,{}),a.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100",children:[a.jsx(NF,{className:"w-5 h-5 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 uppercase",children:i})]}),a.jsxs("button",{onClick:()=>s(),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100 text-gray-700",children:[a.jsx(kF,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:l("auth.logout")})]})]})]})}),a.jsx("main",{className:"p-4 lg:p-6",children:e})]})]})}function CR({onActionClick:e}){const{profile:t}=jr(),{setCurrentPage:r}=Ho(),[n,s]=W.useState([]),[i,o]=W.useState([]),[l,c]=W.useState(0),[u,d]=W.useState(0),[h,f]=W.useState(!0);W.useEffect(()=>{A(),b();const y=ae.channel("reminders_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_reminders"},()=>{A()}).subscribe();return()=>{y.unsubscribe()}},[]);const A=async()=>{try{const y=new Date;y.setHours(0,0,0,0);const x=new Date(y);x.setDate(x.getDate()+1);const{data:w,error:N}=await ae.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).gte("due_date",y.toISOString()).lt("due_date",x.toISOString()).order("due_date",{ascending:!0}).limit(5);if(N)throw N;const{data:_,error:C}=await ae.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).lt("due_date",y.toISOString()).order("due_date",{ascending:!0}).limit(5);if(C)throw C;s(w||[]),o(_||[])}catch(y){console.error("Error loading reminders:",y)}finally{f(!1)}},b=async()=>{try{if((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales"){const{count:y}=await ae.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval");c(y||0)}if((t==null?void 0:t.role)==="admin"){const{count:y}=await ae.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval");d(y||0)}}catch(y){console.error("Error loading approvals:",y)}},m=async y=>{try{const{error:x}=await ae.from("crm_reminders").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",y);if(x)throw x;A()}catch(x){console.error("Error completing reminder:",x)}},v=y=>{switch(y){case"send_price":case"send_coa":case"send_sample":return Ri;case"follow_up":return Fl;default:return Na}},p=y=>{switch(y){case"send_price":return"text-green-600";case"send_coa":return"text-blue-600";case"send_sample":return"text-purple-600";case"follow_up":return"text-orange-600";default:return"text-gray-600"}};if(h)return a.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:a.jsxs("div",{className:"animate-pulse space-y-4",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),a.jsx("div",{className:"h-10 bg-gray-200 rounded"}),a.jsx("div",{className:"h-10 bg-gray-200 rounded"})]})});const g=n.length+i.length+l+u;return g===0?a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(Ra,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),a.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"All Clear!"})]}),a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Us,{className:"w-16 h-16 text-green-500 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No pending actions for today"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Great job staying on top of everything!"})]})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(Ra,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),a.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:[g," ",g===1?"Action":"Actions"]})]})}),a.jsxs("div",{className:"p-4 space-y-3",children:[(l>0||u>0)&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ea,{className:"w-4 h-4 text-yellow-600"}),a.jsx("h3",{className:"text-sm font-semibold text-yellow-600",children:"Pending Approvals"})]}),a.jsxs("div",{className:"space-y-2",children:[l>0&&a.jsxs("div",{onClick:()=>r("sales-orders"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[a.jsx(sr,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Sales Orders Pending Approval"}),a.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[l," order",l!==1?"s":""," waiting for your review"]})]}),a.jsx(Sc,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),u>0&&a.jsxs("div",{onClick:()=>r("delivery-challan"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[a.jsx(bF,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Delivery Challans Pending Approval"}),a.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[u," challan",u!==1?"s":""," waiting for your review"]})]}),a.jsx(Sc,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})]})]}),i.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ea,{className:"w-4 h-4 text-red-600"}),a.jsxs("h3",{className:"text-sm font-semibold text-red-600",children:["Overdue (",i.length,")"]})]}),a.jsx("div",{className:"space-y-2",children:i.map(y=>{const x=v(y.reminder_type),w=p(y.reminder_type);return a.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg hover:shadow-sm transition",children:[a.jsx(x,{className:`w-4 h-4 ${w} mt-0.5 flex-shrink-0`}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:y.title}),y.crm_inquiries&&a.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",y.crm_inquiries.inquiry_number," - ",y.crm_inquiries.company_name]}),a.jsxs("p",{className:"text-xs text-red-600 font-medium mt-1",children:[Math.abs(Math.floor((new Date().getTime()-new Date(y.due_date).getTime())/(1e3*60*60*24)))," days overdue"]})]}),a.jsx("button",{onClick:()=>m(y.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:a.jsx(Us,{className:"w-5 h-5"})})]},y.id)})})]}),n.length>0&&a.jsxs("div",{children:[i.length>0&&a.jsxs("div",{className:"flex items-center gap-2 mb-2 mt-4",children:[a.jsx(Ra,{className:"w-4 h-4 text-blue-600"}),a.jsxs("h3",{className:"text-sm font-semibold text-blue-600",children:["Today (",n.length,")"]})]}),a.jsx("div",{className:"space-y-2",children:n.map(y=>{const x=v(y.reminder_type),w=p(y.reminder_type);return a.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 border border-blue-200 rounded-lg hover:shadow-sm transition",children:[a.jsx(x,{className:`w-4 h-4 ${w} mt-0.5 flex-shrink-0`}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:y.title}),y.crm_inquiries&&a.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",y.crm_inquiries.inquiry_number," - ",y.crm_inquiries.company_name]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:new Date(y.due_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),a.jsx("button",{onClick:()=>m(y.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:a.jsx(Us,{className:"w-5 h-5"})})]},y.id)})})]})]}),g>5&&a.jsx("div",{className:"p-3 border-t border-gray-200",children:a.jsxs("button",{className:"w-full flex items-center justify-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[a.jsx("span",{children:"View All Actions"}),a.jsx(Sc,{className:"w-4 h-4"})]})})]})}function D4(){const{t:e}=kn(),{profile:t}=jr(),{setCurrentPage:r}=Ho(),[n,s]=W.useState({totalProducts:0,lowStockItems:0,nearExpiryBatches:0,totalCustomers:0,salesThisMonth:0,revenueThisMonth:0,profitThisMonth:0,pendingFollowUps:0,pendingSalesOrders:0,pendingDeliveryChallans:0,overdueInvoicesCount:0,overdueInvoicesAmount:0}),[i,o]=W.useState(!0),[l,c]=W.useState(null);W.useEffect(()=>{u()},[]);const u=async()=>{var b,m,v,p,g,y,x;try{c(null);const w=new Date,N=new Date(w.getFullYear(),w.getMonth(),1),_=new Date(w.getFullYear(),w.getMonth()+1,0,23,59,59),[C,j,E,S,F,I,O,M,P]=await Promise.all([ae.from("products").select("id",{count:"exact",head:!0}).eq("is_active",!0),ae.from("batches").select("current_stock, expiry_date").eq("is_active",!0),ae.from("customers").select("id",{count:"exact",head:!0}).eq("is_active",!0),ae.from("sales_invoices").select("total_amount, subtotal, created_at, invoice_date").gte("invoice_date",N.toISOString()).lte("invoice_date",_.toISOString()),ae.from("crm_activities").select("id",{count:"exact"}).eq("is_completed",!1).not("follow_up_date","is",null),ae.from("app_settings").select("low_stock_threshold").maybeSingle(),ae.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval"),ae.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval"),ae.from("sales_invoices").select("id, total_amount, due_date").in("payment_status",["pending","partial"]).lt("due_date",new Date().toISOString().split("T")[0])]),X=((b=I==null?void 0:I.data)==null?void 0:b.low_stock_threshold)||100,J=((m=j.data)==null?void 0:m.filter(Q=>Q.current_stock<X).length)||0,H=new Date;H.setDate(H.getDate()+30);const V=((v=j.data)==null?void 0:v.filter(Q=>Q.expiry_date&&new Date(Q.expiry_date)<=H&&new Date(Q.expiry_date)>=new Date).length)||0,K=((p=S.data)==null?void 0:p.reduce((Q,z)=>Q+(Number(z.total_amount)||0),0))||0,B=((g=S.data)==null?void 0:g.reduce((Q,z)=>Q+(Number(z.subtotal)||0),0))||0,L=K-B*.7,D=(await Promise.all((P.data||[]).map(async Q=>{const{data:z}=await ae.rpc("get_invoice_paid_amount",{p_invoice_id:Q.id}),G=z||0;return Q.total_amount-G}))).reduce((Q,z)=>Q+z,0);s({totalProducts:C.count||0,lowStockItems:J,nearExpiryBatches:V,totalCustomers:E.count||0,salesThisMonth:((y=S.data)==null?void 0:y.length)||0,revenueThisMonth:K,profitThisMonth:Math.max(0,L),pendingFollowUps:F.count||0,pendingSalesOrders:O.count||0,pendingDeliveryChallans:M.count||0,overdueInvoicesCount:((x=P.data)==null?void 0:x.length)||0,overdueInvoicesAmount:D})}catch{c("Failed to load dashboard data. Please try again.")}finally{o(!1)}},d=[{title:e("dashboard.lowStock"),value:n.lowStockItems,icon:as,color:"orange"},{title:e("dashboard.nearExpiry"),value:n.nearExpiryBatches,icon:Ra,color:"red"},{title:e("dashboard.salesThisMonth"),value:n.salesThisMonth,icon:ui,color:"blue"}],h=[];((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts")&&h.push({title:"Overdue Invoices",value:n.overdueInvoicesCount,subtitle:`Rp ${n.overdueInvoicesAmount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,icon:as,color:"red-gradient",link:"sales"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales")&&h.push({title:"Pending PO Approvals",value:n.pendingSalesOrders,icon:sr,color:"yellow",link:"sales-orders"}),(t==null?void 0:t.role)==="admin"&&h.push({title:"Pending DC Approvals",value:n.pendingDeliveryChallans,icon:bF,color:"yellow",link:"delivery-challan"});const f=[...h,...d],A={blue:{bg:"bg-blue-50",text:"text-blue-600",icon:"bg-blue-100"},orange:{bg:"bg-orange-50",text:"text-orange-600",icon:"bg-orange-100"},red:{bg:"bg-red-50",text:"text-red-600",icon:"bg-red-100"},"red-gradient":{bg:"bg-gradient-to-br from-red-500 to-orange-500",text:"text-white",icon:"bg-white/20"},green:{bg:"bg-green-50",text:"text-green-600",icon:"bg-green-100"},emerald:{bg:"bg-emerald-50",text:"text-emerald-600",icon:"bg-emerald-100"},purple:{bg:"bg-purple-50",text:"text-purple-600",icon:"bg-purple-100"},yellow:{bg:"bg-yellow-50",text:"text-yellow-600",icon:"bg-yellow-100"}};return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("dashboard.title")}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to your pharma trading management system"})]}),l?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[a.jsx(as,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),a.jsx("p",{className:"text-red-700 font-medium",children:l}),a.jsx("button",{onClick:u,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Try Again"})]}):i?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:[...Array(8)].map((b,m)=>a.jsxs("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse",children:[a.jsx("div",{className:"h-10 bg-gray-200 rounded mb-3"}),a.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2"})]},m))}):a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:f.map((b,m)=>{const v=b.icon,p=A[b.color],g=!!b.link;return a.jsx("div",{className:`${p.bg} rounded-lg shadow p-3 md:p-4 transition hover:shadow-lg ${g?"cursor-pointer":""}`,onClick:()=>g&&r(b.link),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:`text-xs md:text-sm font-medium ${b.color==="red-gradient"?"text-white/80":"text-gray-600"} truncate`,children:b.title}),a.jsx("p",{className:`text-xl md:text-2xl font-bold ${p.text} mt-1`,children:b.value}),b.subtitle&&a.jsx("p",{className:`text-xs mt-0.5 ${b.color==="red-gradient"?"text-white/90":"text-gray-500"} truncate`,children:b.subtitle})]}),a.jsx("div",{className:`${p.icon} p-2 md:p-3 rounded-full flex-shrink-0 ml-2`,children:a.jsx(v,{className:`w-4 h-4 md:w-5 md:h-5 ${p.text}`})})]})},m)})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsx(CR,{})}),a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Links"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("a",{href:"#",className:"block p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition text-blue-700 font-medium",children:"Go to Command Center"}),a.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"View All Inquiries"}),a.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"Create Manual Inquiry"})]})]})]})]})})}function ws({data:e,columns:t,onRowClick:r,actions:n,loading:s}){const[i,o]=W.useState(""),[l,c]=W.useState(null),{t:u}=kn(),d=A=>{let b="asc";(l==null?void 0:l.key)===A&&l.direction==="asc"&&(b="desc"),c({key:A,direction:b})},h=A=>{const b=[],m=v=>{v!=null&&(typeof v=="object"&&!Array.isArray(v)?Object.values(v).forEach(m):Array.isArray(v)?v.forEach(m):b.push(String(v)))};return Object.values(A).forEach(m),b},f=(()=>{let A=[...e];return i&&(A=A.filter(b=>h(b).some(m=>m.toLowerCase().includes(i.toLowerCase())))),l&&A.sort((b,m)=>{const v=b[l.key],p=m[l.key];return v<p?l.direction==="asc"?-1:1:v>p?l.direction==="asc"?1:-1:0}),A})();return s?a.jsx("div",{className:"bg-white rounded-lg shadow",children:a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:u("common.loading")})]})}):a.jsxs("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("div",{className:"relative",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:i,onChange:A=>o(A.target.value),placeholder:u("common.search"),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[t.map(A=>a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:A.sortable?a.jsxs("button",{onClick:()=>d(A.key),className:"flex items-center gap-1 hover:text-gray-700",children:[A.label,(l==null?void 0:l.key)===A.key?l.direction==="asc"?a.jsx(Yb,{className:"w-4 h-4"}):a.jsx(Fi,{className:"w-4 h-4"}):a.jsx(Fi,{className:"w-4 h-4 opacity-30"})]}):A.label},A.key)),n&&a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:u("common.actions")})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:t.length+(n?1:0),className:"px-6 py-8 text-center text-gray-500",children:u("common.noData")})}):f.map((A,b)=>a.jsxs("tr",{onClick:()=>r==null?void 0:r(A),className:r?"cursor-pointer hover:bg-gray-50":"",children:[t.map(m=>a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.render?m.render(A):A[m.key]},m.key)),n&&a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:n(A)})]},b))})]})})]})}function qt({isOpen:e,onClose:t,title:r,children:n,size:s="md"}){const{t:i}=kn();if(!e)return null;const o={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[a.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity",onClick:t}),a.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl ${o[s]} w-full max-h-[90vh] flex flex-col`,children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:r}),a.jsx("button",{onClick:t,className:"p-1 rounded hover:bg-gray-100 transition",children:a.jsx(Kr,{className:"w-5 h-5 text-gray-500"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:n})]})]})})}function BR(){const{t:e}=kn(),{profile:t}=jr(),[r,n]=W.useState([]),[s,i]=W.useState(!0),[o,l]=W.useState(!1),[c,u]=W.useState(null),[d,h]=W.useState({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:""});W.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:g,error:y}=await ae.from("products").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(y)throw y;n(g||[])}catch(g){console.error("Error loading products:",g)}finally{i(!1)}},A=async g=>{g.preventDefault();try{const y=parseFloat(d.min_stock_level)||null,x={product_name:d.product_name,product_code:null,hsn_code:d.hsn_code,category:d.category,unit:d.unit,packaging_type:d.packaging_type,default_supplier:d.default_supplier,description:d.description,min_stock_level:y};if(c){const{error:w}=await ae.from("products").update(x).eq("id",c.id);if(w)throw w}else{const{error:w}=await ae.from("products").insert([{...x,created_by:t==null?void 0:t.id}]);if(w)throw w}l(!1),v(),f()}catch(y){console.error("Error saving product:",y),alert("Failed to save product")}},b=g=>{var y;u(g),h({product_name:g.product_name,hsn_code:g.hsn_code,category:g.category,unit:g.unit,packaging_type:g.packaging_type,default_supplier:g.default_supplier,description:g.description,min_stock_level:((y=g.min_stock_level)==null?void 0:y.toString())||""}),l(!0)},m=async g=>{try{const{data:y}=await ae.from("sales_invoice_items").select("id").eq("product_id",g.id).limit(1);if(y&&y.length>0){alert('Cannot delete this product. It has been used in sales invoices. Please use the "Deactivate" option instead or contact your administrator.');return}const{data:x}=await ae.from("delivery_challan_items").select("id").eq("product_id",g.id).limit(1);if(x&&x.length>0){alert('Cannot delete this product. It has been used in delivery challans. Please use the "Deactivate" option instead.');return}const{data:w}=await ae.from("batches").select("id, batch_number").eq("product_id",g.id);if(w&&w.length>0){if(!confirm(`This product has ${w.length} batch(es). Deleting this product will permanently remove:
- ${w.length} batches
- All related inventory transactions
- All related documents

Are you absolutely sure you want to continue?`))return}else if(!confirm("Are you sure you want to delete this product?"))return;if(w&&w.length>0){for(const _ of w)await ae.from("batch_documents").delete().eq("batch_id",_.id),await ae.from("inventory_transactions").delete().eq("batch_id",_.id),await ae.from("finance_expenses").delete().eq("batch_id",_.id);await ae.from("batches").delete().eq("product_id",g.id)}await ae.from("inventory_transactions").delete().eq("product_id",g.id),await ae.from("product_files").delete().eq("product_id",g.id);const{error:N}=await ae.from("products").delete().eq("id",g.id);if(N)throw N;alert("Product deleted successfully"),await f()}catch(y){console.error("Error deleting product:",y);const x=(y==null?void 0:y.message)||"Unknown error occurred";alert(`Failed to delete product: ${x}

If this product is in use, consider deactivating it instead.`)}},v=()=>{u(null),h({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:""})},p=[{key:"product_name",label:"Product Name"},{key:"hsn_code",label:"HSN Code"},{key:"category",label:"Category",render:g=>a.jsx("span",{className:"capitalize",children:g.category})},{key:"unit",label:"Unit",render:g=>a.jsx("span",{className:"capitalize",children:g.unit})},{key:"min_stock",label:"Min Stock Level",render:g=>a.jsx("span",{children:g.min_stock_level?`${g.min_stock_level} ${g.unit}`:"-"})}];return a.jsxs(Zn,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your product catalog with packaging details"})]}),a.jsxs("button",{onClick:()=>{v(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Add Product"]})]}),a.jsx(ws,{data:r,columns:p,loading:s,actions:g=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>b(g),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>m(g),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:a.jsx(nn,{className:"w-4 h-4"})})]})})]}),a.jsx(qt,{isOpen:o,onClose:()=>{l(!1),v()},title:c?"Edit Product":"Add Product",children:a.jsxs("form",{onSubmit:A,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),a.jsx("input",{type:"text",required:!0,value:d.product_name,onChange:g=>h({...d,product_name:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HSN Code"}),a.jsx("input",{type:"text",value:d.hsn_code,onChange:g=>h({...d,hsn_code:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),a.jsxs("select",{required:!0,value:d.category,onChange:g=>h({...d,category:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[a.jsx("option",{value:"api",children:"API"}),a.jsx("option",{value:"excipient",children:"Excipient"}),a.jsx("option",{value:"solvent",children:"Solvent"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit *"}),a.jsxs("select",{required:!0,value:d.unit,onChange:g=>h({...d,unit:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[a.jsx("option",{value:"kg",children:"Kilogram"}),a.jsx("option",{value:"litre",children:"Litre"}),a.jsx("option",{value:"ton",children:"Ton"}),a.jsx("option",{value:"piece",children:"Piece"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Stock Level"}),a.jsx("input",{type:"number",step:"0.001",value:d.min_stock_level,onChange:g=>h({...d,min_stock_level:g.target.value}),placeholder:"e.g., 100",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Alert when stock falls below this level (in ",d.unit,")"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Supplier"}),a.jsx("input",{type:"text",value:d.default_supplier,onChange:g=>h({...d,default_supplier:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:d.description,onChange:g=>h({...d,description:g.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{l(!1),v()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Save"})]})]})})]})}const OF=["Jakarta Barat","Jakarta Pusat","Jakarta Selatan","Jakarta Timur","Jakarta Utara","Surabaya","Bandung","Bekasi","Tangerang","Depok","Semarang","Palembang","South Tangerang","Makassar","Bogor","Batam","Pekanbaru","Bandar Lampung","Padang","Malang","Denpasar","Samarinda","Tasikmalaya","Pontianak","Cimahi","Balikpapan","Jambi","Surakarta (Solo)","Serang","Manado","Cilegon","Mataram","Yogyakarta","Kupang","Banjarmasin","Ambon","Sukabumi","Cirebon","Palu","Tegal","Binjai","Pekalongan","Kediri","Jayapura","Palangkaraya","Probolinggo","Tanjung Pinang","Banjar","Madiun","Banjarbaru","Tarakan","Bitung","Pangkal Pinang","Pasuruan","Ternate","Sorong","Bengkulu","Tanjungbalai","Dumai","Batu","Gorontalo","Bontang","Blitar","Metro","Pematang Siantar","Mojokerto","Magelang","Salatiga","Parepare","Bukittinggi","Singkawang","Lubuklinggau","Prabumulih","Langsa","Padang Sidempuan","Tebing Tinggi","Tanjung Balai","Sabang","Lhokseumawe","Subulussalam","Banda Aceh","Medan","Sibolga","Gunungsitoli"].sort(),kR=["Cash on Delivery","Net 7 days","Net 10 days","Net 15 days","Net 30 days","Net 45 days","Net 60 days","Net 90 days","End of Month","2/10 Net 30","1/10 Net 30","Due on Receipt","Advance Payment","50% Advance, 50% on Delivery","Monthly Billing"];function SR(){const{t:e}=kn(),{profile:t}=jr(),[r,n]=W.useState([]),[s,i]=W.useState(!0),[o,l]=W.useState(!1),[c,u]=W.useState(null),[d,h]=W.useState({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""});W.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:g,error:y}=await ae.from("customers").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(y)throw y;n(g||[])}catch(g){console.error("Error loading customers:",g)}finally{i(!1)}},A=async g=>{g.preventDefault();try{if(c){const{error:y}=await ae.from("customers").update(d).eq("id",c.id);if(y)throw y}else{const{error:y}=await ae.from("customers").insert([{...d,created_by:t==null?void 0:t.id}]);if(y)throw y}l(!1),u(null),b(),f()}catch(y){console.error("Error saving customer:",y),alert("Failed to save customer")}},b=()=>{h({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""})},m=g=>{u(g),h({company_name:g.company_name,npwp:g.npwp,address:g.address,city:g.city,country:g.country,contact_person:g.contact_person,email:g.email,phone:g.phone,pbf_license:g.pbf_license||"",gst_vat_type:g.gst_vat_type,payment_terms:g.payment_terms}),l(!0)},v=async g=>{if(confirm("Are you sure you want to delete this customer?"))try{const{error:y}=await ae.from("customers").update({is_active:!1}).eq("id",g.id);if(y)throw y;f()}catch(y){console.error("Error deleting customer:",y),alert("Failed to delete customer")}},p=[{key:"company_name",label:e("customers.companyName"),sortable:!0},{key:"contact_person",label:e("customers.contactPerson"),sortable:!0,render:g=>a.jsxs("div",{children:[a.jsx("div",{children:g.contact_person}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[g.email&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(ha,{className:"w-3 h-3"}),g.email]}),g.phone&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Fl,{className:"w-3 h-3"}),g.phone]})]})]})},{key:"city",label:e("customers.city"),sortable:!0},{key:"payment_terms",label:e("customers.paymentTerms"),sortable:!0}];return a.jsxs(Zn,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("customers.title")}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your customer relationships"})]}),a.jsxs("button",{onClick:()=>{u(null),b(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),e("customers.addCustomer")]})]}),a.jsx(ws,{data:r,columns:p,loading:s,actions:g=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>m(g),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>v(g),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:a.jsx(nn,{className:"w-4 h-4"})})]})})]}),a.jsx(qt,{isOpen:o,onClose:()=>l(!1),title:e(c?"customers.editCustomer":"customers.addCustomer"),size:"xl",children:a.jsxs("form",{onSubmit:A,className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.companyName")," *"]}),a.jsx("input",{type:"text",required:!0,value:d.company_name,onChange:g=>h({...d,company_name:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.npwp")}),a.jsx("input",{type:"text",value:d.npwp,onChange:g=>h({...d,npwp:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.contactPerson")," *"]}),a.jsx("input",{type:"text",required:!0,value:d.contact_person,onChange:g=>h({...d,contact_person:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.email")}),a.jsx("input",{type:"email",value:d.email,onChange:g=>h({...d,email:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.phone")}),a.jsx("input",{type:"tel",value:d.phone,onChange:g=>h({...d,phone:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PBF License (No.Izin PBF)"}),a.jsx("input",{type:"text",value:d.pbf_license,onChange:g=>h({...d,pbf_license:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"e.g., 01.001.722.9-411.000"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.city")}),a.jsxs("select",{value:d.city,onChange:g=>h({...d,city:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select City"}),OF.map(g=>a.jsx("option",{value:g,children:g},g))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.country")}),a.jsx("input",{type:"text",value:d.country,readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50 text-gray-600"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.gstVatType")}),a.jsx("input",{type:"text",value:d.gst_vat_type,onChange:g=>h({...d,gst_vat_type:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.paymentTerms")}),a.jsxs("select",{value:d.payment_terms,onChange:g=>h({...d,payment_terms:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select Payment Terms"}),kR.map(g=>a.jsx("option",{value:g,children:g},g))]})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.address")}),a.jsx("textarea",{value:d.address,onChange:g=>h({...d,address:g.target.value}),rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[a.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-3 py-1.5 text-sm text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition",children:e("common.cancel")}),a.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:e("common.save")})]})]})})]})}function ER(){const{t:e}=kn(),{setCurrentPage:t}=Ho(),[r,n]=W.useState([]),[s,i]=W.useState(!0),[o,l]=W.useState(null),[c,u]=W.useState([]);W.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:_,error:C}=await ae.from("product_stock_summary").select("*").order("product_name");if(C)throw C;const{data:j}=await ae.from("import_requirements").select("product_id, shortage_quantity").in("status",["pending","ordered"]),E=new Map;j==null||j.forEach(I=>{const O=E.get(I.product_id)||0;E.set(I.product_id,O+Number(I.shortage_quantity))});const F=(await Promise.all((_||[]).map(async I=>{const{data:O}=await ae.from("stock_reservations").select("reserved_quantity").eq("product_id",I.product_id).eq("status","active"),M=(O==null?void 0:O.reduce((H,V)=>H+Number(V.reserved_quantity),0))||0,P=E.get(I.product_id)||0,X=P>0?-P:M,J=I.total_current_stock-M;return{...I,reserved_quantity:X,available_quantity:J}}))).filter(I=>I.total_current_stock>0||I.reserved_quantity!==0||E.has(I.product_id));n(F)}catch(_){console.error("Error loading stock summary:",_)}finally{i(!1)}},h=async _=>{try{const{data:C,error:j}=await ae.from("batches").select("id, batch_number, current_stock, reserved_stock, expiry_date, import_date").eq("product_id",_).eq("is_active",!0).gt("current_stock",0).order("expiry_date",{ascending:!0,nullsFirst:!1});if(j)throw j;const E=(C||[]).map(S=>({...S,reserved_quantity:S.reserved_stock||0,available_quantity:S.current_stock-(S.reserved_stock||0)}));u(E)}catch(C){console.error("Error loading product batches:",C)}},f=async _=>{l(_),await h(_.product_id)},A=()=>{t("batches")},b=_=>_?new Date(_)<new Date:!1,m=_=>{if(!_)return!1;const C=new Date;return C.setDate(C.getDate()+30),new Date(_)<=C&&!b(_)},v=(_,C)=>_===0?"text-gray-400":_<500?"text-orange-600":"text-green-600",p=[{key:"product_name",label:"Product",render:_=>a.jsxs("div",{className:"py-1",children:[a.jsx("span",{className:"font-medium text-gray-900",children:_.product_name}),a.jsxs("span",{className:"text-xs text-gray-500 ml-2 capitalize",children:["(",_.category,")"]})]})},{key:"stock",label:"Total Stock",render:_=>a.jsxs("span",{className:`font-semibold ${v(_.total_current_stock,_.active_batch_count)}`,children:[_.total_current_stock.toLocaleString()," ",_.unit]})},{key:"reserved",label:"Reserved",render:_=>_.reserved_quantity===0?a.jsx("span",{className:"text-gray-400",children:"-"}):_.reserved_quantity<0?a.jsxs("span",{className:"text-red-600 font-semibold",children:[_.reserved_quantity.toLocaleString()," ",_.unit]}):a.jsxs("span",{className:"text-orange-600 font-medium",children:[_.reserved_quantity.toLocaleString()," ",_.unit]})},{key:"available",label:"Available",render:_=>a.jsxs("span",{className:"text-green-600 font-semibold",children:[_.available_quantity.toLocaleString()," ",_.unit]})},{key:"batches",label:"Batches",render:_=>a.jsxs("span",{className:"text-sm",children:[a.jsx("span",{className:"text-blue-600 font-medium",children:_.active_batch_count}),_.expired_batch_count>0&&a.jsxs("span",{className:"text-red-600 ml-1",children:["(",_.expired_batch_count," expired)"]})]})},{key:"expiry",label:"Nearest Expiry",render:_=>_.nearest_expiry_date?a.jsxs("span",{className:`text-sm ${b(_.nearest_expiry_date)?"text-red-700 font-semibold":m(_.nearest_expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:[new Date(_.nearest_expiry_date).toLocaleDateString(),m(_.nearest_expiry_date)&&a.jsx(as,{className:"w-3 h-3 inline ml-1"})]}):a.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}],g=[{key:"batch_number",label:"Batch",render:_=>a.jsx("span",{className:"font-mono text-sm",children:_.batch_number})},{key:"total_stock",label:"Total",render:_=>a.jsxs("span",{className:"font-semibold text-sm",children:[_.current_stock.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"reserved",label:"Reserved",render:_=>a.jsx("span",{className:"text-orange-600 font-medium text-sm",children:_.reserved_quantity>0?`${_.reserved_quantity.toLocaleString()} ${o==null?void 0:o.unit}`:"-"})},{key:"available",label:"Available",render:_=>a.jsxs("span",{className:"text-green-600 font-semibold text-sm",children:[_.available_quantity.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"import_date",label:"Imported",render:_=>a.jsx("span",{className:"text-sm text-gray-600",children:new Date(_.import_date).toLocaleDateString()})},{key:"expiry_date",label:"Expiry",render:_=>a.jsx("span",{className:`text-sm ${b(_.expiry_date)?"text-red-700 font-semibold":m(_.expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:_.expiry_date?new Date(_.expiry_date).toLocaleDateString():"-"})}],y=r.reduce((_,C)=>_+C.total_current_stock,0),x=r.length,w=r.filter(_=>_.total_current_stock<500).length,N=r.filter(_=>_.nearest_expiry_date&&m(_.nearest_expiry_date)).length;return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Stock Inventory"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Current stock levels across all products"})]}),a.jsxs("button",{onClick:A,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Ps,{className:"w-5 h-5"}),"View Batches"]})]}),o&&a.jsxs("div",{className:"bg-blue-50 rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[o.product_name," - Batch Details"]}),a.jsx("button",{onClick:()=>l(null),className:"text-gray-500 hover:text-gray-700 text-xl font-bold",children:""})]}),a.jsx(ws,{columns:g,data:c,loading:!1})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx(ws,{columns:p,data:r,loading:s,onRowClick:f}),!s&&r.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ps,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500 text-lg",children:"No stock available"}),a.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"All products are currently out of stock"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Products In Stock"}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:x})]}),a.jsx(Ps,{className:"w-10 h-10 text-blue-200"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Total Stock Units"}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:y.toLocaleString()})]}),a.jsx(ui,{className:"w-10 h-10 text-green-200"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Low Stock Items"}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:w})]}),a.jsx(as,{className:"w-10 h-10 text-orange-200"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-red-100 text-sm font-medium",children:"Near Expiry"}),a.jsx("p",{className:"text-3xl font-bold mt-1",children:N})]}),a.jsx(Na,{className:"w-10 h-10 text-red-200"})]})})]})]})})}const FR=["application/pdf","image/jpeg","image/jpg","image/png","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"],TR=10*1024*1024,IR=[{value:"invoice",label:"Invoice"},{value:"bill_of_lading",label:"Bill of Lading"},{value:"coa",label:"Certificate of Analysis"},{value:"packing_list",label:"Packing List"},{value:"other",label:"Other"}];function a_({batchId:e,existingFiles:t=[],onFilesChange:r,disabled:n=!1}){const[s,i]=W.useState(t),[o,l]=W.useState(!1),c=W.useRef(null),u=g=>{i(g),r==null||r(g)},d=g=>{if(!g||g.length===0)return;const y=[];Array.from(g).forEach(x=>{if(!FR.includes(x.type)){alert(`File ${x.name} is not a supported format. Please upload PDF, JPG, PNG, XLSX, or DOCX files.`);return}if(x.size>TR){alert(`File ${x.name} exceeds the 10MB size limit.`);return}y.push({file:x,file_name:x.name,file_type:"other",file_size:x.size,uploading:!1})}),u([...s,...y])},h=g=>{g.preventDefault(),l(!1),d(g.dataTransfer.files)},f=g=>{g.preventDefault(),l(!0)},A=()=>{l(!1)},b=async g=>{const y=s[g];if(y.id&&e){if(!confirm("Are you sure you want to delete this document?"))return;try{const{error:w}=await ae.from("batch_documents").delete().eq("id",y.id);if(w)throw w;if(y.file_url){const N=y.file_url.split("/"),_=N[N.length-1],C=`${e}/${_}`;await ae.storage.from("batch-documents").remove([C])}}catch(w){console.error("Error deleting file:",w),alert("Failed to delete file. Please try again.");return}}const x=s.filter((w,N)=>N!==g);u(x)},m=(g,y)=>{const x=[...s];x[g].file_type=y,u(x)},v=g=>{var x;const y=(x=g.split(".").pop())==null?void 0:x.toLowerCase();return["jpg","jpeg","png"].includes(y||"")?a.jsx(n_,{className:"w-5 h-5 text-blue-600"}):y==="pdf"?a.jsx(sr,{className:"w-5 h-5 text-red-600"}):a.jsx(wF,{className:"w-5 h-5 text-gray-600"})},p=g=>g<1024?g+" B":g<1024*1024?(g/1024).toFixed(1)+" KB":(g/(1024*1024)).toFixed(1)+" MB";return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{onDrop:h,onDragOver:f,onDragLeave:A,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{var g;return!n&&((g=c.current)==null?void 0:g.click())},children:[a.jsx(SA,{className:`w-12 h-12 mx-auto mb-3 ${o?"text-blue-500":"text-gray-400"}`}),a.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[a.jsx("span",{className:"font-medium text-blue-600",children:"Click to upload"})," or drag and drop"]}),a.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG, XLSX, DOCX (max 10MB)"}),a.jsx("input",{ref:c,type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.xlsx,.xls,.docx,.doc",onChange:g=>d(g.target.files),className:"hidden",disabled:n})]}),s.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Documents (",s.length,")"]}),s.map((g,y)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsx("div",{className:"flex-shrink-0",children:v(g.file_name)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center gap-2",children:g.file_url?a.jsx("a",{href:g.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-700 truncate",onClick:x=>x.stopPropagation(),children:g.file_name}):a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:g.file_name})}),a.jsx("p",{className:"text-xs text-gray-500",children:p(g.file_size)})]}),a.jsx("select",{value:g.file_type,onChange:x=>m(y,x.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:n,onClick:x=>x.stopPropagation(),children:IR.map(x=>a.jsx("option",{value:x.value,children:x.label},x.value))}),g.uploading&&a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}),g.error&&a.jsx("div",{className:"flex-shrink-0",title:g.error,children:a.jsx(ea,{className:"w-5 h-5 text-red-600"})}),!n&&!g.uploading&&a.jsx("button",{type:"button",onClick:x=>{x.stopPropagation(),b(y)},className:"flex-shrink-0 p-1 text-red-600 hover:bg-red-50 rounded transition",children:a.jsx(Kr,{className:"w-4 h-4"})})]},y))]})]})}function LR(){const{t:e}=kn(),{profile:t}=jr(),[r,n]=W.useState([]),[s,i]=W.useState([]),[o,l]=W.useState(!0),[c,u]=W.useState(!1),[d,h]=W.useState(!1),[f,A]=W.useState([]),[b,m]=W.useState(null),[v,p]=W.useState(null),[g,y]=W.useState([]),[x,w]=W.useState({batch_number:"",product_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_charges:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"});W.useEffect(()=>{N(),_()},[]);const N=async()=>{try{const{data:B,error:L}=await ae.from("batches").select(`
          *,
          products(product_name, product_code, unit)
        `).order("import_date",{ascending:!1});if(L)throw L;const U=await Promise.all((B||[]).map(async D=>{const{count:Q}=await ae.from("batch_documents").select("*",{count:"exact",head:!0}).eq("batch_id",D.id);return{...D,document_count:Q||0}}));n(U)}catch(B){console.error("Error loading batches:",B)}finally{l(!1)}},_=async()=>{try{const{data:B,error:L}=await ae.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(L)throw L;i(B||[])}catch(B){console.error("Error loading products:",B)}},C=async B=>{try{const{data:L,error:U}=await ae.from("batch_documents").select("*").eq("batch_id",B).order("uploaded_at",{ascending:!1});if(U)throw U;A(L||[]),m(B),h(!0)}catch(L){console.error("Error loading documents:",L),alert("Failed to load documents")}},j=async B=>{if(B.preventDefault(),x.import_price_usd>0&&x.exchange_rate_usd_to_idr<=0){alert("Please enter a valid exchange rate");return}try{let L=0;if(v){const{data:le,error:ee}=await ae.from("sales_invoice_items").select("quantity").eq("batch_id",v.id);if(ee)throw ee;if(L=(le==null?void 0:le.reduce((_e,se)=>_e+parseFloat(se.quantity||0),0))||0,x.import_quantity<L){alert(`Cannot reduce import quantity to ${x.import_quantity}. You have already sold ${L} units from this batch.`);return}}const U=x.import_price_usd*x.exchange_rate_usd_to_idr,D=(le,ee,_e)=>ee==="percentage"?_e*le/100:le,Q=D(x.duty_charges,x.duty_charge_type,U),z=D(x.freight_charges,x.freight_charge_type,U),G=D(x.other_charges,x.other_charge_type,U),Z={batch_number:x.batch_number,product_id:x.product_id,import_date:x.import_date,import_quantity:x.import_quantity,current_stock:x.import_quantity,packaging_details:x.packaging_details,import_price:U,import_price_usd:x.import_price_usd||null,exchange_rate_usd_to_idr:x.exchange_rate_usd_to_idr||null,duty_charges:Q,duty_charge_type:x.duty_charge_type,freight_charges:z,freight_charge_type:x.freight_charge_type,other_charges:G,other_charge_type:x.other_charge_type,expiry_date:x.expiry_date||null};let R;if(v){const{error:le}=await ae.from("batches").update(Z).eq("id",v.id);if(le)throw le;if(R=v.id,x.import_quantity!==v.import_quantity){const{error:ee}=await ae.from("inventory_transactions").update({quantity:x.import_quantity,notes:`Updated import quantity from ${v.import_quantity} to ${x.import_quantity}`}).eq("batch_id",v.id).eq("transaction_type","purchase");ee&&console.error("Error updating purchase transaction:",ee)}}else{const{data:{user:le}}=await ae.auth.getUser();if(!le)throw new Error("Not authenticated");const{data:ee,error:_e}=await ae.from("batches").insert([{...Z,is_active:!0,created_by:le.id}]).select().single();if(_e)throw _e;R=ee.id}await E(R),u(!1),I(),N()}catch(L){console.error("Error saving batch:",L),alert("Failed to save batch. Please try again.")}},E=async B=>{const L=g.filter(U=>U.file&&!U.id);for(const U of L)try{const D=`${Date.now()}_${U.file.name}`,Q=`${B}/${D}`,{error:z}=await ae.storage.from("batch-documents").upload(Q,U.file);if(z)throw z;const{data:{publicUrl:G}}=ae.storage.from("batch-documents").getPublicUrl(Q),{error:Z}=await ae.from("batch_documents").insert([{batch_id:B,file_url:G,file_name:U.file.name,file_type:U.file_type,file_size:U.file_size}]);if(Z)throw Z}catch(D){console.error("Error uploading file:",D)}},S=async B=>{p(B);let L="",U="bag";if(B.packaging_details){const Q=B.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/);Q&&(L=Q[3],U=Q[2].toLowerCase())}w({batch_number:B.batch_number,product_id:B.product_id,import_date:B.import_date,import_quantity:B.import_quantity,packaging_details:B.packaging_details,import_price_usd:B.import_price_usd||0,exchange_rate_usd_to_idr:B.exchange_rate_usd_to_idr||0,duty_charges:B.duty_charges,duty_charge_type:"fixed",freight_charges:B.freight_charges,freight_charge_type:"fixed",other_charges:B.other_charges,other_charge_type:"fixed",expiry_date:B.expiry_date,per_pack_weight:L,pack_type:U});const{data:D}=await ae.from("batch_documents").select("*").eq("batch_id",B.id);y(D||[]),u(!0)},F=async B=>{try{const{data:L}=await ae.from("sales_invoice_items").select("id, sales_invoices(invoice_number)").eq("batch_id",B).limit(1);if(L&&L.length>0){alert("Cannot delete this batch. It has been used in sales invoices. Please delete the related invoices first or contact your administrator.");return}const{data:U}=await ae.from("delivery_challan_items").select("id").eq("batch_id",B).limit(1);if(U&&U.length>0){alert("Cannot delete this batch. It has been used in delivery challans. Please delete the related delivery challans first.");return}if(!confirm("Are you sure you want to delete this batch? This will permanently remove all related data."))return;const{error:D}=await ae.from("batch_documents").delete().eq("batch_id",B);if(D)throw D;const{error:Q}=await ae.from("inventory_transactions").delete().eq("batch_id",B);if(Q)throw Q;const{error:z}=await ae.from("finance_expenses").delete().eq("batch_id",B);if(z)throw z;const{error:G}=await ae.from("batches").delete().eq("id",B);if(G)throw G;alert("Batch deleted successfully"),await N()}catch(L){console.error("Error deleting batch:",L);const U=(L==null?void 0:L.message)||"Unknown error occurred";alert(`Failed to delete batch: ${U}`)}},I=()=>{p(null),y([]),w({batch_number:"",product_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_charges:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"})},O=B=>B.current_stock<B.import_quantity*.2,M=B=>B.expiry_date?new Date(B.expiry_date)<new Date:!1,P=B=>{if(!B.expiry_date)return!1;const L=new Date;return L.setDate(L.getDate()+30),new Date(B.expiry_date)<=L&&!M(B)},X=()=>{const B=x.import_price_usd*x.exchange_rate_usd_to_idr,L=(z,G)=>G==="percentage"?B*z/100:z,U=L(x.duty_charges,x.duty_charge_type),D=L(x.freight_charges,x.freight_charge_type),Q=L(x.other_charges,x.other_charge_type);return B+U+D+Q},J=(B,L)=>{const U=x.import_price_usd*x.exchange_rate_usd_to_idr;return L==="percentage"?U*B/100:B},H=(B,L="IDR")=>L==="USD"?`$${B.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${B.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,V=[{key:"batch_number",label:"Batch Number"},{key:"product",label:"Product",render:B=>{var L,U;return a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:(L=B.products)==null?void 0:L.product_name}),a.jsx("div",{className:"text-xs text-gray-500",children:(U=B.products)==null?void 0:U.product_code})]})}},{key:"import_date",label:"Import Date",render:B=>new Date(B.import_date).toLocaleDateString()},{key:"stock",label:"Stock",render:B=>{var U,D,Q;const L=B.current_stock-(B.reserved_stock||0);return a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:O(B)?"text-orange-600 font-semibold":"font-medium",children:[B.current_stock," ",(U=B.products)==null?void 0:U.unit]}),O(B)&&a.jsx(as,{className:"w-4 h-4 text-orange-600"})]}),B.reserved_stock>0&&a.jsxs("div",{className:"text-xs space-y-0.5",children:[a.jsxs("div",{className:"text-amber-600",children:["Reserved: ",B.reserved_stock," ",(D=B.products)==null?void 0:D.unit]}),a.jsxs("div",{className:"text-green-600",children:["Free: ",L," ",(Q=B.products)==null?void 0:Q.unit]})]})]})}},{key:"pricing",label:"Import Price",render:B=>a.jsx("div",{className:"text-sm",children:B.import_price_usd&&B.exchange_rate_usd_to_idr?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"font-medium text-green-700",children:H(B.import_price_usd,"USD")}),a.jsx("div",{className:"text-xs text-gray-500",children:H(B.import_price)}),a.jsxs("div",{className:"text-xs text-gray-400",children:["@ ",B.exchange_rate_usd_to_idr.toLocaleString()]})]}):a.jsx("div",{className:"text-gray-500",children:H(B.import_price)})})},{key:"expiry_date",label:"Expiry Date",render:B=>a.jsx("span",{className:M(B)?"text-red-700 font-semibold":P(B)?"text-orange-600 font-semibold":"",children:B.expiry_date?new Date(B.expiry_date).toLocaleDateString():"N/A"})},{key:"documents",label:"Docs",render:B=>a.jsxs("button",{onClick:()=>C(B.id),className:"flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition",children:[a.jsx(sr,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:B.document_count||0})]})},{key:"total_cost",label:"Total Cost",render:B=>{const L=B.import_price+B.duty_charges+B.freight_charges+B.other_charges;return a.jsx("span",{className:"font-medium",children:H(L)})}}],K=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse"||(t==null?void 0:t.role)==="accounts";return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Batches"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage import batches with USD pricing and document tracking"})]}),K&&a.jsxs("button",{onClick:()=>{I(),u(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Add Batch"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Batches"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:r.length})]}),a.jsx(Ps,{className:"w-8 h-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-orange-600",children:"Low Stock"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:r.filter(O).length})]}),a.jsx(as,{className:"w-8 h-8 text-orange-600"})]})}),a.jsx("div",{className:"bg-red-50 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-red-600",children:"Near Expiry"}),a.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:r.filter(P).length})]}),a.jsx(as,{className:"w-8 h-8 text-red-600"})]})})]}),a.jsx(ws,{columns:V,data:r,loading:o,actions:K?B=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>S(B),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>F(B.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(nn,{className:"w-4 h-4"})})]}):void 0}),a.jsx(qt,{isOpen:c,onClose:()=>{u(!1),I()},title:v?"Edit Batch":"Add New Batch",children:a.jsxs("form",{onSubmit:j,className:"space-y-3",children:[a.jsxs("div",{className:"border-b pb-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Batch Number *"}),a.jsx("input",{type:"text",value:x.batch_number,onChange:B=>w({...x,batch_number:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Product *"}),a.jsxs("select",{value:x.product_id,onChange:B=>w({...x,product_id:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Product"}),s.map(B=>a.jsxs("option",{value:B.id,children:[B.product_name," (",B.product_code,")"]},B.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Date *"}),a.jsx("input",{type:"date",value:x.import_date,onChange:B=>w({...x,import_date:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expiry Date"}),a.jsx("input",{type:"date",value:x.expiry_date,onChange:B=>w({...x,expiry_date:B.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]})]})]}),a.jsxs("div",{className:"border-b pb-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Quantity"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Quantity *"}),a.jsx("input",{type:"number",value:x.import_quantity===0?"":x.import_quantity,onChange:B=>w({...x,import_quantity:B.target.value===""?0:Number(B.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,min:"0",step:"0.001",placeholder:"0"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total quantity being imported"})]}),v&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Current Stock"}),a.jsx("div",{className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50",children:a.jsx("span",{className:"text-gray-700 font-medium",children:v.current_stock.toLocaleString()})}),a.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Available: ",v.current_stock.toLocaleString()," | Sold: ",(v.import_quantity-v.current_stock).toLocaleString()]})]})]})]}),a.jsxs("div",{className:"border-b pb-2",children:[a.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[a.jsx(Ps,{className:"w-4 h-4"}),"Packaging Details (Optional)"]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Per Pack Weight"}),a.jsx("input",{type:"number",step:"0.001",value:x.per_pack_weight,onChange:B=>{const L={...x,per_pack_weight:B.target.value};if(x.import_quantity&&B.target.value){const U=parseFloat(B.target.value);if(U){const D=(x.import_quantity/U).toFixed(0);L.packaging_details=`${D} ${x.pack_type}${parseInt(D)!==1?"s":""} x ${U}kg`}}w(L)},placeholder:"e.g., 25",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"kg per pack"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pack Type"}),a.jsxs("select",{value:x.pack_type,onChange:B=>{const L={...x,pack_type:B.target.value};if(x.import_quantity&&x.per_pack_weight){const U=parseFloat(x.per_pack_weight);if(U){const D=(x.import_quantity/U).toFixed(0);L.packaging_details=`${D} ${B.target.value}${parseInt(D)!==1?"s":""} x ${U}kg`}}w(L)},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[a.jsx("option",{value:"bag",children:"Bag"}),a.jsx("option",{value:"drum",children:"Drum"}),a.jsx("option",{value:"tin",children:"Tin"}),a.jsx("option",{value:"box",children:"Box"}),a.jsx("option",{value:"carton",children:"Carton"}),a.jsx("option",{value:"pallet",children:"Pallet"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Calculated Packs"}),a.jsx("div",{className:"px-2 py-1.5 text-sm bg-gray-50 border border-gray-200 rounded",children:a.jsx("span",{className:"text-gray-700 font-medium",children:x.import_quantity&&x.per_pack_weight?Math.ceil(x.import_quantity/parseFloat(x.per_pack_weight)):"-"})}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total packs"})]})]}),x.packaging_details&&a.jsx("div",{className:"mt-1.5 p-2 bg-blue-50 border border-blue-200 rounded",children:a.jsxs("p",{className:"text-xs text-blue-900",children:[a.jsx("span",{className:"font-semibold",children:"Packaging: "}),x.packaging_details]})})]}),a.jsxs("div",{className:"border-b pb-2",children:[a.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[a.jsx(El,{className:"w-4 h-4 text-green-600"}),"Import Pricing (USD)"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Import Price (USD)"}),a.jsx("input",{type:"number",value:x.import_price_usd===0?"":x.import_price_usd,onChange:B=>w({...x,import_price_usd:B.target.value===""?0:Number(B.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Exchange Rate (USD to IDR)"}),a.jsx("input",{type:"number",value:x.exchange_rate_usd_to_idr===0?"":x.exchange_rate_usd_to_idr,onChange:B=>w({...x,exchange_rate_usd_to_idr:B.target.value===""?0:Number(B.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.0001",placeholder:"15000"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["1 USD = ",x.exchange_rate_usd_to_idr.toLocaleString()," IDR"]})]})]}),x.import_price_usd>0&&x.exchange_rate_usd_to_idr>0&&a.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:[a.jsxs("p",{className:"text-xs text-green-800",children:[a.jsx("span",{className:"font-semibold",children:"Calculated Import Price (IDR):"})," ",H(x.import_price_usd*x.exchange_rate_usd_to_idr)]}),a.jsxs("p",{className:"text-xs text-green-600 mt-0.5",children:[H(x.import_price_usd,"USD"),"  ",x.exchange_rate_usd_to_idr.toLocaleString()," = ",H(x.import_price_usd*x.exchange_rate_usd_to_idr)]})]})]}),a.jsxs("div",{className:"border-b pb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Additional Charges"}),a.jsx("div",{className:"space-y-3",children:a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_1fr] gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duty"}),a.jsxs("div",{className:"flex gap-0.5",children:[a.jsx("input",{type:"number",value:x.duty_charges===0?"":x.duty_charges,onChange:B=>w({...x,duty_charges:B.target.value===""?0:Number(B.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),a.jsxs("select",{value:x.duty_charge_type,onChange:B=>w({...x,duty_charge_type:B.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[a.jsx("option",{value:"percentage",children:"%"}),a.jsx("option",{value:"fixed",children:"Rp"})]})]}),x.duty_charges>0&&a.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",H(J(x.duty_charges,x.duty_charge_type))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Freight"}),a.jsxs("div",{className:"flex gap-0.5",children:[a.jsx("input",{type:"number",value:x.freight_charges===0?"":x.freight_charges,onChange:B=>w({...x,freight_charges:B.target.value===""?0:Number(B.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),a.jsxs("select",{value:x.freight_charge_type,onChange:B=>w({...x,freight_charge_type:B.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[a.jsx("option",{value:"percentage",children:"%"}),a.jsx("option",{value:"fixed",children:"Rp"})]})]}),x.freight_charges>0&&a.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",H(J(x.freight_charges,x.freight_charge_type))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Other"}),a.jsxs("div",{className:"flex gap-0.5",children:[a.jsx("input",{type:"number",value:x.other_charges===0?"":x.other_charges,onChange:B=>w({...x,other_charges:B.target.value===""?0:Number(B.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),a.jsxs("select",{value:x.other_charge_type,onChange:B=>w({...x,other_charge_type:B.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[a.jsx("option",{value:"percentage",children:"%"}),a.jsx("option",{value:"fixed",children:"Rp"})]})]}),x.other_charges>0&&a.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",H(J(x.other_charges,x.other_charge_type))]})]})]})})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-2",children:[a.jsx("h3",{className:"text-xs font-semibold text-blue-900 mb-1.5",children:"Total Cost Summary"}),a.jsxs("div",{className:"space-y-0.5 text-xs text-blue-800",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Import Price (IDR):"}),a.jsx("span",{className:"font-medium",children:H(x.import_price_usd*x.exchange_rate_usd_to_idr)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Duty Charges:"}),a.jsxs("span",{className:"font-medium",children:[H(J(x.duty_charges,x.duty_charge_type)),x.duty_charge_type==="percentage"&&x.duty_charges>0&&a.jsxs("span",{className:"text-xs ml-1",children:["(",x.duty_charges,"%)"]})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Freight Charges:"}),a.jsxs("span",{className:"font-medium",children:[H(J(x.freight_charges,x.freight_charge_type)),x.freight_charge_type==="percentage"&&x.freight_charges>0&&a.jsxs("span",{className:"text-xs ml-1",children:["(",x.freight_charges,"%)"]})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Other Charges:"}),a.jsxs("span",{className:"font-medium",children:[H(J(x.other_charges,x.other_charge_type)),x.other_charge_type==="percentage"&&x.other_charges>0&&a.jsxs("span",{className:"text-xs ml-1",children:["(",x.other_charges,"%)"]})]})]}),a.jsxs("div",{className:"border-t border-blue-300 pt-1.5 mt-1.5 flex justify-between",children:[a.jsx("span",{className:"font-bold",children:"Total Cost (IDR):"}),a.jsx("span",{className:"font-bold text-sm",children:H(X())})]})]})]}),a.jsxs("div",{className:"border-t pt-2",children:[a.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[a.jsx(sr,{className:"w-4 h-4"}),"Import Documents"]}),a.jsx(a_,{batchId:v==null?void 0:v.id,existingFiles:g,onFilesChange:y})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{u(!1),I()},className:"px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:v?"Update Batch":"Add Batch"})]})]})}),a.jsx(qt,{isOpen:d,onClose:()=>{h(!1),A([]),m(null)},title:"Batch Documents",children:a.jsx("div",{className:"space-y-3",children:f.length>0?f.map(B=>a.jsxs("a",{href:B.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[a.jsx(sr,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:B.file_name}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[a.jsx("span",{className:"capitalize",children:B.file_type.replace("_"," ")}),a.jsx("span",{children:""}),a.jsxs("span",{children:[(B.file_size/1024).toFixed(1)," KB"]}),a.jsx("span",{children:""}),a.jsx("span",{children:new Date(B.uploaded_at).toLocaleDateString()})]})]}),a.jsx(Og,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]},B.id)):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(sr,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No documents uploaded for this batch"})]})})})]})})}const OR="modulepreload",UR=function(e){return"/"+e},R4={},ky=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=UR(c),c in R4)return;R4[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":OR,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,A)=>{h.addEventListener("load",f),h.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function Lr(e){"@babel/helpers - typeof";return Lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lr(e)}var xo=Uint8Array,li=Uint16Array,s_=Int32Array,i_=new xo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o_=new xo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Q4=new xo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),UF=function(e,t){for(var r=new li(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new s_(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},PF=UF(i_,2),PR=PF.b,tw=PF.r;PR[28]=258,tw[258]=28;var DR=UF(o_,0),M4=DR.r,rw=new li(32768);for(var tn=0;tn<32768;++tn){var rc=(tn&43690)>>1|(tn&21845)<<1;rc=(rc&52428)>>2|(rc&13107)<<2,rc=(rc&61680)>>4|(rc&3855)<<4,rw[tn]=((rc&65280)>>8|(rc&255)<<8)>>1}var bh=function(e,t,r){for(var n=e.length,s=0,i=new li(t);s<n;++s)e[s]&&++i[e[s]-1];var o=new li(t);for(s=1;s<t;++s)o[s]=o[s-1]+i[s-1]<<1;var l;if(r){l=new li(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var u=s<<4|e[s],d=t-e[s],h=o[e[s]-1]++<<d,f=h|(1<<d)-1;h<=f;++h)l[rw[h]>>c]=u}else for(l=new li(n),s=0;s<n;++s)e[s]&&(l[s]=rw[o[e[s]-1]++]>>15-e[s]);return l},qu=new xo(288);for(var tn=0;tn<144;++tn)qu[tn]=8;for(var tn=144;tn<256;++tn)qu[tn]=9;for(var tn=256;tn<280;++tn)qu[tn]=7;for(var tn=280;tn<288;++tn)qu[tn]=8;var Rg=new xo(32);for(var tn=0;tn<32;++tn)Rg[tn]=5;var RR=bh(qu,9,0),QR=bh(Rg,5,0),DF=function(e){return(e+7)/8|0},MR=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new xo(e.subarray(t,r))},cl=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},If=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Sy=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,i=r.slice();if(!s)return{t:QF,l:0};if(s==1){var o=new xo(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(w,N){return w.f-N.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=s-1;)l=r[r[u].f<r[h].f?u++:h++],c=r[u!=d&&r[u].f<r[h].f?u++:h++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var f=i[0].s,n=1;n<s;++n)i[n].s>f&&(f=i[n].s);var A=new li(f+1),b=nw(r[d-1],A,0);if(b>t){var n=0,m=0,v=b-t,p=1<<v;for(i.sort(function(N,_){return A[_.s]-A[N.s]||N.f-_.f});n<s;++n){var g=i[n].s;if(A[g]>t)m+=p-(1<<b-A[g]),A[g]=t;else break}for(m>>=v;m>0;){var y=i[n].s;A[y]<t?m-=1<<t-A[y]++-1:++n}for(;n>=0&&m;--n){var x=i[n].s;A[x]==t&&(--A[x],++m)}b=t}return{t:new xo(A),l:b}},nw=function(e,t,r){return e.s==-1?Math.max(nw(e.l,t,r+1),nw(e.r,t,r+1)):t[e.s]=r},H4=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new li(++t),n=0,s=e[0],i=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=e[l]}return{c:r.subarray(0,n),n:t}},Lf=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},RF=function(e,t,r){var n=r.length,s=DF(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<n;++i)e[s+i+4]=r[i];return(s+4+n)*8},q4=function(e,t,r,n,s,i,o,l,c,u,d){cl(t,d++,r),++s[256];for(var h=Sy(s,15),f=h.t,A=h.l,b=Sy(i,15),m=b.t,v=b.l,p=H4(f),g=p.c,y=p.n,x=H4(m),w=x.c,N=x.n,_=new li(19),C=0;C<g.length;++C)++_[g[C]&31];for(var C=0;C<w.length;++C)++_[w[C]&31];for(var j=Sy(_,7),E=j.t,S=j.l,F=19;F>4&&!E[Q4[F-1]];--F);var I=u+5<<3,O=Lf(s,qu)+Lf(i,Rg)+o,M=Lf(s,f)+Lf(i,m)+o+14+3*F+Lf(_,E)+2*_[16]+3*_[17]+7*_[18];if(c>=0&&I<=O&&I<=M)return RF(t,d,e.subarray(c,c+u));var P,X,J,H;if(cl(t,d,1+(M<O)),d+=2,M<O){P=bh(f,A,0),X=f,J=bh(m,v,0),H=m;var V=bh(E,S,0);cl(t,d,y-257),cl(t,d+5,N-1),cl(t,d+10,F-4),d+=14;for(var C=0;C<F;++C)cl(t,d+3*C,E[Q4[C]]);d+=3*F;for(var K=[g,w],B=0;B<2;++B)for(var L=K[B],C=0;C<L.length;++C){var U=L[C]&31;cl(t,d,V[U]),d+=E[U],U>15&&(cl(t,d,L[C]>>5&127),d+=L[C]>>12)}}else P=RR,X=qu,J=QR,H=Rg;for(var C=0;C<l;++C){var D=n[C];if(D>255){var U=D>>18&31;If(t,d,P[U+257]),d+=X[U+257],U>7&&(cl(t,d,D>>23&31),d+=i_[U]);var Q=D&31;If(t,d,J[Q]),d+=H[Q],Q>3&&(If(t,d,D>>5&8191),d+=o_[Q])}else If(t,d,P[D]),d+=X[D]}return If(t,d,P[256]),d+X[256]},HR=new s_([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),QF=new xo(0),qR=function(e,t,r,n,s,i){var o=i.z||e.length,l=new xo(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),u=i.l,d=(i.r||0)&7;if(t){d&&(c[0]=i.r>>3);for(var h=HR[t-1],f=h>>13,A=h&8191,b=(1<<r)-1,m=i.p||new li(32768),v=i.h||new li(b+1),p=Math.ceil(r/3),g=2*p,y=function(se){return(e[se]^e[se+1]<<p^e[se+2]<<g)&b},x=new s_(25e3),w=new li(288),N=new li(32),_=0,C=0,j=i.i||0,E=0,S=i.w||0,F=0;j+2<o;++j){var I=y(j),O=j&32767,M=v[I];if(m[O]=M,v[I]=O,S<=j){var P=o-j;if((_>7e3||E>24576)&&(P>423||!u)){d=q4(e,c,0,x,w,N,C,E,F,j-F,d),E=_=C=0,F=j;for(var X=0;X<286;++X)w[X]=0;for(var X=0;X<30;++X)N[X]=0}var J=2,H=0,V=A,K=O-M&32767;if(P>2&&I==y(j-K))for(var B=Math.min(f,P)-1,L=Math.min(32767,j),U=Math.min(258,P);K<=L&&--V&&O!=M;){if(e[j+J]==e[j+J-K]){for(var D=0;D<U&&e[j+D]==e[j+D-K];++D);if(D>J){if(J=D,H=K,D>B)break;for(var Q=Math.min(K,D-2),z=0,X=0;X<Q;++X){var G=j-K+X&32767,Z=m[G],R=G-Z&32767;R>z&&(z=R,M=G)}}}O=M,M=m[O],K+=O-M&32767}if(H){x[E++]=268435456|tw[J]<<18|M4[H];var le=tw[J]&31,ee=M4[H]&31;C+=i_[le]+o_[ee],++w[257+le],++N[ee],S=j+J,++_}else x[E++]=e[j],++w[e[j]]}}for(j=Math.max(j,S);j<o;++j)x[E++]=e[j],++w[e[j]];d=q4(e,c,u,x,w,N,C,E,F,j-F,d),u||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=v,i.p=m,i.i=j,i.w=S)}else{for(var j=i.w||0;j<o+u;j+=65535){var _e=j+65535;_e>=o&&(c[d/8|0]=u,_e=o),d=RF(c,d+1,e.subarray(j,_e))}i.i=o}return MR(l,0,n+DF(d)+s)},MF=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},KR=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new xo(i.length+e.length);o.set(i),o.set(e,i.length),e=o,s.w=i.length}return qR(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},HF=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},$R=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=MF();s.p(t.dictionary),HF(e,2,s.d())}};function aw(e,t){t||(t={});var r=MF();r.p(e);var n=KR(e,t,t.dictionary?6:2,4);return $R(n,t),HF(n,n.length-4,r.d()),n}var VR=typeof TextDecoder<"u"&&new TextDecoder,GR=0;try{VR.decode(QF,{stream:!0}),GR=1}catch{}function WR(e){if(Array.isArray(e))return e}function zR(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function K4(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function XR(e,t){if(e){if(typeof e=="string")return K4(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?K4(e,t):void 0}}function YR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $4(e,t){return WR(e)||zR(e,t)||XR(e,t)||YR()}function V4(e,t="utf8"){return new TextDecoder(t).decode(e)}const JR=new TextEncoder;function ZR(e){return JR.encode(e)}const eQ=1024*8,tQ=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Ey={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class l_{constructor(t=eQ,r={}){Fr(this,"buffer");Fr(this,"byteLength");Fr(this,"byteOffset");Fr(this,"length");Fr(this,"offset");Fr(this,"lastWrittenByte");Fr(this,"littleEndian");Fr(this,"_data");Fr(this,"_mark");Fr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,i=t.byteLength-s;let o=s;(ArrayBuffer.isView(t)||t instanceof l_)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=Ey[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+n);if(this.littleEndian===tQ&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new Ey[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new Ey[r](i);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return V4(this.readBytes(t))}decodeText(t=1,r="utf8"){return V4(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(ZR(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function MA(e){let t=e.length;for(;--t>=0;)e[t]=0}const rQ=3,nQ=258,qF=29,aQ=256,sQ=aQ+1+qF,KF=30,iQ=512,oQ=new Array((sQ+2)*2);MA(oQ);const lQ=new Array(KF*2);MA(lQ);const cQ=new Array(iQ);MA(cQ);const uQ=new Array(nQ-rQ+1);MA(uQ);const dQ=new Array(qF);MA(dQ);const AQ=new Array(KF);MA(AQ);const fQ=(e,t,r,n)=>{let s=e&65535|0,i=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+t[n++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var sw=fQ;const hQ=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},pQ=new Uint32Array(hQ()),mQ=(e,t,r,n)=>{const s=pQ,i=n+r;e^=-1;for(let o=n;o<i;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var ko=mQ,iw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},$F={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const gQ=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var xQ=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)gQ(r,n)&&(e[n]=r[n])}}return e},yQ=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,i=e.length;n<i;n++){let o=e[n];r.set(o,s),s+=o.length}return r},VF={assign:xQ,flattenChunks:yQ};let GF=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{GF=!1}const a0=new Uint8Array(256);for(let e=0;e<256;e++)a0[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;a0[254]=a0[254]=1;var vQ=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,i,o=e.length,l=0;for(s=0;s<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),i=0,s=0;i<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const bQ=(e,t)=>{if(t<65534&&e.subarray&&GF)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var wQ=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const i=new Array(r*2);for(s=0,n=0;n<r;){let o=e[n++];if(o<128){i[s++]=o;continue}let l=a0[o];if(l>4){i[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return bQ(i,s)},_Q=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+a0[e[r]]>t?r:t},ow={string2buf:vQ,buf2string:wQ,utf8border:_Q};function NQ(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var jQ=NQ;const Kp=16209,CQ=16191;var BQ=function(t,r){let n,s,i,o,l,c,u,d,h,f,A,b,m,v,p,g,y,x,w,N,_,C,j,E;const S=t.state;n=t.next_in,j=t.input,s=n+(t.avail_in-5),i=t.next_out,E=t.output,o=i-(r-t.avail_out),l=i+(t.avail_out-257),c=S.dmax,u=S.wsize,d=S.whave,h=S.wnext,f=S.window,A=S.hold,b=S.bits,m=S.lencode,v=S.distcode,p=(1<<S.lenbits)-1,g=(1<<S.distbits)-1;e:do{b<15&&(A+=j[n++]<<b,b+=8,A+=j[n++]<<b,b+=8),y=m[A&p];t:for(;;){if(x=y>>>24,A>>>=x,b-=x,x=y>>>16&255,x===0)E[i++]=y&65535;else if(x&16){w=y&65535,x&=15,x&&(b<x&&(A+=j[n++]<<b,b+=8),w+=A&(1<<x)-1,A>>>=x,b-=x),b<15&&(A+=j[n++]<<b,b+=8,A+=j[n++]<<b,b+=8),y=v[A&g];r:for(;;){if(x=y>>>24,A>>>=x,b-=x,x=y>>>16&255,x&16){if(N=y&65535,x&=15,b<x&&(A+=j[n++]<<b,b+=8,b<x&&(A+=j[n++]<<b,b+=8)),N+=A&(1<<x)-1,N>c){t.msg="invalid distance too far back",S.mode=Kp;break e}if(A>>>=x,b-=x,x=i-o,N>x){if(x=N-x,x>d&&S.sane){t.msg="invalid distance too far back",S.mode=Kp;break e}if(_=0,C=f,h===0){if(_+=u-x,x<w){w-=x;do E[i++]=f[_++];while(--x);_=i-N,C=E}}else if(h<x){if(_+=u+h-x,x-=h,x<w){w-=x;do E[i++]=f[_++];while(--x);if(_=0,h<w){x=h,w-=x;do E[i++]=f[_++];while(--x);_=i-N,C=E}}}else if(_+=h-x,x<w){w-=x;do E[i++]=f[_++];while(--x);_=i-N,C=E}for(;w>2;)E[i++]=C[_++],E[i++]=C[_++],E[i++]=C[_++],w-=3;w&&(E[i++]=C[_++],w>1&&(E[i++]=C[_++]))}else{_=i-N;do E[i++]=E[_++],E[i++]=E[_++],E[i++]=E[_++],w-=3;while(w>2);w&&(E[i++]=E[_++],w>1&&(E[i++]=E[_++]))}}else if(x&64){t.msg="invalid distance code",S.mode=Kp;break e}else{y=v[(y&65535)+(A&(1<<x)-1)];continue r}break}}else if(x&64)if(x&32){S.mode=CQ;break e}else{t.msg="invalid literal/length code",S.mode=Kp;break e}else{y=m[(y&65535)+(A&(1<<x)-1)];continue t}break}}while(n<s&&i<l);w=b>>3,n-=w,b-=w<<3,A&=(1<<b)-1,t.next_in=n,t.next_out=i,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=i<l?257+(l-i):257-(i-l),S.hold=A,S.bits=b};const Nd=15,G4=852,W4=592,z4=0,Fy=1,X4=2,kQ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),SQ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),EQ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),FQ=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),TQ=(e,t,r,n,s,i,o,l)=>{const c=l.bits;let u=0,d=0,h=0,f=0,A=0,b=0,m=0,v=0,p=0,g=0,y,x,w,N,_,C=null,j;const E=new Uint16Array(Nd+1),S=new Uint16Array(Nd+1);let F=null,I,O,M;for(u=0;u<=Nd;u++)E[u]=0;for(d=0;d<n;d++)E[t[r+d]]++;for(A=c,f=Nd;f>=1&&E[f]===0;f--);if(A>f&&(A=f),f===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,l.bits=1,0;for(h=1;h<f&&E[h]===0;h++);for(A<h&&(A=h),v=1,u=1;u<=Nd;u++)if(v<<=1,v-=E[u],v<0)return-1;if(v>0&&(e===z4||f!==1))return-1;for(S[1]=0,u=1;u<Nd;u++)S[u+1]=S[u]+E[u];for(d=0;d<n;d++)t[r+d]!==0&&(o[S[t[r+d]]++]=d);if(e===z4?(C=F=o,j=20):e===Fy?(C=kQ,F=SQ,j=257):(C=EQ,F=FQ,j=0),g=0,d=0,u=h,_=i,b=A,m=0,w=-1,p=1<<A,N=p-1,e===Fy&&p>G4||e===X4&&p>W4)return 1;for(;;){I=u-m,o[d]+1<j?(O=0,M=o[d]):o[d]>=j?(O=F[o[d]-j],M=C[o[d]-j]):(O=96,M=0),y=1<<u-m,x=1<<b,h=x;do x-=y,s[_+(g>>m)+x]=I<<24|O<<16|M|0;while(x!==0);for(y=1<<u-1;g&y;)y>>=1;if(y!==0?(g&=y-1,g+=y):g=0,d++,--E[u]===0){if(u===f)break;u=t[r+o[d]]}if(u>A&&(g&N)!==w){for(m===0&&(m=A),_+=h,b=u-m,v=1<<b;b+m<f&&(v-=E[b+m],!(v<=0));)b++,v<<=1;if(p+=1<<b,e===Fy&&p>G4||e===X4&&p>W4)return 1;w=g&N,s[w]=A<<24|b<<16|_-i|0}}return g!==0&&(s[_+g]=u-m<<24|64<<16|0),l.bits=A,0};var wh=TQ;const IQ=0,WF=1,zF=2,{Z_FINISH:Y4,Z_BLOCK:LQ,Z_TREES:$p,Z_OK:Ku,Z_STREAM_END:OQ,Z_NEED_DICT:UQ,Z_STREAM_ERROR:Qi,Z_DATA_ERROR:XF,Z_MEM_ERROR:YF,Z_BUF_ERROR:PQ,Z_DEFLATED:J4}=$F,Px=16180,Z4=16181,ej=16182,tj=16183,rj=16184,nj=16185,aj=16186,sj=16187,ij=16188,oj=16189,Qg=16190,ul=16191,Ty=16192,lj=16193,Iy=16194,cj=16195,uj=16196,dj=16197,Aj=16198,Vp=16199,Gp=16200,fj=16201,hj=16202,pj=16203,mj=16204,gj=16205,Ly=16206,xj=16207,yj=16208,on=16209,JF=16210,ZF=16211,DQ=852,RQ=592,QQ=15,MQ=QQ,vj=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function HQ(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Zu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Px||t.mode>ZF?1:0},e6=e=>{if(Zu(e))return Qi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Px,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(DQ),t.distcode=t.distdyn=new Int32Array(RQ),t.sane=1,t.back=-1,Ku},t6=e=>{if(Zu(e))return Qi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,e6(e)},r6=(e,t)=>{let r;if(Zu(e))return Qi;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Qi:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,t6(e))},n6=(e,t)=>{if(!e)return Qi;const r=new HQ;e.state=r,r.strm=e,r.window=null,r.mode=Px;const n=r6(e,t);return n!==Ku&&(e.state=null),n},qQ=e=>n6(e,MQ);let bj=!0,Oy,Uy;const KQ=e=>{if(bj){Oy=new Int32Array(512),Uy=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(wh(WF,e.lens,0,288,Oy,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;wh(zF,e.lens,0,32,Uy,0,e.work,{bits:5}),bj=!1}e.lencode=Oy,e.lenbits=9,e.distcode=Uy,e.distbits=5},a6=(e,t,r,n)=>{let s;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(t.subarray(r-n,r-n+s),i.wnext),n-=s,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},$Q=(e,t)=>{let r,n,s,i,o,l,c,u,d,h,f,A,b,m,v=0,p,g,y,x,w,N,_,C;const j=new Uint8Array(4);let E,S;const F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Zu(e)||!e.output||!e.input&&e.avail_in!==0)return Qi;r=e.state,r.mode===ul&&(r.mode=Ty),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,h=l,f=c,C=Ku;e:for(;;)switch(r.mode){case Px:if(r.wrap===0){r.mode=Ty;break}for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,j[0]=u&255,j[1]=u>>>8&255,r.check=ko(r.check,j,2,0),u=0,d=0,r.mode=Z4;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=on;break}if((u&15)!==J4){e.msg="unknown compression method",r.mode=on;break}if(u>>>=4,d-=4,_=(u&15)+8,r.wbits===0&&(r.wbits=_),_>15||_>r.wbits){e.msg="invalid window size",r.mode=on;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?oj:ul,u=0,d=0;break;case Z4:for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==J4){e.msg="unknown compression method",r.mode=on;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=on;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,r.check=ko(r.check,j,2,0)),u=0,d=0,r.mode=ej;case ej:for(;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,j[2]=u>>>16&255,j[3]=u>>>24&255,r.check=ko(r.check,j,4,0)),u=0,d=0,r.mode=tj;case tj:for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,r.check=ko(r.check,j,2,0)),u=0,d=0,r.mode=rj;case rj:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(j[0]=u&255,j[1]=u>>>8&255,r.check=ko(r.check,j,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=nj;case nj:if(r.flags&1024&&(A=r.length,A>l&&(A=l),A&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+A),_)),r.flags&512&&r.wrap&4&&(r.check=ko(r.check,n,A,i)),l-=A,i+=A,r.length-=A),r.length))break e;r.length=0,r.mode=aj;case aj:if(r.flags&2048){if(l===0)break e;A=0;do _=n[i+A++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_));while(_&&A<l);if(r.flags&512&&r.wrap&4&&(r.check=ko(r.check,n,A,i)),l-=A,i+=A,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=sj;case sj:if(r.flags&4096){if(l===0)break e;A=0;do _=n[i+A++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_));while(_&&A<l);if(r.flags&512&&r.wrap&4&&(r.check=ko(r.check,n,A,i)),l-=A,i+=A,_)break e}else r.head&&(r.head.comment=null);r.mode=ij;case ij:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=on;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=ul;break;case oj:for(;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}e.adler=r.check=vj(u),u=0,d=0,r.mode=Qg;case Qg:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=d,UQ;e.adler=r.check=1,r.mode=ul;case ul:if(t===LQ||t===$p)break e;case Ty:if(r.last){u>>>=d&7,d-=d&7,r.mode=Ly;break}for(;d<3;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=lj;break;case 1:if(KQ(r),r.mode=Vp,t===$p){u>>>=2,d-=2;break e}break;case 2:r.mode=uj;break;case 3:e.msg="invalid block type",r.mode=on}u>>>=2,d-=2;break;case lj:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=on;break}if(r.length=u&65535,u=0,d=0,r.mode=Iy,t===$p)break e;case Iy:r.mode=cj;case cj:if(A=r.length,A){if(A>l&&(A=l),A>c&&(A=c),A===0)break e;s.set(n.subarray(i,i+A),o),l-=A,i+=A,c-=A,o+=A,r.length-=A;break}r.mode=ul;break;case uj:for(;d<14;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=on;break}r.have=0,r.mode=dj;case dj:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.lens[F[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[F[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},C=wh(IQ,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,C){e.msg="invalid code lengths set",r.mode=on;break}r.have=0,r.mode=Aj;case Aj:for(;r.have<r.nlen+r.ndist;){for(;v=r.lencode[u&(1<<r.lenbits)-1],p=v>>>24,g=v>>>16&255,y=v&65535,!(p<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(y<16)u>>>=p,d-=p,r.lens[r.have++]=y;else{if(y===16){for(S=p+2;d<S;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(u>>>=p,d-=p,r.have===0){e.msg="invalid bit length repeat",r.mode=on;break}_=r.lens[r.have-1],A=3+(u&3),u>>>=2,d-=2}else if(y===17){for(S=p+3;d<S;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=p,d-=p,_=0,A=3+(u&7),u>>>=3,d-=3}else{for(S=p+7;d<S;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=p,d-=p,_=0,A=11+(u&127),u>>>=7,d-=7}if(r.have+A>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=on;break}for(;A--;)r.lens[r.have++]=_}}if(r.mode===on)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=on;break}if(r.lenbits=9,E={bits:r.lenbits},C=wh(WF,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,C){e.msg="invalid literal/lengths set",r.mode=on;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},C=wh(zF,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,C){e.msg="invalid distances set",r.mode=on;break}if(r.mode=Vp,t===$p)break e;case Vp:r.mode=Gp;case Gp:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=d,BQ(e,f),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,r.mode===ul&&(r.back=-1);break}for(r.back=0;v=r.lencode[u&(1<<r.lenbits)-1],p=v>>>24,g=v>>>16&255,y=v&65535,!(p<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(g&&!(g&240)){for(x=p,w=g,N=y;v=r.lencode[N+((u&(1<<x+w)-1)>>x)],p=v>>>24,g=v>>>16&255,y=v&65535,!(x+p<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=x,d-=x,r.back+=x}if(u>>>=p,d-=p,r.back+=p,r.length=y,g===0){r.mode=gj;break}if(g&32){r.back=-1,r.mode=ul;break}if(g&64){e.msg="invalid literal/length code",r.mode=on;break}r.extra=g&15,r.mode=fj;case fj:if(r.extra){for(S=r.extra;d<S;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=hj;case hj:for(;v=r.distcode[u&(1<<r.distbits)-1],p=v>>>24,g=v>>>16&255,y=v&65535,!(p<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(!(g&240)){for(x=p,w=g,N=y;v=r.distcode[N+((u&(1<<x+w)-1)>>x)],p=v>>>24,g=v>>>16&255,y=v&65535,!(x+p<=d);){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}u>>>=x,d-=x,r.back+=x}if(u>>>=p,d-=p,r.back+=p,g&64){e.msg="invalid distance code",r.mode=on;break}r.offset=y,r.extra=g&15,r.mode=pj;case pj:if(r.extra){for(S=r.extra;d<S;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=on;break}r.mode=mj;case mj:if(c===0)break e;if(A=f-c,r.offset>A){if(A=r.offset-A,A>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=on;break}A>r.wnext?(A-=r.wnext,b=r.wsize-A):b=r.wnext-A,A>r.length&&(A=r.length),m=r.window}else m=s,b=o-r.offset,A=r.length;A>c&&(A=c),c-=A,r.length-=A;do s[o++]=m[b++];while(--A);r.length===0&&(r.mode=Gp);break;case gj:if(c===0)break e;s[o++]=r.length,c--,r.mode=Gp;break;case Ly:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[i++]<<d,d+=8}if(f-=c,e.total_out+=f,r.total+=f,r.wrap&4&&f&&(e.adler=r.check=r.flags?ko(r.check,s,f,o-f):sw(r.check,s,f,o-f)),f=c,r.wrap&4&&(r.flags?u:vj(u))!==r.check){e.msg="incorrect data check",r.mode=on;break}u=0,d=0}r.mode=xj;case xj:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[i++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=on;break}u=0,d=0}r.mode=yj;case yj:C=OQ;break e;case on:C=XF;break e;case JF:return YF;case ZF:default:return Qi}return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=u,r.bits=d,(r.wsize||f!==e.avail_out&&r.mode<on&&(r.mode<Ly||t!==Y4))&&a6(e,e.output,e.next_out,f-e.avail_out),h-=e.avail_in,f-=e.avail_out,e.total_in+=h,e.total_out+=f,r.total+=f,r.wrap&4&&f&&(e.adler=r.check=r.flags?ko(r.check,s,f,e.next_out-f):sw(r.check,s,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===ul?128:0)+(r.mode===Vp||r.mode===Iy?256:0),(h===0&&f===0||t===Y4)&&C===Ku&&(C=PQ),C},VQ=e=>{if(Zu(e))return Qi;let t=e.state;return t.window&&(t.window=null),e.state=null,Ku},GQ=(e,t)=>{if(Zu(e))return Qi;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Ku):Qi},WQ=(e,t)=>{const r=t.length;let n,s,i;return Zu(e)||(n=e.state,n.wrap!==0&&n.mode!==Qg)?Qi:n.mode===Qg&&(s=1,s=sw(s,t,r,0),s!==n.check)?XF:(i=a6(e,t,r,r),i?(n.mode=JF,YF):(n.havedict=1,Ku))};var zQ=t6,XQ=r6,YQ=e6,JQ=qQ,ZQ=n6,eM=$Q,tM=VQ,rM=GQ,nM=WQ,aM="pako inflate (from Nodeca project)",gl={inflateReset:zQ,inflateReset2:XQ,inflateResetKeep:YQ,inflateInit:JQ,inflateInit2:ZQ,inflate:eM,inflateEnd:tM,inflateGetHeader:rM,inflateSetDictionary:nM,inflateInfo:aM};function sM(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var iM=sM;const s6=Object.prototype.toString,{Z_NO_FLUSH:oM,Z_FINISH:lM,Z_OK:s0,Z_STREAM_END:Py,Z_NEED_DICT:Dy,Z_STREAM_ERROR:cM,Z_DATA_ERROR:wj,Z_MEM_ERROR:uM}=$F;function E0(e){this.options=VF.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jQ,this.strm.avail_out=0;let r=gl.inflateInit2(this.strm,t.windowBits);if(r!==s0)throw new Error(iw[r]);if(this.header=new iM,gl.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=ow.string2buf(t.dictionary):s6.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=gl.inflateSetDictionary(this.strm,t.dictionary),r!==s0)))throw new Error(iw[r])}E0.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?lM:oM,s6.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=gl.inflate(r,o),i===Dy&&s&&(i=gl.inflateSetDictionary(r,s),i===s0?i=gl.inflate(r,o):i===wj&&(i=Dy));r.avail_in>0&&i===Py&&r.state.wrap>0&&e[r.next_in]!==0;)gl.inflateReset(r),i=gl.inflate(r,o);switch(i){case cM:case wj:case Dy:case uM:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===Py))if(this.options.to==="string"){let c=ow.utf8border(r.output,r.next_out),u=r.next_out-c,d=ow.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===s0&&l===0)){if(i===Py)return i=gl.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};E0.prototype.onData=function(e){this.chunks.push(e)};E0.prototype.onEnd=function(e){e===s0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=VF.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function dM(e,t){const r=new E0(t);if(r.push(e),r.err)throw r.msg||iw[r.err];return r.result}var AM=E0,fM=dM,hM={Inflate:AM,inflate:fM};const{Inflate:pM,inflate:mM}=hM;var _j=pM,gM=mM;const i6=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;i6[e]=t}const Nj=4294967295;function xM(e,t,r){let n=e;for(let s=0;s<r;s++)n=i6[(n^t[s])&255]^n>>>8;return n}function yM(e,t){return(xM(Nj,e,t)^Nj)>>>0}function jj(e,t,r){const n=e.readUint32(),s=yM(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function o6(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function l6(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function c6(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function u6(e,t,r,n,s){let i=0;if(r.length===0){for(;i<s;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-s]>>1)&255}else{for(;i<s;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-s]+r[i]>>1)&255}}function d6(e,t,r,n,s){let i=0;if(r.length===0){for(;i<s;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-s]&255}else{for(;i<s;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+vM(t[i-s],r[i],r[i-s])&255}}function vM(e,t,r){const n=e+t-r,s=Math.abs(n-e),i=Math.abs(n-t),o=Math.abs(n-r);return s<=i&&s<=o?e:i<=o?t:r}function bM(e,t,r,n,s,i){switch(e){case 0:o6(t,r,s);break;case 1:l6(t,r,s,i);break;case 2:c6(t,r,n,s);break;case 3:u6(t,r,n,s,i);break;case 4:d6(t,r,n,s,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const wM=new Uint16Array([255]),_M=new Uint8Array(wM.buffer),NM=_M[0]===255;function jM(e){const{data:t,width:r,height:n,channels:s,depth:i}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*s,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const h=o[d],f=Math.ceil((r-h.x)/h.xStep),A=Math.ceil((n-h.y)/h.yStep);if(f<=0||A<=0)continue;const b=f*l,m=new Uint8Array(b);for(let v=0;v<A;v++){const p=t[u++],g=t.subarray(u,u+b);u+=b;const y=new Uint8Array(b);bM(p,g,y,m,b,l),m.set(y);for(let x=0;x<f;x++){const w=h.x+x*h.xStep,N=h.y+v*h.yStep;if(!(w>=r||N>=n))for(let _=0;_<l;_++)c[(N*r+w)*l+_]=y[x*l+_]}}}if(i===16){const d=new Uint16Array(c.buffer);if(NM)for(let h=0;h<d.length;h++)d[h]=CM(d[h]);return d}else return c}function CM(e){return(e&255)<<8|e>>8&255}const BM=new Uint16Array([255]),kM=new Uint8Array(BM.buffer),SM=kM[0]===255,EM=new Uint8Array(0);function Cj(e){const{data:t,width:r,height:n,channels:s,depth:i}=e,o=Math.ceil(i/8)*s,l=Math.ceil(i/8*s*r),c=new Uint8Array(n*l);let u=EM,d=0,h,f;for(let A=0;A<n;A++){switch(h=t.subarray(d+1,d+1+l),f=c.subarray(A*l,(A+1)*l),t[d]){case 0:o6(h,f,l);break;case 1:l6(h,f,l,o);break;case 2:c6(h,f,u,l);break;case 3:u6(h,f,u,l,o);break;case 4:d6(h,f,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=f,d+=l+1}if(i===16){const A=new Uint16Array(c.buffer);if(SM)for(let b=0;b<A.length;b++)A[b]=FM(A[b]);return A}else return c}function FM(e){return(e&255)<<8|e>>8&255}const zm=Uint8Array.of(137,80,78,71,13,10,26,10);function Bj(e){if(!TM(e.readBytes(zm.length)))throw new Error("wrong PNG signature")}function TM(e){if(e.length<zm.length)return!1;for(let t=0;t<zm.length;t++)if(e[t]!==zm[t])return!1;return!0}const IM="tEXt",LM=0,A6=new TextDecoder("latin1");function OM(e){if(PM(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const UM=/^[\u0000-\u00FF]*$/;function PM(e){if(!UM.test(e))throw new Error("invalid latin1 text")}function DM(e,t,r){const n=f6(t);e[n]=RM(t,r-n.length-1)}function f6(e){for(e.mark();e.readByte()!==LM;);const t=e.offset;e.reset();const r=A6.decode(e.readBytes(t-e.offset-1));return e.skip(1),OM(r),r}function RM(e,t){return A6.decode(e.readBytes(t))}const Xs={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Ry={UNKNOWN:-1,DEFLATE:0},kj={UNKNOWN:-1,ADAPTIVE:0},Qy={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Wp={NONE:0,BACKGROUND:1,PREVIOUS:2},My={SOURCE:0,OVER:1};class QM extends l_{constructor(r,n={}){super(r);Fr(this,"_checkCrc");Fr(this,"_inflator");Fr(this,"_png");Fr(this,"_apng");Fr(this,"_end");Fr(this,"_hasPalette");Fr(this,"_palette");Fr(this,"_hasTransparency");Fr(this,"_transparency");Fr(this,"_compressionMethod");Fr(this,"_filterMethod");Fr(this,"_interlaceMethod");Fr(this,"_colorType");Fr(this,"_isAnimated");Fr(this,"_numberOfFrames");Fr(this,"_numberOfPlays");Fr(this,"_frames");Fr(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new _j,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Ry.UNKNOWN,this._filterMethod=kj.UNKNOWN,this._interlaceMethod=Qy.UNKNOWN,this._colorType=Xs.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Bj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(Bj(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case IM:DM(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?jj(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?jj(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=MM(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case Xs.GREYSCALE:s=1;break;case Xs.TRUECOLOUR:s=3;break;case Xs.INDEXED_COLOUR:s=1;break;case Xs.GREYSCALE_ALPHA:s=2;break;case Xs.TRUECOLOUR_ALPHA:s=4;break;case Xs.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Ry.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<n;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Xs.GREYSCALE:case Xs.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Xs.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Xs.UNKNOWN:case Xs.GREYSCALE_ALPHA:case Xs.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=f6(this),s=this.readUint8();if(s!==Ry.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:gM(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=Cj({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(s,i,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case Wp.NONE:break;case Wp.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case Wp.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,i=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case My.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=i(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case My.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=i(o,l);for(let d=0;d<this._png.channels;d++){const h=n.data[u+this._png.channels-1]/s,f=d%(this._png.channels-1)===0?1:n.data[u+d],A=Math.floor(h*f+(1-h)*r.data[c+d]);r.data[c+d]+=A}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==kj.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Qy.NO_INTERLACE)this._png.data=Cj({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Qy.ADAM7)this._png.data=jM({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Wp.NONE,blendOp:My.SOURCE,data:r}),this._inflator=new _j,this._writingDataChunks=!1}}function MM(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var Sj;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(Sj||(Sj={}));function HM(e,t){return new QM(e,t).decode()}var zt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Hy(){zt.console&&typeof zt.console.log=="function"&&zt.console.log.apply(zt.console,arguments)}var qr={log:Hy,warn:function(e){zt.console&&(typeof zt.console.warn=="function"?zt.console.warn.apply(zt.console,arguments):Hy.call(null,arguments))},error:function(e){zt.console&&(typeof zt.console.error=="function"?zt.console.error.apply(zt.console,arguments):Hy(e))}};function qy(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){hu(n.response,t,r)},n.onerror=function(){qr.error("could not download file")},n.send()}function Ej(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function zp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var hu=zt.saveAs||((typeof window>"u"?"undefined":Lr(window))!=="object"||window!==zt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=zt.URL||zt.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?Ej(s.href)?qy(e,t,r):zp(s,s.target="_blank"):zp(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){zp(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(Ej(e))qy(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){zp(n)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:Lr(i)!=="object"&&(qr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return qy(e,t,r);var s=e.type==="application/octet-stream",i=/constructor/i.test(zt.HTMLElement)||zt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":Lr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=zt.URL||zt.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function h6(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,i=r[n].process,o=s.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Xm=zt.atob.bind(zt),Fj=zt.btoa.bind(zt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Ky(e,t){var r=e[0],n=e[1],s=e[2],i=e[3];r=$a(r,n,s,i,t[0],7,-680876936),i=$a(i,r,n,s,t[1],12,-389564586),s=$a(s,i,r,n,t[2],17,606105819),n=$a(n,s,i,r,t[3],22,-1044525330),r=$a(r,n,s,i,t[4],7,-176418897),i=$a(i,r,n,s,t[5],12,1200080426),s=$a(s,i,r,n,t[6],17,-1473231341),n=$a(n,s,i,r,t[7],22,-45705983),r=$a(r,n,s,i,t[8],7,1770035416),i=$a(i,r,n,s,t[9],12,-1958414417),s=$a(s,i,r,n,t[10],17,-42063),n=$a(n,s,i,r,t[11],22,-1990404162),r=$a(r,n,s,i,t[12],7,1804603682),i=$a(i,r,n,s,t[13],12,-40341101),s=$a(s,i,r,n,t[14],17,-1502002290),r=Va(r,n=$a(n,s,i,r,t[15],22,1236535329),s,i,t[1],5,-165796510),i=Va(i,r,n,s,t[6],9,-1069501632),s=Va(s,i,r,n,t[11],14,643717713),n=Va(n,s,i,r,t[0],20,-373897302),r=Va(r,n,s,i,t[5],5,-701558691),i=Va(i,r,n,s,t[10],9,38016083),s=Va(s,i,r,n,t[15],14,-660478335),n=Va(n,s,i,r,t[4],20,-405537848),r=Va(r,n,s,i,t[9],5,568446438),i=Va(i,r,n,s,t[14],9,-1019803690),s=Va(s,i,r,n,t[3],14,-187363961),n=Va(n,s,i,r,t[8],20,1163531501),r=Va(r,n,s,i,t[13],5,-1444681467),i=Va(i,r,n,s,t[2],9,-51403784),s=Va(s,i,r,n,t[7],14,1735328473),r=Ga(r,n=Va(n,s,i,r,t[12],20,-1926607734),s,i,t[5],4,-378558),i=Ga(i,r,n,s,t[8],11,-2022574463),s=Ga(s,i,r,n,t[11],16,1839030562),n=Ga(n,s,i,r,t[14],23,-35309556),r=Ga(r,n,s,i,t[1],4,-1530992060),i=Ga(i,r,n,s,t[4],11,1272893353),s=Ga(s,i,r,n,t[7],16,-155497632),n=Ga(n,s,i,r,t[10],23,-1094730640),r=Ga(r,n,s,i,t[13],4,681279174),i=Ga(i,r,n,s,t[0],11,-358537222),s=Ga(s,i,r,n,t[3],16,-722521979),n=Ga(n,s,i,r,t[6],23,76029189),r=Ga(r,n,s,i,t[9],4,-640364487),i=Ga(i,r,n,s,t[12],11,-421815835),s=Ga(s,i,r,n,t[15],16,530742520),r=Wa(r,n=Ga(n,s,i,r,t[2],23,-995338651),s,i,t[0],6,-198630844),i=Wa(i,r,n,s,t[7],10,1126891415),s=Wa(s,i,r,n,t[14],15,-1416354905),n=Wa(n,s,i,r,t[5],21,-57434055),r=Wa(r,n,s,i,t[12],6,1700485571),i=Wa(i,r,n,s,t[3],10,-1894986606),s=Wa(s,i,r,n,t[10],15,-1051523),n=Wa(n,s,i,r,t[1],21,-2054922799),r=Wa(r,n,s,i,t[8],6,1873313359),i=Wa(i,r,n,s,t[15],10,-30611744),s=Wa(s,i,r,n,t[6],15,-1560198380),n=Wa(n,s,i,r,t[13],21,1309151649),r=Wa(r,n,s,i,t[4],6,-145523070),i=Wa(i,r,n,s,t[11],10,-1120210379),s=Wa(s,i,r,n,t[2],15,718787259),n=Wa(n,s,i,r,t[9],21,-343485551),e[0]=pc(r,e[0]),e[1]=pc(n,e[1]),e[2]=pc(s,e[2]),e[3]=pc(i,e[3])}function Dx(e,t,r,n,s,i){return t=pc(pc(t,e),pc(n,i)),pc(t<<s|t>>>32-s,r)}function $a(e,t,r,n,s,i,o){return Dx(t&r|~t&n,e,t,s,i,o)}function Va(e,t,r,n,s,i,o){return Dx(t&n|r&~n,e,t,s,i,o)}function Ga(e,t,r,n,s,i,o){return Dx(t^r^n,e,t,s,i,o)}function Wa(e,t,r,n,s,i,o){return Dx(r^(t|~n),e,t,s,i,o)}function p6(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Ky(n,qM(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Ky(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Ky(n,s),n}function qM(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var Tj="0123456789abcdef".split("");function KM(e){for(var t="",r=0;r<4;r++)t+=Tj[e>>8*r+4&15]+Tj[e>>8*r&15];return t}function $M(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function lw(e){return p6(e).map($M).join("")}var VM=function(e){for(var t=0;t<e.length;t++)e[t]=KM(e[t]);return e.join("")}(p6("hello"))!="5d41402abc4b2a76b9719d911017c592";function pc(e,t){if(VM){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function cw(e,t){var r,n,s,i;if(e!==r){for(var o=(s=e,i=1+(256/e.length|0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var h=t.length,f=0,A=0,b="";for(c=0;c<h;c++)A=(A+(d=l[f=(f+1)%256]))%256,l[f]=l[A],l[A]=d,o=l[(l[f]+l[A])%256],b+=String.fromCharCode(t.charCodeAt(c)^o);return b}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Ij={print:4,modify:8,copy:16,"annot-forms":32};function Dd(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(Ij.perm!==void 0)throw new Error("Invalid permission: "+l);s+=Ij[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=lw(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=cw(this.encryptionKey,this.padding)}function Rd(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function Lj(e){if(Lr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!s],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,n)}catch(l){zt.console&&qr.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Mg(e){if(!(this instanceof Mg))return new Mg(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function m6(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function yu(e,t,r,n,s){if(!(this instanceof yu))return new yu(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,m6.call(this,n,s)}function tA(e,t,r,n,s){if(!(this instanceof tA))return new tA(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,m6.call(this,n,s)}function Lt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],o=[],l=1,c=16,u="S",d=null;Lr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,f={},A={internal:{},__private__:{}};A.__private__.PubSub=Lj;var b="1.3",m=A.__private__.getPdfVersion=function(){return b};A.__private__.setPdfVersion=function(q){b=q};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};A.__private__.getPageFormats=function(){return v};var p=A.__private__.getPageFormat=function(q){return v[q]};s=s||"a4";var g="compat",y="advanced",x=g;function w(){this.saveGraphicsState(),te(new Pt(Xe,0,0,-Xe,0,Jc()*Xe).toString()+" cm"),this.setFontSize(this.getFontSize()/Xe),u="n",x=y}function N(){this.restoreGraphicsState(),u="S",x=g}var _=A.__private__.combineFontStyleAndFontWeight=function(q,ce){if(q=="bold"&&ce=="normal"||q=="bold"&&ce==400||q=="normal"&&ce=="italic"||q=="bold"&&ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ce&&(q=ce==400||ce==="normal"?q==="italic"?"italic":"normal":ce!=700&&ce!=="bold"||q!=="normal"?(ce==700?"bold":ce)+""+q:"bold"),q};A.advancedAPI=function(q){var ce=x===g;return ce&&w.call(this),typeof q!="function"||(q(this),ce&&N.call(this)),this},A.compatAPI=function(q){var ce=x===y;return ce&&N.call(this),typeof q!="function"||(q(this),ce&&w.call(this)),this},A.isAdvancedAPI=function(){return x===y};var C,j=function(q){if(x!==y)throw new Error(q+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},E=A.roundToPrecision=A.__private__.roundToPrecision=function(q,ce){var Be=t||ce;if(isNaN(q)||isNaN(Be))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return q.toFixed(Be).replace(/0+$/,"")};C=A.hpf=A.__private__.hpf=typeof c=="number"?function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.hpf");return E(q,c)}:c==="smart"?function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.hpf");return E(q,q>-1&&q<1?16:5)}:function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.hpf");return E(q,16)};var S=A.f2=A.__private__.f2=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.f2");return E(q,2)},F=A.__private__.f3=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.f3");return E(q,3)},I=A.scale=A.__private__.scale=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.scale");return x===g?q*Xe:x===y?q:void 0},O=function(q){return I(function(ce){return x===g?Jc()-ce:x===y?ce:void 0}(q))};A.__private__.setPrecision=A.setPrecision=function(q){typeof parseInt(q,10)=="number"&&(t=parseInt(q,10))};var M,P="00000000000000000000000000000000",X=A.__private__.getFileId=function(){return P},J=A.__private__.setFileId=function(q){return P=q!==void 0&&/^[a-fA-F0-9]{32}$/.test(q)?q.toUpperCase():P.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(na=new Dd(d.userPermissions,d.userPassword,d.ownerPassword,P)),P};A.setFileId=function(q){return J(q),this},A.getFileId=function(){return X()};var H=A.__private__.convertDateToPDFDate=function(q){var ce=q.getTimezoneOffset(),Be=ce<0?"+":"-",Ie=Math.floor(Math.abs(ce/60)),He=Math.abs(ce%60),ct=[Be,U(Ie),"'",U(He),"'"].join("");return["D:",q.getFullYear(),U(q.getMonth()+1),U(q.getDate()),U(q.getHours()),U(q.getMinutes()),U(q.getSeconds()),ct].join("")},V=A.__private__.convertPDFDateToDate=function(q){var ce=parseInt(q.substr(2,4),10),Be=parseInt(q.substr(6,2),10)-1,Ie=parseInt(q.substr(8,2),10),He=parseInt(q.substr(10,2),10),ct=parseInt(q.substr(12,2),10),ht=parseInt(q.substr(14,2),10);return new Date(ce,Be,Ie,He,ct,ht,0)},K=A.__private__.setCreationDate=function(q){var ce;if(q===void 0&&(q=new Date),q instanceof Date)ce=H(q);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(q))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ce=q}return M=ce},B=A.__private__.getCreationDate=function(q){var ce=M;return q==="jsDate"&&(ce=V(M)),ce};A.setCreationDate=function(q){return K(q),this},A.getCreationDate=function(q){return B(q)};var L,U=A.__private__.padd2=function(q){return("0"+parseInt(q)).slice(-2)},D=A.__private__.padd2Hex=function(q){return("00"+(q=q.toString())).substr(q.length)},Q=0,z=[],G=[],Z=0,R=[],le=[],ee=!1,_e=G;A.__private__.setCustomOutputDestination=function(q){ee=!0,_e=q};var se=function(q){ee||(_e=q)};A.__private__.resetCustomOutputDestination=function(){ee=!1,_e=G};var te=A.__private__.out=function(q){return q=q.toString(),Z+=q.length+1,_e.push(q),_e},Ne=A.__private__.write=function(q){return te(arguments.length===1?q.toString():Array.prototype.join.call(arguments," "))},Se=A.__private__.getArrayBuffer=function(q){for(var ce=q.length,Be=new ArrayBuffer(ce),Ie=new Uint8Array(Be);ce--;)Ie[ce]=q.charCodeAt(ce);return Be},Ae=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];A.__private__.getStandardFonts=function(){return Ae};var ye=e.fontSize||16;A.__private__.setFontSize=A.setFontSize=function(q){return ye=x===y?q/Xe:q,this};var Le,Re=A.__private__.getFontSize=A.getFontSize=function(){return x===g?ye:ye*Xe},we=e.R2L||!1;A.__private__.setR2L=A.setR2L=function(q){return we=q,this},A.__private__.getR2L=A.getR2L=function(){return we};var Pe,ze=A.__private__.setZoomMode=function(q){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(q))Le=q;else if(isNaN(q)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(q)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+q+'" is not recognized.');Le=q}else Le=parseInt(q,10)};A.__private__.getZoomMode=function(){return Le};var Ve,lt=A.__private__.setPageMode=function(q){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(q)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+q+'" is not recognized.');Pe=q};A.__private__.getPageMode=function(){return Pe};var pe=A.__private__.setLayoutMode=function(q){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(q)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+q+'" is not recognized.');Ve=q};A.__private__.getLayoutMode=function(){return Ve},A.__private__.setDisplayMode=A.setDisplayMode=function(q,ce,Be){return ze(q),pe(ce),lt(Be),this};var Fe={title:"",subject:"",author:"",keywords:"",creator:""};A.__private__.getDocumentProperty=function(q){if(Object.keys(Fe).indexOf(q)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Fe[q]},A.__private__.getDocumentProperties=function(){return Fe},A.__private__.setDocumentProperties=A.setProperties=A.setDocumentProperties=function(q){for(var ce in Fe)Fe.hasOwnProperty(ce)&&q[ce]&&(Fe[ce]=q[ce]);return this},A.__private__.setDocumentProperty=function(q,ce){if(Object.keys(Fe).indexOf(q)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Fe[q]=ce};var Ke,Xe,tt,st,ke,Ee={},Je={},rt=[],Ze={},xt={},mt={},bt={},vt=null,Nt=0,Bt=[],tr=new Lj(A),Ma=e.hotfixes||[],rr={},dn={},ta=[],Pt=function q(ce,Be,Ie,He,ct,ht){if(!(this instanceof q))return new q(ce,Be,Ie,He,ct,ht);isNaN(ce)&&(ce=1),isNaN(Be)&&(Be=0),isNaN(Ie)&&(Ie=0),isNaN(He)&&(He=1),isNaN(ct)&&(ct=0),isNaN(ht)&&(ht=0),this._matrix=[ce,Be,Ie,He,ct,ht]};Object.defineProperty(Pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(q){this._matrix[0]=q}}),Object.defineProperty(Pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(q){this._matrix[1]=q}}),Object.defineProperty(Pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(q){this._matrix[2]=q}}),Object.defineProperty(Pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(q){this._matrix[3]=q}}),Object.defineProperty(Pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(q){this._matrix[4]=q}}),Object.defineProperty(Pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(q){this._matrix[5]=q}}),Object.defineProperty(Pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(q){this._matrix[0]=q}}),Object.defineProperty(Pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(q){this._matrix[1]=q}}),Object.defineProperty(Pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(q){this._matrix[2]=q}}),Object.defineProperty(Pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(q){this._matrix[3]=q}}),Object.defineProperty(Pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(q){this._matrix[4]=q}}),Object.defineProperty(Pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(q){this._matrix[5]=q}}),Object.defineProperty(Pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Pt.prototype.join=function(q){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(q)},Pt.prototype.multiply=function(q){var ce=q.sx*this.sx+q.shy*this.shx,Be=q.sx*this.shy+q.shy*this.sy,Ie=q.shx*this.sx+q.sy*this.shx,He=q.shx*this.shy+q.sy*this.sy,ct=q.tx*this.sx+q.ty*this.shx+this.tx,ht=q.tx*this.shy+q.ty*this.sy+this.ty;return new Pt(ce,Be,Ie,He,ct,ht)},Pt.prototype.decompose=function(){var q=this.sx,ce=this.shy,Be=this.shx,Ie=this.sy,He=this.tx,ct=this.ty,ht=Math.sqrt(q*q+ce*ce),It=(q/=ht)*Be+(ce/=ht)*Ie;Be-=q*It,Ie-=ce*It;var Rt=Math.sqrt(Be*Be+Ie*Ie);return It/=Rt,q*(Ie/=Rt)<ce*(Be/=Rt)&&(q=-q,ce=-ce,It=-It,ht=-ht),{scale:new Pt(ht,0,0,Rt,0,0),translate:new Pt(1,0,0,1,He,ct),rotate:new Pt(q,ce,-ce,q,0,0),skew:new Pt(1,0,It,1,0,0)}},Pt.prototype.toString=function(q){return this.join(" ")},Pt.prototype.inversed=function(){var q=this.sx,ce=this.shy,Be=this.shx,Ie=this.sy,He=this.tx,ct=this.ty,ht=1/(q*Ie-ce*Be),It=Ie*ht,Rt=-ce*ht,Yt=-Be*ht,nr=q*ht;return new Pt(It,Rt,Yt,nr,-It*He-Yt*ct,-Rt*He-nr*ct)},Pt.prototype.applyToPoint=function(q){var ce=q.x*this.sx+q.y*this.shx+this.tx,Be=q.x*this.shy+q.y*this.sy+this.ty;return new Jo(ce,Be)},Pt.prototype.applyToRectangle=function(q){var ce=this.applyToPoint(q),Be=this.applyToPoint(new Jo(q.x+q.w,q.y+q.h));return new af(ce.x,ce.y,Be.x-ce.x,Be.y-ce.y)},Pt.prototype.clone=function(){var q=this.sx,ce=this.shy,Be=this.shx,Ie=this.sy,He=this.tx,ct=this.ty;return new Pt(q,ce,Be,Ie,He,ct)},A.Matrix=Pt;var qn=A.matrixMult=function(q,ce){return ce.multiply(q)},ra=new Pt(1,0,0,1,0,0);A.unitMatrix=A.identityMatrix=ra;var Sn=function(q,ce){if(!xt[q]){var Be=(ce instanceof yu?"Sh":"P")+(Object.keys(Ze).length+1).toString(10);ce.id=Be,xt[q]=Be,Ze[Be]=ce,tr.publish("addPattern",ce)}};A.ShadingPattern=yu,A.TilingPattern=tA,A.addShadingPattern=function(q,ce){return j("addShadingPattern()"),Sn(q,ce),this},A.beginTilingPattern=function(q){j("beginTilingPattern()"),sf(q.boundingBox[0],q.boundingBox[1],q.boundingBox[2]-q.boundingBox[0],q.boundingBox[3]-q.boundingBox[1],q.matrix)},A.endTilingPattern=function(q,ce){j("endTilingPattern()"),ce.stream=le[L].join(`
`),Sn(q,ce),tr.publish("endTilingPattern",ce),ta.pop().restore()};var ma,Ar=A.__private__.newObject=function(){var q=Cr();return de(q,!0),q},Cr=A.__private__.newObjectDeferred=function(){return Q++,z[Q]=function(){return Z},Q},de=function(q,ce){return ce=typeof ce=="boolean"&&ce,z[q]=Z,ce&&te(q+" 0 obj"),q},ne=A.__private__.newAdditionalObject=function(){var q={objId:Cr(),content:""};return R.push(q),q},oe=Cr(),ie=Cr(),xe=A.__private__.decodeColorString=function(q){var ce=q.split(" ");if(ce.length!==2||ce[1]!=="g"&&ce[1]!=="G")ce.length!==5||ce[4]!=="k"&&ce[4]!=="K"||(ce=[(1-ce[0])*(1-ce[3]),(1-ce[1])*(1-ce[3]),(1-ce[2])*(1-ce[3]),"r"]);else{var Be=parseFloat(ce[0]);ce=[Be,Be,Be,"r"]}for(var Ie="#",He=0;He<3;He++)Ie+=("0"+Math.floor(255*parseFloat(ce[He])).toString(16)).slice(-2);return Ie},me=A.__private__.encodeColorString=function(q){var ce;typeof q=="string"&&(q={ch1:q});var Be=q.ch1,Ie=q.ch2,He=q.ch3,ct=q.ch4,ht=q.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Be=="string"&&Be.charAt(0)!=="#"){var It=new h6(Be);if(It.ok)Be=It.toHex();else if(!/^\d*\.?\d*$/.test(Be))throw new Error('Invalid color "'+Be+'" passed to jsPDF.encodeColorString.')}if(typeof Be=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Be)&&(Be="#"+Be[1]+Be[1]+Be[2]+Be[2]+Be[3]+Be[3]),typeof Be=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Be)){var Rt=parseInt(Be.substr(1),16);Be=Rt>>16&255,Ie=Rt>>8&255,He=255&Rt}if(Ie===void 0||ct===void 0&&Be===Ie&&Ie===He)ce=typeof Be=="string"?Be+" "+ht[0]:q.precision===2?S(Be/255)+" "+ht[0]:F(Be/255)+" "+ht[0];else if(ct===void 0||Lr(ct)==="object"){if(ct&&!isNaN(ct.a)&&ct.a===0)return["1.","1.","1.",ht[1]].join(" ");ce=typeof Be=="string"?[Be,Ie,He,ht[1]].join(" "):q.precision===2?[S(Be/255),S(Ie/255),S(He/255),ht[1]].join(" "):[F(Be/255),F(Ie/255),F(He/255),ht[1]].join(" ")}else ce=typeof Be=="string"?[Be,Ie,He,ct,ht[2]].join(" "):q.precision===2?[S(Be),S(Ie),S(He),S(ct),ht[2]].join(" "):[F(Be),F(Ie),F(He),F(ct),ht[2]].join(" ");return ce},Ue=A.__private__.getFilters=function(){return o},Qe=A.__private__.putStream=function(q){var ce=(q=q||{}).data||"",Be=q.filters||Ue(),Ie=q.alreadyAppliedFilters||[],He=q.addLength1||!1,ct=ce.length,ht=q.objectId,It=function(aa){return aa};if(d!==null&&ht===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(It=na.encryptor(ht,0));var Rt={};Be===!0&&(Be=["FlateEncode"]);var Yt=q.additionalKeyValues||[],nr=(Rt=Lt.API.processDataByFilters!==void 0?Lt.API.processDataByFilters(ce,Be):{data:ce,reverseChain:[]}).reverseChain+(Array.isArray(Ie)?Ie.join(" "):Ie.toString());if(Rt.data.length!==0&&(Yt.push({key:"Length",value:Rt.data.length}),He===!0&&Yt.push({key:"Length1",value:ct})),nr.length!=0)if(nr.split("/").length-1==1)Yt.push({key:"Filter",value:nr});else{Yt.push({key:"Filter",value:"["+nr+"]"});for(var xr=0;xr<Yt.length;xr+=1)if(Yt[xr].key==="DecodeParms"){for(var An=[],$n=0;$n<Rt.reverseChain.split("/").length-1;$n+=1)An.push("null");An.push(Yt[xr].value),Yt[xr].value="["+An.join(" ")+"]"}}te("<<");for(var $r=0;$r<Yt.length;$r++)te("/"+Yt[$r].key+" "+Yt[$r].value);te(">>"),Rt.data.length!==0&&(te("stream"),te(It(Rt.data)),te("endstream"))},qe=A.__private__.putPage=function(q){var ce=q.number,Be=q.data,Ie=q.objId,He=q.contentsObjId;de(Ie,!0),te("<</Type /Page"),te("/Parent "+q.rootDictionaryObjId+" 0 R"),te("/Resources "+q.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(C(q.mediaBox.bottomLeftX))+" "+parseFloat(C(q.mediaBox.bottomLeftY))+" "+C(q.mediaBox.topRightX)+" "+C(q.mediaBox.topRightY)+"]"),q.cropBox!==null&&te("/CropBox ["+C(q.cropBox.bottomLeftX)+" "+C(q.cropBox.bottomLeftY)+" "+C(q.cropBox.topRightX)+" "+C(q.cropBox.topRightY)+"]"),q.bleedBox!==null&&te("/BleedBox ["+C(q.bleedBox.bottomLeftX)+" "+C(q.bleedBox.bottomLeftY)+" "+C(q.bleedBox.topRightX)+" "+C(q.bleedBox.topRightY)+"]"),q.trimBox!==null&&te("/TrimBox ["+C(q.trimBox.bottomLeftX)+" "+C(q.trimBox.bottomLeftY)+" "+C(q.trimBox.topRightX)+" "+C(q.trimBox.topRightY)+"]"),q.artBox!==null&&te("/ArtBox ["+C(q.artBox.bottomLeftX)+" "+C(q.artBox.bottomLeftY)+" "+C(q.artBox.topRightX)+" "+C(q.artBox.topRightY)+"]"),typeof q.userUnit=="number"&&q.userUnit!==1&&te("/UserUnit "+q.userUnit),tr.publish("putPage",{objId:Ie,pageContext:Bt[ce],pageNumber:ce,page:Be}),te("/Contents "+He+" 0 R"),te(">>"),te("endobj");var ct=Be.join(`
`);return x===y&&(ct+=`
Q`),de(He,!0),Qe({data:ct,filters:Ue(),objectId:He}),te("endobj"),Ie},Ge=A.__private__.putPages=function(){var q,ce,Be=[];for(q=1;q<=Nt;q++)Bt[q].objId=Cr(),Bt[q].contentsObjId=Cr();for(q=1;q<=Nt;q++)Be.push(qe({number:q,data:le[q],objId:Bt[q].objId,contentsObjId:Bt[q].contentsObjId,mediaBox:Bt[q].mediaBox,cropBox:Bt[q].cropBox,bleedBox:Bt[q].bleedBox,trimBox:Bt[q].trimBox,artBox:Bt[q].artBox,userUnit:Bt[q].userUnit,rootDictionaryObjId:oe,resourceDictionaryObjId:ie}));de(oe,!0),te("<</Type /Pages");var Ie="/Kids [";for(ce=0;ce<Nt;ce++)Ie+=Be[ce]+" 0 R ";te(Ie+"]"),te("/Count "+Nt),te(">>"),te("endobj"),tr.publish("postPutPages")},Te=function(q){tr.publish("putFont",{font:q,out:te,newObject:Ar,putStream:Qe}),q.isAlreadyPutted!==!0&&(q.objectNumber=Ar(),te("<<"),te("/Type /Font"),te("/BaseFont /"+Rd(q.postScriptName)),te("/Subtype /Type1"),typeof q.encoding=="string"&&te("/Encoding /"+q.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},be=function(q){q.objectNumber=Ar();var ce=[];ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Form"}),ce.push({key:"BBox",value:"["+[C(q.x),C(q.y),C(q.x+q.width),C(q.y+q.height)].join(" ")+"]"}),ce.push({key:"Matrix",value:"["+q.matrix.toString()+"]"});var Be=q.pages[1].join(`
`);Qe({data:Be,additionalKeyValues:ce,objectId:q.objectNumber}),te("endobj")},Me=function(q,ce){ce||(ce=21);var Be=Ar(),Ie=function(ht,It){var Rt,Yt=[],nr=1/(It-1);for(Rt=0;Rt<1;Rt+=nr)Yt.push(Rt);if(Yt.push(1),ht[0].offset!=0){var xr={offset:0,color:ht[0].color};ht.unshift(xr)}if(ht[ht.length-1].offset!=1){var An={offset:1,color:ht[ht.length-1].color};ht.push(An)}for(var $n="",$r=0,aa=0;aa<Yt.length;aa++){for(Rt=Yt[aa];Rt>ht[$r+1].offset;)$r++;var Vn=ht[$r].offset,Ca=(Rt-Vn)/(ht[$r+1].offset-Vn),tl=ht[$r].color,Vi=ht[$r+1].color;$n+=D(Math.round((1-Ca)*tl[0]+Ca*Vi[0]).toString(16))+D(Math.round((1-Ca)*tl[1]+Ca*Vi[1]).toString(16))+D(Math.round((1-Ca)*tl[2]+Ca*Vi[2]).toString(16))}return $n.trim()}(q.colors,ce),He=[];He.push({key:"FunctionType",value:"0"}),He.push({key:"Domain",value:"[0.0 1.0]"}),He.push({key:"Size",value:"["+ce+"]"}),He.push({key:"BitsPerSample",value:"8"}),He.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),He.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe({data:Ie,additionalKeyValues:He,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Be}),te("endobj"),q.objectNumber=Ar(),te("<< /ShadingType "+q.type),te("/ColorSpace /DeviceRGB");var ct="/Coords ["+C(parseFloat(q.coords[0]))+" "+C(parseFloat(q.coords[1]))+" ";q.type===2?ct+=C(parseFloat(q.coords[2]))+" "+C(parseFloat(q.coords[3])):ct+=C(parseFloat(q.coords[2]))+" "+C(parseFloat(q.coords[3]))+" "+C(parseFloat(q.coords[4]))+" "+C(parseFloat(q.coords[5])),te(ct+="]"),q.matrix&&te("/Matrix ["+q.matrix.toString()+"]"),te("/Function "+Be+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},et=function(q,ce){var Be=Cr(),Ie=Ar();ce.push({resourcesOid:Be,objectOid:Ie}),q.objectNumber=Ie;var He=[];He.push({key:"Type",value:"/Pattern"}),He.push({key:"PatternType",value:"1"}),He.push({key:"PaintType",value:"1"}),He.push({key:"TilingType",value:"1"}),He.push({key:"BBox",value:"["+q.boundingBox.map(C).join(" ")+"]"}),He.push({key:"XStep",value:C(q.xStep)}),He.push({key:"YStep",value:C(q.yStep)}),He.push({key:"Resources",value:Be+" 0 R"}),q.matrix&&He.push({key:"Matrix",value:"["+q.matrix.toString()+"]"}),Qe({data:q.stream,additionalKeyValues:He,objectId:q.objectNumber}),te("endobj")},dt=function(q){for(var ce in q.objectNumber=Ar(),te("<<"),q)switch(ce){case"opacity":te("/ca "+S(q[ce]));break;case"stroke-opacity":te("/CA "+S(q[ce]))}te(">>"),te("endobj")},it=function(q){de(q.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ce in te("/Font <<"),Ee)Ee.hasOwnProperty(ce)&&(h===!1||h===!0&&f.hasOwnProperty(ce))&&te("/"+ce+" "+Ee[ce].objectNumber+" 0 R");te(">>")}(),function(){if(Object.keys(Ze).length>0){for(var ce in te("/Shading <<"),Ze)Ze.hasOwnProperty(ce)&&Ze[ce]instanceof yu&&Ze[ce].objectNumber>=0&&te("/"+ce+" "+Ze[ce].objectNumber+" 0 R");tr.publish("putShadingPatternDict"),te(">>")}}(),function(ce){if(Object.keys(Ze).length>0){for(var Be in te("/Pattern <<"),Ze)Ze.hasOwnProperty(Be)&&Ze[Be]instanceof A.TilingPattern&&Ze[Be].objectNumber>=0&&Ze[Be].objectNumber<ce&&te("/"+Be+" "+Ze[Be].objectNumber+" 0 R");tr.publish("putTilingPatternDict"),te(">>")}}(q.objectOid),function(){if(Object.keys(mt).length>0){var ce;for(ce in te("/ExtGState <<"),mt)mt.hasOwnProperty(ce)&&mt[ce].objectNumber>=0&&te("/"+ce+" "+mt[ce].objectNumber+" 0 R");tr.publish("putGStateDict"),te(">>")}}(),function(){for(var ce in te("/XObject <<"),rr)rr.hasOwnProperty(ce)&&rr[ce].objectNumber>=0&&te("/"+ce+" "+rr[ce].objectNumber+" 0 R");tr.publish("putXobjectDict"),te(">>")}(),te(">>"),te("endobj")},Ct=function(q){Je[q.fontName]=Je[q.fontName]||{},Je[q.fontName][q.fontStyle]=q.id},Xt=function(q,ce,Be,Ie,He){var ct={id:"F"+(Object.keys(Ee).length+1).toString(10),postScriptName:q,fontName:ce,fontStyle:Be,encoding:Ie,isStandardFont:He||!1,metadata:{}};return tr.publish("addFont",{font:ct,instance:this}),Ee[ct.id]=ct,Ct(ct),ct.id},Vt=A.__private__.pdfEscape=A.pdfEscape=function(q,ce){return function(Be,Ie){var He,ct,ht,It,Rt,Yt,nr,xr,An;if(ht=(Ie=Ie||{}).sourceEncoding||"Unicode",Rt=Ie.outputEncoding,(Ie.autoencode||Rt)&&Ee[Ke].metadata&&Ee[Ke].metadata[ht]&&Ee[Ke].metadata[ht].encoding&&(It=Ee[Ke].metadata[ht].encoding,!Rt&&Ee[Ke].encoding&&(Rt=Ee[Ke].encoding),!Rt&&It.codePages&&(Rt=It.codePages[0]),typeof Rt=="string"&&(Rt=It[Rt]),Rt)){for(nr=!1,Yt=[],He=0,ct=Be.length;He<ct;He++)(xr=Rt[Be.charCodeAt(He)])?Yt.push(String.fromCharCode(xr)):Yt.push(Be[He]),Yt[He].charCodeAt(0)>>8&&(nr=!0);Be=Yt.join("")}for(He=Be.length;nr===void 0&&He!==0;)Be.charCodeAt(He-1)>>8&&(nr=!0),He--;if(!nr)return Be;for(Yt=Ie.noBOM?[]:[254,255],He=0,ct=Be.length;He<ct;He++){if((An=(xr=Be.charCodeAt(He))>>8)>>8)throw new Error("Character at position "+He+" of string '"+Be+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Yt.push(An),Yt.push(xr-(An<<8))}return String.fromCharCode.apply(void 0,Yt)}(q,ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_r=A.__private__.beginPage=function(q){le[++Nt]=[],Bt[Nt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(q[0]),topRightY:Number(q[1])}},Xr(Nt),se(le[L])},ja=function(q,ce){var Be,Ie,He;switch(r=ce||r,typeof q=="string"&&(Be=p(q.toLowerCase()),Array.isArray(Be)&&(Ie=Be[0],He=Be[1])),Array.isArray(q)&&(Ie=q[0]*Xe,He=q[1]*Xe),isNaN(Ie)&&(Ie=s[0],He=s[1]),(Ie>14400||He>14400)&&(qr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ie=Math.min(14400,Ie),He=Math.min(14400,He)),s=[Ie,He],r.substr(0,1)){case"l":He>Ie&&(s=[He,Ie]);break;case"p":Ie>He&&(s=[He,Ie])}_r(s),Jt(ef),te(dd),rf!==0&&te(rf+" J"),nf!==0&&te(nf+" j"),tr.publish("addPage",{pageNumber:Nt})},cr=function(q){q>0&&q<=Nt&&(le.splice(q,1),Bt.splice(q,1),Nt--,L>Nt&&(L=Nt),this.setPage(L))},Xr=function(q){q>0&&q<=Nt&&(L=q)},Qr=A.__private__.getNumberOfPages=A.getNumberOfPages=function(){return le.length-1},Ki=function(q,ce,Be){var Ie,He=void 0;return Be=Be||{},q=q!==void 0?q:Ee[Ke].fontName,ce=ce!==void 0?ce:Ee[Ke].fontStyle,Ie=q.toLowerCase(),Je[Ie]!==void 0&&Je[Ie][ce]!==void 0?He=Je[Ie][ce]:Je[q]!==void 0&&Je[q][ce]!==void 0?He=Je[q][ce]:Be.disableWarning===!1&&qr.warn("Unable to look up font label for font '"+q+"', '"+ce+"'. Refer to getFontList() for available fonts."),He||Be.noFallback||(He=Je.times[ce])==null&&(He=Je.times.normal),He},vn=A.__private__.putInfo=function(){var q=Ar(),ce=function(Ie){return Ie};for(var Be in d!==null&&(ce=na.encryptor(q,0)),te("<<"),te("/Producer ("+Vt(ce("jsPDF "+Lt.version))+")"),Fe)Fe.hasOwnProperty(Be)&&Fe[Be]&&te("/"+Be.substr(0,1).toUpperCase()+Be.substr(1)+" ("+Vt(ce(Fe[Be]))+")");te("/CreationDate ("+Vt(ce(M))+")"),te(">>"),te("endobj")},ld=A.__private__.putCatalog=function(q){var ce=(q=q||{}).rootDictionaryObjId||oe;switch(Ar(),te("<<"),te("/Type /Catalog"),te("/Pages "+ce+" 0 R"),Le||(Le="fullwidth"),Le){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Be=""+Le;Be.substr(Be.length-1)==="%"&&(Le=parseInt(Le)/100),typeof Le=="number"&&te("/OpenAction [3 0 R /XYZ null null "+S(Le)+"]")}switch(Ve||(Ve="continuous"),Ve){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}Pe&&te("/PageMode /"+Pe),tr.publish("putCatalog"),te(">>"),te("endobj")},d1=A.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(Q+1)),te("/Root "+Q+" 0 R"),te("/Info "+(Q-1)+" 0 R"),d!==null&&te("/Encrypt "+na.oid+" 0 R"),te("/ID [ <"+P+"> <"+P+"> ]"),te(">>")},Kn=A.__private__.putHeader=function(){te("%PDF-"+b),te("%")},M0=A.__private__.putXRef=function(){var q="0000000000";te("xref"),te("0 "+(Q+1)),te("0000000000 65535 f ");for(var ce=1;ce<=Q;ce++)typeof z[ce]=="function"?te((q+z[ce]()).slice(-10)+" 00000 n "):z[ce]!==void 0?te((q+z[ce]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},wo=A.__private__.buildDocument=function(){var q;Q=0,Z=0,G=[],z=[],R=[],oe=Cr(),ie=Cr(),se(G),tr.publish("buildDocument"),Kn(),Ge(),function(){tr.publish("putAdditionalObjects");for(var Be=0;Be<R.length;Be++){var Ie=R[Be];de(Ie.objId,!0),te(Ie.content),te("endobj")}tr.publish("postPutAdditionalObjects")}(),q=[],function(){for(var Be in Ee)Ee.hasOwnProperty(Be)&&(h===!1||h===!0&&f.hasOwnProperty(Be))&&Te(Ee[Be])}(),function(){var Be;for(Be in mt)mt.hasOwnProperty(Be)&&dt(mt[Be])}(),function(){for(var Be in rr)rr.hasOwnProperty(Be)&&be(rr[Be])}(),function(Be){var Ie;for(Ie in Ze)Ze.hasOwnProperty(Ie)&&(Ze[Ie]instanceof yu?Me(Ze[Ie]):Ze[Ie]instanceof tA&&et(Ze[Ie],Be))}(q),tr.publish("putResources"),q.forEach(it),it({resourcesOid:ie,objectOid:Number.MAX_SAFE_INTEGER}),tr.publish("postPutResources"),d!==null&&(na.oid=Ar(),te("<<"),te("/Filter /Standard"),te("/V "+na.v),te("/R "+na.r),te("/U <"+na.toHexString(na.U)+">"),te("/O <"+na.toHexString(na.O)+">"),te("/P "+na.P),te(">>"),te("endobj")),vn(),ld();var ce=Z;return M0(),d1(),te("startxref"),te(""+ce),te("%%EOF"),se(le[L]),G.join(`
`)},cd=A.__private__.getBlob=function(q){return new Blob([Se(q)],{type:"application/pdf"})},H0=A.output=A.__private__.output=(ma=function(q,ce){switch(typeof(ce=ce||{})=="string"?ce={filename:ce}:ce.filename=ce.filename||"generated.pdf",q){case void 0:return wo();case"save":A.save(ce.filename);break;case"arraybuffer":return Se(wo());case"blob":return cd(wo());case"bloburi":case"bloburl":if(zt.URL!==void 0&&typeof zt.URL.createObjectURL=="function")return zt.URL&&zt.URL.createObjectURL(cd(wo()))||void 0;qr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Be="",Ie=wo();try{Be=Fj(Ie)}catch{Be=Fj(unescape(encodeURIComponent(Ie)))}return"data:application/pdf;filename="+ce.filename+";base64,"+Be;case"pdfobjectnewwindow":if(Object.prototype.toString.call(zt)==="[object Window]"){var He="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ct=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ce.pdfObjectUrl&&(He=ce.pdfObjectUrl,ct="");var ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+He+'"'+ct+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ce)+");<\/script></body></html>",It=zt.open();return It!==null&&It.document.write(ht),It}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(zt)==="[object Window]"){var Rt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ce.filename+'" width="500px" height="400px" /></body></html>',Yt=zt.open();if(Yt!==null){Yt.document.write(Rt);var nr=this;Yt.document.documentElement.querySelector("#pdfViewer").onload=function(){Yt.document.title=ce.filename,Yt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(nr.output("bloburl"))}}return Yt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(zt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var xr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ce)+'"></iframe></body></html>',An=zt.open();if(An!==null&&(An.document.write(xr),An.document.title=ce.filename),An||typeof safari>"u")return An;break;case"datauri":case"dataurl":return zt.document.location.href=this.output("datauristring",ce);default:return null}},ma.foo=function(){try{return ma.apply(this,arguments)}catch(Be){var q=Be.stack||"";~q.indexOf(" at ")&&(q=q.split(" at ")[1]);var ce="Error in function "+q.split(`
`)[0].split("<")[0]+": "+Be.message;if(!zt.console)throw new Error(ce);zt.console.error(ce,Be),zt.alert&&alert(ce)}},ma.foo.bar=ma,ma.foo),mi=function(q){return Array.isArray(Ma)===!0&&Ma.indexOf(q)>-1};switch(n){case"pt":Xe=1;break;case"mm":Xe=72/25.4;break;case"cm":Xe=72/2.54;break;case"in":Xe=72;break;case"px":Xe=mi("px_scaling")==1?.75:96/72;break;case"pc":case"em":Xe=12;break;case"ex":Xe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Xe=n}var na=null;K(),J();var Wo=A.__private__.getPageInfo=A.getPageInfo=function(q){if(isNaN(q)||q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Bt[q].objId,pageNumber:q,pageContext:Bt[q]}},q0=A.__private__.getPageInfoByObjId=function(q){if(isNaN(q)||q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ce in Bt)if(Bt[ce].objId===q)break;return Wo(ce)},A1=A.__private__.getCurrentPageInfo=A.getCurrentPageInfo=function(){return{objId:Bt[L].objId,pageNumber:L,pageContext:Bt[L]}};A.addPage=function(){return ja.apply(this,arguments),this},A.setPage=function(){return Xr.apply(this,arguments),se.call(this,le[L]),this},A.insertPage=function(q){return this.addPage(),this.movePage(L,q),this},A.movePage=function(q,ce){var Be,Ie;if(q>ce){Be=le[q],Ie=Bt[q];for(var He=q;He>ce;He--)le[He]=le[He-1],Bt[He]=Bt[He-1];le[ce]=Be,Bt[ce]=Ie,this.setPage(ce)}else if(q<ce){Be=le[q],Ie=Bt[q];for(var ct=q;ct<ce;ct++)le[ct]=le[ct+1],Bt[ct]=Bt[ct+1];le[ce]=Be,Bt[ce]=Ie,this.setPage(ce)}return this},A.deletePage=function(){return cr.apply(this,arguments),this},A.__private__.text=A.text=function(q,ce,Be,Ie,He){var ct,ht,It,Rt,Yt,nr,xr,An,$n,$r=(Ie=Ie||{}).scope||this;if(typeof q=="number"&&typeof ce=="number"&&(typeof Be=="string"||Array.isArray(Be))){var aa=Be;Be=ce,ce=q,q=aa}if(arguments[3]instanceof Pt==0?(It=arguments[4],Rt=arguments[5],Lr(xr=arguments[3])==="object"&&xr!==null||(typeof It=="string"&&(Rt=It,It=null),typeof xr=="string"&&(Rt=xr,xr=null),typeof xr=="number"&&(It=xr,xr=null),Ie={flags:xr,angle:It,align:Rt})):(j("The transform parameter of text() with a Matrix value"),$n=He),isNaN(ce)||isNaN(Be)||q==null)throw new Error("Invalid arguments passed to jsPDF.text");if(q.length===0)return $r;var Vn,Ca="",tl=typeof Ie.lineHeightFactor=="number"?Ie.lineHeightFactor:zc,Vi=$r.internal.scaleFactor;function rl(Br){return Br=Br.split("	").join(Array(Ie.TabLen||9).join(" ")),Vt(Br,xr)}function lf(Br){for(var Mr,Fn=Br.concat(),sa=[],sl=Fn.length;sl--;)typeof(Mr=Fn.shift())=="string"?sa.push(Mr):Array.isArray(Br)&&(Mr.length===1||Mr[1]===void 0&&Mr[2]===void 0)?sa.push(Mr[0]):sa.push([Mr[0],Mr[1],Mr[2]]);return sa}function fd(Br,Mr){var Fn;if(typeof Br=="string")Fn=Mr(Br)[0];else if(Array.isArray(Br)){for(var sa,sl,xf=Br.concat(),md=[],ep=xf.length;ep--;)typeof(sa=xf.shift())=="string"?md.push(Mr(sa)[0]):Array.isArray(sa)&&typeof sa[0]=="string"&&(sl=Mr(sa[0],sa[1],sa[2]),md.push([sl[0],sl[1],sl[2]]));Fn=md}return Fn}var Rl=!1,Zc=!0;if(typeof q=="string")Rl=!0;else if(Array.isArray(q)){var eu=q.concat();ht=[];for(var Ql,Ba=eu.length;Ba--;)(typeof(Ql=eu.shift())!="string"||Array.isArray(Ql)&&typeof Ql[0]!="string")&&(Zc=!1);Rl=Zc}if(Rl===!1)throw new Error('Type of text must be string or Array. "'+q+'" is not recognized.');typeof q=="string"&&(q=q.match(/[\r?\n]/)?q.split(/\r\n|\r|\n/g):[q]);var tu=ye/$r.internal.scaleFactor,ru=tu*(tl-1);switch(Ie.baseline){case"bottom":Be-=ru;break;case"top":Be+=tu-ru;break;case"hanging":Be+=tu-2*ru;break;case"middle":Be+=tu/2-ru}if((nr=Ie.maxWidth||0)>0&&(typeof q=="string"?q=$r.splitTextToSize(q,nr):Object.prototype.toString.call(q)==="[object Array]"&&(q=q.reduce(function(Br,Mr){return Br.concat($r.splitTextToSize(Mr,nr))},[]))),ct={text:q,x:ce,y:Be,options:Ie,mutex:{pdfEscape:Vt,activeFontKey:Ke,fonts:Ee,activeFontSize:ye}},tr.publish("preProcessText",ct),q=ct.text,It=(Ie=ct.options).angle,$n instanceof Pt==0&&It&&typeof It=="number"){It*=Math.PI/180,Ie.rotationDirection===0&&(It=-It),x===y&&(It=-It);var cf=Math.cos(It),uf=Math.sin(It);$n=new Pt(cf,uf,-uf,cf,0,0)}else It&&It instanceof Pt&&($n=It);x!==y||$n||($n=ra),(Yt=Ie.charSpace||Yo)!==void 0&&(Ca+=C(I(Yt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(An=Ie.horizontalScale)!==void 0&&(Ca+=C(100*An)+` Tz
`),Ie.lang;var us=-1,nl=Ie.renderingMode!==void 0?Ie.renderingMode:Ie.stroke,hd=$r.internal.getCurrentPageInfo().pageContext;switch(nl){case 0:case!1:case"fill":us=0;break;case 1:case!0:case"stroke":us=1;break;case 2:case"fillThenStroke":us=2;break;case 3:case"invisible":us=3;break;case 4:case"fillAndAddForClipping":us=4;break;case 5:case"strokeAndAddPathForClipping":us=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":us=6;break;case 7:case"addToPathForClipping":us=7}var J0=hd.usedRenderingMode!==void 0?hd.usedRenderingMode:-1;us!==-1?Ca+=us+` Tr
`:J0!==-1&&(Ca+=`0 Tr
`),us!==-1&&(hd.usedRenderingMode=us),Rt=Ie.align||"left";var gi,nu=ye*tl,df=$r.internal.pageSize.getWidth(),Af=Ee[Ke];Yt=Ie.charSpace||Yo,nr=Ie.maxWidth||0,xr=Object.assign({autoencode:!0,noBOM:!0},Ie.flags);var Ml=[],au=function(Br){return $r.getStringUnitWidth(Br,{font:Af,charSpace:Yt,fontSize:ye,doKerning:!1})*ye/Vi};if(Object.prototype.toString.call(q)==="[object Array]"){var Hs;ht=lf(q),Rt!=="left"&&(gi=ht.map(au));var qs,Hl=0;if(Rt==="right"){ce-=gi[0],q=[],Ba=ht.length;for(var al=0;al<Ba;al++)al===0?(qs=zo(ce),Hs=Xo(Be)):(qs=I(Hl-gi[al]),Hs=-nu),q.push([ht[al],qs,Hs]),Hl=gi[al]}else if(Rt==="center"){ce-=gi[0]/2,q=[],Ba=ht.length;for(var ql=0;ql<Ba;ql++)ql===0?(qs=zo(ce),Hs=Xo(Be)):(qs=I((Hl-gi[ql])/2),Hs=-nu),q.push([ht[ql],qs,Hs]),Hl=gi[ql]}else if(Rt==="left"){q=[],Ba=ht.length;for(var ff=0;ff<Ba;ff++)q.push(ht[ff])}else if(Rt==="justify"&&Af.encoding==="Identity-H"){q=[],Ba=ht.length,nr=nr!==0?nr:df;for(var pd=0,En=0;En<Ba;En++)if(Hs=En===0?Xo(Be):-nu,qs=En===0?zo(ce):pd,En<Ba-1){var Z0=I((nr-gi[En])/(ht[En].split(" ").length-1)),No=ht[En].split(" ");q.push([No[0]+" ",qs,Hs]),pd=0;for(var jo=1;jo<No.length;jo++){var hf=(au(No[jo-1]+" "+No[jo])-au(No[jo]))*Vi+Z0;jo==No.length-1?q.push([No[jo],hf,0]):q.push([No[jo]+" ",hf,0]),pd-=hf}}else q.push([ht[En],qs,Hs]);q.push(["",pd,0])}else{if(Rt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(q=[],Ba=ht.length,nr=nr!==0?nr:df,En=0;En<Ba;En++){Hs=En===0?Xo(Be):-nu,qs=En===0?zo(ce):0;var pf=ht[En].split(" ").length-1,mf=pf>0?(nr-gi[En])/pf:0;En<Ba-1?Ml.push(C(I(mf))):Ml.push(0),q.push([ht[En],qs,Hs])}}}(typeof Ie.R2L=="boolean"?Ie.R2L:we)===!0&&(q=fd(q,function(Br,Mr,Fn){return[Br.split("").reverse().join(""),Mr,Fn]})),ct={text:q,x:ce,y:Be,options:Ie,mutex:{pdfEscape:Vt,activeFontKey:Ke,fonts:Ee,activeFontSize:ye}},tr.publish("postProcessText",ct),q=ct.text,Vn=ct.mutex.isHex||!1;var gf=Ee[Ke].encoding;gf!=="WinAnsiEncoding"&&gf!=="StandardEncoding"||(q=fd(q,function(Br,Mr,Fn){return[rl(Br),Mr,Fn]})),ht=lf(q),q=[];for(var Kl,$l,Vl,su=Array.isArray(ht[0])?1:0,Gl="",iu=function(Br,Mr,Fn){var sa="";return Fn instanceof Pt?(Fn=typeof Ie.angle=="number"?qn(Fn,new Pt(1,0,0,1,Br,Mr)):qn(new Pt(1,0,0,1,Br,Mr),Fn),x===y&&(Fn=qn(new Pt(1,0,0,-1,0,0),Fn)),sa=Fn.join(" ")+` Tm
`):sa=C(Br)+" "+C(Mr)+` Td
`,sa},xi=0;xi<ht.length;xi++){switch(Gl="",su){case 1:Vl=(Vn?"<":"(")+ht[xi][0]+(Vn?">":")"),Kl=parseFloat(ht[xi][1]),$l=parseFloat(ht[xi][2]);break;case 0:Vl=(Vn?"<":"(")+ht[xi]+(Vn?">":")"),Kl=zo(ce),$l=Xo(Be)}Ml!==void 0&&Ml[xi]!==void 0&&(Gl=Ml[xi]+` Tw
`),xi===0?q.push(Gl+iu(Kl,$l,$n)+Vl):su===0?q.push(Gl+Vl):su===1&&q.push(Gl+iu(Kl,$l,$n)+Vl)}q=su===0?q.join(` Tj
T* `):q.join(` Tj
`),q+=` Tj
`;var Co=`BT
/`;return Co+=Ke+" "+ye+` Tf
`,Co+=C(ye*tl)+` TL
`,Co+=Xc+`
`,Co+=Ca,Co+=q,te(Co+="ET"),f[Ke]=!0,$r};var f1=A.__private__.clip=A.clip=function(q){return te(q==="evenodd"?"W*":"W"),this};A.clipEvenOdd=function(){return f1("evenodd")},A.__private__.discardPath=A.discardPath=function(){return te("n"),this};var _o=A.__private__.isValidStyle=function(q){var ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(q)!==-1&&(ce=!0),ce};A.__private__.setDefaultPathOperation=A.setDefaultPathOperation=function(q){return _o(q)&&(u=q),this};var K0=A.__private__.getStyle=A.getStyle=function(q){var ce=u;switch(q){case"D":case"S":ce="S";break;case"F":ce="f";break;case"FD":case"DF":ce="B";break;case"f":case"f*":case"B":case"B*":ce=q}return ce},$0=A.close=function(){return te("h"),this};A.stroke=function(){return te("S"),this},A.fill=function(q){return ud("f",q),this},A.fillEvenOdd=function(q){return ud("f*",q),this},A.fillStroke=function(q){return ud("B",q),this},A.fillStrokeEvenOdd=function(q){return ud("B*",q),this};var ud=function(q,ce){Lr(ce)==="object"?p1(ce,q):te(q)},Wc=function(q){q===null||x===y&&q===void 0||(q=K0(q),te(q))};function h1(q,ce,Be,Ie,He){var ct=new tA(ce||this.boundingBox,Be||this.xStep,Ie||this.yStep,this.gState,He||this.matrix);ct.stream=this.stream;var ht=q+"$$"+this.cloneIndex+++"$$";return Sn(ht,ct),ct}var p1=function(q,ce){var Be=xt[q.key],Ie=Ze[Be];if(Ie instanceof yu)te("q"),te(m1(ce)),Ie.gState&&A.setGState(Ie.gState),te(q.matrix.toString()+" cm"),te("/"+Be+" sh"),te("Q");else if(Ie instanceof tA){var He=new Pt(1,0,0,-1,0,Jc());q.matrix&&(He=He.multiply(q.matrix||ra),Be=h1.call(Ie,q.key,q.boundingBox,q.xStep,q.yStep,He).id),te("q"),te("/Pattern cs"),te("/"+Be+" scn"),Ie.gState&&A.setGState(Ie.gState),te(ce),te("Q")}},m1=function(q){switch(q){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ZA=A.moveTo=function(q,ce){return te(C(I(q))+" "+C(O(ce))+" m"),this},V0=A.lineTo=function(q,ce){return te(C(I(q))+" "+C(O(ce))+" l"),this},$i=A.curveTo=function(q,ce,Be,Ie,He,ct){return te([C(I(q)),C(O(ce)),C(I(Be)),C(O(Ie)),C(I(He)),C(O(ct)),"c"].join(" ")),this};A.__private__.line=A.line=function(q,ce,Be,Ie,He){if(isNaN(q)||isNaN(ce)||isNaN(Be)||isNaN(Ie)||!_o(He))throw new Error("Invalid arguments passed to jsPDF.line");return x===g?this.lines([[Be-q,Ie-ce]],q,ce,[1,1],He||"S"):this.lines([[Be-q,Ie-ce]],q,ce,[1,1]).stroke()},A.__private__.lines=A.lines=function(q,ce,Be,Ie,He,ct){var ht,It,Rt,Yt,nr,xr,An,$n,$r,aa,Vn,Ca;if(typeof q=="number"&&(Ca=Be,Be=ce,ce=q,q=Ca),Ie=Ie||[1,1],ct=ct||!1,isNaN(ce)||isNaN(Be)||!Array.isArray(q)||!Array.isArray(Ie)||!_o(He)||typeof ct!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ZA(ce,Be),ht=Ie[0],It=Ie[1],Yt=q.length,aa=ce,Vn=Be,Rt=0;Rt<Yt;Rt++)(nr=q[Rt]).length===2?(aa=nr[0]*ht+aa,Vn=nr[1]*It+Vn,V0(aa,Vn)):(xr=nr[0]*ht+aa,An=nr[1]*It+Vn,$n=nr[2]*ht+aa,$r=nr[3]*It+Vn,aa=nr[4]*ht+aa,Vn=nr[5]*It+Vn,$i(xr,An,$n,$r,aa,Vn));return ct&&$0(),Wc(He),this},A.path=function(q){for(var ce=0;ce<q.length;ce++){var Be=q[ce],Ie=Be.c;switch(Be.op){case"m":ZA(Ie[0],Ie[1]);break;case"l":V0(Ie[0],Ie[1]);break;case"c":$i.apply(this,Ie);break;case"h":$0()}}return this},A.__private__.rect=A.rect=function(q,ce,Be,Ie,He){if(isNaN(q)||isNaN(ce)||isNaN(Be)||isNaN(Ie)||!_o(He))throw new Error("Invalid arguments passed to jsPDF.rect");return x===g&&(Ie=-Ie),te([C(I(q)),C(O(ce)),C(I(Be)),C(I(Ie)),"re"].join(" ")),Wc(He),this},A.__private__.triangle=A.triangle=function(q,ce,Be,Ie,He,ct,ht){if(isNaN(q)||isNaN(ce)||isNaN(Be)||isNaN(Ie)||isNaN(He)||isNaN(ct)||!_o(ht))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Be-q,Ie-ce],[He-Be,ct-Ie],[q-He,ce-ct]],q,ce,[1,1],ht,!0),this},A.__private__.roundedRect=A.roundedRect=function(q,ce,Be,Ie,He,ct,ht){if(isNaN(q)||isNaN(ce)||isNaN(Be)||isNaN(Ie)||isNaN(He)||isNaN(ct)||!_o(ht))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var It=4/3*(Math.SQRT2-1);return He=Math.min(He,.5*Be),ct=Math.min(ct,.5*Ie),this.lines([[Be-2*He,0],[He*It,0,He,ct-ct*It,He,ct],[0,Ie-2*ct],[0,ct*It,-He*It,ct,-He,ct],[2*He-Be,0],[-He*It,0,-He,-ct*It,-He,-ct],[0,2*ct-Ie],[0,-ct*It,He*It,-ct,He,-ct]],q+He,ce,[1,1],ht,!0),this},A.__private__.ellipse=A.ellipse=function(q,ce,Be,Ie,He){if(isNaN(q)||isNaN(ce)||isNaN(Be)||isNaN(Ie)||!_o(He))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ct=4/3*(Math.SQRT2-1)*Be,ht=4/3*(Math.SQRT2-1)*Ie;return ZA(q+Be,ce),$i(q+Be,ce-ht,q+ct,ce-Ie,q,ce-Ie),$i(q-ct,ce-Ie,q-Be,ce-ht,q-Be,ce),$i(q-Be,ce+ht,q-ct,ce+Ie,q,ce+Ie),$i(q+ct,ce+Ie,q+Be,ce+ht,q+Be,ce),Wc(He),this},A.__private__.circle=A.circle=function(q,ce,Be,Ie){if(isNaN(q)||isNaN(ce)||isNaN(Be)||!_o(Ie))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(q,ce,Be,Be,Ie)},A.setFont=function(q,ce,Be){return Be&&(ce=_(ce,Be)),Ke=Ki(q,ce,{disableWarning:!1}),this};var g1=A.__private__.getFont=A.getFont=function(){return Ee[Ki.apply(A,arguments)]};A.__private__.getFontList=A.getFontList=function(){var q,ce,Be={};for(q in Je)if(Je.hasOwnProperty(q))for(ce in Be[q]=[],Je[q])Je[q].hasOwnProperty(ce)&&Be[q].push(ce);return Be},A.addFont=function(q,ce,Be,Ie,He){var ct=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ct.indexOf(arguments[3])!==-1?He=arguments[3]:arguments[3]&&ct.indexOf(arguments[3])==-1&&(Be=_(Be,Ie)),Xt.call(this,q,ce,Be,He=He||"Identity-H")};var zc,ef=e.lineWidth||.200025,x1=A.__private__.getLineWidth=A.getLineWidth=function(){return ef},Jt=A.__private__.setLineWidth=A.setLineWidth=function(q){return ef=q,te(C(I(q))+" w"),this};A.__private__.setLineDash=Lt.API.setLineDash=Lt.API.setLineDashPattern=function(q,ce){if(q=q||[],ce=ce||0,isNaN(ce)||!Array.isArray(q))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return q=q.map(function(Be){return C(I(Be))}).join(" "),ce=C(I(ce)),te("["+q+"] "+ce+" d"),this};var y1=A.__private__.getLineHeight=A.getLineHeight=function(){return ye*zc};A.__private__.getLineHeight=A.getLineHeight=function(){return ye*zc};var v1=A.__private__.setLineHeightFactor=A.setLineHeightFactor=function(q){return typeof(q=q||1.15)=="number"&&(zc=q),this},b1=A.__private__.getLineHeightFactor=A.getLineHeightFactor=function(){return zc};v1(e.lineHeight);var zo=A.__private__.getHorizontalCoordinate=function(q){return I(q)},Xo=A.__private__.getVerticalCoordinate=function(q){return x===y?q:Bt[L].mediaBox.topRightY-Bt[L].mediaBox.bottomLeftY-I(q)},w1=A.__private__.getHorizontalCoordinateString=A.getHorizontalCoordinateString=function(q){return C(zo(q))},_1=A.__private__.getVerticalCoordinateString=A.getVerticalCoordinateString=function(q){return C(Xo(q))},dd=e.strokeColor||"0 G";A.__private__.getStrokeColor=A.getDrawColor=function(){return xe(dd)},A.__private__.setStrokeColor=A.setDrawColor=function(q,ce,Be,Ie){return dd=me({ch1:q,ch2:ce,ch3:Be,ch4:Ie,pdfColorType:"draw",precision:2}),te(dd),this};var tf=e.fillColor||"0 g";A.__private__.getFillColor=A.getFillColor=function(){return xe(tf)},A.__private__.setFillColor=A.setFillColor=function(q,ce,Be,Ie){return tf=me({ch1:q,ch2:ce,ch3:Be,ch4:Ie,pdfColorType:"fill",precision:2}),te(tf),this};var Xc=e.textColor||"0 g",N1=A.__private__.getTextColor=A.getTextColor=function(){return xe(Xc)};A.__private__.setTextColor=A.setTextColor=function(q,ce,Be,Ie){return Xc=me({ch1:q,ch2:ce,ch3:Be,ch4:Ie,pdfColorType:"text",precision:3}),this};var Yo=e.charSpace,j1=A.__private__.getCharSpace=A.getCharSpace=function(){return parseFloat(Yo||0)};A.__private__.setCharSpace=A.setCharSpace=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Yo=q,this};var rf=0;A.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},A.__private__.setLineCap=A.setLineCap=function(q){var ce=A.CapJoinStyles[q];if(ce===void 0)throw new Error("Line cap style of '"+q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return rf=ce,te(ce+" J"),this};var nf=0;A.__private__.setLineJoin=A.setLineJoin=function(q){var ce=A.CapJoinStyles[q];if(ce===void 0)throw new Error("Line join style of '"+q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return nf=ce,te(ce+" j"),this},A.__private__.setLineMiterLimit=A.__private__.setMiterLimit=A.setLineMiterLimit=A.setMiterLimit=function(q){if(q=q||0,isNaN(q))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(C(I(q))+" M"),this},A.GState=Mg,A.setGState=function(q){(q=typeof q=="string"?mt[bt[q]]:G0(null,q)).equals(vt)||(te("/"+q.id+" gs"),vt=q)};var G0=function(q,ce){if(!q||!bt[q]){var Be=!1;for(var Ie in mt)if(mt.hasOwnProperty(Ie)&&mt[Ie].equals(ce)){Be=!0;break}if(Be)ce=mt[Ie];else{var He="GS"+(Object.keys(mt).length+1).toString(10);mt[He]=ce,ce.id=He}return q&&(bt[q]=ce.id),tr.publish("addGState",ce),ce}};A.addGState=function(q,ce){return G0(q,ce),this},A.saveGraphicsState=function(){return te("q"),rt.push({key:Ke,size:ye,color:Xc}),this},A.restoreGraphicsState=function(){te("Q");var q=rt.pop();return Ke=q.key,ye=q.size,Xc=q.color,vt=null,this},A.setCurrentTransformationMatrix=function(q){return te(q.toString()+" cm"),this},A.comment=function(q){return te("#"+q),this};var Jo=function(q,ce){var Be=q||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Be},set:function(ct){isNaN(ct)||(Be=parseFloat(ct))}});var Ie=ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ie},set:function(ct){isNaN(ct)||(Ie=parseFloat(ct))}});var He="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return He},set:function(ct){He=ct.toString()}}),this},af=function(q,ce,Be,Ie){Jo.call(this,q,ce),this.type="rect";var He=Be||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return He},set:function(ht){isNaN(ht)||(He=parseFloat(ht))}});var ct=Ie||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ct},set:function(ht){isNaN(ht)||(ct=parseFloat(ht))}}),this},Ad=function(){this.page=Nt,this.currentPage=L,this.pages=le.slice(0),this.pagesContext=Bt.slice(0),this.x=tt,this.y=st,this.matrix=ke,this.width=of(L),this.height=z0(L),this.outputDestination=_e,this.id="",this.objectNumber=-1};Ad.prototype.restore=function(){Nt=this.page,L=this.currentPage,Bt=this.pagesContext,le=this.pages,tt=this.x,st=this.y,ke=this.matrix,W0(L,this.width),Zo(L,this.height),_e=this.outputDestination};var sf=function(q,ce,Be,Ie,He){ta.push(new Ad),Nt=L=0,le=[],tt=q,st=ce,ke=He,_r([Be,Ie])};for(var Yc in A.beginFormObject=function(q,ce,Be,Ie,He){return sf(q,ce,Be,Ie,He),this},A.endFormObject=function(q){return function(ce){if(dn[ce])ta.pop().restore();else{var Be=new Ad,Ie="Xo"+(Object.keys(rr).length+1).toString(10);Be.id=Ie,dn[ce]=Ie,rr[Ie]=Be,tr.publish("addFormObject",Be),ta.pop().restore()}}(q),this},A.doFormObject=function(q,ce){var Be=rr[dn[q]];return te("q"),te(ce.toString()+" cm"),te("/"+Be.id+" Do"),te("Q"),this},A.getFormObject=function(q){var ce=rr[dn[q]];return{x:ce.x,y:ce.y,width:ce.width,height:ce.height,matrix:ce.matrix}},A.save=function(q,ce){return q=q||"generated.pdf",(ce=ce||{}).returnPromise=ce.returnPromise||!1,ce.returnPromise===!1?(hu(cd(wo()),q),typeof hu.unload=="function"&&zt.setTimeout&&setTimeout(hu.unload,911),this):new Promise(function(Be,Ie){try{var He=hu(cd(wo()),q);typeof hu.unload=="function"&&zt.setTimeout&&setTimeout(hu.unload,911),Be(He)}catch(ct){Ie(ct.message)}})},Lt.API)Lt.API.hasOwnProperty(Yc)&&(Yc==="events"&&Lt.API.events.length?function(q,ce){var Be,Ie,He;for(He=ce.length-1;He!==-1;He--)Be=ce[He][0],Ie=ce[He][1],q.subscribe.apply(q,[Be].concat(typeof Ie=="function"?[Ie]:Ie))}(tr,Lt.API.events):A[Yc]=Lt.API[Yc]);function of(q){return Bt[q].mediaBox.topRightX-Bt[q].mediaBox.bottomLeftX}function W0(q,ce){Bt[q].mediaBox.topRightX=ce+Bt[q].mediaBox.bottomLeftX}function z0(q){return Bt[q].mediaBox.topRightY-Bt[q].mediaBox.bottomLeftY}function Zo(q,ce){Bt[q].mediaBox.topRightY=ce+Bt[q].mediaBox.bottomLeftY}var el=A.getPageWidth=function(q){return of(q=q||L)/Xe},X0=A.setPageWidth=function(q,ce){W0(q,ce*Xe)},Jc=A.getPageHeight=function(q){return z0(q=q||L)/Xe},Y0=A.setPageHeight=function(q,ce){Zo(q,ce*Xe)};return A.internal={pdfEscape:Vt,getStyle:K0,getFont:g1,getFontSize:Re,getCharSpace:j1,getTextColor:N1,getLineHeight:y1,getLineHeightFactor:b1,getLineWidth:x1,write:Ne,getHorizontalCoordinate:zo,getVerticalCoordinate:Xo,getCoordinateString:w1,getVerticalCoordinateString:_1,collections:{},newObject:Ar,newAdditionalObject:ne,newObjectDeferred:Cr,newObjectDeferredBegin:de,getFilters:Ue,putStream:Qe,events:tr,scaleFactor:Xe,pageSize:{getWidth:function(){return el(L)},setWidth:function(q){X0(L,q)},getHeight:function(){return Jc(L)},setHeight:function(q){Y0(L,q)}},encryptionOptions:d,encryption:na,getEncryptor:function(q){return d!==null?na.encryptor(q,0):function(ce){return ce}},output:H0,getNumberOfPages:Qr,get pages(){return le},out:te,f2:S,f3:F,getPageInfo:Wo,getPageInfoByObjId:q0,getCurrentPageInfo:A1,getPDFVersion:m,Point:Jo,Rectangle:af,Matrix:Pt,hasHotfix:mi},Object.defineProperty(A.internal.pageSize,"width",{get:function(){return el(L)},set:function(q){X0(L,q)},enumerable:!0,configurable:!0}),Object.defineProperty(A.internal.pageSize,"height",{get:function(){return Jc(L)},set:function(q){Y0(L,q)},enumerable:!0,configurable:!0}),(function(q){for(var ce=0,Be=Ae.length;ce<Be;ce++){var Ie=Xt.call(this,q[ce][0],q[ce][1],q[ce][2],Ae[ce][3],!0);h===!1&&(f[Ie]=!0);var He=q[ce][0].split("-");Ct({id:Ie,fontName:He[0],fontStyle:He[1]||""})}tr.publish("addFonts",{fonts:Ee,dictionary:Je})}).call(A,Ae),Ke="F1",ja(s,r),tr.publish("initialized"),A}Dd.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Dd.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Dd.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Dd.prototype.processOwnerPassword=function(e,t){return cw(lw(t).substr(0,5),e)},Dd.prototype.encryptor=function(e,t){var r=lw(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return cw(r,n)}},Mg.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Lr(e)!==Lr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Lt.API={events:[]},Lt.version="3.0.4";var _n=Lt.API,c_=1,ed=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jd=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zt=function(e){return e.toFixed(2)},nc=function(e){return e.toFixed(5)};_n.__acroform__={};var Ms=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Oj=function(e){return e*c_},To=function(e){var t=new x6,r=Tt.internal.getHeight(e)||0,n=Tt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Zt(n)),Number(Zt(r))],t},GM=_n.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},WM=_n.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},zM=_n.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Dn=_n.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zM(e,t-1)},Rn=_n.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return GM(e,t-1)},Qn=_n.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return WM(e,t-1)},XM=_n.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],i=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(i)||0,[Number(Zt(c.lowerLeft_X)),Number(Zt(c.lowerLeft_Y)),Number(Zt(c.upperRight_X)),Number(Zt(c.upperRight_Y))]},YM=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=uw(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+Zt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=To(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},uw=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(S){return S.split(`
`)}):s.map(function(S){return[S]});var i=r,o=Tt.internal.getHeight(e)||0;o=o<0?-o:o;var l=Tt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(S,F,I){if(S+1<s.length){var O=F+" "+s[S+1][0];return Xp(O,e,I).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var u,d,h=Xp("3",e,i).height,f=e.multiline?o-i:(o-h)/2,A=f+=2,b=0,m=0,v=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+Xp(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var p="",g=0,y=0;y<s.length;y++)if(s.hasOwnProperty(y)){var x=!1;if(s[y].length!==1&&v!==s[y].length-1){if((h+2)*(g+2)+2>o)continue e;p+=s[y][v],x=!0,m=y,y--}else{p=(p+=s[y][v]+" ").substr(p.length-1)==" "?p.substr(0,p.length-1):p;var w=parseInt(y),N=c(w,p,i),_=y>=s.length-1;if(N&&!_){p+=" ",v=0;continue}if(N||_){if(_)m=w;else if(e.multiline&&(h+2)*(g+2)+2>o)continue e}else{if(!e.multiline||(h+2)*(g+2)+2>o)continue e;m=w}}for(var C="",j=b;j<=m;j++){var E=s[j];if(e.multiline){if(j===m){C+=E[v]+" ",v=(v+1)%E.length;continue}if(j===b){C+=E[E.length-1]+" ";continue}}C+=E[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,d=Xp(C,e,i).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}t+=Zt(u)+" "+Zt(A)+` Td
`,t+="("+ed(C)+`) Tj
`,t+=-Zt(u)+` 0 Td
`,A=-(i+2),d=0,b=x?m:m+1,g++,p=""}break}return n.text=t,n.fontSize=i,n},Xp=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},JM={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ZM=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},e9=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(yo.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(JM)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");c_=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new y6,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&ZM(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var i=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=XM(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Tt.createDefaultAppearanceStream(l),Lr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=YM(l);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var h="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var A=l.appearanceStreamContent[f];if(h+="/"+f+" ",h+="<<",Object.keys(A).length>=1||Array.isArray(A)){for(var o in A)if(A.hasOwnProperty(o)){var b=A[o];typeof b=="function"&&(b=b.call(s,l)),h+="/"+o+" "+b+" ",s.internal.acroformPlugin.xForms.indexOf(b)>=0||s.internal.acroformPlugin.xForms.push(b)}}else typeof(b=A)=="function"&&(b=b.call(s,l)),h+="/"+o+" "+b,s.internal.acroformPlugin.xForms.indexOf(b)>=0||s.internal.acroformPlugin.xForms.push(b);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&function(m,v){for(var p in m)if(m.hasOwnProperty(p)){var g=p,y=m[p];v.internal.newObjectDeferredBegin(y.objId,!0),Lr(y)==="object"&&typeof y.putStream=="function"&&y.putStream(),delete m[g]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},g6=_n.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),Lr(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+ed(n(e[i].toString()))+")"):s+=e[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},$y=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+ed(n(e))+")"},Po=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Po.prototype.toString=function(){return this.objId+" 0 R"},Po.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Po.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:g6(s,this.objId,this.scope)}):s instanceof Po?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var x6=function(){Po.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ms(x6,Po);var y6=function(){Po.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ed(r(e))+")"}},set:function(r){e=r}})};Ms(y6,Po);var yo=function e(){Po.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute F supplied.');t=p}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Dn(t,3)},set:function(p){p?this.F=Rn(t,3):this.F=Qn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute Ff supplied.');r=p}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(p){n=p!==void 0?p:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(p){n[0]=p}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(p){n[1]=p}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(p){n[2]=p}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(p){n[3]=p}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(p){switch(p){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=p;break;default:throw new Error('Invalid value "'+p+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Hg)return;i="FieldObject"+e.FieldNum++}var p=function(g){return g};return this.scope&&(p=this.scope.internal.getEncryptor(this.objId)),"("+ed(p(i))+")"},set:function(p){i=p.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(p){i=p}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(p){o=p}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(p){l=p}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(p){c=p}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/c_:u},set:function(p){u=p}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(p){d=p}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Hg||this instanceof Eu))return $y(h,this.objId,this.scope)},set:function(p){p=p.toString(),h=p}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof va==0?$y(f,this.objId,this.scope):f},set:function(p){p=p.toString(),f=this instanceof va==0?p.substr(0,1)==="("?jd(p.substr(1,p.length-2)):jd(p):p}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof va==1?jd(f.substr(1,f.length-1)):f},set:function(p){p=p.toString(),f=this instanceof va==1?"/"+p:p}});var A=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(A)return A},set:function(p){this.V=p}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof va==0?$y(A,this.objId,this.scope):A},set:function(p){p=p.toString(),A=this instanceof va==0?p.substr(0,1)==="("?jd(p.substr(1,p.length-2)):jd(p):p}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof va==1?jd(A.substr(1,A.length-1)):A},set:function(p){p=p.toString(),A=this instanceof va==1?"/"+p:p}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(p){p=!!p,m=p}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(p){b=p}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,1)},set:function(p){p?this.Ff=Rn(this.Ff,1):this.Ff=Qn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,2)},set:function(p){p?this.Ff=Rn(this.Ff,2):this.Ff=Qn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,3)},set:function(p){p?this.Ff=Rn(this.Ff,3):this.Ff=Qn(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(p){if([0,1,2].indexOf(p)===-1)throw new Error('Invalid value "'+p+'" for attribute Q supplied.');v=p}}),Object.defineProperty(this,"textAlign",{get:function(){var p;switch(v){case 0:default:p="left";break;case 1:p="center";break;case 2:p="right"}return p},configurable:!0,enumerable:!0,set:function(p){switch(p){case"right":case 2:v=2;break;case"center":case 1:v=1;break;default:v=0}}})};Ms(yo,Po);var AA=function(){yo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return g6(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(i,o,l){l||(l=1);for(var c,u=[];c=o.exec(i);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,18)},set:function(r){r?this.Ff=Rn(this.Ff,18):this.Ff=Qn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Rn(this.Ff,19):this.Ff=Qn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,20)},set:function(r){r?(this.Ff=Rn(this.Ff,20),t.sort()):this.Ff=Qn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,22)},set:function(r){r?this.Ff=Rn(this.Ff,22):this.Ff=Qn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,23)},set:function(r){r?this.Ff=Rn(this.Ff,23):this.Ff=Qn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,27)},set:function(r){r?this.Ff=Rn(this.Ff,27):this.Ff=Qn(this.Ff,27)}}),this.hasAppearanceStream=!1};Ms(AA,yo);var fA=function(){AA.call(this),this.fontName="helvetica",this.combo=!1};Ms(fA,AA);var hA=function(){fA.call(this),this.combo=!0};Ms(hA,fA);var Ym=function(){hA.call(this),this.edit=!0};Ms(Ym,hA);var va=function(){yo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,15)},set:function(r){r?this.Ff=Rn(this.Ff,15):this.Ff=Qn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,16)},set:function(r){r?this.Ff=Rn(this.Ff,16):this.Ff=Qn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,17)},set:function(r){r?this.Ff=Rn(this.Ff,17):this.Ff=Qn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,26)},set:function(r){r?this.Ff=Rn(this.Ff,26):this.Ff=Qn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+ed(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Lr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ms(va,yo);var Jm=function(){va.call(this),this.pushButton=!0};Ms(Jm,va);var pA=function(){va.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ms(pA,va);var Hg=function(){var e,t;yo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+ed(s(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Lr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Tt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ms(Hg,yo),pA.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},pA.prototype.createOption=function(e){var t=new Hg;return t.Parent=this,t.optionName=e,this.Kids.push(t),t9.call(this.scope,t),t};var Zm=function(){va.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Tt.CheckBox.createAppearanceStream()};Ms(Zm,va);var Eu=function(){yo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,13)},set:function(t){t?this.Ff=Rn(this.Ff,13):this.Ff=Qn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,21)},set:function(t){t?this.Ff=Rn(this.Ff,21):this.Ff=Qn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,23)},set:function(t){t?this.Ff=Rn(this.Ff,23):this.Ff=Qn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,24)},set:function(t){t?this.Ff=Rn(this.Ff,24):this.Ff=Qn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,25)},set:function(t){t?this.Ff=Rn(this.Ff,25):this.Ff=Qn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,26)},set:function(t){t?this.Ff=Rn(this.Ff,26):this.Ff=Qn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ms(Eu,yo);var eg=function(){Eu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Dn(this.Ff,14)},set:function(e){e?this.Ff=Rn(this.Ff,14):this.Ff=Qn(this.Ff,14)}}),this.password=!0};Ms(eg,Eu);var Tt={CheckBox:{createAppearanceStream:function(){return{N:{On:Tt.CheckBox.YesNormal},D:{On:Tt.CheckBox.YesPushDown,Off:Tt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=To(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=uw(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Zt(Tt.internal.getWidth(e))+" "+Zt(Tt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Zt(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=To(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],i=Tt.internal.getHeight(e),o=Tt.internal.getWidth(e),l=uw(e,e.caption);return s.push("1 g"),s.push("0 0 "+Zt(o)+" "+Zt(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Zt(o-1)+" "+Zt(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Zt(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=To(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zt(Tt.internal.getWidth(e))+" "+Zt(Tt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Tt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Tt.RadioButton.Circle.YesNormal,t.D[e]=Tt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=To(e);t.scope=e.scope;var r=[],n=Tt.internal.getWidth(e)<=Tt.internal.getHeight(e)?Tt.internal.getWidth(e)/4:Tt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Tt.internal.Bezier_C,i=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+nc(Tt.internal.getWidth(e)/2)+" "+nc(Tt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=To(e);t.scope=e.scope;var r=[],n=Tt.internal.getWidth(e)<=Tt.internal.getHeight(e)?Tt.internal.getWidth(e)/4:Tt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*Tt.internal.Bezier_C).toFixed(5)),o=Number((n*Tt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+nc(Tt.internal.getWidth(e)/2)+" "+nc(Tt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+nc(Tt.internal.getWidth(e)/2)+" "+nc(Tt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=To(e);t.scope=e.scope;var r=[],n=Tt.internal.getWidth(e)<=Tt.internal.getHeight(e)?Tt.internal.getWidth(e)/4:Tt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*Tt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+nc(Tt.internal.getWidth(e)/2)+" "+nc(Tt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Tt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Tt.RadioButton.Cross.YesNormal,t.D[e]=Tt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=To(e);t.scope=e.scope;var r=[],n=Tt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Zt(Tt.internal.getWidth(e)-2)+" "+Zt(Tt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Zt(n.x1.x)+" "+Zt(n.x1.y)+" m"),r.push(Zt(n.x2.x)+" "+Zt(n.x2.y)+" l"),r.push(Zt(n.x4.x)+" "+Zt(n.x4.y)+" m"),r.push(Zt(n.x3.x)+" "+Zt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=To(e);t.scope=e.scope;var r=Tt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zt(Tt.internal.getWidth(e))+" "+Zt(Tt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zt(Tt.internal.getWidth(e)-2)+" "+Zt(Tt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Zt(r.x1.x)+" "+Zt(r.x1.y)+" m"),n.push(Zt(r.x2.x)+" "+Zt(r.x2.y)+" l"),n.push(Zt(r.x4.x)+" "+Zt(r.x4.y)+" m"),n.push(Zt(r.x3.x)+" "+Zt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=To(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zt(Tt.internal.getWidth(e))+" "+Zt(Tt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Tt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Tt.internal.getWidth(e),r=Tt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Tt.internal.getWidth=function(e){var t=0;return Lr(e)==="object"&&(t=Oj(e.Rect[2])),t},Tt.internal.getHeight=function(e){var t=0;return Lr(e)==="object"&&(t=Oj(e.Rect[3])),t};var t9=_n.addField=function(e){if(e9(this,e),!(e instanceof yo))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};_n.AcroFormChoiceField=AA,_n.AcroFormListBox=fA,_n.AcroFormComboBox=hA,_n.AcroFormEditBox=Ym,_n.AcroFormButton=va,_n.AcroFormPushButton=Jm,_n.AcroFormRadioButton=pA,_n.AcroFormCheckBox=Zm,_n.AcroFormTextField=Eu,_n.AcroFormPasswordField=eg,_n.AcroFormAppearance=Tt,_n.AcroForm={ChoiceField:AA,ListBox:fA,ComboBox:hA,EditBox:Ym,Button:va,PushButton:Jm,RadioButton:pA,CheckBox:Zm,TextField:Eu,PasswordField:eg,Appearance:Tt},Lt.AcroForm={ChoiceField:AA,ListBox:fA,ComboBox:hA,EditBox:Ym,Button:va,PushButton:Jm,RadioButton:pA,CheckBox:Zm,TextField:Eu,PasswordField:eg,Appearance:Tt};Lt.AcroForm;function v6(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(S,F){var I,O,M,P,X,J=r;if((F=F||r)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(N(S))for(X in n)for(M=n[X],I=0;I<M.length;I+=1){for(P=!0,O=0;O<M[I].length;O+=1)if(M[I][O]!==void 0&&M[I][O]!==S[O]){P=!1;break}if(P===!0){J=X;break}}else for(X in n)for(M=n[X],I=0;I<M.length;I+=1){for(P=!0,O=0;O<M[I].length;O+=1)if(M[I][O]!==void 0&&M[I][O]!==S.charCodeAt(O)){P=!1;break}if(P===!0){J=X;break}}return J===r&&F!==r&&(J=F),J},i=function S(F){for(var I=this.internal.write,O=this.internal.putStream,M=(0,this.internal.getFilters)();M.indexOf("FlateEncode")!==-1;)M.splice(M.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var P=[];if(P.push({key:"Type",value:"/XObject"}),P.push({key:"Subtype",value:"/Image"}),P.push({key:"Width",value:F.width}),P.push({key:"Height",value:F.height}),F.colorSpace===p.INDEXED?P.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(P.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===p.DEVICE_CMYK&&P.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),P.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&P.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)&&F.transparency.length>0){for(var X="",J=0,H=F.transparency.length;J<H;J++)X+=F.transparency[J]+" "+F.transparency[J]+" ";P.push({key:"Mask",value:"["+X+"]"})}F.sMask!==void 0&&P.push({key:"SMask",value:F.objectId+1+" 0 R"});var V=F.filter!==void 0?["/"+F.filter]:void 0;if(O({data:F.data,additionalKeyValues:P,alreadyAppliedFilters:V,objectId:F.objectId}),I("endobj"),"sMask"in F&&F.sMask!==void 0){var K,B=(K=F.sMaskBitsPerComponent)!==null&&K!==void 0?K:F.bitsPerComponent,L={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:B,data:F.sMask};"filter"in F&&(L.decodeParameters="/Predictor ".concat(F.predictor," /Colors 1 /BitsPerComponent ").concat(B," /Columns ").concat(F.width),L.filter=F.filter),S.call(this,L)}if(F.colorSpace===p.INDEXED){var U=this.internal.newObject();O({data:C(new Uint8Array(F.palette)),objectId:U}),I("endobj")}},o=function(){var S=this.internal.collections[t+"images"];for(var F in S)i.call(this,S[F])},l=function(){var S,F=this.internal.collections[t+"images"],I=this.internal.write;for(var O in F)I("/I"+(S=F[O]).index,S.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var S=this.internal.collections[t+"images"];return c.call(this),S},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(S){return typeof e["process"+S.toUpperCase()]=="function"},f=function(S){return Lr(S)==="object"&&S.nodeType===1},A=function(S,F){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var I=""+S.getAttribute("src");if(I.indexOf("data:image/")===0)return Xm(unescape(I).split("base64,").pop());var O=e.loadFile(I,!0);if(O!==void 0)return O}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var M;switch(F){case"PNG":M="image/png";break;case"WEBP":M="image/webp";break;default:M="image/jpeg"}return Xm(S.toDataURL(M,1).split("base64,").pop())}},b=function(S){var F=this.internal.collections[t+"images"];if(F){for(var I in F)if(S===F[I].alias)return F[I]}},m=function(S,F,I){return S||F||(S=-96,F=-96),S<0&&(S=-1*I.width*72/S/this.internal.scaleFactor),F<0&&(F=-1*I.height*72/F/this.internal.scaleFactor),S===0&&(S=F*I.width/I.height),F===0&&(F=S*I.height/I.width),[S,F]},v=function(S,F,I,O,M,P){var X=m.call(this,I,O,M),J=this.internal.getCoordinateString,H=this.internal.getVerticalCoordinateString,V=u.call(this);if(I=X[0],O=X[1],V[M.index]=M,P){P*=Math.PI/180;var K=Math.cos(P),B=Math.sin(P),L=function(D){return D.toFixed(4)},U=[L(K),L(B),L(-1*B),L(K),0,0,"cm"]}this.internal.write("q"),P?(this.internal.write([1,"0","0",1,J(S),H(F+O),"cm"].join(" ")),this.internal.write(U.join(" ")),this.internal.write([J(I),"0","0",J(O),"0","0","cm"].join(" "))):this.internal.write([J(I),"0","0",J(O),J(S),H(F+O),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+M.index+" Do"),this.internal.write("Q")},p=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var g=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(S){var F,I,O=0;if(typeof S=="string")for(I=S.length,F=0;F<I;F++)O=(O<<5)-O+S.charCodeAt(F),O|=0;else if(N(S))for(I=S.byteLength/2,F=0;F<I;F++)O=(O<<5)-O+S[F],O|=0;return O},x=e.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var F=!0;return S.length===0&&(F=!1),S.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(F=!1),F},w=e.__addimage__.extractImageFromDataUrl=function(S){if(S==null||!(S=S.trim()).startsWith("data:"))return null;var F=S.indexOf(",");return F<0?null:S.substring(0,F).trim().endsWith("base64")?S.substring(F+1):null};e.__addimage__.isArrayBuffer=function(S){return S instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(S){return S instanceof Int8Array||S instanceof Uint8Array||S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array},_=e.__addimage__.binaryStringToUint8Array=function(S){for(var F=S.length,I=new Uint8Array(F),O=0;O<F;O++)I[O]=S.charCodeAt(O);return I},C=e.__addimage__.arrayBufferToBinaryString=function(S){for(var F="",I=N(S)?S:new Uint8Array(S),O=0;O<I.length;O+=8192)F+=String.fromCharCode.apply(null,I.subarray(O,O+8192));return F};e.addImage=function(){var S,F,I,O,M,P,X,J,H;if(typeof arguments[1]=="number"?(F=r,I=arguments[1],O=arguments[2],M=arguments[3],P=arguments[4],X=arguments[5],J=arguments[6],H=arguments[7]):(F=arguments[1],I=arguments[2],O=arguments[3],M=arguments[4],P=arguments[5],X=arguments[6],J=arguments[7],H=arguments[8]),Lr(S=arguments[0])==="object"&&!f(S)&&"imageData"in S){var V=S;S=V.imageData,F=V.format||F||r,I=V.x||I||0,O=V.y||O||0,M=V.w||V.width||M,P=V.h||V.height||P,X=V.alias||X,J=V.compression||J,H=V.rotation||V.angle||H}var K=this.internal.getFilters();if(J===void 0&&K.indexOf("FlateEncode")!==-1&&(J="SLOW"),isNaN(I)||isNaN(O))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var B=j.call(this,S,F,X,J);return v.call(this,I,O,M,P,B,H),this};var j=function(S,F,I,O){var M,P,X;if(typeof S=="string"&&s(S)===r){S=unescape(S);var J=E(S,!1);(J!==""||(J=e.loadFile(S,!0))!==void 0)&&(S=J)}if(f(S)&&(S=A(S,F)),F=s(S,F),!h(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((X=I)==null||X.length===0)&&(I=function(H){return typeof H=="string"||N(H)?y(H):N(H.data)?y(H.data):null}(S)),(M=b.call(this,I))||(S instanceof Uint8Array||F==="RGBA"||(P=S,S=_(S)),M=this["process"+F.toUpperCase()](S,d.call(this),I,function(H){return H&&typeof H=="string"&&(H=H.toUpperCase()),H in e.image_compression?H:g.NONE}(O),P)),!M)throw new Error("An unknown error occurred whilst processing the image.");return M},E=e.__addimage__.convertBase64ToBinaryString=function(S,F){F=typeof F!="boolean"||F;var I,O="";if(typeof S=="string"){var M;I=(M=w(S))!==null&&M!==void 0?M:S;try{O=Xm(I)}catch(P){if(F)throw x(I)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+P.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return O};e.getImageProperties=function(S){var F,I,O="";if(f(S)&&(S=A(S)),typeof S=="string"&&s(S)===r&&((O=E(S,!1))===""&&(O=e.loadFile(S)||""),S=O),I=s(S),!h(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(S instanceof Uint8Array||(S=_(S)),!(F=this["process"+I.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=I,F}})(Lt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Lt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,h=0;h<u.length&&!d;h++)switch((n=u[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var f=0;f<u.length;f++){n=u[f];var A=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),p=this.internal.getEncryptor(m.objId),g=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+A(p(n.contents))+")",i+=" /Popup "+v.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+A(p(g))+") >>",m.content=i;var y=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+y,n.open&&(i+=" /Open true"),i+=" >>",v.content=i,this.internal.write(m.objId,"0 R",v.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var x=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+A(b(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+x+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var w=this.annotations._nameMap[n.options.name];n.options.pageNumber=w.page,n.options.top=w.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+A(b(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var N=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+N+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+s),h:u(n+i)},options:o,type:"link"})},e.textWithLink=function(r,n,s,i){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,s,i),s+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,s-u,l,o,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Lt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},l=e.__arabicParser__.isArabicEndLetter=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(m){return o(m)&&s.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return o(m)&&i(m)&&t[m.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(m){var v=0,p=r,g="",y=0;for(v=0;v<m.length;v+=1)p[m.charCodeAt(v)]!==void 0?(y++,typeof(p=p[m.charCodeAt(v)])=="number"&&(g+=String.fromCharCode(p),p=r,y=0),v===m.length-1&&(p=r,g+=m.charAt(v-(y-1)),v-=y-1,y=0)):(p=r,g+=m.charAt(v-y),v-=y,y=0);return g};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var f=e.__arabicParser__.getCorrectForm=function(m,v,p){return o(m)?i(m)===!1?-1:!u(m)||!o(v)&&!o(p)||!o(p)&&l(v)||l(m)&&!o(v)||l(m)&&c(v)||l(m)&&l(v)?0:d(m)&&o(v)&&!l(v)&&o(p)&&u(p)?3:l(m)||!o(p)?1:2:-1},A=function(m){var v=0,p=0,g=0,y="",x="",w="",N=(m=m||"").split("\\s+"),_=[];for(v=0;v<N.length;v+=1){for(_.push(""),p=0;p<N[v].length;p+=1)y=N[v][p],x=N[v][p-1],w=N[v][p+1],o(y)?(g=f(y,x,w),_[v]+=g!==-1?String.fromCharCode(t[y.charCodeAt(0)][g]):y):_[v]+=y;_[v]=h(_[v])}return _.join(" ")},b=e.__arabicParser__.processArabic=e.processArabic=function(){var m,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,p=[];if(Array.isArray(v)){var g=0;for(p=[],g=0;g<v.length;g+=1)Array.isArray(v[g])?p.push([A(v[g][0]),v[g][1],v[g][2]]):p.push([A(v[g])]);m=p}else m=A(v);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",b])}(Lt.API),Lt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Lt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var A=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return A},set:function(m){A=m}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(m){b=m}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),h=u.font||this.getFont(),f=u.scaleFactor||this.internal.scaleFactor,A=0,b=0,m=0,v=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var p=u.maxWidth;p>0?typeof c=="string"?c=this.splitTextToSize(c,p):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(y,x){return y.concat(v.splitTextToSize(x,p))},[])):c=Array.isArray(c)?c:[c];for(var g=0;g<c.length;g++)A<(m=this.getStringUnitWidth(c[g],{font:h})*d)&&(A=m);return A!==0&&(b=c.length),{w:A/=f,h:Math.max((b*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/f,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,f=this.internal.__cell__.tableHeaderRow,A=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,A&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,h,f){if(n.call(this),!d)throw new Error("No data for PDF table.");var A,b,m,v,p=[],g=[],y=[],x={},w={},N=[],_=[],C=(f=f||{}).autoSize||!1,j=f.printHeaders!==!1,E=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,S=f.margins||Object.assign({width:this.getPageWidth()},t),F=typeof f.padding=="number"?f.padding:3,I=f.headerBackgroundColor||"#c8c8c8",O=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=E,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=I,this.internal.__cell__.headerTextColor=O,this.setFontSize(E),h==null)g=p=Object.keys(d[0]),y=p.map(function(){return"left"});else if(Array.isArray(h)&&Lr(h[0])==="object")for(p=h.map(function(V){return V.name}),g=h.map(function(V){return V.prompt||V.name||""}),y=h.map(function(V){return V.align||"left"}),A=0;A<h.length;A+=1)w[h[A].name]=.7499990551181103*h[A].width;else Array.isArray(h)&&typeof h[0]=="string"&&(g=p=h,y=p.map(function(){return"left"}));if(C||Array.isArray(h)&&typeof h[0]=="string")for(A=0;A<p.length;A+=1){for(x[v=p[A]]=d.map(function(V){return V[v]}),this.setFont(void 0,"bold"),N.push(this.getTextDimensions(g[A],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=x[v],this.setFont(void 0,"normal"),m=0;m<b.length;m+=1)N.push(this.getTextDimensions(b[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);w[v]=Math.max.apply(null,N)+F+F,N=[]}if(j){var M={};for(A=0;A<p.length;A+=1)M[p[A]]={},M[p[A]].text=g[A],M[p[A]].align=y[A];var P=l.call(this,M,w);_=p.map(function(V){return new i(c,u,w[V],P,M[V].text,void 0,M[V].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var X=h.reduce(function(V,K){return V[K.name]=K.align,V},{});for(A=0;A<d.length;A+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:A,data:d[A]},this);var J=l.call(this,d[A],w);for(m=0;m<p.length;m+=1){var H=d[A][p[m]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:A,col:m,data:H},this),o.call(this,new i(c,u,w[p[m]],J,H,A+2,X[p[m]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(A){var b=c[A];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,u[A]-d-d)},this).map(function(A){return this.getLineHeightFactor()*A.length*h/f+d+d},this).reduce(function(A,b){return Math.max(A,b)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],A=0;A<this.internal.__cell__.tableHeaderRow.length;A+=1){d=this.internal.__cell__.tableHeaderRow[A].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,f.push(d)),d.lineNumber=c;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(b)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(Lt.API);var b6={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},w6=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],dw=v6(w6),_6=[100,200,300,400,500,600,700,800,900],r9=v6(_6);function Vy(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return b6[i=i||"normal"]?i:"normal"}(e.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),s=function(i){return typeof dw[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function Uj(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var n9={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Pj={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Dj(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Rj(e){return e.trimLeft()}function a9(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function s9(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Yp,Qj,Mj,Cd,Jp,Hj,qj,Kj,Gy=["times"];function $j(e,t,r,n,s){var i=4,o=Gj;switch(s){case Lt.API.image_compression.FAST:i=1,o=Vj;break;case Lt.API.image_compression.MEDIUM:i=6,o=Wj;break;case Lt.API.image_compression.SLOW:i=9,o=zj}e=function(c,u,d,h){for(var f,A=c.length/u,b=new Uint8Array(c.length+A),m=[i9,Vj,Gj,Wj,zj],v=0;v<A;v+=1){var p=v*u,g=c.subarray(p,p+u);if(h)b.set(h(g,d,f),p+v);else{for(var y=m.length,x=[],w=0;w<y;w+=1)x[w]=m[w](g,d,f);var N=l9(x.concat());b.set(x[N],p+v)}f=g}return b}(e,t,Math.ceil(r*n/8),o);var l=aw(e,{level:i});return Lt.API.__addimage__.arrayBufferToBinaryString(l)}function i9(e){var t=Array.apply([],e);return t.unshift(0),t}function Vj(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var i=e[s-t]||0;n[s+1]=e[s]-i+256&255}return n}function Gj(e,t,r){var n=e.length,s=[];s[0]=2;for(var i=0;i<n;i+=1){var o=r&&r[i]||0;s[i+1]=e[i]-o+256&255}return s}function Wj(e,t,r){var n=e.length,s=[];s[0]=3;for(var i=0;i<n;i+=1){var o=e[i-t]||0,l=r&&r[i]||0;s[i+1]=e[i]+256-(o+l>>>1)&255}return s}function zj(e,t,r){var n=e.length,s=[];s[0]=4;for(var i=0;i<n;i+=1){var o=o9(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);s[i+1]=e[i]-o+256&255}return s}function o9(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),i=Math.abs(e+t-r-r);return n<=s&&n<=i?e:s<=i?t:r}function l9(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function Wy(e,t,r){var n=t*r,s=Math.floor(n/8),i=16-(n-8*s+r),o=(1<<r)-1;return N6(e,s)>>i&o}function Xj(e,t,r,n){var s=r*n,i=Math.floor(s/8),o=16-(s-8*i+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,d,h){if(d+1<u.byteLength)u.setUint16(d,h,!1);else{var f=h>>8&255;u.setUint8(d,f)}})(e,i,N6(e,i)&~(l<<o)&65535|c)}function N6(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function c9(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,o=1<<1+(7&s);e[t++],e[t++];var l=null,c=null;i&&(l=t,c=o,t+=3*o);var u=!0,d=[],h=0,f=null,A=0,b=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,b=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];h=e[t++]|e[t++]<<8,f=e[t++],1&m||(f=null),A=m>>2&7,t++;break;case 254:for(;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var v=e[t++]|e[t++]<<8,p=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,x=e[t++],w=x>>6&1,N=1<<1+(7&x),_=l,C=c,j=!1;x>>7&&(j=!0,_=t,C=N,t+=3*N);var E=t;for(t++;;){var S;if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}d.push({x:v,y:p,width:g,height:y,has_local_palette:j,palette_offset:_,palette_size:C,data_offset:E,data_length:t-E,transparent_index:f,interlaced:!!w,delay:h,disposal:A});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return b},this.frameInfo=function(F){if(F<0||F>=d.length)throw new Error("Frame index out of range.");return d[F]},this.decodeAndBlitFrameBGRA=function(F,I){var O=this.frameInfo(F),M=O.width*O.height,P=new Uint8Array(M);Yj(e,O.data_offset,P,M);var X=O.palette_offset,J=O.transparent_index;J===null&&(J=256);var H=O.width,V=r-H,K=H,B=4*(O.y*r+O.x),L=4*((O.y+O.height)*r+O.x),U=B,D=4*V;O.interlaced===!0&&(D+=4*r*7);for(var Q=8,z=0,G=P.length;z<G;++z){var Z=P[z];if(K===0&&(K=H,(U+=D)>=L&&(D=4*V+4*r*(Q-1),U=B+(H+V)*(Q<<1),Q>>=1)),Z===J)U+=4;else{var R=e[X+3*Z],le=e[X+3*Z+1],ee=e[X+3*Z+2];I[U++]=ee,I[U++]=le,I[U++]=R,I[U++]=255}--K}},this.decodeAndBlitFrameRGBA=function(F,I){var O=this.frameInfo(F),M=O.width*O.height,P=new Uint8Array(M);Yj(e,O.data_offset,P,M);var X=O.palette_offset,J=O.transparent_index;J===null&&(J=256);var H=O.width,V=r-H,K=H,B=4*(O.y*r+O.x),L=4*((O.y+O.height)*r+O.x),U=B,D=4*V;O.interlaced===!0&&(D+=4*r*7);for(var Q=8,z=0,G=P.length;z<G;++z){var Z=P[z];if(K===0&&(K=H,(U+=D)>=L&&(D=4*V+4*r*(Q-1),U=B+(H+V)*(Q<<1),Q>>=1)),Z===J)U+=4;else{var R=e[X+3*Z],le=e[X+3*Z+1],ee=e[X+3*Z+2];I[U++]=R,I[U++]=le,I[U++]=ee,I[U++]=255}--K}}}function Yj(e,t,r,n){for(var s=e[t++],i=1<<s,o=i+1,l=o+1,c=s+1,u=(1<<c)-1,d=0,h=0,f=0,A=e[t++],b=new Int32Array(4096),m=null;;){for(;d<16&&A!==0;)h|=e[t++]<<d,d+=8,A===1?A=e[t++]:--A;if(d<c)break;var v=h&u;if(h>>=c,d-=c,v!==i){if(v===o)break;for(var p=v<l?v:m,g=0,y=p;y>i;)y=b[y]>>8,++g;var x=y;if(f+g+(p!==v?1:0)>n)return void qr.log("Warning, gif stream longer than expected.");r[f++]=x;var w=f+=g;for(p!==v&&(r[f++]=x),y=p;g--;)y=b[y],r[--w]=255&y,y>>=8;m!==null&&l<4096&&(b[l++]=m<<8|x,l>=u+1&&c<12&&(++c,u=u<<1|1)),m=v}else l=o+1,u=(1<<(c=s+1))-1,m=null}return f!==n&&qr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function zy(e){var t,r,n,s,i,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),h=new Array(65535),f=new Array(65535),A=new Array(64),b=new Array(64),m=[],v=0,p=7,g=new Array(64),y=new Array(64),x=new Array(64),w=new Array(256),N=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],M=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function P(B,L){for(var U=0,D=0,Q=new Array,z=1;z<=16;z++){for(var G=1;G<=B[z];G++)Q[L[D]]=[],Q[L[D]][0]=U,Q[L[D]][1]=z,D++,U++;U*=2}return Q}function X(B){for(var L=B[0],U=B[1]-1;U>=0;)L&1<<U&&(v|=1<<p),U--,--p<0&&(v==255?(J(255),J(0)):J(v),p=7,v=0)}function J(B){m.push(B)}function H(B){J(B>>8&255),J(255&B)}function V(B,L,U,D,Q){for(var z,G=Q[0],Z=Q[240],R=function(ye,Le){var Re,we,Pe,ze,Ve,lt,pe,Fe,Ke,Xe,tt=0;for(Ke=0;Ke<8;++Ke){Re=ye[tt],we=ye[tt+1],Pe=ye[tt+2],ze=ye[tt+3],Ve=ye[tt+4],lt=ye[tt+5],pe=ye[tt+6];var st=Re+(Fe=ye[tt+7]),ke=Re-Fe,Ee=we+pe,Je=we-pe,rt=Pe+lt,Ze=Pe-lt,xt=ze+Ve,mt=ze-Ve,bt=st+xt,vt=st-xt,Nt=Ee+rt,Bt=Ee-rt;ye[tt]=bt+Nt,ye[tt+4]=bt-Nt;var tr=.707106781*(Bt+vt);ye[tt+2]=vt+tr,ye[tt+6]=vt-tr;var Ma=.382683433*((bt=mt+Ze)-(Bt=Je+ke)),rr=.5411961*bt+Ma,dn=1.306562965*Bt+Ma,ta=.707106781*(Nt=Ze+Je),Pt=ke+ta,qn=ke-ta;ye[tt+5]=qn+rr,ye[tt+3]=qn-rr,ye[tt+1]=Pt+dn,ye[tt+7]=Pt-dn,tt+=8}for(tt=0,Ke=0;Ke<8;++Ke){Re=ye[tt],we=ye[tt+8],Pe=ye[tt+16],ze=ye[tt+24],Ve=ye[tt+32],lt=ye[tt+40],pe=ye[tt+48];var ra=Re+(Fe=ye[tt+56]),Sn=Re-Fe,ma=we+pe,Ar=we-pe,Cr=Pe+lt,de=Pe-lt,ne=ze+Ve,oe=ze-Ve,ie=ra+ne,xe=ra-ne,me=ma+Cr,Ue=ma-Cr;ye[tt]=ie+me,ye[tt+32]=ie-me;var Qe=.707106781*(Ue+xe);ye[tt+16]=xe+Qe,ye[tt+48]=xe-Qe;var qe=.382683433*((ie=oe+de)-(Ue=Ar+Sn)),Ge=.5411961*ie+qe,Te=1.306562965*Ue+qe,be=.707106781*(me=de+Ar),Me=Sn+be,et=Sn-be;ye[tt+40]=et+Ge,ye[tt+24]=et-Ge,ye[tt+8]=Me+Te,ye[tt+56]=Me-Te,tt++}for(Ke=0;Ke<64;++Ke)Xe=ye[Ke]*Le[Ke],A[Ke]=Xe>0?Xe+.5|0:Xe-.5|0;return A}(B,L),le=0;le<64;++le)b[_[le]]=R[le];var ee=b[0]-U;U=b[0],ee==0?X(D[0]):(X(D[f[z=32767+ee]]),X(h[z]));for(var _e=63;_e>0&&b[_e]==0;)_e--;if(_e==0)return X(G),U;for(var se,te=1;te<=_e;){for(var Ne=te;b[te]==0&&te<=_e;)++te;var Se=te-Ne;if(Se>=16){se=Se>>4;for(var Ae=1;Ae<=se;++Ae)X(Z);Se&=15}z=32767+b[te],X(Q[(Se<<4)+f[z]]),X(h[z]),te++}return _e!=63&&X(G),U}function K(B){B=Math.min(Math.max(B,1),100),i!=B&&(function(L){for(var U=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],D=0;D<64;D++){var Q=o((U[D]*L+50)/100);Q=Math.min(Math.max(Q,1),255),l[_[D]]=Q}for(var z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],G=0;G<64;G++){var Z=o((z[G]*L+50)/100);Z=Math.min(Math.max(Z,1),255),c[_[G]]=Z}for(var R=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],le=0,ee=0;ee<8;ee++)for(var _e=0;_e<8;_e++)u[le]=1/(l[_[le]]*R[ee]*R[_e]*8),d[le]=1/(c[_[le]]*R[ee]*R[_e]*8),le++}(B<50?Math.floor(5e3/B):Math.floor(200-2*B)),i=B)}this.encode=function(B,L){L&&K(L),m=new Array,v=0,p=7,H(65496),H(65504),H(16),J(74),J(70),J(73),J(70),J(0),J(1),J(1),J(0),H(1),H(1),J(0),J(0),function(){H(65499),H(132),J(0);for(var we=0;we<64;we++)J(l[we]);J(1);for(var Pe=0;Pe<64;Pe++)J(c[Pe])}(),function(we,Pe){H(65472),H(17),J(8),H(Pe),H(we),J(3),J(1),J(17),J(0),J(2),J(17),J(1),J(3),J(17),J(1)}(B.width,B.height),function(){H(65476),H(418),J(0);for(var we=0;we<16;we++)J(C[we+1]);for(var Pe=0;Pe<=11;Pe++)J(j[Pe]);J(16);for(var ze=0;ze<16;ze++)J(E[ze+1]);for(var Ve=0;Ve<=161;Ve++)J(S[Ve]);J(1);for(var lt=0;lt<16;lt++)J(F[lt+1]);for(var pe=0;pe<=11;pe++)J(I[pe]);J(17);for(var Fe=0;Fe<16;Fe++)J(O[Fe+1]);for(var Ke=0;Ke<=161;Ke++)J(M[Ke])}(),H(65498),H(12),J(3),J(1),J(0),J(2),J(17),J(3),J(17),J(0),J(63),J(0);var U=0,D=0,Q=0;v=0,p=7,this.encode.displayName="_encode_";for(var z,G,Z,R,le,ee,_e,se,te,Ne=B.data,Se=B.width,Ae=B.height,ye=4*Se,Le=0;Le<Ae;){for(z=0;z<ye;){for(le=ye*Le+z,_e=-1,se=0,te=0;te<64;te++)ee=le+(se=te>>3)*ye+(_e=4*(7&te)),Le+se>=Ae&&(ee-=ye*(Le+1+se-Ae)),z+_e>=ye&&(ee-=z+_e-ye+4),G=Ne[ee++],Z=Ne[ee++],R=Ne[ee++],g[te]=(N[G]+N[Z+256|0]+N[R+512|0]>>16)-128,y[te]=(N[G+768|0]+N[Z+1024|0]+N[R+1280|0]>>16)-128,x[te]=(N[G+1280|0]+N[Z+1536|0]+N[R+1792|0]>>16)-128;U=V(g,u,U,t,n),D=V(y,d,D,r,s),Q=V(x,d,Q,r,s),z+=32}Le+=8}if(p>=0){var Re=[];Re[1]=p+1,Re[0]=(1<<p+1)-1,X(Re)}return H(65497),new Uint8Array(m)},e=e||50,function(){for(var B=String.fromCharCode,L=0;L<256;L++)w[L]=B(L)}(),t=P(C,j),r=P(F,I),n=P(E,S),s=P(O,M),function(){for(var B=1,L=2,U=1;U<=15;U++){for(var D=B;D<L;D++)f[32767+D]=U,h[32767+D]=[],h[32767+D][1]=U,h[32767+D][0]=D;for(var Q=-(L-1);Q<=-B;Q++)f[32767+Q]=U,h[32767+Q]=[],h[32767+Q][1]=U,h[32767+Q][0]=L-1+Q;B<<=1,L<<=1}}(),function(){for(var B=0;B<256;B++)N[B]=19595*B,N[B+256|0]=38470*B,N[B+512|0]=7471*B+32768,N[B+768|0]=-11059*B,N[B+1024|0]=-21709*B,N[B+1280|0]=32768*B+8421375,N[B+1536|0]=-27439*B,N[B+1792|0]=-5329*B}(),K(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Yi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Jj(e){function t(j){if(!j)throw Error("assert :P")}function r(j,E,S){for(var F=0;4>F;F++)if(j[E+F]!=S.charCodeAt(F))return!0;return!1}function n(j,E,S,F,I){for(var O=0;O<I;O++)j[E+O]=S[F+O]}function s(j,E,S,F){for(var I=0;I<F;I++)j[E+I]=S}function i(j){return new Int32Array(j)}function o(j,E){for(var S=[],F=0;F<j;F++)S.push(new E);return S}function l(j,E){var S=[];return function F(I,O,M){for(var P=M[O],X=0;X<P&&(I.push(M.length>O+1?[]:new E),!(M.length<O+1));X++)F(I[X],O+1,M)}(S,0,j),S}var c=function(){var j=this;function E(k,T){for(var Y=1<<T-1>>>0;k&Y;)Y>>>=1;return Y?(k&Y-1)+Y:k}function S(k,T,Y,re,ue){t(!(re%Y));do k[T+(re-=Y)]=ue;while(0<re)}function F(k,T,Y,re,ue){if(t(2328>=ue),512>=ue)var fe=i(512);else if((fe=i(ue))==null)return 0;return function(he,ge,ve,je,Oe,Ye){var Ce,De,$e=ge,at=1<<ve,We=i(16),ot=i(16);for(t(Oe!=0),t(je!=null),t(he!=null),t(0<ve),De=0;De<Oe;++De){if(15<je[De])return 0;++We[je[De]]}if(We[0]==Oe)return 0;for(ot[1]=0,Ce=1;15>Ce;++Ce){if(We[Ce]>1<<Ce)return 0;ot[Ce+1]=ot[Ce]+We[Ce]}for(De=0;De<Oe;++De)Ce=je[De],0<je[De]&&(Ye[ot[Ce]++]=De);if(ot[15]==1)return(je=new I).g=0,je.value=Ye[0],S(he,$e,1,at,je),at;var ut,gt=-1,pt=at-1,Qt=0,Ft=1,ir=1,Ot=1<<ve;for(De=0,Ce=1,Oe=2;Ce<=ve;++Ce,Oe<<=1){if(Ft+=ir<<=1,0>(ir-=We[Ce]))return 0;for(;0<We[Ce];--We[Ce])(je=new I).g=Ce,je.value=Ye[De++],S(he,$e+Qt,Oe,Ot,je),Qt=E(Qt,Ce)}for(Ce=ve+1,Oe=2;15>=Ce;++Ce,Oe<<=1){if(Ft+=ir<<=1,0>(ir-=We[Ce]))return 0;for(;0<We[Ce];--We[Ce]){if(je=new I,(Qt&pt)!=gt){for($e+=Ot,ut=1<<(gt=Ce)-ve;15>gt&&!(0>=(ut-=We[gt]));)++gt,ut<<=1;at+=Ot=1<<(ut=gt-ve),he[ge+(gt=Qt&pt)].g=ut+ve,he[ge+gt].value=$e-ge-gt}je.g=Ce-ve,je.value=Ye[De++],S(he,$e+(Qt>>ve),Oe,Ot,je),Qt=E(Qt,Ce)}}return Ft!=2*ot[15]-1?0:at}(k,T,Y,re,ue,fe)}function I(){this.value=this.g=0}function O(){this.value=this.g=0}function M(){this.G=o(5,I),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(au,O)}function P(k,T,Y,re){t(k!=null),t(T!=null),t(2147483648>re),k.Ca=254,k.I=0,k.b=-8,k.Ka=0,k.oa=T,k.pa=Y,k.Jd=T,k.Yc=Y+re,k.Zc=4<=re?Y+re-4+1:Y,G(k)}function X(k,T){for(var Y=0;0<T--;)Y|=R(k,128)<<T;return Y}function J(k,T){var Y=X(k,T);return Z(k)?-Y:Y}function H(k,T,Y,re){var ue,fe=0;for(t(k!=null),t(T!=null),t(4294967288>re),k.Sb=re,k.Ra=0,k.u=0,k.h=0,4<re&&(re=4),ue=0;ue<re;++ue)fe+=T[Y+ue]<<8*ue;k.Ra=fe,k.bb=re,k.oa=T,k.pa=Y}function V(k){for(;8<=k.u&&k.bb<k.Sb;)k.Ra>>>=8,k.Ra+=k.oa[k.pa+k.bb]<<Hl-8>>>0,++k.bb,k.u-=8;D(k)&&(k.h=1,k.u=0)}function K(k,T){if(t(0<=T),!k.h&&T<=qs){var Y=U(k)&Hs[T];return k.u+=T,V(k),Y}return k.h=1,k.u=0}function B(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function U(k){return k.Ra>>>(k.u&Hl-1)>>>0}function D(k){return t(k.bb<=k.Sb),k.h||k.bb==k.Sb&&k.u>Hl}function Q(k,T){k.u=T,k.h=D(k)}function z(k){k.u>=al&&(t(k.u>=al),V(k))}function G(k){t(k!=null&&k.oa!=null),k.pa<k.Zc?(k.I=(k.oa[k.pa++]|k.I<<8)>>>0,k.b+=8):(t(k!=null&&k.oa!=null),k.pa<k.Yc?(k.b+=8,k.I=k.oa[k.pa++]|k.I<<8):k.Ka?k.b=0:(k.I<<=8,k.b+=8,k.Ka=1))}function Z(k){return X(k,1)}function R(k,T){var Y=k.Ca;0>k.b&&G(k);var re=k.b,ue=Y*T>>>8,fe=(k.I>>>re>ue)+0;for(fe?(Y-=ue,k.I-=ue+1<<re>>>0):Y=ue+1,re=Y,ue=0;256<=re;)ue+=8,re>>=8;return re=7^ue+ql[re],k.b-=re,k.Ca=(Y<<re)-1,fe}function le(k,T,Y){k[T+0]=Y>>24&255,k[T+1]=Y>>16&255,k[T+2]=Y>>8&255,k[T+3]=255&Y}function ee(k,T){return k[T+0]|k[T+1]<<8}function _e(k,T){return ee(k,T)|k[T+2]<<16}function se(k,T){return ee(k,T)|ee(k,T+2)<<16}function te(k,T){var Y=1<<T;return t(k!=null),t(0<T),k.X=i(Y),k.X==null?0:(k.Mb=32-T,k.Xa=T,1)}function Ne(k,T){t(k!=null),t(T!=null),t(k.Xa==T.Xa),n(T.X,0,k.X,0,1<<T.Xa)}function Se(){this.X=[],this.Xa=this.Mb=0}function Ae(k,T,Y,re){t(Y!=null),t(re!=null);var ue=Y[0],fe=re[0];return ue==0&&(ue=(k*fe+T/2)/T),fe==0&&(fe=(T*ue+k/2)/k),0>=ue||0>=fe?0:(Y[0]=ue,re[0]=fe,1)}function ye(k,T){return k+(1<<T)-1>>>T}function Le(k,T){return((4278255360&k)+(4278255360&T)>>>0&4278255360)+((16711935&k)+(16711935&T)>>>0&16711935)>>>0}function Re(k,T){j[T]=function(Y,re,ue,fe,he,ge,ve){var je;for(je=0;je<he;++je){var Oe=j[k](ge[ve+je-1],ue,fe+je);ge[ve+je]=Le(Y[re+je],Oe)}}}function we(){this.ud=this.hd=this.jd=0}function Pe(k,T){return((4278124286&(k^T))>>>1)+(k&T)>>>0}function ze(k){return 0<=k&&256>k?k:0>k?0:255<k?255:void 0}function Ve(k,T){return ze(k+(k-T+.5>>1))}function lt(k,T,Y){return Math.abs(T-Y)-Math.abs(k-Y)}function pe(k,T,Y,re,ue,fe,he){for(re=fe[he-1],Y=0;Y<ue;++Y)fe[he+Y]=re=Le(k[T+Y],re)}function Fe(k,T,Y,re,ue){var fe;for(fe=0;fe<Y;++fe){var he=k[T+fe],ge=he>>8&255,ve=16711935&(ve=(ve=16711935&he)+((ge<<16)+ge));re[ue+fe]=(4278255360&he)+ve>>>0}}function Ke(k,T){T.jd=255&k,T.hd=k>>8&255,T.ud=k>>16&255}function Xe(k,T,Y,re,ue,fe){var he;for(he=0;he<re;++he){var ge=T[Y+he],ve=ge>>>8,je=ge,Oe=255&(Oe=(Oe=ge>>>16)+((k.jd<<24>>24)*(ve<<24>>24)>>>5));je=255&(je=(je+=(k.hd<<24>>24)*(ve<<24>>24)>>>5)+((k.ud<<24>>24)*(Oe<<24>>24)>>>5)),ue[fe+he]=(4278255360&ge)+(Oe<<16)+je}}function tt(k,T,Y,re,ue){j[T]=function(fe,he,ge,ve,je,Oe,Ye,Ce,De){for(ve=Ye;ve<Ce;++ve)for(Ye=0;Ye<De;++Ye)je[Oe++]=ue(ge[re(fe[he++])])},j[k]=function(fe,he,ge,ve,je,Oe,Ye){var Ce=8>>fe.b,De=fe.Ea,$e=fe.K[0],at=fe.w;if(8>Ce)for(fe=(1<<fe.b)-1,at=(1<<Ce)-1;he<ge;++he){var We,ot=0;for(We=0;We<De;++We)We&fe||(ot=re(ve[je++])),Oe[Ye++]=ue($e[ot&at]),ot>>=Ce}else j["VP8LMapColor"+Y](ve,je,$e,at,Oe,Ye,he,ge,De)}}function st(k,T,Y,re,ue){for(Y=T+Y;T<Y;){var fe=k[T++];re[ue++]=fe>>16&255,re[ue++]=fe>>8&255,re[ue++]=255&fe}}function ke(k,T,Y,re,ue){for(Y=T+Y;T<Y;){var fe=k[T++];re[ue++]=fe>>16&255,re[ue++]=fe>>8&255,re[ue++]=255&fe,re[ue++]=fe>>24&255}}function Ee(k,T,Y,re,ue){for(Y=T+Y;T<Y;){var fe=(he=k[T++])>>16&240|he>>12&15,he=240&he|he>>28&15;re[ue++]=fe,re[ue++]=he}}function Je(k,T,Y,re,ue){for(Y=T+Y;T<Y;){var fe=(he=k[T++])>>16&248|he>>13&7,he=he>>5&224|he>>3&31;re[ue++]=fe,re[ue++]=he}}function rt(k,T,Y,re,ue){for(Y=T+Y;T<Y;){var fe=k[T++];re[ue++]=255&fe,re[ue++]=fe>>8&255,re[ue++]=fe>>16&255}}function Ze(k,T,Y,re,ue,fe){if(fe==0)for(Y=T+Y;T<Y;)le(re,((fe=k[T++])[0]>>24|fe[1]>>8&65280|fe[2]<<8&16711680|fe[3]<<24)>>>0),ue+=32;else n(re,ue,k,T,Y)}function xt(k,T){j[T][0]=j[k+"0"],j[T][1]=j[k+"1"],j[T][2]=j[k+"2"],j[T][3]=j[k+"3"],j[T][4]=j[k+"4"],j[T][5]=j[k+"5"],j[T][6]=j[k+"6"],j[T][7]=j[k+"7"],j[T][8]=j[k+"8"],j[T][9]=j[k+"9"],j[T][10]=j[k+"10"],j[T][11]=j[k+"11"],j[T][12]=j[k+"12"],j[T][13]=j[k+"13"],j[T][14]=j[k+"0"],j[T][15]=j[k+"0"]}function mt(k){return k==k1||k==S1||k==ip||k==E1}function bt(){this.eb=[],this.size=this.A=this.fb=0}function vt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Nt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new bt,this.f.kb=new vt,this.sd=null}function Bt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function tr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ma(k){return alert("todo:WebPSamplerProcessPlane"),k.T}function rr(k,T){var Y=k.T,re=T.ba.f.RGBA,ue=re.eb,fe=re.fb+k.ka*re.A,he=vi[T.ba.S],ge=k.y,ve=k.O,je=k.f,Oe=k.N,Ye=k.ea,Ce=k.W,De=T.cc,$e=T.dc,at=T.Mc,We=T.Nc,ot=k.ka,ut=k.ka+k.T,gt=k.U,pt=gt+1>>1;for(ot==0?he(ge,ve,null,null,je,Oe,Ye,Ce,je,Oe,Ye,Ce,ue,fe,null,null,gt):(he(T.ec,T.fc,ge,ve,De,$e,at,We,je,Oe,Ye,Ce,ue,fe-re.A,ue,fe,gt),++Y);ot+2<ut;ot+=2)De=je,$e=Oe,at=Ye,We=Ce,Oe+=k.Rc,Ce+=k.Rc,fe+=2*re.A,he(ge,(ve+=2*k.fa)-k.fa,ge,ve,De,$e,at,We,je,Oe,Ye,Ce,ue,fe-re.A,ue,fe,gt);return ve+=k.fa,k.j+ut<k.o?(n(T.ec,T.fc,ge,ve,gt),n(T.cc,T.dc,je,Oe,pt),n(T.Mc,T.Nc,Ye,Ce,pt),Y--):1&ut||he(ge,ve,null,null,je,Oe,Ye,Ce,je,Oe,Ye,Ce,ue,fe+re.A,null,null,gt),Y}function dn(k,T,Y){var re=k.F,ue=[k.J];if(re!=null){var fe=k.U,he=T.ba.S,ge=he==sp||he==ip;T=T.ba.f.RGBA;var ve=[0],je=k.ka;ve[0]=k.T,k.Kb&&(je==0?--ve[0]:(--je,ue[0]-=k.width),k.j+k.ka+k.T==k.o&&(ve[0]=k.o-k.j-je));var Oe=T.eb;je=T.fb+je*T.A,k=p5(re,ue[0],k.width,fe,ve,Oe,je+(ge?0:3),T.A),t(Y==ve),k&&mt(he)&&yf(Oe,je,ge,fe,ve,T.A)}return 0}function ta(k){var T=k.ma,Y=T.ba.S,re=11>Y,ue=Y==np||Y==ap||Y==sp||Y==B1||Y==12||mt(Y);if(T.memory=null,T.Ib=null,T.Jb=null,T.Nd=null,!df(T.Oa,k,ue?11:12))return 0;if(ue&&mt(Y)&&lf(),k.da)alert("todo:use_scaling");else{if(re){if(T.Ib=Ma,k.Kb){if(Y=k.U+1>>1,T.memory=i(k.U+2*Y),T.memory==null)return 0;T.ec=T.memory,T.fc=0,T.cc=T.ec,T.dc=T.fc+k.U,T.Mc=T.cc,T.Nc=T.dc+Y,T.Ib=rr,lf()}}else alert("todo:EmitYUV");ue&&(T.Jb=dn,re&&Vi())}if(re&&!F5){for(k=0;256>k;++k)SL[k]=89858*(k-128)+lp>>op,TL[k]=-22014*(k-128)+lp,FL[k]=-45773*(k-128),EL[k]=113618*(k-128)+lp>>op;for(k=bf;k<I1;++k)T=76283*(k-16)+lp>>op,IL[k-bf]=vn(T,255),LL[k-bf]=vn(T+8>>4,15);F5=1}return 1}function Pt(k){var T=k.ma,Y=k.U,re=k.T;return t(!(1&k.ka)),0>=Y||0>=re?0:(Y=T.Ib(k,T),T.Jb!=null&&T.Jb(k,T,Y),T.Dc+=Y,1)}function qn(k){k.ma.memory=null}function ra(k,T,Y,re){return K(k,8)!=47?0:(T[0]=K(k,14)+1,Y[0]=K(k,14)+1,re[0]=K(k,1),K(k,3)!=0?0:!k.h)}function Sn(k,T){if(4>k)return k+1;var Y=k-2>>1;return(2+(1&k)<<Y)+K(T,Y)+1}function ma(k,T){return 120<T?T-120:1<=(Y=((Y=pL[T-1])>>4)*k+(8-(15&Y)))?Y:1;var Y}function Ar(k,T,Y){var re=U(Y),ue=k[T+=255&re].g-8;return 0<ue&&(Q(Y,Y.u+8),re=U(Y),T+=k[T].value,T+=re&(1<<ue)-1),Q(Y,Y.u+k[T].g),k[T].value}function Cr(k,T,Y){return Y.g+=k.g,Y.value+=k.value<<T>>>0,t(8>=Y.g),k.g}function de(k,T,Y){var re=k.xc;return t((T=re==0?0:k.vc[k.md*(Y>>re)+(T>>re)])<k.Wb),k.Ya[T]}function ne(k,T,Y,re){var ue=k.ab,fe=k.c*T,he=k.C;T=he+T;var ge=Y,ve=re;for(re=k.Ta,Y=k.Ua;0<ue--;){var je=k.gc[ue],Oe=he,Ye=T,Ce=ge,De=ve,$e=(ve=re,ge=Y,je.Ea);switch(t(Oe<Ye),t(Ye<=je.nc),je.hc){case 2:En(Ce,De,(Ye-Oe)*$e,ve,ge);break;case 0:var at=Oe,We=Ye,ot=ve,ut=ge,gt=(Ot=je).Ea;at==0&&(ff(Ce,De,null,null,1,ot,ut),pe(Ce,De+1,0,0,gt-1,ot,ut+1),De+=gt,ut+=gt,++at);for(var pt=1<<Ot.b,Qt=pt-1,Ft=ye(gt,Ot.b),ir=Ot.K,Ot=Ot.w+(at>>Ot.b)*Ft;at<We;){var mr=ir,ia=Ot,or=1;for(pd(Ce,De,ot,ut-gt,1,ot,ut);or<gt;){var Ut=(or&~Qt)+pt;Ut>gt&&(Ut=gt),(0,pf[mr[ia++]>>8&15])(Ce,De+ +or,ot,ut+or-gt,Ut-or,ot,ut+or),or=Ut}De+=gt,ut+=gt,++at&Qt||(Ot+=Ft)}Ye!=je.nc&&n(ve,ge-$e,ve,ge+(Ye-Oe-1)*$e,$e);break;case 1:for($e=Ce,We=De,gt=(Ce=je.Ea)-(ut=Ce&~(ot=(De=1<<je.b)-1)),at=ye(Ce,je.b),pt=je.K,je=je.w+(Oe>>je.b)*at;Oe<Ye;){for(Qt=pt,Ft=je,ir=new we,Ot=We+ut,mr=We+Ce;We<Ot;)Ke(Qt[Ft++],ir),mf(ir,$e,We,De,ve,ge),We+=De,ge+=De;We<mr&&(Ke(Qt[Ft++],ir),mf(ir,$e,We,gt,ve,ge),We+=gt,ge+=gt),++Oe&ot||(je+=at)}break;case 3:if(Ce==ve&&De==ge&&0<je.b){for(We=ve,Ce=$e=ge+(Ye-Oe)*$e-(ut=(Ye-Oe)*ye(je.Ea,je.b)),De=ve,ot=ge,at=[],ut=(gt=ut)-1;0<=ut;--ut)at[ut]=De[ot+ut];for(ut=gt-1;0<=ut;--ut)We[Ce+ut]=at[ut];Z0(je,Oe,Ye,ve,$e,ve,ge)}else Z0(je,Oe,Ye,Ce,De,ve,ge)}ge=re,ve=Y}ve!=Y&&n(re,Y,ge,ve,fe)}function oe(k,T){var Y=k.V,re=k.Ba+k.c*k.C,ue=T-k.C;if(t(T<=k.l.o),t(16>=ue),0<ue){var fe=k.l,he=k.Ta,ge=k.Ua,ve=fe.width;if(ne(k,ue,Y,re),ue=ge=[ge],t((Y=k.C)<(re=T)),t(fe.v<fe.va),re>fe.o&&(re=fe.o),Y<fe.j){var je=fe.j-Y;Y=fe.j,ue[0]+=je*ve}if(Y>=re?Y=0:(ue[0]+=4*fe.v,fe.ka=Y-fe.j,fe.U=fe.va-fe.v,fe.T=re-Y,Y=1),Y){if(ge=ge[0],11>(Y=k.ca).S){var Oe=Y.f.RGBA,Ye=(re=Y.S,ue=fe.U,fe=fe.T,je=Oe.eb,Oe.A),Ce=fe;for(Oe=Oe.fb+k.Ma*Oe.A;0<Ce--;){var De=he,$e=ge,at=ue,We=je,ot=Oe;switch(re){case rp:gf(De,$e,at,We,ot);break;case np:Kl(De,$e,at,We,ot);break;case k1:Kl(De,$e,at,We,ot),yf(We,ot,0,at,1,0);break;case w5:su(De,$e,at,We,ot);break;case ap:Ze(De,$e,at,We,ot,1);break;case S1:Ze(De,$e,at,We,ot,1),yf(We,ot,0,at,1,0);break;case sp:Ze(De,$e,at,We,ot,0);break;case ip:Ze(De,$e,at,We,ot,0),yf(We,ot,1,at,1,0);break;case B1:$l(De,$e,at,We,ot);break;case E1:$l(De,$e,at,We,ot),h5(We,ot,at,1,0);break;case _5:Vl(De,$e,at,We,ot);break;default:t(0)}ge+=ve,Oe+=Ye}k.Ma+=fe}else alert("todo:EmitRescaledRowsYUVA");t(k.Ma<=Y.height)}}k.C=T,t(k.C<=k.i)}function ie(k){var T;if(0<k.ua)return 0;for(T=0;T<k.Wb;++T){var Y=k.Ya[T].G,re=k.Ya[T].H;if(0<Y[1][re[1]+0].g||0<Y[2][re[2]+0].g||0<Y[3][re[3]+0].g)return 0}return 1}function xe(k,T,Y,re,ue,fe){if(k.Z!=0){var he=k.qd,ge=k.rd;for(t(zl[k.Z]!=null);T<Y;++T)zl[k.Z](he,ge,re,ue,re,ue,fe),he=re,ge=ue,ue+=fe;k.qd=he,k.rd=ge}}function me(k,T){var Y=k.l.ma,re=Y.Z==0||Y.Z==1?k.l.j:k.C;if(re=k.C<re?re:k.C,t(T<=k.l.o),T>re){var ue=k.l.width,fe=Y.ca,he=Y.tb+ue*re,ge=k.V,ve=k.Ba+k.c*re,je=k.gc;t(k.ab==1),t(je[0].hc==3),jo(je[0],re,T,ge,ve,fe,he),xe(Y,re,T,fe,he,ue)}k.C=k.Ma=T}function Ue(k,T,Y,re,ue,fe,he){var ge=k.$/re,ve=k.$%re,je=k.m,Oe=k.s,Ye=Y+k.$,Ce=Ye;ue=Y+re*ue;var De=Y+re*fe,$e=280+Oe.ua,at=k.Pb?ge:16777216,We=0<Oe.ua?Oe.Wa:null,ot=Oe.wc,ut=Ye<De?de(Oe,ve,ge):null;t(k.C<fe),t(De<=ue);var gt=!1;e:for(;;){for(;gt||Ye<De;){var pt=0;if(ge>=at){var Qt=Ye-Y;t((at=k).Pb),at.wd=at.m,at.xd=Qt,0<at.s.ua&&Ne(at.s.Wa,at.s.vb),at=ge+gL}if(ve&ot||(ut=de(Oe,ve,ge)),t(ut!=null),ut.Qb&&(T[Ye]=ut.qb,gt=!0),!gt)if(z(je),ut.jc){pt=je,Qt=T;var Ft=Ye,ir=ut.pd[U(pt)&au-1];t(ut.jc),256>ir.g?(Q(pt,pt.u+ir.g),Qt[Ft]=ir.value,pt=0):(Q(pt,pt.u+ir.g-256),t(256<=ir.value),pt=ir.value),pt==0&&(gt=!0)}else pt=Ar(ut.G[0],ut.H[0],je);if(je.h)break;if(gt||256>pt){if(!gt)if(ut.nd)T[Ye]=(ut.qb|pt<<8)>>>0;else{if(z(je),gt=Ar(ut.G[1],ut.H[1],je),z(je),Qt=Ar(ut.G[2],ut.H[2],je),Ft=Ar(ut.G[3],ut.H[3],je),je.h)break;T[Ye]=(Ft<<24|gt<<16|pt<<8|Qt)>>>0}if(gt=!1,++Ye,++ve>=re&&(ve=0,++ge,he!=null&&ge<=fe&&!(ge%16)&&he(k,ge),We!=null))for(;Ce<Ye;)pt=T[Ce++],We.X[(506832829*pt&4294967295)>>>We.Mb]=pt}else if(280>pt){if(pt=Sn(pt-256,je),Qt=Ar(ut.G[4],ut.H[4],je),z(je),Qt=ma(re,Qt=Sn(Qt,je)),je.h)break;if(Ye-Y<Qt||ue-Ye<pt)break e;for(Ft=0;Ft<pt;++Ft)T[Ye+Ft]=T[Ye+Ft-Qt];for(Ye+=pt,ve+=pt;ve>=re;)ve-=re,++ge,he!=null&&ge<=fe&&!(ge%16)&&he(k,ge);if(t(Ye<=ue),ve&ot&&(ut=de(Oe,ve,ge)),We!=null)for(;Ce<Ye;)pt=T[Ce++],We.X[(506832829*pt&4294967295)>>>We.Mb]=pt}else{if(!(pt<$e))break e;for(gt=pt-280,t(We!=null);Ce<Ye;)pt=T[Ce++],We.X[(506832829*pt&4294967295)>>>We.Mb]=pt;pt=Ye,t(!(gt>>>(Qt=We).Xa)),T[pt]=Qt.X[gt],gt=!0}gt||t(je.h==D(je))}if(k.Pb&&je.h&&Ye<ue)t(k.m.h),k.a=5,k.m=k.wd,k.$=k.xd,0<k.s.ua&&Ne(k.s.vb,k.s.Wa);else{if(je.h)break e;he!=null&&he(k,ge>fe?fe:ge),k.a=0,k.$=Ye-Y}return 1}return k.a=3,0}function Qe(k){t(k!=null),k.vc=null,k.yc=null,k.Ya=null;var T=k.Wa;T!=null&&(T.X=null),k.vb=null,t(k!=null)}function qe(){var k=new Yt;return k==null?null:(k.a=0,k.xb=C5,xt("Predictor","VP8LPredictors"),xt("Predictor","VP8LPredictors_C"),xt("PredictorAdd","VP8LPredictorsAdd"),xt("PredictorAdd","VP8LPredictorsAdd_C"),En=Fe,mf=Xe,gf=st,Kl=ke,$l=Ee,Vl=Je,su=rt,j.VP8LMapColor32b=No,j.VP8LMapColor8b=hf,k)}function Ge(k,T,Y,re,ue){var fe=1,he=[k],ge=[T],ve=re.m,je=re.s,Oe=null,Ye=0;e:for(;;){if(Y)for(;fe&&K(ve,1);){var Ce=he,De=ge,$e=re,at=1,We=$e.m,ot=$e.gc[$e.ab],ut=K(We,2);if($e.Oc&1<<ut)fe=0;else{switch($e.Oc|=1<<ut,ot.hc=ut,ot.Ea=Ce[0],ot.nc=De[0],ot.K=[null],++$e.ab,t(4>=$e.ab),ut){case 0:case 1:ot.b=K(We,3)+2,at=Ge(ye(ot.Ea,ot.b),ye(ot.nc,ot.b),0,$e,ot.K),ot.K=ot.K[0];break;case 3:var gt,pt=K(We,8)+1,Qt=16<pt?0:4<pt?1:2<pt?2:3;if(Ce[0]=ye(ot.Ea,Qt),ot.b=Qt,gt=at=Ge(pt,1,0,$e,ot.K)){var Ft,ir=pt,Ot=ot,mr=1<<(8>>Ot.b),ia=i(mr);if(ia==null)gt=0;else{var or=Ot.K[0],Ut=Ot.w;for(ia[0]=Ot.K[0][0],Ft=1;Ft<1*ir;++Ft)ia[Ft]=Le(or[Ut+Ft],ia[Ft-1]);for(;Ft<4*mr;++Ft)ia[Ft]=0;Ot.K[0]=null,Ot.K[0]=ia,gt=1}}at=gt;break;case 2:break;default:t(0)}fe=at}}if(he=he[0],ge=ge[0],fe&&K(ve,1)&&!(fe=1<=(Ye=K(ve,4))&&11>=Ye)){re.a=3;break e}var jt;if(jt=fe)t:{var Tn,er,gr,Yr=re,ka=he,ds=ge,bn=Ye,Ha=Y,As=Yr.m,oa=Yr.s,yr=[null],Sr=1,wn=0,Er=mL[bn];r:for(;;){if(Ha&&K(As,1)){var Sa=K(As,3)+2,Wi=ye(ka,Sa),In=ye(ds,Sa),Bs=Wi*In;if(!Ge(Wi,In,0,Yr,yr))break r;for(yr=yr[0],oa.xc=Sa,Tn=0;Tn<Bs;++Tn){var Hr=yr[Tn]>>8&65535;yr[Tn]=Hr,Hr>=Sr&&(Sr=Hr+1)}}if(As.h)break r;for(er=0;5>er;++er){var la=N5[er];!er&&0<bn&&(la+=1<<bn),wn<la&&(wn=la)}var $s=o(Sr*Er,I),fs=Sr,Vs=o(fs,M);if(Vs==null)var Gs=null;else t(65536>=fs),Gs=Vs;var ks=i(wn);if(Gs==null||ks==null||$s==null){Yr.a=1;break r}var Ws=$s;for(Tn=gr=0;Tn<Sr;++Tn){var Vr=Gs[Tn],zs=Vr.G,zi=Vr.H,ou=0,ol=1,Ea=0;for(er=0;5>er;++er){la=N5[er],zs[er]=Ws,zi[er]=gr,!er&&0<bn&&(la+=1<<bn);a:{var up,L1=la,dp=Yr,wf=ks,PL=Ws,DL=gr,O1=0,Xl=dp.m,RL=K(Xl,1);if(s(wf,0,0,L1),RL){var QL=K(Xl,1)+1,ML=K(Xl,1),L5=K(Xl,ML==0?1:8);wf[L5]=1,QL==2&&(wf[L5=K(Xl,8)]=1);var Ap=1}else{var O5=i(19),U5=K(Xl,4)+4;if(19<U5){dp.a=3;var fp=0;break a}for(up=0;up<U5;++up)O5[hL[up]]=K(Xl,3);var U1=void 0,_f=void 0,P5=dp,HL=O5,hp=L1,D5=wf,P1=0,Yl=P5.m,R5=8,Q5=o(128,I);n:for(;F(Q5,0,7,HL,19);){if(K(Yl,1)){var qL=2+2*K(Yl,3);if((U1=2+K(Yl,qL))>hp)break n}else U1=hp;for(_f=0;_f<hp&&U1--;){z(Yl);var M5=Q5[0+(127&U(Yl))];Q(Yl,Yl.u+M5.g);var gd=M5.value;if(16>gd)D5[_f++]=gd,gd!=0&&(R5=gd);else{var KL=gd==16,H5=gd-16,$L=AL[H5],q5=K(Yl,dL[H5])+$L;if(_f+q5>hp)break n;for(var VL=KL?R5:0;0<q5--;)D5[_f++]=VL}}P1=1;break n}P1||(P5.a=3),Ap=P1}(Ap=Ap&&!Xl.h)&&(O1=F(PL,DL,8,wf,L1)),Ap&&O1!=0?fp=O1:(dp.a=3,fp=0)}if(fp==0)break r;if(ol&&fL[er]==1&&(ol=Ws[gr].g==0),ou+=Ws[gr].g,gr+=fp,3>=er){var Nf,D1=ks[0];for(Nf=1;Nf<la;++Nf)ks[Nf]>D1&&(D1=ks[Nf]);Ea+=D1}}if(Vr.nd=ol,Vr.Qb=0,ol&&(Vr.qb=(zs[3][zi[3]+0].value<<24|zs[1][zi[1]+0].value<<16|zs[2][zi[2]+0].value)>>>0,ou==0&&256>zs[0][zi[0]+0].value&&(Vr.Qb=1,Vr.qb+=zs[0][zi[0]+0].value<<8)),Vr.jc=!Vr.Qb&&6>Ea,Vr.jc){var pp,ll=Vr;for(pp=0;pp<au;++pp){var Jl=pp,Zl=ll.pd[Jl],mp=ll.G[0][ll.H[0]+Jl];256<=mp.value?(Zl.g=mp.g+256,Zl.value=mp.value):(Zl.g=0,Zl.value=0,Jl>>=Cr(mp,8,Zl),Jl>>=Cr(ll.G[1][ll.H[1]+Jl],16,Zl),Jl>>=Cr(ll.G[2][ll.H[2]+Jl],0,Zl),Cr(ll.G[3][ll.H[3]+Jl],24,Zl))}}}oa.vc=yr,oa.Wb=Sr,oa.Ya=Gs,oa.yc=$s,jt=1;break t}jt=0}if(!(fe=jt)){re.a=3;break e}if(0<Ye){if(je.ua=1<<Ye,!te(je.Wa,Ye)){re.a=1,fe=0;break e}}else je.ua=0;var R1=re,K5=he,GL=ge,Q1=R1.s,M1=Q1.xc;if(R1.c=K5,R1.i=GL,Q1.md=ye(K5,M1),Q1.wc=M1==0?-1:(1<<M1)-1,Y){re.xb=NL;break e}if((Oe=i(he*ge))==null){re.a=1,fe=0;break e}fe=(fe=Ue(re,Oe,0,he,ge,ge,null))&&!ve.h;break e}return fe?(ue!=null?ue[0]=Oe:(t(Oe==null),t(Y)),re.$=0,Y||Qe(je)):Qe(je),fe}function Te(k,T){var Y=k.c*k.i,re=Y+T+16*T;return t(k.c<=T),k.V=i(re),k.V==null?(k.Ta=null,k.Ua=0,k.a=1,0):(k.Ta=k.V,k.Ua=k.Ba+Y+T,1)}function be(k,T){var Y=k.C,re=T-Y,ue=k.V,fe=k.Ba+k.c*Y;for(t(T<=k.l.o);0<re;){var he=16<re?16:re,ge=k.l.ma,ve=k.l.width,je=ve*he,Oe=ge.ca,Ye=ge.tb+ve*Y,Ce=k.Ta,De=k.Ua;ne(k,he,ue,fe),m5(Ce,De,Oe,Ye,je),xe(ge,Y,Y+he,Oe,Ye,ve),re-=he,ue+=he*k.c,Y+=he}t(Y==T),k.C=k.Ma=T}function Me(){this.ub=this.yd=this.td=this.Rb=0}function et(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function dt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function it(){this.Yb=function(){var k=[];return function T(Y,re,ue){for(var fe=ue[re],he=0;he<fe&&(Y.push(ue.length>re+1?[]:0),!(ue.length<re+1));he++)T(Y[he],re+1,ue)}(k,0,[3,11]),k}()}function Ct(){this.jb=i(3),this.Wc=l([4,8],it),this.Xc=l([4,17],it)}function Xt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Vt(){this.ld=this.La=this.dd=this.tc=0}function _r(){this.Na=this.la=0}function ja(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function cr(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Xr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Vt),this.Y=0,this.ya=Array(new cr),this.aa=0,this.l=new ld}function Qr(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Ki(){this.cb=this.a=0,this.sc="",this.m=new B,this.Od=new Me,this.Kc=new et,this.ed=new Xt,this.Qa=new dt,this.Ic=this.$c=this.Aa=0,this.D=new Xr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,B),this.ia=0,this.pb=o(4,ja),this.Pa=new Ct,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Qr),this.Hd=0,this.rb=Array(new _r),this.sb=0,this.wa=Array(new Vt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new cr),this.L=this.aa=0,this.gd=l([4,2],Vt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function vn(k,T){return 0>k?0:k>T?T:k}function ld(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function d1(){var k=new Ki;return k!=null&&(k.a=0,k.sc="OK",k.cb=0,k.Xb=0,vf||(vf=cd)),k}function Kn(k,T,Y){return k.a==0&&(k.a=T,k.sc=Y,k.cb=0),0}function M0(k,T,Y){return 3<=Y&&k[T+0]==157&&k[T+1]==1&&k[T+2]==42}function wo(k,T){if(k==null)return 0;if(k.a=0,k.sc="OK",T==null)return Kn(k,2,"null VP8Io passed to VP8GetHeaders()");var Y=T.data,re=T.w,ue=T.ha;if(4>ue)return Kn(k,7,"Truncated header.");var fe=Y[re+0]|Y[re+1]<<8|Y[re+2]<<16,he=k.Od;if(he.Rb=!(1&fe),he.td=fe>>1&7,he.yd=fe>>4&1,he.ub=fe>>5,3<he.td)return Kn(k,3,"Incorrect keyframe parameters.");if(!he.yd)return Kn(k,4,"Frame not displayable.");re+=3,ue-=3;var ge=k.Kc;if(he.Rb){if(7>ue)return Kn(k,7,"cannot parse picture header");if(!M0(Y,re,ue))return Kn(k,3,"Bad code word");ge.c=16383&(Y[re+4]<<8|Y[re+3]),ge.Td=Y[re+4]>>6,ge.i=16383&(Y[re+6]<<8|Y[re+5]),ge.Ud=Y[re+6]>>6,re+=7,ue-=7,k.za=ge.c+15>>4,k.Ub=ge.i+15>>4,T.width=ge.c,T.height=ge.i,T.Da=0,T.j=0,T.v=0,T.va=T.width,T.o=T.height,T.da=0,T.ib=T.width,T.hb=T.height,T.U=T.width,T.T=T.height,s((fe=k.Pa).jb,0,255,fe.jb.length),t((fe=k.Qa)!=null),fe.Cb=0,fe.Bb=0,fe.Fb=1,s(fe.Zb,0,0,fe.Zb.length),s(fe.Lb,0,0,fe.Lb)}if(he.ub>ue)return Kn(k,7,"bad partition length");P(fe=k.m,Y,re,he.ub),re+=he.ub,ue-=he.ub,he.Rb&&(ge.Ld=Z(fe),ge.Kd=Z(fe)),ge=k.Qa;var ve,je=k.Pa;if(t(fe!=null),t(ge!=null),ge.Cb=Z(fe),ge.Cb){if(ge.Bb=Z(fe),Z(fe)){for(ge.Fb=Z(fe),ve=0;4>ve;++ve)ge.Zb[ve]=Z(fe)?J(fe,7):0;for(ve=0;4>ve;++ve)ge.Lb[ve]=Z(fe)?J(fe,6):0}if(ge.Bb)for(ve=0;3>ve;++ve)je.jb[ve]=Z(fe)?X(fe,8):255}else ge.Bb=0;if(fe.Ka)return Kn(k,3,"cannot parse segment header");if((ge=k.ed).zd=Z(fe),ge.Tb=X(fe,6),ge.wb=X(fe,3),ge.Pc=Z(fe),ge.Pc&&Z(fe)){for(je=0;4>je;++je)Z(fe)&&(ge.vd[je]=J(fe,6));for(je=0;4>je;++je)Z(fe)&&(ge.od[je]=J(fe,6))}if(k.L=ge.Tb==0?0:ge.zd?1:2,fe.Ka)return Kn(k,3,"cannot parse filter header");var Oe=ue;if(ue=ve=re,re=ve+Oe,ge=Oe,k.Xb=(1<<X(k.m,2))-1,Oe<3*(je=k.Xb))Y=7;else{for(ve+=3*je,ge-=3*je,Oe=0;Oe<je;++Oe){var Ye=Y[ue+0]|Y[ue+1]<<8|Y[ue+2]<<16;Ye>ge&&(Ye=ge),P(k.Jc[+Oe],Y,ve,Ye),ve+=Ye,ge-=Ye,ue+=3}P(k.Jc[+je],Y,ve,ge),Y=ve<re?0:5}if(Y!=0)return Kn(k,Y,"cannot parse partitions");for(Y=X(ve=k.m,7),ue=Z(ve)?J(ve,4):0,re=Z(ve)?J(ve,4):0,ge=Z(ve)?J(ve,4):0,je=Z(ve)?J(ve,4):0,ve=Z(ve)?J(ve,4):0,Oe=k.Qa,Ye=0;4>Ye;++Ye){if(Oe.Cb){var Ce=Oe.Zb[Ye];Oe.Fb||(Ce+=Y)}else{if(0<Ye){k.pb[Ye]=k.pb[0];continue}Ce=Y}var De=k.pb[Ye];De.Sc[0]=F1[vn(Ce+ue,127)],De.Sc[1]=T1[vn(Ce+0,127)],De.Eb[0]=2*F1[vn(Ce+re,127)],De.Eb[1]=101581*T1[vn(Ce+ge,127)]>>16,8>De.Eb[1]&&(De.Eb[1]=8),De.Qc[0]=F1[vn(Ce+je,117)],De.Qc[1]=T1[vn(Ce+ve,127)],De.lc=Ce+ve}if(!he.Rb)return Kn(k,4,"Not a key frame.");for(Z(fe),he=k.Pa,Y=0;4>Y;++Y){for(ue=0;8>ue;++ue)for(re=0;3>re;++re)for(ge=0;11>ge;++ge)je=R(fe,wL[Y][ue][re][ge])?X(fe,8):vL[Y][ue][re][ge],he.Wc[Y][ue].Yb[re][ge]=je;for(ue=0;17>ue;++ue)he.Xc[Y][ue]=he.Wc[Y][_L[ue]]}return k.kc=Z(fe),k.kc&&(k.Bd=X(fe,8)),k.cb=1}function cd(k,T,Y,re,ue,fe,he){var ge=T[ue].Yb[Y];for(Y=0;16>ue;++ue){if(!R(k,ge[Y+0]))return ue;for(;!R(k,ge[Y+1]);)if(ge=T[++ue].Yb[0],Y=0,ue==16)return 16;var ve=T[ue+1].Yb;if(R(k,ge[Y+2])){var je=k,Oe=0;if(R(je,(Ce=ge)[(Ye=Y)+3]))if(R(je,Ce[Ye+6])){for(ge=0,Ye=2*(Oe=R(je,Ce[Ye+8]))+(Ce=R(je,Ce[Ye+9+Oe])),Oe=0,Ce=xL[Ye];Ce[ge];++ge)Oe+=Oe+R(je,Ce[ge]);Oe+=3+(8<<Ye)}else R(je,Ce[Ye+7])?(Oe=7+2*R(je,165),Oe+=R(je,145)):Oe=5+R(je,159);else Oe=R(je,Ce[Ye+4])?3+R(je,Ce[Ye+5]):2;ge=ve[2]}else Oe=1,ge=ve[1];ve=he+yL[ue],0>(je=k).b&&G(je);var Ye,Ce=je.b,De=(Ye=je.Ca>>1)-(je.I>>Ce)>>31;--je.b,je.Ca+=De,je.Ca|=1,je.I-=(Ye+1&De)<<Ce,fe[ve]=((Oe^De)-De)*re[(0<ue)+0]}return 16}function H0(k){var T=k.rb[k.sb-1];T.la=0,T.Na=0,s(k.zc,0,0,k.zc.length),k.ja=0}function mi(k,T,Y,re,ue){ue=k[T+Y+32*re]+(ue>>3),k[T+Y+32*re]=-256&ue?0>ue?0:255:ue}function na(k,T,Y,re,ue,fe){mi(k,T,0,Y,re+ue),mi(k,T,1,Y,re+fe),mi(k,T,2,Y,re-fe),mi(k,T,3,Y,re-ue)}function Wo(k){return(20091*k>>16)+k}function q0(k,T,Y,re){var ue,fe=0,he=i(16);for(ue=0;4>ue;++ue){var ge=k[T+0]+k[T+8],ve=k[T+0]-k[T+8],je=(35468*k[T+4]>>16)-Wo(k[T+12]),Oe=Wo(k[T+4])+(35468*k[T+12]>>16);he[fe+0]=ge+Oe,he[fe+1]=ve+je,he[fe+2]=ve-je,he[fe+3]=ge-Oe,fe+=4,T++}for(ue=fe=0;4>ue;++ue)ge=(k=he[fe+0]+4)+he[fe+8],ve=k-he[fe+8],je=(35468*he[fe+4]>>16)-Wo(he[fe+12]),mi(Y,re,0,0,ge+(Oe=Wo(he[fe+4])+(35468*he[fe+12]>>16))),mi(Y,re,1,0,ve+je),mi(Y,re,2,0,ve-je),mi(Y,re,3,0,ge-Oe),fe++,re+=32}function A1(k,T,Y,re){var ue=k[T+0]+4,fe=35468*k[T+4]>>16,he=Wo(k[T+4]),ge=35468*k[T+1]>>16;na(Y,re,0,ue+he,k=Wo(k[T+1]),ge),na(Y,re,1,ue+fe,k,ge),na(Y,re,2,ue-fe,k,ge),na(Y,re,3,ue-he,k,ge)}function f1(k,T,Y,re,ue){q0(k,T,Y,re),ue&&q0(k,T+16,Y,re+4)}function _o(k,T,Y,re){iu(k,T+0,Y,re,1),iu(k,T+32,Y,re+128,1)}function K0(k,T,Y,re){var ue;for(k=k[T+0]+4,ue=0;4>ue;++ue)for(T=0;4>T;++T)mi(Y,re,T,ue,k)}function $0(k,T,Y,re){k[T+0]&&Br(k,T+0,Y,re),k[T+16]&&Br(k,T+16,Y,re+4),k[T+32]&&Br(k,T+32,Y,re+128),k[T+48]&&Br(k,T+48,Y,re+128+4)}function ud(k,T,Y,re){var ue,fe=i(16);for(ue=0;4>ue;++ue){var he=k[T+0+ue]+k[T+12+ue],ge=k[T+4+ue]+k[T+8+ue],ve=k[T+4+ue]-k[T+8+ue],je=k[T+0+ue]-k[T+12+ue];fe[0+ue]=he+ge,fe[8+ue]=he-ge,fe[4+ue]=je+ve,fe[12+ue]=je-ve}for(ue=0;4>ue;++ue)he=(k=fe[0+4*ue]+3)+fe[3+4*ue],ge=fe[1+4*ue]+fe[2+4*ue],ve=fe[1+4*ue]-fe[2+4*ue],je=k-fe[3+4*ue],Y[re+0]=he+ge>>3,Y[re+16]=je+ve>>3,Y[re+32]=he-ge>>3,Y[re+48]=je-ve>>3,re+=64}function Wc(k,T,Y){var re,ue=T-32,fe=Ks,he=255-k[ue-1];for(re=0;re<Y;++re){var ge,ve=fe,je=he+k[T-1];for(ge=0;ge<Y;++ge)k[T+ge]=ve[je+k[ue+ge]];T+=32}}function h1(k,T){Wc(k,T,4)}function p1(k,T){Wc(k,T,8)}function m1(k,T){Wc(k,T,16)}function ZA(k,T){var Y;for(Y=0;16>Y;++Y)n(k,T+32*Y,k,T-32,16)}function V0(k,T){var Y;for(Y=16;0<Y;--Y)s(k,T,k[T-1],16),T+=32}function $i(k,T,Y){var re;for(re=0;16>re;++re)s(T,Y+32*re,k,16)}function g1(k,T){var Y,re=16;for(Y=0;16>Y;++Y)re+=k[T-1+32*Y]+k[T+Y-32];$i(re>>5,k,T)}function zc(k,T){var Y,re=8;for(Y=0;16>Y;++Y)re+=k[T-1+32*Y];$i(re>>4,k,T)}function ef(k,T){var Y,re=8;for(Y=0;16>Y;++Y)re+=k[T+Y-32];$i(re>>4,k,T)}function x1(k,T){$i(128,k,T)}function Jt(k,T,Y){return k+2*T+Y+2>>2}function y1(k,T){var Y,re=T-32;for(re=new Uint8Array([Jt(k[re-1],k[re+0],k[re+1]),Jt(k[re+0],k[re+1],k[re+2]),Jt(k[re+1],k[re+2],k[re+3]),Jt(k[re+2],k[re+3],k[re+4])]),Y=0;4>Y;++Y)n(k,T+32*Y,re,0,re.length)}function v1(k,T){var Y=k[T-1],re=k[T-1+32],ue=k[T-1+64],fe=k[T-1+96];le(k,T+0,16843009*Jt(k[T-1-32],Y,re)),le(k,T+32,16843009*Jt(Y,re,ue)),le(k,T+64,16843009*Jt(re,ue,fe)),le(k,T+96,16843009*Jt(ue,fe,fe))}function b1(k,T){var Y,re=4;for(Y=0;4>Y;++Y)re+=k[T+Y-32]+k[T-1+32*Y];for(re>>=3,Y=0;4>Y;++Y)s(k,T+32*Y,re,4)}function zo(k,T){var Y=k[T-1+0],re=k[T-1+32],ue=k[T-1+64],fe=k[T-1-32],he=k[T+0-32],ge=k[T+1-32],ve=k[T+2-32],je=k[T+3-32];k[T+0+96]=Jt(re,ue,k[T-1+96]),k[T+1+96]=k[T+0+64]=Jt(Y,re,ue),k[T+2+96]=k[T+1+64]=k[T+0+32]=Jt(fe,Y,re),k[T+3+96]=k[T+2+64]=k[T+1+32]=k[T+0+0]=Jt(he,fe,Y),k[T+3+64]=k[T+2+32]=k[T+1+0]=Jt(ge,he,fe),k[T+3+32]=k[T+2+0]=Jt(ve,ge,he),k[T+3+0]=Jt(je,ve,ge)}function Xo(k,T){var Y=k[T+1-32],re=k[T+2-32],ue=k[T+3-32],fe=k[T+4-32],he=k[T+5-32],ge=k[T+6-32],ve=k[T+7-32];k[T+0+0]=Jt(k[T+0-32],Y,re),k[T+1+0]=k[T+0+32]=Jt(Y,re,ue),k[T+2+0]=k[T+1+32]=k[T+0+64]=Jt(re,ue,fe),k[T+3+0]=k[T+2+32]=k[T+1+64]=k[T+0+96]=Jt(ue,fe,he),k[T+3+32]=k[T+2+64]=k[T+1+96]=Jt(fe,he,ge),k[T+3+64]=k[T+2+96]=Jt(he,ge,ve),k[T+3+96]=Jt(ge,ve,ve)}function w1(k,T){var Y=k[T-1+0],re=k[T-1+32],ue=k[T-1+64],fe=k[T-1-32],he=k[T+0-32],ge=k[T+1-32],ve=k[T+2-32],je=k[T+3-32];k[T+0+0]=k[T+1+64]=fe+he+1>>1,k[T+1+0]=k[T+2+64]=he+ge+1>>1,k[T+2+0]=k[T+3+64]=ge+ve+1>>1,k[T+3+0]=ve+je+1>>1,k[T+0+96]=Jt(ue,re,Y),k[T+0+64]=Jt(re,Y,fe),k[T+0+32]=k[T+1+96]=Jt(Y,fe,he),k[T+1+32]=k[T+2+96]=Jt(fe,he,ge),k[T+2+32]=k[T+3+96]=Jt(he,ge,ve),k[T+3+32]=Jt(ge,ve,je)}function _1(k,T){var Y=k[T+0-32],re=k[T+1-32],ue=k[T+2-32],fe=k[T+3-32],he=k[T+4-32],ge=k[T+5-32],ve=k[T+6-32],je=k[T+7-32];k[T+0+0]=Y+re+1>>1,k[T+1+0]=k[T+0+64]=re+ue+1>>1,k[T+2+0]=k[T+1+64]=ue+fe+1>>1,k[T+3+0]=k[T+2+64]=fe+he+1>>1,k[T+0+32]=Jt(Y,re,ue),k[T+1+32]=k[T+0+96]=Jt(re,ue,fe),k[T+2+32]=k[T+1+96]=Jt(ue,fe,he),k[T+3+32]=k[T+2+96]=Jt(fe,he,ge),k[T+3+64]=Jt(he,ge,ve),k[T+3+96]=Jt(ge,ve,je)}function dd(k,T){var Y=k[T-1+0],re=k[T-1+32],ue=k[T-1+64],fe=k[T-1+96];k[T+0+0]=Y+re+1>>1,k[T+2+0]=k[T+0+32]=re+ue+1>>1,k[T+2+32]=k[T+0+64]=ue+fe+1>>1,k[T+1+0]=Jt(Y,re,ue),k[T+3+0]=k[T+1+32]=Jt(re,ue,fe),k[T+3+32]=k[T+1+64]=Jt(ue,fe,fe),k[T+3+64]=k[T+2+64]=k[T+0+96]=k[T+1+96]=k[T+2+96]=k[T+3+96]=fe}function tf(k,T){var Y=k[T-1+0],re=k[T-1+32],ue=k[T-1+64],fe=k[T-1+96],he=k[T-1-32],ge=k[T+0-32],ve=k[T+1-32],je=k[T+2-32];k[T+0+0]=k[T+2+32]=Y+he+1>>1,k[T+0+32]=k[T+2+64]=re+Y+1>>1,k[T+0+64]=k[T+2+96]=ue+re+1>>1,k[T+0+96]=fe+ue+1>>1,k[T+3+0]=Jt(ge,ve,je),k[T+2+0]=Jt(he,ge,ve),k[T+1+0]=k[T+3+32]=Jt(Y,he,ge),k[T+1+32]=k[T+3+64]=Jt(re,Y,he),k[T+1+64]=k[T+3+96]=Jt(ue,re,Y),k[T+1+96]=Jt(fe,ue,re)}function Xc(k,T){var Y;for(Y=0;8>Y;++Y)n(k,T+32*Y,k,T-32,8)}function N1(k,T){var Y;for(Y=0;8>Y;++Y)s(k,T,k[T-1],8),T+=32}function Yo(k,T,Y){var re;for(re=0;8>re;++re)s(T,Y+32*re,k,8)}function j1(k,T){var Y,re=8;for(Y=0;8>Y;++Y)re+=k[T+Y-32]+k[T-1+32*Y];Yo(re>>4,k,T)}function rf(k,T){var Y,re=4;for(Y=0;8>Y;++Y)re+=k[T+Y-32];Yo(re>>3,k,T)}function nf(k,T){var Y,re=4;for(Y=0;8>Y;++Y)re+=k[T-1+32*Y];Yo(re>>3,k,T)}function G0(k,T){Yo(128,k,T)}function Jo(k,T,Y){var re=k[T-Y],ue=k[T+0],fe=3*(ue-re)+C1[1020+k[T-2*Y]-k[T+Y]],he=tp[112+(fe+4>>3)];k[T-Y]=Ks[255+re+tp[112+(fe+3>>3)]],k[T+0]=Ks[255+ue-he]}function af(k,T,Y,re){var ue=k[T+0],fe=k[T+Y];return yi[255+k[T-2*Y]-k[T-Y]]>re||yi[255+fe-ue]>re}function Ad(k,T,Y,re){return 4*yi[255+k[T-Y]-k[T+0]]+yi[255+k[T-2*Y]-k[T+Y]]<=re}function sf(k,T,Y,re,ue){var fe=k[T-3*Y],he=k[T-2*Y],ge=k[T-Y],ve=k[T+0],je=k[T+Y],Oe=k[T+2*Y],Ye=k[T+3*Y];return 4*yi[255+ge-ve]+yi[255+he-je]>re?0:yi[255+k[T-4*Y]-fe]<=ue&&yi[255+fe-he]<=ue&&yi[255+he-ge]<=ue&&yi[255+Ye-Oe]<=ue&&yi[255+Oe-je]<=ue&&yi[255+je-ve]<=ue}function Yc(k,T,Y,re){var ue=2*re+1;for(re=0;16>re;++re)Ad(k,T+re,Y,ue)&&Jo(k,T+re,Y)}function of(k,T,Y,re){var ue=2*re+1;for(re=0;16>re;++re)Ad(k,T+re*Y,1,ue)&&Jo(k,T+re*Y,1)}function W0(k,T,Y,re){var ue;for(ue=3;0<ue;--ue)Yc(k,T+=4*Y,Y,re)}function z0(k,T,Y,re){var ue;for(ue=3;0<ue;--ue)of(k,T+=4,Y,re)}function Zo(k,T,Y,re,ue,fe,he,ge){for(fe=2*fe+1;0<ue--;){if(sf(k,T,Y,fe,he))if(af(k,T,Y,ge))Jo(k,T,Y);else{var ve=k,je=T,Oe=Y,Ye=ve[je-2*Oe],Ce=ve[je-Oe],De=ve[je+0],$e=ve[je+Oe],at=ve[je+2*Oe],We=27*(ut=C1[1020+3*(De-Ce)+C1[1020+Ye-$e]])+63>>7,ot=18*ut+63>>7,ut=9*ut+63>>7;ve[je-3*Oe]=Ks[255+ve[je-3*Oe]+ut],ve[je-2*Oe]=Ks[255+Ye+ot],ve[je-Oe]=Ks[255+Ce+We],ve[je+0]=Ks[255+De-We],ve[je+Oe]=Ks[255+$e-ot],ve[je+2*Oe]=Ks[255+at-ut]}T+=re}}function el(k,T,Y,re,ue,fe,he,ge){for(fe=2*fe+1;0<ue--;){if(sf(k,T,Y,fe,he))if(af(k,T,Y,ge))Jo(k,T,Y);else{var ve=k,je=T,Oe=Y,Ye=ve[je-Oe],Ce=ve[je+0],De=ve[je+Oe],$e=tp[112+(4+(at=3*(Ce-Ye))>>3)],at=tp[112+(at+3>>3)],We=$e+1>>1;ve[je-2*Oe]=Ks[255+ve[je-2*Oe]+We],ve[je-Oe]=Ks[255+Ye+at],ve[je+0]=Ks[255+Ce-$e],ve[je+Oe]=Ks[255+De-We]}T+=re}}function X0(k,T,Y,re,ue,fe){Zo(k,T,Y,1,16,re,ue,fe)}function Jc(k,T,Y,re,ue,fe){Zo(k,T,1,Y,16,re,ue,fe)}function Y0(k,T,Y,re,ue,fe){var he;for(he=3;0<he;--he)el(k,T+=4*Y,Y,1,16,re,ue,fe)}function q(k,T,Y,re,ue,fe){var he;for(he=3;0<he;--he)el(k,T+=4,1,Y,16,re,ue,fe)}function ce(k,T,Y,re,ue,fe,he,ge){Zo(k,T,ue,1,8,fe,he,ge),Zo(Y,re,ue,1,8,fe,he,ge)}function Be(k,T,Y,re,ue,fe,he,ge){Zo(k,T,1,ue,8,fe,he,ge),Zo(Y,re,1,ue,8,fe,he,ge)}function Ie(k,T,Y,re,ue,fe,he,ge){el(k,T+4*ue,ue,1,8,fe,he,ge),el(Y,re+4*ue,ue,1,8,fe,he,ge)}function He(k,T,Y,re,ue,fe,he,ge){el(k,T+4,1,ue,8,fe,he,ge),el(Y,re+4,1,ue,8,fe,he,ge)}function ct(){this.ba=new Nt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new tr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ht(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function It(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Rt(){this.ua=0,this.Wa=new Se,this.vb=new Se,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new M,this.yc=new I}function Yt(){this.xb=this.a=0,this.l=new ld,this.ca=new Nt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Rt,this.ab=0,this.gc=o(4,It),this.Oc=0}function nr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ld,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function xr(k,T,Y,re,ue,fe,he){for(k=k==null?0:k[T+0],T=0;T<he;++T)ue[fe+T]=k+Y[re+T]&255,k=ue[fe+T]}function An(k,T,Y,re,ue,fe,he){var ge;if(k==null)xr(null,null,Y,re,ue,fe,he);else for(ge=0;ge<he;++ge)ue[fe+ge]=k[T+ge]+Y[re+ge]&255}function $n(k,T,Y,re,ue,fe,he){if(k==null)xr(null,null,Y,re,ue,fe,he);else{var ge,ve=k[T+0],je=ve,Oe=ve;for(ge=0;ge<he;++ge)je=Oe+(ve=k[T+ge])-je,Oe=Y[re+ge]+(-256&je?0>je?0:255:je)&255,je=ve,ue[fe+ge]=Oe}}function $r(k,T,Y,re){var ue=T.width,fe=T.o;if(t(k!=null&&T!=null),0>Y||0>=re||Y+re>fe)return null;if(!k.Cc){if(k.ga==null){var he;if(k.ga=new nr,(he=k.ga==null)||(he=T.width*T.o,t(k.Gb.length==0),k.Gb=i(he),k.Uc=0,k.Gb==null?he=0:(k.mb=k.Gb,k.nb=k.Uc,k.rc=null,he=1),he=!he),!he){he=k.ga;var ge=k.Fa,ve=k.P,je=k.qc,Oe=k.mb,Ye=k.nb,Ce=ve+1,De=je-1,$e=he.l;if(t(ge!=null&&Oe!=null&&T!=null),zl[0]=null,zl[1]=xr,zl[2]=An,zl[3]=$n,he.ca=Oe,he.tb=Ye,he.c=T.width,he.i=T.height,t(0<he.c&&0<he.i),1>=je)T=0;else if(he.$a=3&ge[ve+0],he.Z=ge[ve+0]>>2&3,he.Lc=ge[ve+0]>>4&3,ve=ge[ve+0]>>6&3,0>he.$a||1<he.$a||4<=he.Z||1<he.Lc||ve)T=0;else if($e.put=Pt,$e.ac=ta,$e.bc=qn,$e.ma=he,$e.width=T.width,$e.height=T.height,$e.Da=T.Da,$e.v=T.v,$e.va=T.va,$e.j=T.j,$e.o=T.o,he.$a)e:{t(he.$a==1),T=qe();t:for(;;){if(T==null){T=0;break e}if(t(he!=null),he.mc=T,T.c=he.c,T.i=he.i,T.l=he.l,T.l.ma=he,T.l.width=he.c,T.l.height=he.i,T.a=0,H(T.m,ge,Ce,De),!Ge(he.c,he.i,1,T,null)||(T.ab==1&&T.gc[0].hc==3&&ie(T.s)?(he.ic=1,ge=T.c*T.i,T.Ta=null,T.Ua=0,T.V=i(ge),T.Ba=0,T.V==null?(T.a=1,T=0):T=1):(he.ic=0,T=Te(T,he.c)),!T))break t;T=1;break e}he.mc=null,T=0}else T=De>=he.c*he.i;he=!T}if(he)return null;k.ga.Lc!=1?k.Ga=0:re=fe-Y}t(k.ga!=null),t(Y+re<=fe);e:{if(T=(ge=k.ga).c,fe=ge.l.o,ge.$a==0){if(Ce=k.rc,De=k.Vc,$e=k.Fa,ve=k.P+1+Y*T,je=k.mb,Oe=k.nb+Y*T,t(ve<=k.P+k.qc),ge.Z!=0)for(t(zl[ge.Z]!=null),he=0;he<re;++he)zl[ge.Z](Ce,De,$e,ve,je,Oe,T),Ce=je,De=Oe,Oe+=T,ve+=T;else for(he=0;he<re;++he)n(je,Oe,$e,ve,T),Ce=je,De=Oe,Oe+=T,ve+=T;k.rc=Ce,k.Vc=De}else{if(t(ge.mc!=null),T=Y+re,t((he=ge.mc)!=null),t(T<=he.i),he.C>=T)T=1;else if(ge.ic||Vi(),ge.ic){ge=he.V,Ce=he.Ba,De=he.c;var at=he.i,We=($e=1,ve=he.$/De,je=he.$%De,Oe=he.m,Ye=he.s,he.$),ot=De*at,ut=De*T,gt=Ye.wc,pt=We<ut?de(Ye,je,ve):null;t(We<=ot),t(T<=at),t(ie(Ye));t:for(;;){for(;!Oe.h&&We<ut;){if(je&gt||(pt=de(Ye,je,ve)),t(pt!=null),z(Oe),256>(at=Ar(pt.G[0],pt.H[0],Oe)))ge[Ce+We]=at,++We,++je>=De&&(je=0,++ve<=T&&!(ve%16)&&me(he,ve));else{if(!(280>at)){$e=0;break t}at=Sn(at-256,Oe);var Qt,Ft=Ar(pt.G[4],pt.H[4],Oe);if(z(Oe),!(We>=(Ft=ma(De,Ft=Sn(Ft,Oe)))&&ot-We>=at)){$e=0;break t}for(Qt=0;Qt<at;++Qt)ge[Ce+We+Qt]=ge[Ce+We+Qt-Ft];for(We+=at,je+=at;je>=De;)je-=De,++ve<=T&&!(ve%16)&&me(he,ve);We<ut&&je&gt&&(pt=de(Ye,je,ve))}t(Oe.h==D(Oe))}me(he,ve>T?T:ve);break t}!$e||Oe.h&&We<ot?($e=0,he.a=Oe.h?5:3):he.$=We,T=$e}else T=Ue(he,he.V,he.Ba,he.c,he.i,T,be);if(!T){re=0;break e}}Y+re>=fe&&(k.Cc=1),re=1}if(!re)return null;if(k.Cc&&((re=k.ga)!=null&&(re.mc=null),k.ga=null,0<k.Ga))return alert("todo:WebPDequantizeLevels"),null}return k.nb+Y*ue}function aa(k,T,Y,re,ue,fe){for(;0<ue--;){var he,ge=k,ve=T+(Y?1:0),je=k,Oe=T+(Y?0:3);for(he=0;he<re;++he){var Ye=je[Oe+4*he];Ye!=255&&(Ye*=32897,ge[ve+4*he+0]=ge[ve+4*he+0]*Ye>>23,ge[ve+4*he+1]=ge[ve+4*he+1]*Ye>>23,ge[ve+4*he+2]=ge[ve+4*he+2]*Ye>>23)}T+=fe}}function Vn(k,T,Y,re,ue){for(;0<re--;){var fe;for(fe=0;fe<Y;++fe){var he=k[T+2*fe+0],ge=15&(je=k[T+2*fe+1]),ve=4369*ge,je=(240&je|je>>4)*ve>>16;k[T+2*fe+0]=(240&he|he>>4)*ve>>16&240|(15&he|he<<4)*ve>>16>>4&15,k[T+2*fe+1]=240&je|ge}T+=ue}}function Ca(k,T,Y,re,ue,fe,he,ge){var ve,je,Oe=255;for(je=0;je<ue;++je){for(ve=0;ve<re;++ve){var Ye=k[T+ve];fe[he+4*ve]=Ye,Oe&=Ye}T+=Y,he+=ge}return Oe!=255}function tl(k,T,Y,re,ue){var fe;for(fe=0;fe<ue;++fe)Y[re+fe]=k[T+fe]>>8}function Vi(){yf=aa,h5=Vn,p5=Ca,m5=tl}function rl(k,T,Y){j[k]=function(re,ue,fe,he,ge,ve,je,Oe,Ye,Ce,De,$e,at,We,ot,ut,gt){var pt,Qt=gt-1>>1,Ft=ge[ve+0]|je[Oe+0]<<16,ir=Ye[Ce+0]|De[$e+0]<<16;t(re!=null);var Ot=3*Ft+ir+131074>>2;for(T(re[ue+0],255&Ot,Ot>>16,at,We),fe!=null&&(Ot=3*ir+Ft+131074>>2,T(fe[he+0],255&Ot,Ot>>16,ot,ut)),pt=1;pt<=Qt;++pt){var mr=ge[ve+pt]|je[Oe+pt]<<16,ia=Ye[Ce+pt]|De[$e+pt]<<16,or=Ft+mr+ir+ia+524296,Ut=or+2*(mr+ir)>>3;Ot=Ut+Ft>>1,Ft=(or=or+2*(Ft+ia)>>3)+mr>>1,T(re[ue+2*pt-1],255&Ot,Ot>>16,at,We+(2*pt-1)*Y),T(re[ue+2*pt-0],255&Ft,Ft>>16,at,We+(2*pt-0)*Y),fe!=null&&(Ot=or+ir>>1,Ft=Ut+ia>>1,T(fe[he+2*pt-1],255&Ot,Ot>>16,ot,ut+(2*pt-1)*Y),T(fe[he+2*pt+0],255&Ft,Ft>>16,ot,ut+(2*pt+0)*Y)),Ft=mr,ir=ia}1&gt||(Ot=3*Ft+ir+131074>>2,T(re[ue+gt-1],255&Ot,Ot>>16,at,We+(gt-1)*Y),fe!=null&&(Ot=3*ir+Ft+131074>>2,T(fe[he+gt-1],255&Ot,Ot>>16,ot,ut+(gt-1)*Y)))}}function lf(){vi[rp]=jL,vi[np]=B5,vi[w5]=CL,vi[ap]=k5,vi[sp]=S5,vi[B1]=E5,vi[_5]=BL,vi[k1]=B5,vi[S1]=k5,vi[ip]=S5,vi[E1]=E5}function fd(k){return k&-16384?0>k?0:255:k>>kL}function Rl(k,T){return fd((19077*k>>8)+(26149*T>>8)-14234)}function Zc(k,T,Y){return fd((19077*k>>8)-(6419*T>>8)-(13320*Y>>8)+8708)}function eu(k,T){return fd((19077*k>>8)+(33050*T>>8)-17685)}function Ql(k,T,Y,re,ue){re[ue+0]=Rl(k,Y),re[ue+1]=Zc(k,T,Y),re[ue+2]=eu(k,T)}function Ba(k,T,Y,re,ue){re[ue+0]=eu(k,T),re[ue+1]=Zc(k,T,Y),re[ue+2]=Rl(k,Y)}function tu(k,T,Y,re,ue){var fe=Zc(k,T,Y);T=fe<<3&224|eu(k,T)>>3,re[ue+0]=248&Rl(k,Y)|fe>>5,re[ue+1]=T}function ru(k,T,Y,re,ue){var fe=240&eu(k,T)|15;re[ue+0]=240&Rl(k,Y)|Zc(k,T,Y)>>4,re[ue+1]=fe}function cf(k,T,Y,re,ue){re[ue+0]=255,Ql(k,T,Y,re,ue+1)}function uf(k,T,Y,re,ue){Ba(k,T,Y,re,ue),re[ue+3]=255}function us(k,T,Y,re,ue){Ql(k,T,Y,re,ue),re[ue+3]=255}function nl(k,T,Y){j[k]=function(re,ue,fe,he,ge,ve,je,Oe,Ye){for(var Ce=Oe+(-2&Ye)*Y;Oe!=Ce;)T(re[ue+0],fe[he+0],ge[ve+0],je,Oe),T(re[ue+1],fe[he+0],ge[ve+0],je,Oe+Y),ue+=2,++he,++ve,Oe+=2*Y;1&Ye&&T(re[ue+0],fe[he+0],ge[ve+0],je,Oe)}}function hd(k,T,Y){return Y==0?k==0?T==0?6:5:T==0?4:0:Y}function J0(k,T,Y,re,ue){switch(k>>>30){case 3:iu(T,Y,re,ue,0);break;case 2:xi(T,Y,re,ue);break;case 1:Br(T,Y,re,ue)}}function gi(k,T){var Y,re,ue=T.M,fe=T.Nb,he=k.oc,ge=k.pc+40,ve=k.oc,je=k.pc+584,Oe=k.oc,Ye=k.pc+600;for(Y=0;16>Y;++Y)he[ge+32*Y-1]=129;for(Y=0;8>Y;++Y)ve[je+32*Y-1]=129,Oe[Ye+32*Y-1]=129;for(0<ue?he[ge-1-32]=ve[je-1-32]=Oe[Ye-1-32]=129:(s(he,ge-32-1,127,21),s(ve,je-32-1,127,9),s(Oe,Ye-32-1,127,9)),re=0;re<k.za;++re){var Ce=T.ya[T.aa+re];if(0<re){for(Y=-1;16>Y;++Y)n(he,ge+32*Y-4,he,ge+32*Y+12,4);for(Y=-1;8>Y;++Y)n(ve,je+32*Y-4,ve,je+32*Y+4,4),n(Oe,Ye+32*Y-4,Oe,Ye+32*Y+4,4)}var De=k.Gd,$e=k.Hd+re,at=Ce.ad,We=Ce.Hc;if(0<ue&&(n(he,ge-32,De[$e].y,0,16),n(ve,je-32,De[$e].f,0,8),n(Oe,Ye-32,De[$e].ea,0,8)),Ce.Za){var ot=he,ut=ge-32+16;for(0<ue&&(re>=k.za-1?s(ot,ut,De[$e].y[15],4):n(ot,ut,De[$e+1].y,0,4)),Y=0;4>Y;Y++)ot[ut+128+Y]=ot[ut+256+Y]=ot[ut+384+Y]=ot[ut+0+Y];for(Y=0;16>Y;++Y,We<<=2)ot=he,ut=ge+T5[Y],Gi[Ce.Ob[Y]](ot,ut),J0(We,at,16*+Y,ot,ut)}else if(ot=hd(re,ue,Ce.Ob[0]),Wl[ot](he,ge),We!=0)for(Y=0;16>Y;++Y,We<<=2)J0(We,at,16*+Y,he,ge+T5[Y]);for(Y=Ce.Gc,ot=hd(re,ue,Ce.Dd),il[ot](ve,je),il[ot](Oe,Ye),We=at,ot=ve,ut=je,255&(Ce=0|Y)&&(170&Ce?Co(We,256,ot,ut):Mr(We,256,ot,ut)),Ce=Oe,We=Ye,255&(Y>>=8)&&(170&Y?Co(at,320,Ce,We):Mr(at,320,Ce,We)),ue<k.Ub-1&&(n(De[$e].y,0,he,ge+480,16),n(De[$e].f,0,ve,je+224,8),n(De[$e].ea,0,Oe,Ye+224,8)),Y=8*fe*k.B,De=k.sa,$e=k.ta+16*re+16*fe*k.R,at=k.qa,Ce=k.ra+8*re+Y,We=k.Ha,ot=k.Ia+8*re+Y,Y=0;16>Y;++Y)n(De,$e+Y*k.R,he,ge+32*Y,16);for(Y=0;8>Y;++Y)n(at,Ce+Y*k.B,ve,je+32*Y,8),n(We,ot+Y*k.B,Oe,Ye+32*Y,8)}}function nu(k,T,Y,re,ue,fe,he,ge,ve){var je=[0],Oe=[0],Ye=0,Ce=ve!=null?ve.kd:0,De=ve??new ht;if(k==null||12>Y)return 7;De.data=k,De.w=T,De.ha=Y,T=[T],Y=[Y],De.gb=[De.gb];e:{var $e=T,at=Y,We=De.gb;if(t(k!=null),t(at!=null),t(We!=null),We[0]=0,12<=at[0]&&!r(k,$e[0],"RIFF")){if(r(k,$e[0]+8,"WEBP")){We=3;break e}var ot=se(k,$e[0]+4);if(12>ot||4294967286<ot){We=3;break e}if(Ce&&ot>at[0]-8){We=7;break e}We[0]=ot,$e[0]+=12,at[0]-=12}We=0}if(We!=0)return We;for(ot=0<De.gb[0],Y=Y[0];;){e:{var ut=k;at=T,We=Y;var gt=je,pt=Oe,Qt=$e=[0];if((Ot=Ye=[Ye])[0]=0,8>We[0])We=7;else{if(!r(ut,at[0],"VP8X")){if(se(ut,at[0]+4)!=10){We=3;break e}if(18>We[0]){We=7;break e}var Ft=se(ut,at[0]+8),ir=1+_e(ut,at[0]+12);if(2147483648<=ir*(ut=1+_e(ut,at[0]+15))){We=3;break e}Qt!=null&&(Qt[0]=Ft),gt!=null&&(gt[0]=ir),pt!=null&&(pt[0]=ut),at[0]+=18,We[0]-=18,Ot[0]=1}We=0}}if(Ye=Ye[0],$e=$e[0],We!=0)return We;if(at=!!(2&$e),!ot&&Ye)return 3;if(fe!=null&&(fe[0]=!!(16&$e)),he!=null&&(he[0]=at),ge!=null&&(ge[0]=0),he=je[0],$e=Oe[0],Ye&&at&&ve==null){We=0;break}if(4>Y){We=7;break}if(ot&&Ye||!ot&&!Ye&&!r(k,T[0],"ALPH")){Y=[Y],De.na=[De.na],De.P=[De.P],De.Sa=[De.Sa];e:{Ft=k,We=T,ot=Y;var Ot=De.gb;gt=De.na,pt=De.P,Qt=De.Sa,ir=22,t(Ft!=null),t(ot!=null),ut=We[0];var mr=ot[0];for(t(gt!=null),t(Qt!=null),gt[0]=null,pt[0]=null,Qt[0]=0;;){if(We[0]=ut,ot[0]=mr,8>mr){We=7;break e}var ia=se(Ft,ut+4);if(4294967286<ia){We=3;break e}var or=8+ia+1&-2;if(ir+=or,0<Ot&&ir>Ot){We=3;break e}if(!r(Ft,ut,"VP8 ")||!r(Ft,ut,"VP8L")){We=0;break e}if(mr[0]<or){We=7;break e}r(Ft,ut,"ALPH")||(gt[0]=Ft,pt[0]=ut+8,Qt[0]=ia),ut+=or,mr-=or}}if(Y=Y[0],De.na=De.na[0],De.P=De.P[0],De.Sa=De.Sa[0],We!=0)break}Y=[Y],De.Ja=[De.Ja],De.xa=[De.xa];e:if(Ot=k,We=T,ot=Y,gt=De.gb[0],pt=De.Ja,Qt=De.xa,Ft=We[0],ut=!r(Ot,Ft,"VP8 "),ir=!r(Ot,Ft,"VP8L"),t(Ot!=null),t(ot!=null),t(pt!=null),t(Qt!=null),8>ot[0])We=7;else{if(ut||ir){if(Ot=se(Ot,Ft+4),12<=gt&&Ot>gt-12){We=3;break e}if(Ce&&Ot>ot[0]-8){We=7;break e}pt[0]=Ot,We[0]+=8,ot[0]-=8,Qt[0]=ir}else Qt[0]=5<=ot[0]&&Ot[Ft+0]==47&&!(Ot[Ft+4]>>5),pt[0]=ot[0];We=0}if(Y=Y[0],De.Ja=De.Ja[0],De.xa=De.xa[0],T=T[0],We!=0)break;if(4294967286<De.Ja)return 3;if(ge==null||at||(ge[0]=De.xa?2:1),he=[he],$e=[$e],De.xa){if(5>Y){We=7;break}ge=he,Ce=$e,at=fe,k==null||5>Y?k=0:5<=Y&&k[T+0]==47&&!(k[T+4]>>5)?(ot=[0],Ot=[0],gt=[0],H(pt=new L,k,T,Y),ra(pt,ot,Ot,gt)?(ge!=null&&(ge[0]=ot[0]),Ce!=null&&(Ce[0]=Ot[0]),at!=null&&(at[0]=gt[0]),k=1):k=0):k=0}else{if(10>Y){We=7;break}ge=$e,k==null||10>Y||!M0(k,T+3,Y-3)?k=0:(Ce=k[T+0]|k[T+1]<<8|k[T+2]<<16,at=16383&(k[T+7]<<8|k[T+6]),k=16383&(k[T+9]<<8|k[T+8]),1&Ce||3<(Ce>>1&7)||!(Ce>>4&1)||Ce>>5>=De.Ja||!at||!k?k=0:(he&&(he[0]=at),ge&&(ge[0]=k),k=1))}if(!k||(he=he[0],$e=$e[0],Ye&&(je[0]!=he||Oe[0]!=$e)))return 3;ve!=null&&(ve[0]=De,ve.offset=T-ve.w,t(4294967286>T-ve.w),t(ve.offset==ve.ha-Y));break}return We==0||We==7&&Ye&&ve==null?(fe!=null&&(fe[0]|=De.na!=null&&0<De.na.length),re!=null&&(re[0]=he),ue!=null&&(ue[0]=$e),0):We}function df(k,T,Y){var re=T.width,ue=T.height,fe=0,he=0,ge=re,ve=ue;if(T.Da=k!=null&&0<k.Da,T.Da&&(ge=k.cd,ve=k.bd,fe=k.v,he=k.j,11>Y||(fe&=-2,he&=-2),0>fe||0>he||0>=ge||0>=ve||fe+ge>re||he+ve>ue))return 0;if(T.v=fe,T.j=he,T.va=fe+ge,T.o=he+ve,T.U=ge,T.T=ve,T.da=k!=null&&0<k.da,T.da){if(!Ae(ge,ve,Y=[k.ib],fe=[k.hb]))return 0;T.ib=Y[0],T.hb=fe[0]}return T.ob=k!=null&&k.ob,T.Kb=k==null||!k.Sd,T.da&&(T.ob=T.ib<3*re/4&&T.hb<3*ue/4,T.Kb=0),1}function Af(k){if(k==null)return 2;if(11>k.S){var T=k.f.RGBA;T.fb+=(k.height-1)*T.A,T.A=-T.A}else T=k.f.kb,k=k.height,T.O+=(k-1)*T.fa,T.fa=-T.fa,T.N+=(k-1>>1)*T.Ab,T.Ab=-T.Ab,T.W+=(k-1>>1)*T.Db,T.Db=-T.Db,T.F!=null&&(T.J+=(k-1)*T.lb,T.lb=-T.lb);return 0}function Ml(k,T,Y,re){if(re==null||0>=k||0>=T)return 2;if(Y!=null){if(Y.Da){var ue=Y.cd,fe=Y.bd,he=-2&Y.v,ge=-2&Y.j;if(0>he||0>ge||0>=ue||0>=fe||he+ue>k||ge+fe>T)return 2;k=ue,T=fe}if(Y.da){if(!Ae(k,T,ue=[Y.ib],fe=[Y.hb]))return 2;k=ue[0],T=fe[0]}}re.width=k,re.height=T;e:{var ve=re.width,je=re.height;if(k=re.S,0>=ve||0>=je||!(k>=rp&&13>k))k=2;else{if(0>=re.Rd&&re.sd==null){he=fe=ue=T=0;var Oe=(ge=ve*I5[k])*je;if(11>k||(fe=(je+1)/2*(T=(ve+1)/2),k==12&&(he=(ue=ve)*je)),(je=i(Oe+2*fe+he))==null){k=1;break e}re.sd=je,11>k?((ve=re.f.RGBA).eb=je,ve.fb=0,ve.A=ge,ve.size=Oe):((ve=re.f.kb).y=je,ve.O=0,ve.fa=ge,ve.Fd=Oe,ve.f=je,ve.N=0+Oe,ve.Ab=T,ve.Cd=fe,ve.ea=je,ve.W=0+Oe+fe,ve.Db=T,ve.Ed=fe,k==12&&(ve.F=je,ve.J=0+Oe+2*fe),ve.Tc=he,ve.lb=ue)}if(T=1,ue=re.S,fe=re.width,he=re.height,ue>=rp&&13>ue)if(11>ue)k=re.f.RGBA,T&=(ge=Math.abs(k.A))*(he-1)+fe<=k.size,T&=ge>=fe*I5[ue],T&=k.eb!=null;else{k=re.f.kb,ge=(fe+1)/2,Oe=(he+1)/2,ve=Math.abs(k.fa),je=Math.abs(k.Ab);var Ye=Math.abs(k.Db),Ce=Math.abs(k.lb),De=Ce*(he-1)+fe;T&=ve*(he-1)+fe<=k.Fd,T&=je*(Oe-1)+ge<=k.Cd,T=(T&=Ye*(Oe-1)+ge<=k.Ed)&ve>=fe&je>=ge&Ye>=ge,T&=k.y!=null,T&=k.f!=null,T&=k.ea!=null,ue==12&&(T&=Ce>=fe,T&=De<=k.Tc,T&=k.F!=null)}else T=0;k=T?0:2}}return k!=0||Y!=null&&Y.fd&&(k=Af(re)),k}var au=64,Hs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],qs=24,Hl=32,al=8,ql=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Re("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(k){return k},j.Predictor2=function(k,T,Y){return T[Y+0]},j.Predictor3=function(k,T,Y){return T[Y+1]},j.Predictor4=function(k,T,Y){return T[Y-1]},j.Predictor5=function(k,T,Y){return Pe(Pe(k,T[Y+1]),T[Y+0])},j.Predictor6=function(k,T,Y){return Pe(k,T[Y-1])},j.Predictor7=function(k,T,Y){return Pe(k,T[Y+0])},j.Predictor8=function(k,T,Y){return Pe(T[Y-1],T[Y+0])},j.Predictor9=function(k,T,Y){return Pe(T[Y+0],T[Y+1])},j.Predictor10=function(k,T,Y){return Pe(Pe(k,T[Y-1]),Pe(T[Y+0],T[Y+1]))},j.Predictor11=function(k,T,Y){var re=T[Y+0];return 0>=lt(re>>24&255,k>>24&255,(T=T[Y-1])>>24&255)+lt(re>>16&255,k>>16&255,T>>16&255)+lt(re>>8&255,k>>8&255,T>>8&255)+lt(255&re,255&k,255&T)?re:k},j.Predictor12=function(k,T,Y){var re=T[Y+0];return(ze((k>>24&255)+(re>>24&255)-((T=T[Y-1])>>24&255))<<24|ze((k>>16&255)+(re>>16&255)-(T>>16&255))<<16|ze((k>>8&255)+(re>>8&255)-(T>>8&255))<<8|ze((255&k)+(255&re)-(255&T)))>>>0},j.Predictor13=function(k,T,Y){var re=T[Y-1];return(Ve((k=Pe(k,T[Y+0]))>>24&255,re>>24&255)<<24|Ve(k>>16&255,re>>16&255)<<16|Ve(k>>8&255,re>>8&255)<<8|Ve(255&k,255&re))>>>0};var ff=j.PredictorAdd0;j.PredictorAdd1=pe,Re("Predictor2","PredictorAdd2"),Re("Predictor3","PredictorAdd3"),Re("Predictor4","PredictorAdd4"),Re("Predictor5","PredictorAdd5"),Re("Predictor6","PredictorAdd6"),Re("Predictor7","PredictorAdd7"),Re("Predictor8","PredictorAdd8"),Re("Predictor9","PredictorAdd9"),Re("Predictor10","PredictorAdd10"),Re("Predictor11","PredictorAdd11"),Re("Predictor12","PredictorAdd12"),Re("Predictor13","PredictorAdd13");var pd=j.PredictorAdd2;tt("ColorIndexInverseTransform","MapARGB","32b",function(k){return k>>8&255},function(k){return k}),tt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(k){return k},function(k){return k>>8&255});var En,Z0=j.ColorIndexInverseTransform,No=j.MapARGB,jo=j.VP8LColorIndexInverseTransformAlpha,hf=j.MapAlpha,pf=j.VP8LPredictorsAdd=[];pf.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var mf,gf,Kl,$l,Vl,su,Gl,iu,xi,Co,Br,Mr,Fn,sa,sl,xf,md,ep,l5,c5,u5,d5,A5,f5,yf,h5,p5,m5,g5=i(511),x5=i(2041),y5=i(225),v5=i(767),b5=0,C1=x5,tp=y5,Ks=v5,yi=g5,rp=0,np=1,w5=2,ap=3,sp=4,B1=5,_5=6,k1=7,S1=8,ip=9,E1=10,dL=[2,3,7],AL=[3,3,11],N5=[280,256,256,256,40],fL=[0,1,1,1,0],hL=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],pL=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],mL=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],gL=8,F1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],T1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],vf=null,xL=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],yL=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],j5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],vL=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],bL=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],wL=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],_L=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Wl=[],Gi=[],il=[],NL=1,C5=2,zl=[],vi=[];rl("UpsampleRgbLinePair",Ql,3),rl("UpsampleBgrLinePair",Ba,3),rl("UpsampleRgbaLinePair",us,4),rl("UpsampleBgraLinePair",uf,4),rl("UpsampleArgbLinePair",cf,4),rl("UpsampleRgba4444LinePair",ru,2),rl("UpsampleRgb565LinePair",tu,2);var jL=j.UpsampleRgbLinePair,CL=j.UpsampleBgrLinePair,B5=j.UpsampleRgbaLinePair,k5=j.UpsampleBgraLinePair,S5=j.UpsampleArgbLinePair,E5=j.UpsampleRgba4444LinePair,BL=j.UpsampleRgb565LinePair,op=16,lp=1<<op-1,bf=-227,I1=482,kL=6,F5=0,SL=i(256),EL=i(256),FL=i(256),TL=i(256),IL=i(I1-bf),LL=i(I1-bf);nl("YuvToRgbRow",Ql,3),nl("YuvToBgrRow",Ba,3),nl("YuvToRgbaRow",us,4),nl("YuvToBgraRow",uf,4),nl("YuvToArgbRow",cf,4),nl("YuvToRgba4444Row",ru,2),nl("YuvToRgb565Row",tu,2);var T5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],cp=[0,2,8],OL=[8,7,6,4,4,2,2,2,1,1,1,1],UL=1;this.WebPDecodeRGBA=function(k,T,Y,re,ue){var fe=np,he=new ct,ge=new Nt;he.ba=ge,ge.S=fe,ge.width=[ge.width],ge.height=[ge.height];var ve=ge.width,je=ge.height,Oe=new Bt;if(Oe==null||k==null)var Ye=2;else t(Oe!=null),Ye=nu(k,T,Y,Oe.width,Oe.height,Oe.Pd,Oe.Qd,Oe.format,null);if(Ye!=0?ve=0:(ve!=null&&(ve[0]=Oe.width[0]),je!=null&&(je[0]=Oe.height[0]),ve=1),ve){ge.width=ge.width[0],ge.height=ge.height[0],re!=null&&(re[0]=ge.width),ue!=null&&(ue[0]=ge.height);e:{if(re=new ld,(ue=new ht).data=k,ue.w=T,ue.ha=Y,ue.kd=1,T=[0],t(ue!=null),((k=nu(ue.data,ue.w,ue.ha,null,null,null,T,null,ue))==0||k==7)&&T[0]&&(k=4),(T=k)==0){if(t(he!=null),re.data=ue.data,re.w=ue.w+ue.offset,re.ha=ue.ha-ue.offset,re.put=Pt,re.ac=ta,re.bc=qn,re.ma=he,ue.xa){if((k=qe())==null){he=1;break e}if(function(Ce,De){var $e=[0],at=[0],We=[0];t:for(;;){if(Ce==null)return 0;if(De==null)return Ce.a=2,0;if(Ce.l=De,Ce.a=0,H(Ce.m,De.data,De.w,De.ha),!ra(Ce.m,$e,at,We)){Ce.a=3;break t}if(Ce.xb=C5,De.width=$e[0],De.height=at[0],!Ge($e[0],at[0],1,Ce,null))break t;return 1}return t(Ce.a!=0),0}(k,re)){if(re=(T=Ml(re.width,re.height,he.Oa,he.ba))==0){t:{re=k;r:for(;;){if(re==null){re=0;break t}if(t(re.s.yc!=null),t(re.s.Ya!=null),t(0<re.s.Wb),t((Y=re.l)!=null),t((ue=Y.ma)!=null),re.xb!=0){if(re.ca=ue.ba,re.tb=ue.tb,t(re.ca!=null),!df(ue.Oa,Y,ap)){re.a=2;break r}if(!Te(re,Y.width)||Y.da)break r;if((Y.da||mt(re.ca.S))&&Vi(),11>re.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),re.ca.f.kb.F!=null&&Vi()),re.Pb&&0<re.s.ua&&re.s.vb.X==null&&!te(re.s.vb,re.s.Wa.Xa)){re.a=1;break r}re.xb=0}if(!Ue(re,re.V,re.Ba,re.c,re.i,Y.o,oe))break r;ue.Dc=re.Ma,re=1;break t}t(re.a!=0),re=0}re=!re}re&&(T=k.a)}else T=k.a}else{if((k=new d1)==null){he=1;break e}if(k.Fa=ue.na,k.P=ue.P,k.qc=ue.Sa,wo(k,re)){if((T=Ml(re.width,re.height,he.Oa,he.ba))==0){if(k.Aa=0,Y=he.Oa,t((ue=k)!=null),Y!=null){if(0<(ve=0>(ve=Y.Md)?0:100<ve?255:255*ve/100)){for(je=Oe=0;4>je;++je)12>(Ye=ue.pb[je]).lc&&(Ye.ia=ve*OL[0>Ye.lc?0:Ye.lc]>>3),Oe|=Ye.ia;Oe&&(alert("todo:VP8InitRandom"),ue.ia=1)}ue.Ga=Y.Id,100<ue.Ga?ue.Ga=100:0>ue.Ga&&(ue.Ga=0)}(function(Ce,De){if(Ce==null)return 0;if(De==null)return Kn(Ce,2,"NULL VP8Io parameter in VP8Decode().");if(!Ce.cb&&!wo(Ce,De))return 0;if(t(Ce.cb),De.ac==null||De.ac(De)){De.ob&&(Ce.L=0);var $e=cp[Ce.L];if(Ce.L==2?(Ce.yb=0,Ce.zb=0):(Ce.yb=De.v-$e>>4,Ce.zb=De.j-$e>>4,0>Ce.yb&&(Ce.yb=0),0>Ce.zb&&(Ce.zb=0)),Ce.Va=De.o+15+$e>>4,Ce.Hb=De.va+15+$e>>4,Ce.Hb>Ce.za&&(Ce.Hb=Ce.za),Ce.Va>Ce.Ub&&(Ce.Va=Ce.Ub),0<Ce.L){var at=Ce.ed;for($e=0;4>$e;++$e){var We;if(Ce.Qa.Cb){var ot=Ce.Qa.Lb[$e];Ce.Qa.Fb||(ot+=at.Tb)}else ot=at.Tb;for(We=0;1>=We;++We){var ut=Ce.gd[$e][We],gt=ot;if(at.Pc&&(gt+=at.vd[0],We&&(gt+=at.od[0])),0<(gt=0>gt?0:63<gt?63:gt)){var pt=gt;0<at.wb&&(pt=4<at.wb?pt>>2:pt>>1)>9-at.wb&&(pt=9-at.wb),1>pt&&(pt=1),ut.dd=pt,ut.tc=2*gt+pt,ut.ld=40<=gt?2:15<=gt?1:0}else ut.tc=0;ut.La=We}}}$e=0}else Kn(Ce,6,"Frame setup failed"),$e=Ce.a;if($e=$e==0){if($e){Ce.$c=0,0<Ce.Aa||(Ce.Ic=UL);t:{$e=Ce.Ic,at=4*(pt=Ce.za);var Qt=32*pt,Ft=pt+1,ir=0<Ce.L?pt*(0<Ce.Aa?2:1):0,Ot=(Ce.Aa==2?2:1)*pt;if((ut=at+832+(We=3*(16*$e+cp[Ce.L])/2*Qt)+(ot=Ce.Fa!=null&&0<Ce.Fa.length?Ce.Kc.c*Ce.Kc.i:0))!=ut)$e=0;else{if(ut>Ce.Vb){if(Ce.Vb=0,Ce.Ec=i(ut),Ce.Fc=0,Ce.Ec==null){$e=Kn(Ce,1,"no memory during frame initialization.");break t}Ce.Vb=ut}ut=Ce.Ec,gt=Ce.Fc,Ce.Ac=ut,Ce.Bc=gt,gt+=at,Ce.Gd=o(Qt,Qr),Ce.Hd=0,Ce.rb=o(Ft+1,_r),Ce.sb=1,Ce.wa=ir?o(ir,Vt):null,Ce.Y=0,Ce.D.Nb=0,Ce.D.wa=Ce.wa,Ce.D.Y=Ce.Y,0<Ce.Aa&&(Ce.D.Y+=pt),t(!0),Ce.oc=ut,Ce.pc=gt,gt+=832,Ce.ya=o(Ot,cr),Ce.aa=0,Ce.D.ya=Ce.ya,Ce.D.aa=Ce.aa,Ce.Aa==2&&(Ce.D.aa+=pt),Ce.R=16*pt,Ce.B=8*pt,pt=(Qt=cp[Ce.L])*Ce.R,Qt=Qt/2*Ce.B,Ce.sa=ut,Ce.ta=gt+pt,Ce.qa=Ce.sa,Ce.ra=Ce.ta+16*$e*Ce.R+Qt,Ce.Ha=Ce.qa,Ce.Ia=Ce.ra+8*$e*Ce.B+Qt,Ce.$c=0,gt+=We,Ce.mb=ot?ut:null,Ce.nb=ot?gt:null,t(gt+ot<=Ce.Fc+Ce.Vb),H0(Ce),s(Ce.Ac,Ce.Bc,0,at),$e=1}}if($e){if(De.ka=0,De.y=Ce.sa,De.O=Ce.ta,De.f=Ce.qa,De.N=Ce.ra,De.ea=Ce.Ha,De.Vd=Ce.Ia,De.fa=Ce.R,De.Rc=Ce.B,De.F=null,De.J=0,!b5){for($e=-255;255>=$e;++$e)g5[255+$e]=0>$e?-$e:$e;for($e=-1020;1020>=$e;++$e)x5[1020+$e]=-128>$e?-128:127<$e?127:$e;for($e=-112;112>=$e;++$e)y5[112+$e]=-16>$e?-16:15<$e?15:$e;for($e=-255;510>=$e;++$e)v5[255+$e]=0>$e?0:255<$e?255:$e;b5=1}Gl=ud,iu=f1,Co=_o,Br=K0,Mr=$0,xi=A1,Fn=X0,sa=Jc,sl=ce,xf=Be,md=Y0,ep=q,l5=Ie,c5=He,u5=Yc,d5=of,A5=W0,f5=z0,Gi[0]=b1,Gi[1]=h1,Gi[2]=y1,Gi[3]=v1,Gi[4]=zo,Gi[5]=w1,Gi[6]=Xo,Gi[7]=_1,Gi[8]=tf,Gi[9]=dd,Wl[0]=g1,Wl[1]=m1,Wl[2]=ZA,Wl[3]=V0,Wl[4]=zc,Wl[5]=ef,Wl[6]=x1,il[0]=j1,il[1]=p1,il[2]=Xc,il[3]=N1,il[4]=nf,il[5]=rf,il[6]=G0,$e=1}else $e=0}$e&&($e=function(mr,ia){for(mr.M=0;mr.M<mr.Va;++mr.M){var or,Ut=mr.Jc[mr.M&mr.Xb],jt=mr.m,Tn=mr;for(or=0;or<Tn.za;++or){var er=jt,gr=Tn,Yr=gr.Ac,ka=gr.Bc+4*or,ds=gr.zc,bn=gr.ya[gr.aa+or];if(gr.Qa.Bb?bn.$b=R(er,gr.Pa.jb[0])?2+R(er,gr.Pa.jb[2]):R(er,gr.Pa.jb[1]):bn.$b=0,gr.kc&&(bn.Ad=R(er,gr.Bd)),bn.Za=!R(er,145)+0,bn.Za){var Ha=bn.Ob,As=0;for(gr=0;4>gr;++gr){var oa,yr=ds[0+gr];for(oa=0;4>oa;++oa){yr=bL[Yr[ka+oa]][yr];for(var Sr=j5[R(er,yr[0])];0<Sr;)Sr=j5[2*Sr+R(er,yr[Sr])];yr=-Sr,Yr[ka+oa]=yr}n(Ha,As,Yr,ka,4),As+=4,ds[0+gr]=yr}}else yr=R(er,156)?R(er,128)?1:3:R(er,163)?2:0,bn.Ob[0]=yr,s(Yr,ka,yr,4),s(ds,0,yr,4);bn.Dd=R(er,142)?R(er,114)?R(er,183)?1:3:2:0}if(Tn.m.Ka)return Kn(mr,7,"Premature end-of-partition0 encountered.");for(;mr.ja<mr.za;++mr.ja){if(Tn=Ut,er=(jt=mr).rb[jt.sb-1],Yr=jt.rb[jt.sb+jt.ja],or=jt.ya[jt.aa+jt.ja],ka=jt.kc?or.Ad:0)er.la=Yr.la=0,or.Za||(er.Na=Yr.Na=0),or.Hc=0,or.Gc=0,or.ia=0;else{var wn,Er;if(er=Yr,Yr=Tn,ka=jt.Pa.Xc,ds=jt.ya[jt.aa+jt.ja],bn=jt.pb[ds.$b],gr=ds.ad,Ha=0,As=jt.rb[jt.sb-1],yr=oa=0,s(gr,Ha,0,384),ds.Za)var Sa=0,Wi=ka[3];else{Sr=i(16);var In=er.Na+As.Na;if(In=vf(Yr,ka[1],In,bn.Eb,0,Sr,0),er.Na=As.Na=(0<In)+0,1<In)Gl(Sr,0,gr,Ha);else{var Bs=Sr[0]+3>>3;for(Sr=0;256>Sr;Sr+=16)gr[Ha+Sr]=Bs}Sa=1,Wi=ka[0]}var Hr=15&er.la,la=15&As.la;for(Sr=0;4>Sr;++Sr){var $s=1&la;for(Bs=Er=0;4>Bs;++Bs)Hr=Hr>>1|($s=(In=vf(Yr,Wi,In=$s+(1&Hr),bn.Sc,Sa,gr,Ha))>Sa)<<7,Er=Er<<2|(3<In?3:1<In?2:gr[Ha+0]!=0),Ha+=16;Hr>>=4,la=la>>1|$s<<7,oa=(oa<<8|Er)>>>0}for(Wi=Hr,Sa=la>>4,wn=0;4>wn;wn+=2){for(Er=0,Hr=er.la>>4+wn,la=As.la>>4+wn,Sr=0;2>Sr;++Sr){for($s=1&la,Bs=0;2>Bs;++Bs)In=$s+(1&Hr),Hr=Hr>>1|($s=0<(In=vf(Yr,ka[2],In,bn.Qc,0,gr,Ha)))<<3,Er=Er<<2|(3<In?3:1<In?2:gr[Ha+0]!=0),Ha+=16;Hr>>=2,la=la>>1|$s<<5}yr|=Er<<4*wn,Wi|=Hr<<4<<wn,Sa|=(240&la)<<wn}er.la=Wi,As.la=Sa,ds.Hc=oa,ds.Gc=yr,ds.ia=43690&yr?0:bn.ia,ka=!(oa|yr)}if(0<jt.L&&(jt.wa[jt.Y+jt.ja]=jt.gd[or.$b][or.Za],jt.wa[jt.Y+jt.ja].La|=!ka),Tn.Ka)return Kn(mr,7,"Premature end-of-file encountered.")}if(H0(mr),jt=ia,Tn=1,or=(Ut=mr).D,er=0<Ut.L&&Ut.M>=Ut.zb&&Ut.M<=Ut.Va,Ut.Aa==0)t:{if(or.M=Ut.M,or.uc=er,gi(Ut,or),Tn=1,or=(Er=Ut.D).Nb,er=(yr=cp[Ut.L])*Ut.R,Yr=yr/2*Ut.B,Sr=16*or*Ut.R,Bs=8*or*Ut.B,ka=Ut.sa,ds=Ut.ta-er+Sr,bn=Ut.qa,gr=Ut.ra-Yr+Bs,Ha=Ut.Ha,As=Ut.Ia-Yr+Bs,la=(Hr=Er.M)==0,oa=Hr>=Ut.Va-1,Ut.Aa==2&&gi(Ut,Er),Er.uc)for($s=(In=Ut).D.M,t(In.D.uc),Er=In.yb;Er<In.Hb;++Er){Sa=Er,Wi=$s;var fs=(Vs=(Ea=In).D).Nb;wn=Ea.R;var Vs=Vs.wa[Vs.Y+Sa],Gs=Ea.sa,ks=Ea.ta+16*fs*wn+16*Sa,Ws=Vs.dd,Vr=Vs.tc;if(Vr!=0)if(t(3<=Vr),Ea.L==1)0<Sa&&d5(Gs,ks,wn,Vr+4),Vs.La&&f5(Gs,ks,wn,Vr),0<Wi&&u5(Gs,ks,wn,Vr+4),Vs.La&&A5(Gs,ks,wn,Vr);else{var zs=Ea.B,zi=Ea.qa,ou=Ea.ra+8*fs*zs+8*Sa,ol=Ea.Ha,Ea=Ea.Ia+8*fs*zs+8*Sa;fs=Vs.ld,0<Sa&&(sa(Gs,ks,wn,Vr+4,Ws,fs),xf(zi,ou,ol,Ea,zs,Vr+4,Ws,fs)),Vs.La&&(ep(Gs,ks,wn,Vr,Ws,fs),c5(zi,ou,ol,Ea,zs,Vr,Ws,fs)),0<Wi&&(Fn(Gs,ks,wn,Vr+4,Ws,fs),sl(zi,ou,ol,Ea,zs,Vr+4,Ws,fs)),Vs.La&&(md(Gs,ks,wn,Vr,Ws,fs),l5(zi,ou,ol,Ea,zs,Vr,Ws,fs))}}if(Ut.ia&&alert("todo:DitherRow"),jt.put!=null){if(Er=16*Hr,Hr=16*(Hr+1),la?(jt.y=Ut.sa,jt.O=Ut.ta+Sr,jt.f=Ut.qa,jt.N=Ut.ra+Bs,jt.ea=Ut.Ha,jt.W=Ut.Ia+Bs):(Er-=yr,jt.y=ka,jt.O=ds,jt.f=bn,jt.N=gr,jt.ea=Ha,jt.W=As),oa||(Hr-=yr),Hr>jt.o&&(Hr=jt.o),jt.F=null,jt.J=null,Ut.Fa!=null&&0<Ut.Fa.length&&Er<Hr&&(jt.J=$r(Ut,jt,Er,Hr-Er),jt.F=Ut.mb,jt.F==null&&jt.F.length==0)){Tn=Kn(Ut,3,"Could not decode alpha data.");break t}Er<jt.j&&(yr=jt.j-Er,Er=jt.j,t(!(1&yr)),jt.O+=Ut.R*yr,jt.N+=Ut.B*(yr>>1),jt.W+=Ut.B*(yr>>1),jt.F!=null&&(jt.J+=jt.width*yr)),Er<Hr&&(jt.O+=jt.v,jt.N+=jt.v>>1,jt.W+=jt.v>>1,jt.F!=null&&(jt.J+=jt.v),jt.ka=Er-jt.j,jt.U=jt.va-jt.v,jt.T=Hr-Er,Tn=jt.put(jt))}or+1!=Ut.Ic||oa||(n(Ut.sa,Ut.ta-er,ka,ds+16*Ut.R,er),n(Ut.qa,Ut.ra-Yr,bn,gr+8*Ut.B,Yr),n(Ut.Ha,Ut.Ia-Yr,Ha,As+8*Ut.B,Yr))}if(!Tn)return Kn(mr,6,"Output aborted.")}return 1}(Ce,De)),De.bc!=null&&De.bc(De),$e&=1}return $e?(Ce.cb=0,$e):0})(k,re)||(T=k.a)}}else T=k.a}T==0&&he.Oa!=null&&he.Oa.fd&&(T=Af(he.ba))}he=T}fe=he!=0?null:11>fe?ge.f.RGBA.eb:ge.f.kb.y}else fe=null;return fe};var I5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(j,E){for(var S="",F=0;F<4;F++)S+=String.fromCharCode(j[E++]);return S}function d(j,E){return j[E+0]|j[E+1]<<8}function h(j,E){return(j[E+0]|j[E+1]<<8|j[E+2]<<16)>>>0}function f(j,E){return(j[E+0]|j[E+1]<<8|j[E+2]<<16|j[E+3]<<24)>>>0}new c;var A=[0],b=[0],m=[],v=new c,p=e,g=function(j,E){var S={},F=0,I=!1,O=0,M=0;if(S.frames=[],!function(B,L){for(var U=0;U<4;U++)if(B[L+U]!="RIFF".charCodeAt(U))return!0;return!1}(j,E)){for(f(j,E+=4),E+=8;E<j.length;){var P=u(j,E),X=f(j,E+=4);E+=4;var J=X+(1&X);switch(P){case"VP8 ":case"VP8L":S.frames[F]===void 0&&(S.frames[F]={}),(K=S.frames[F]).src_off=I?M:E-8,K.src_size=O+X+8,F++,I&&(I=!1,O=0,M=0);break;case"VP8X":(K=S.header={}).feature_flags=j[E];var H=E+4;K.canvas_width=1+h(j,H),H+=3,K.canvas_height=1+h(j,H),H+=3;break;case"ALPH":I=!0,O=J+8,M=E-8;break;case"ANIM":(K=S.header).bgcolor=f(j,E),H=E+4,K.loop_count=d(j,H),H+=2;break;case"ANMF":var V,K;(K=S.frames[F]={}).offset_x=2*h(j,E),E+=3,K.offset_y=2*h(j,E),E+=3,K.width=1+h(j,E),E+=3,K.height=1+h(j,E),E+=3,K.duration=h(j,E),E+=3,V=j[E++],K.dispose=1&V,K.blend=V>>1&1}P!="ANMF"&&(E+=J)}return S}}(p,0);g.response=p,g.rgbaoutput=!0,g.dataurl=!1;var y=g.header?g.header:null,x=g.frames?g.frames:null;if(y){y.loop_counter=y.loop_count,A=[y.canvas_height],b=[y.canvas_width];for(var w=0;w<x.length&&x[w].blend!=0;w++);}var N=x[0],_=v.WebPDecodeRGBA(p,N.src_off,N.src_size,b,A);N.rgba=_,N.imgwidth=b[0],N.imgheight=A[0];for(var C=0;C<b[0]*A[0]*4;C++)m[C]=_[C];return this.width=b,this.height=A,this.data=m,this}(function(e){var t,r,n,s,i,o,l,c,u,d=function(B){return B=B||{},this.isStrokeTransparent=B.isStrokeTransparent||!1,this.strokeOpacity=B.strokeOpacity||1,this.strokeStyle=B.strokeStyle||"#000000",this.fillStyle=B.fillStyle||"#000000",this.isFillTransparent=B.isFillTransparent||!1,this.fillOpacity=B.fillOpacity||1,this.font=B.font||"10px sans-serif",this.textBaseline=B.textBaseline||"alphabetic",this.textAlign=B.textAlign||"left",this.lineWidth=B.lineWidth||1,this.lineJoin=B.lineJoin||"miter",this.lineCap=B.lineCap||"butt",this.path=B.path||[],this.transform=B.transform!==void 0?B.transform.clone():new c,this.globalCompositeOperation=B.globalCompositeOperation||"normal",this.globalAlpha=B.globalAlpha||1,this.clip_path=B.clip_path||[],this.currentPoint=B.currentPoint||new o,this.miterLimit=B.miterLimit||10,this.lastPoint=B.lastPoint||new o,this.lineDashOffset=B.lineDashOffset||0,this.lineDash=B.lineDash||[],this.margin=B.margin||[0,0,0,0],this.prevPageLastElemOffset=B.prevPageLastElemOffset||0,this.ignoreClearRect=typeof B.ignoreClearRect!="boolean"||B.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var h=function(B){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=B;Object.defineProperty(this,"pdf",{get:function(){return L}});var U=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return U},set:function(te){U=!!te}});var D=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return D},set:function(te){D=!!te}});var Q=0;Object.defineProperty(this,"posX",{get:function(){return Q},set:function(te){isNaN(te)||(Q=te)}});var z=0;Object.defineProperty(this,"posY",{get:function(){return z},set:function(te){isNaN(te)||(z=te)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(te){var Ne;typeof te=="number"?Ne=[te,te,te,te]:((Ne=new Array(4))[0]=te[0],Ne[1]=te.length>=2?te[1]:Ne[0],Ne[2]=te.length>=3?te[2]:Ne[0],Ne[3]=te.length>=4?te[3]:Ne[1]),u.margin=Ne}});var G=!1;Object.defineProperty(this,"autoPaging",{get:function(){return G},set:function(te){G=te}});var Z=0;Object.defineProperty(this,"lastBreak",{get:function(){return Z},set:function(te){Z=te}});var R=[];Object.defineProperty(this,"pageBreaks",{get:function(){return R},set:function(te){R=te}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(te){te instanceof d&&(u=te)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(te){u.path=te}});var le=[];Object.defineProperty(this,"ctxStack",{get:function(){return le},set:function(te){le=te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(te){var Ne;Ne=f(te),this.ctx.fillStyle=Ne.style,this.ctx.isFillTransparent=Ne.a===0,this.ctx.fillOpacity=Ne.a,this.pdf.setFillColor(Ne.r,Ne.g,Ne.b,{a:Ne.a}),this.pdf.setTextColor(Ne.r,Ne.g,Ne.b,{a:Ne.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(te){var Ne=f(te);this.ctx.strokeStyle=Ne.style,this.ctx.isStrokeTransparent=Ne.a===0,this.ctx.strokeOpacity=Ne.a,Ne.a===0?this.pdf.setDrawColor(255,255,255):(Ne.a,this.pdf.setDrawColor(Ne.r,Ne.g,Ne.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(te){["butt","round","square"].indexOf(te)!==-1&&(this.ctx.lineCap=te,this.pdf.setLineCap(te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(te){isNaN(te)||(this.ctx.lineWidth=te,this.pdf.setLineWidth(te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(te){["bevel","round","miter"].indexOf(te)!==-1&&(this.ctx.lineJoin=te,this.pdf.setLineJoin(te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(te){isNaN(te)||(this.ctx.miterLimit=te,this.pdf.setMiterLimit(te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(te){this.ctx.textBaseline=te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(te){["right","end","center","left","start"].indexOf(te)!==-1&&(this.ctx.textAlign=te)}});var ee=null,_e=null,se=null;Object.defineProperty(this,"fontFaces",{get:function(){return se},set:function(te){ee=null,_e=null,se=te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(te){var Ne;if(this.ctx.font=te,(Ne=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(te))!==null){var Se=Ne[1];Ne[2];var Ae=Ne[3],ye=Ne[4];Ne[5];var Le=Ne[6],Re=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ye)[2];ye=Math.floor(Re==="px"?parseFloat(ye)*this.pdf.internal.scaleFactor:Re==="em"?parseFloat(ye)*this.pdf.getFontSize():parseFloat(ye)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ye);var we=function(tt){var st,ke,Ee=[],Je=tt.trim();if(Je==="")return Gy;if(Je in Pj)return[Pj[Je]];for(;Je!=="";){switch(ke=null,st=(Je=Rj(Je)).charAt(0)){case'"':case"'":ke=a9(Je.substring(1),st);break;default:ke=s9(Je)}if(ke===null||(Ee.push(ke[0]),(Je=Rj(ke[1]))!==""&&Je.charAt(0)!==","))return Gy;Je=Je.replace(/^,/,"")}return Ee}(Le);if(this.fontFaces){var Pe=function(tt,st){var ke=tt.getFontList(),Ee=JSON.stringify(ke);if(ee===null||_e!==Ee){var Je=function(rt){var Ze=[];return Object.keys(rt).forEach(function(xt){rt[xt].forEach(function(mt){var bt=null;switch(mt){case"bold":bt={family:xt,weight:"bold"};break;case"italic":bt={family:xt,style:"italic"};break;case"bolditalic":bt={family:xt,weight:"bold",style:"italic"};break;case"":case"normal":bt={family:xt}}bt!==null&&(bt.ref={name:xt,style:mt},Ze.push(bt))})}),Ze}(ke);ee=function(rt){for(var Ze={},xt=0;xt<rt.length;++xt){var mt=Vy(rt[xt]),bt=mt.family,vt=mt.stretch,Nt=mt.style,Bt=mt.weight;Ze[bt]=Ze[bt]||{},Ze[bt][vt]=Ze[bt][vt]||{},Ze[bt][vt][Nt]=Ze[bt][vt][Nt]||{},Ze[bt][vt][Nt][Bt]=mt}return Ze}(Je.concat(st)),_e=Ee}return ee}(this.pdf,this.fontFaces),ze=we.map(function(tt){return{family:tt,stretch:"normal",weight:Ae,style:Se}}),Ve=function(tt,st,ke){for(var Ee=(ke=ke||{}).defaultFontFamily||"times",Je=Object.assign({},n9,ke.genericFontFamilies||{}),rt=null,Ze=null,xt=0;xt<st.length;++xt)if(Je[(rt=Vy(st[xt])).family]&&(rt.family=Je[rt.family]),tt.hasOwnProperty(rt.family)){Ze=tt[rt.family];break}if(!(Ze=Ze||tt[Ee]))throw new Error("Could not find a font-family for the rule '"+Dj(rt)+"' and default family '"+Ee+"'.");if(Ze=function(mt,bt){if(bt[mt])return bt[mt];var vt=dw[mt],Nt=vt<=dw.normal?-1:1,Bt=Uj(bt,w6,vt,Nt);if(!Bt)throw new Error("Could not find a matching font-stretch value for "+mt);return Bt}(rt.stretch,Ze),Ze=function(mt,bt){if(bt[mt])return bt[mt];for(var vt=b6[mt],Nt=0;Nt<vt.length;++Nt)if(bt[vt[Nt]])return bt[vt[Nt]];throw new Error("Could not find a matching font-style for "+mt)}(rt.style,Ze),!(Ze=function(mt,bt){if(bt[mt])return bt[mt];if(mt===400&&bt[500])return bt[500];if(mt===500&&bt[400])return bt[400];var vt=r9[mt],Nt=Uj(bt,_6,vt,mt<400?-1:1);if(!Nt)throw new Error("Could not find a matching font-weight for value "+mt);return Nt}(rt.weight,Ze)))throw new Error("Failed to resolve a font for the rule '"+Dj(rt)+"'.");return Ze}(Pe,ze);this.pdf.setFont(Ve.ref.name,Ve.ref.style)}else{var lt="";(Ae==="bold"||parseInt(Ae,10)>=700||Se==="bold")&&(lt="bold"),Se==="italic"&&(lt+="italic"),lt.length===0&&(lt="normal");for(var pe="",Fe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ke=0;Ke<we.length;Ke++){if(this.pdf.internal.getFont(we[Ke],lt,{noFallback:!0,disableWarning:!0})!==void 0){pe=we[Ke];break}if(lt==="bolditalic"&&this.pdf.internal.getFont(we[Ke],"bold",{noFallback:!0,disableWarning:!0})!==void 0)pe=we[Ke],lt="bold";else if(this.pdf.internal.getFont(we[Ke],"normal",{noFallback:!0,disableWarning:!0})!==void 0){pe=we[Ke],lt="normal";break}}if(pe===""){for(var Xe=0;Xe<we.length;Xe++)if(Fe[we[Xe]]){pe=Fe[we[Xe]];break}}pe=pe===""?"Times":pe,this.pdf.setFont(pe,lt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(te){this.ctx.globalCompositeOperation=te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(te){this.ctx.globalAlpha=te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(te){this.ctx.lineDashOffset=te,K.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(te){this.ctx.lineDash=te,K.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(te){this.ctx.ignoreClearRect=!!te}})};h.prototype.setLineDash=function(B){this.lineDash=B},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){x.call(this,"fill",!1)},h.prototype.stroke=function(){x.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(B,L){if(isNaN(B)||isNaN(L))throw qr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var U=this.ctx.transform.applyToPoint(new o(B,L));this.path.push({type:"mt",x:U.x,y:U.y}),this.ctx.lastPoint=new o(B,L)},h.prototype.closePath=function(){var B=new o(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&Lr(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){B=new o(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(B.x,B.y)},h.prototype.lineTo=function(B,L){if(isNaN(B)||isNaN(L))throw qr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var U=this.ctx.transform.applyToPoint(new o(B,L));this.path.push({type:"lt",x:U.x,y:U.y}),this.ctx.lastPoint=new o(U.x,U.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),x.call(this,null,!0)},h.prototype.quadraticCurveTo=function(B,L,U,D){if(isNaN(U)||isNaN(D)||isNaN(B)||isNaN(L))throw qr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Q=this.ctx.transform.applyToPoint(new o(U,D)),z=this.ctx.transform.applyToPoint(new o(B,L));this.path.push({type:"qct",x1:z.x,y1:z.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},h.prototype.bezierCurveTo=function(B,L,U,D,Q,z){if(isNaN(Q)||isNaN(z)||isNaN(B)||isNaN(L)||isNaN(U)||isNaN(D))throw qr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var G=this.ctx.transform.applyToPoint(new o(Q,z)),Z=this.ctx.transform.applyToPoint(new o(B,L)),R=this.ctx.transform.applyToPoint(new o(U,D));this.path.push({type:"bct",x1:Z.x,y1:Z.y,x2:R.x,y2:R.y,x:G.x,y:G.y}),this.ctx.lastPoint=new o(G.x,G.y)},h.prototype.arc=function(B,L,U,D,Q,z){if(isNaN(B)||isNaN(L)||isNaN(U)||isNaN(D)||isNaN(Q))throw qr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(z=!!z,!this.ctx.transform.isIdentity){var G=this.ctx.transform.applyToPoint(new o(B,L));B=G.x,L=G.y;var Z=this.ctx.transform.applyToPoint(new o(0,U)),R=this.ctx.transform.applyToPoint(new o(0,0));U=Math.sqrt(Math.pow(Z.x-R.x,2)+Math.pow(Z.y-R.y,2))}Math.abs(Q-D)>=2*Math.PI&&(D=0,Q=2*Math.PI),this.path.push({type:"arc",x:B,y:L,radius:U,startAngle:D,endAngle:Q,counterclockwise:z})},h.prototype.arcTo=function(B,L,U,D,Q){throw new Error("arcTo not implemented.")},h.prototype.rect=function(B,L,U,D){if(isNaN(B)||isNaN(L)||isNaN(U)||isNaN(D))throw qr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(B,L),this.lineTo(B+U,L),this.lineTo(B+U,L+D),this.lineTo(B,L+D),this.lineTo(B,L),this.lineTo(B+U,L),this.lineTo(B,L)},h.prototype.fillRect=function(B,L,U,D){if(isNaN(B)||isNaN(L)||isNaN(U)||isNaN(D))throw qr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!A.call(this)){var Q={};this.lineCap!=="butt"&&(Q.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Q.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(B,L,U,D),this.fill(),Q.hasOwnProperty("lineCap")&&(this.lineCap=Q.lineCap),Q.hasOwnProperty("lineJoin")&&(this.lineJoin=Q.lineJoin)}},h.prototype.strokeRect=function(B,L,U,D){if(isNaN(B)||isNaN(L)||isNaN(U)||isNaN(D))throw qr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(B,L,U,D),this.stroke())},h.prototype.clearRect=function(B,L,U,D){if(isNaN(B)||isNaN(L)||isNaN(U)||isNaN(D))throw qr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(B,L,U,D))},h.prototype.save=function(B){B=typeof B!="boolean"||B;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),B){this.ctx.fontSize=this.pdf.internal.getFontSize();var D=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=D}},h.prototype.restore=function(B){B=typeof B!="boolean"||B;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("Q");this.pdf.setPage(L),B&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(B){var L,U,D,Q;if(B.isCanvasGradient===!0&&(B=B.getColor()),!B)return{r:0,g:0,b:0,a:0,style:B};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(B))L=0,U=0,D=0,Q=0;else{var z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(B);if(z!==null)L=parseInt(z[1]),U=parseInt(z[2]),D=parseInt(z[3]),Q=1;else if((z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(B))!==null)L=parseInt(z[1]),U=parseInt(z[2]),D=parseInt(z[3]),Q=parseFloat(z[4]);else{if(Q=1,typeof B=="string"&&B.charAt(0)!=="#"){var G=new h6(B);B=G.ok?G.toHex():"#000000"}B.length===4?(L=B.substring(1,2),L+=L,U=B.substring(2,3),U+=U,D=B.substring(3,4),D+=D):(L=B.substring(1,3),U=B.substring(3,5),D=B.substring(5,7)),L=parseInt(L,16),U=parseInt(U,16),D=parseInt(D,16)}}return{r:L,g:U,b:D,a:Q,style:B}},A=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(B,L,U,D){if(isNaN(L)||isNaN(U)||typeof B!="string")throw qr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(D=isNaN(D)?void 0:D,!A.call(this)){var Q=J(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;F.call(this,{text:B,x:L,y:U,scale:z,angle:Q,align:this.textAlign,maxWidth:D})}},h.prototype.strokeText=function(B,L,U,D){if(isNaN(L)||isNaN(U)||typeof B!="string")throw qr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){D=isNaN(D)?void 0:D;var Q=J(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;F.call(this,{text:B,x:L,y:U,scale:z,renderingMode:"stroke",angle:Q,align:this.textAlign,maxWidth:D})}},h.prototype.measureText=function(B){if(typeof B!="string")throw qr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,U=this.pdf.internal.scaleFactor,D=L.internal.getFontSize(),Q=L.getStringUnitWidth(B)*D/L.internal.scaleFactor;return new function(z){var G=(z=z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return G}}),this}({width:Q*=Math.round(96*U/72*1e4)/1e4})},h.prototype.scale=function(B,L){if(isNaN(B)||isNaN(L))throw qr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var U=new c(B,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(U)},h.prototype.rotate=function(B){if(isNaN(B))throw qr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(B),Math.sin(B),-Math.sin(B),Math.cos(B),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},h.prototype.translate=function(B,L){if(isNaN(B)||isNaN(L))throw qr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var U=new c(1,0,0,1,B,L);this.ctx.transform=this.ctx.transform.multiply(U)},h.prototype.transform=function(B,L,U,D,Q,z){if(isNaN(B)||isNaN(L)||isNaN(U)||isNaN(D)||isNaN(Q)||isNaN(z))throw qr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var G=new c(B,L,U,D,Q,z);this.ctx.transform=this.ctx.transform.multiply(G)},h.prototype.setTransform=function(B,L,U,D,Q,z){B=isNaN(B)?1:B,L=isNaN(L)?0:L,U=isNaN(U)?0:U,D=isNaN(D)?1:D,Q=isNaN(Q)?0:Q,z=isNaN(z)?0:z,this.ctx.transform=new c(B,L,U,D,Q,z)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(B,L,U,D,Q,z,G,Z,R){var le=this.pdf.getImageProperties(B),ee=1,_e=1,se=1,te=1;D!==void 0&&Z!==void 0&&(se=Z/D,te=R/Q,ee=le.width/D*Z/D,_e=le.height/Q*R/Q),z===void 0&&(z=L,G=U,L=0,U=0),D!==void 0&&Z===void 0&&(Z=D,R=Q),D===void 0&&Z===void 0&&(Z=le.width,R=le.height);var Ne=this.ctx.transform.decompose(),Se=J(Ne.rotate.shx),Ae=new c,ye=(Ae=(Ae=(Ae=Ae.multiply(Ne.translate)).multiply(Ne.skew)).multiply(Ne.scale)).applyToRectangle(new l(z-L*se,G-U*te,D*ee,Q*_e));if(this.autoPaging){for(var Le,Re=v.call(this,ye),we=[],Pe=0;Pe<Re.length;Pe+=1)we.indexOf(Re[Pe])===-1&&we.push(Re[Pe]);y(we);for(var ze=we[0],Ve=we[we.length-1],lt=ze;lt<Ve+1;lt++){this.pdf.setPage(lt);var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Fe=lt===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Xe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tt=lt===1?0:Ke+(lt-2)*Xe;if(this.ctx.clip_path.length!==0){var st=this.path;Le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(Le,this.posX+this.margin[3],-tt+Fe+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=st}var ke=JSON.parse(JSON.stringify(ye));ke=g([ke],this.posX+this.margin[3],-tt+Fe+this.ctx.prevPageLastElemOffset)[0];var Ee=(lt>ze||lt<Ve)&&m.call(this);Ee&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,Xe,null).clip().discardPath()),this.pdf.addImage(B,"JPEG",ke.x,ke.y,ke.w,ke.h,null,null,Se),Ee&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(B,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,Se)};var v=function(B,L,U){var D=[];L=L||this.pdf.internal.pageSize.width,U=U||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Q=this.posY+this.ctx.prevPageLastElemOffset;switch(B.type){default:case"mt":case"lt":D.push(Math.floor((B.y+Q)/U)+1);break;case"arc":D.push(Math.floor((B.y+Q-B.radius)/U)+1),D.push(Math.floor((B.y+Q+B.radius)/U)+1);break;case"qct":var z=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,B.x1,B.y1,B.x,B.y);D.push(Math.floor((z.y+Q)/U)+1),D.push(Math.floor((z.y+z.h+Q)/U)+1);break;case"bct":var G=V(this.ctx.lastPoint.x,this.ctx.lastPoint.y,B.x1,B.y1,B.x2,B.y2,B.x,B.y);D.push(Math.floor((G.y+Q)/U)+1),D.push(Math.floor((G.y+G.h+Q)/U)+1);break;case"rect":D.push(Math.floor((B.y+Q)/U)+1),D.push(Math.floor((B.y+B.h+Q)/U)+1)}for(var Z=0;Z<D.length;Z+=1)for(;this.pdf.internal.getNumberOfPages()<D[Z];)p.call(this);return D},p=function(){var B=this.fillStyle,L=this.strokeStyle,U=this.font,D=this.lineCap,Q=this.lineWidth,z=this.lineJoin;this.pdf.addPage(),this.fillStyle=B,this.strokeStyle=L,this.font=U,this.lineCap=D,this.lineWidth=Q,this.lineJoin=z},g=function(B,L,U){for(var D=0;D<B.length;D++)switch(B[D].type){case"bct":B[D].x2+=L,B[D].y2+=U;case"qct":B[D].x1+=L,B[D].y1+=U;default:B[D].x+=L,B[D].y+=U}return B},y=function(B){return B.sort(function(L,U){return L-U})},x=function(B,L){var U=this.fillStyle,D=this.strokeStyle,Q=this.lineCap,z=this.lineWidth,G=Math.abs(z*this.ctx.transform.scaleX),Z=this.lineJoin;if(this.autoPaging){for(var R,le,ee=JSON.parse(JSON.stringify(this.path)),_e=JSON.parse(JSON.stringify(this.path)),se=[],te=0;te<_e.length;te++)if(_e[te].x!==void 0)for(var Ne=v.call(this,_e[te]),Se=0;Se<Ne.length;Se+=1)se.indexOf(Ne[Se])===-1&&se.push(Ne[Se]);for(var Ae=0;Ae<se.length;Ae++)for(;this.pdf.internal.getNumberOfPages()<se[Ae];)p.call(this);y(se);for(var ye=se[0],Le=se[se.length-1],Re=ye;Re<Le+1;Re++){this.pdf.setPage(Re),this.fillStyle=U,this.strokeStyle=D,this.lineCap=Q,this.lineWidth=G,this.lineJoin=Z;var we=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Pe=Re===1?this.posY+this.margin[0]:this.margin[0],ze=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ve=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],lt=Re===1?0:ze+(Re-2)*Ve;if(this.ctx.clip_path.length!==0){var pe=this.path;R=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(R,this.posX+this.margin[3],-lt+Pe+this.ctx.prevPageLastElemOffset),w.call(this,B,!0),this.path=pe}if(le=JSON.parse(JSON.stringify(ee)),this.path=g(le,this.posX+this.margin[3],-lt+Pe+this.ctx.prevPageLastElemOffset),L===!1||Re===0){var Fe=(Re>ye||Re<Le)&&m.call(this);Fe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],we,Ve,null).clip().discardPath()),w.call(this,B,L),Fe&&this.pdf.restoreGraphicsState()}this.lineWidth=z}this.path=ee}else this.lineWidth=G,w.call(this,B,L),this.lineWidth=z},w=function(B,L){if((B!=="stroke"||L||!b.call(this))&&(B==="stroke"||L||!A.call(this))){for(var U,D,Q=[],z=this.path,G=0;G<z.length;G++){var Z=z[G];switch(Z.type){case"begin":Q.push({begin:!0});break;case"close":Q.push({close:!0});break;case"mt":Q.push({start:Z,deltas:[],abs:[]});break;case"lt":var R=Q.length;if(z[G-1]&&!isNaN(z[G-1].x)&&(U=[Z.x-z[G-1].x,Z.y-z[G-1].y],R>0)){for(;R>=0;R--)if(Q[R-1].close!==!0&&Q[R-1].begin!==!0){Q[R-1].deltas.push(U),Q[R-1].abs.push(Z);break}}break;case"bct":U=[Z.x1-z[G-1].x,Z.y1-z[G-1].y,Z.x2-z[G-1].x,Z.y2-z[G-1].y,Z.x-z[G-1].x,Z.y-z[G-1].y],Q[Q.length-1].deltas.push(U);break;case"qct":var le=z[G-1].x+2/3*(Z.x1-z[G-1].x),ee=z[G-1].y+2/3*(Z.y1-z[G-1].y),_e=Z.x+2/3*(Z.x1-Z.x),se=Z.y+2/3*(Z.y1-Z.y),te=Z.x,Ne=Z.y;U=[le-z[G-1].x,ee-z[G-1].y,_e-z[G-1].x,se-z[G-1].y,te-z[G-1].x,Ne-z[G-1].y],Q[Q.length-1].deltas.push(U);break;case"arc":Q.push({deltas:[],abs:[],arc:!0}),Array.isArray(Q[Q.length-1].abs)&&Q[Q.length-1].abs.push(Z)}}D=L?null:B==="stroke"?"stroke":"fill";for(var Se=!1,Ae=0;Ae<Q.length;Ae++)if(Q[Ae].arc)for(var ye=Q[Ae].abs,Le=0;Le<ye.length;Le++){var Re=ye[Le];Re.type==="arc"?C.call(this,Re.x,Re.y,Re.radius,Re.startAngle,Re.endAngle,Re.counterclockwise,void 0,L,!Se):I.call(this,Re.x,Re.y),Se=!0}else if(Q[Ae].close===!0)this.pdf.internal.out("h"),Se=!1;else if(Q[Ae].begin!==!0){var we=Q[Ae].start.x,Pe=Q[Ae].start.y;O.call(this,Q[Ae].deltas,we,Pe),Se=!0}D&&j.call(this,D),L&&E.call(this)}},N=function(B){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,U=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return B-U;case"top":return B+L-U;case"hanging":return B+L-2*U;case"middle":return B+L/2-U;default:return B}},_=function(B){return B+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var B=function(){};return B.colorStops=[],B.addColorStop=function(L,U){this.colorStops.push([L,U])},B.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},B.isCanvasGradient=!0,B},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(B,L,U,D,Q,z,G,Z,R){for(var le=P.call(this,U,D,Q,z),ee=0;ee<le.length;ee++){var _e=le[ee];ee===0&&(R?S.call(this,_e.x1+B,_e.y1+L):I.call(this,_e.x1+B,_e.y1+L)),M.call(this,B,L,_e.x2,_e.y2,_e.x3,_e.y3,_e.x4,_e.y4)}Z?E.call(this):j.call(this,G)},j=function(B){switch(B){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},E=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(B,L){this.pdf.internal.out(r(B)+" "+n(L)+" m")},F=function(B){var L;switch(B.align){case"right":case"end":L="right";break;case"center":L="center";break;default:L="left"}var U,D,Q,z=this.pdf.getTextDimensions(B.text),G=N.call(this,B.y),Z=_.call(this,G)-z.h,R=this.ctx.transform.applyToPoint(new o(B.x,G));if(this.autoPaging){var le=this.ctx.transform.decompose(),ee=new c;ee=(ee=(ee=ee.multiply(le.translate)).multiply(le.skew)).multiply(le.scale);for(var _e=this.ctx.transform.applyToRectangle(new l(B.x,G,z.w,z.h)),se=ee.applyToRectangle(new l(B.x,Z,z.w,z.h)),te=v.call(this,se),Ne=[],Se=0;Se<te.length;Se+=1)Ne.indexOf(te[Se])===-1&&Ne.push(te[Se]);y(Ne);for(var Ae=Ne[0],ye=Ne[Ne.length-1],Le=Ae;Le<ye+1;Le++){this.pdf.setPage(Le);var Re=Le===1?this.posY+this.margin[0]:this.margin[0],we=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pe=this.pdf.internal.pageSize.height-this.margin[2],ze=Pe-this.margin[0],Ve=this.pdf.internal.pageSize.width-this.margin[1],lt=Ve-this.margin[3],pe=Le===1?0:we+(Le-2)*ze;if(this.ctx.clip_path.length!==0){var Fe=this.path;U=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(U,this.posX+this.margin[3],-1*pe+Re),w.call(this,"fill",!0),this.path=Fe}var Ke=g([JSON.parse(JSON.stringify(se))],this.posX+this.margin[3],-pe+Re+this.ctx.prevPageLastElemOffset)[0];B.scale>=.01&&(D=this.pdf.internal.getFontSize(),this.pdf.setFontSize(D*B.scale),Q=this.lineWidth,this.lineWidth=Q*B.scale);var Xe=this.autoPaging!=="text";if(Xe||Ke.y+Ke.h<=Pe){if(Xe||Ke.y>=Re&&Ke.x<=Ve){var tt=Xe?B.text:this.pdf.splitTextToSize(B.text,B.maxWidth||Ve-Ke.x)[0],st=g([JSON.parse(JSON.stringify(_e))],this.posX+this.margin[3],-pe+Re+this.ctx.prevPageLastElemOffset)[0],ke=Xe&&(Le>Ae||Le<ye)&&m.call(this);ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,ze,null).clip().discardPath()),this.pdf.text(tt,st.x,st.y,{angle:B.angle,align:L,renderingMode:B.renderingMode}),ke&&this.pdf.restoreGraphicsState()}}else Ke.y<Pe&&(this.ctx.prevPageLastElemOffset+=Pe-Ke.y);B.scale>=.01&&(this.pdf.setFontSize(D),this.lineWidth=Q)}}else B.scale>=.01&&(D=this.pdf.internal.getFontSize(),this.pdf.setFontSize(D*B.scale),Q=this.lineWidth,this.lineWidth=Q*B.scale),this.pdf.text(B.text,R.x+this.posX,R.y+this.posY,{angle:B.angle,align:L,renderingMode:B.renderingMode,maxWidth:B.maxWidth}),B.scale>=.01&&(this.pdf.setFontSize(D),this.lineWidth=Q)},I=function(B,L,U,D){U=U||0,D=D||0,this.pdf.internal.out(r(B+U)+" "+n(L+D)+" l")},O=function(B,L,U){return this.pdf.lines(B,L,U,null,null)},M=function(B,L,U,D,Q,z,G,Z){this.pdf.internal.out([t(s(U+B)),t(i(D+L)),t(s(Q+B)),t(i(z+L)),t(s(G+B)),t(i(Z+L)),"c"].join(" "))},P=function(B,L,U,D){for(var Q=2*Math.PI,z=Math.PI/2;L>U;)L-=Q;var G=Math.abs(U-L);G<Q&&D&&(G=Q-G);for(var Z=[],R=D?-1:1,le=L;G>1e-5;){var ee=le+R*Math.min(G,z);Z.push(X.call(this,B,le,ee)),G-=Math.abs(ee-le),le=ee}return Z},X=function(B,L,U){var D=(U-L)/2,Q=B*Math.cos(D),z=B*Math.sin(D),G=Q,Z=-z,R=G*G+Z*Z,le=R+G*Q+Z*z,ee=4/3*(Math.sqrt(2*R*le)-le)/(G*z-Z*Q),_e=G-ee*Z,se=Z+ee*G,te=_e,Ne=-se,Se=D+L,Ae=Math.cos(Se),ye=Math.sin(Se);return{x1:B*Math.cos(L),y1:B*Math.sin(L),x2:_e*Ae-se*ye,y2:_e*ye+se*Ae,x3:te*Ae-Ne*ye,y3:te*ye+Ne*Ae,x4:B*Math.cos(U),y4:B*Math.sin(U)}},J=function(B){return 180*B/Math.PI},H=function(B,L,U,D,Q,z){var G=B+.5*(U-B),Z=L+.5*(D-L),R=Q+.5*(U-Q),le=z+.5*(D-z),ee=Math.min(B,Q,G,R),_e=Math.max(B,Q,G,R),se=Math.min(L,z,Z,le),te=Math.max(L,z,Z,le);return new l(ee,se,_e-ee,te-se)},V=function(B,L,U,D,Q,z,G,Z){var R,le,ee,_e,se,te,Ne,Se,Ae,ye,Le,Re,we,Pe,ze=U-B,Ve=D-L,lt=Q-U,pe=z-D,Fe=G-Q,Ke=Z-z;for(le=0;le<41;le++)Ae=(Ne=(ee=B+(R=le/40)*ze)+R*((se=U+R*lt)-ee))+R*(se+R*(Q+R*Fe-se)-Ne),ye=(Se=(_e=L+R*Ve)+R*((te=D+R*pe)-_e))+R*(te+R*(z+R*Ke-te)-Se),le==0?(Le=Ae,Re=ye,we=Ae,Pe=ye):(Le=Math.min(Le,Ae),Re=Math.min(Re,ye),we=Math.max(we,Ae),Pe=Math.max(Pe,ye));return new l(Math.round(Le),Math.round(Re),Math.round(we-Le),Math.round(Pe-Re))},K=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var B,L,U=(B=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:B,lineDashOffset:L}));this.prevLineDash!==U&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=U)}}})(Lt.API),function(e){var t=function(o){var l,c,u,d,h,f,A,b,m,v;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(h=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(f=(h=((h=((h=((h=(h-(v=h%85))/85)-(m=h%85))/85)-(b=h%85))/85)-(A=h%85))/85)%85,c.push(f+33,A+33,b+33,m+33,v+33)):c.push(122);return function(p,g){for(var y=g;y>0;y--)p.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,h,f=String,A="length",b=255,m="charCodeAt",v="slice",p="replace";for(o[v](-2),o=o[v](0,-2)[p](/\s/g,"")[p]("z","!!!!!"),u=[],d=0,h=(o+=l="uuuuu"[v](o[A]%5||5))[A];h>d;d+=5)c=52200625*(o[m](d)-33)+614125*(o[m](d+1)-33)+7225*(o[m](d+2)-33)+85*(o[m](d+3)-33)+(o[m](d+4)-33),u.push(b&c>>24,b&c>>16,b&c>>8,b&c);return function(g,y){for(var x=y;x>0;x--)g.pop()}(u,l[A]),f.fromCharCode.apply(f,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=aw(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=s(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=i(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Lt.API),function(e){e.loadFile=function(t,r,n){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var h=new XMLHttpRequest,f=0,A=function(b){var m=b.length,v=[],p=String.fromCharCode;for(f=0;f<m;f+=1)v.push(p(255&b.charCodeAt(f)));return v.join("")};if(h.open("GET",c,!u),h.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(h.onload=function(){h.status===200?d(A(this.responseText)):d(void 0)}),h.send(null),u&&h.status===200)return A(h.responseText)}(s,i,o)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Lt.API),function(e){function t(){return(zt.html2canvas?Promise.resolve(zt.html2canvas):ky(()=>Promise.resolve().then(()=>zV),void 0)).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(zt.DOMPurify?Promise.resolve(zt.DOMPurify):ky(()=>Promise.resolve().then(()=>ree),void 0)).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Lr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},i=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),h=c.firstChild;h;h=h.nextSibling)u!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||d.appendChild(l(h,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:s("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var A=0;A<d.length;++A){var b=d[A],m=b.src.find(function(v){return v.format==="truetype"});m&&u.addFont(m.url,b.ref.name,b.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,u.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||Lt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,h){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(f){return u.updateProgress(null,d),f}).then(d,h).then(function(f){return u.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),f=u.call(h,l,c);return o.convert(f,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Lt.getPageSize=function(l,c,u){if(Lr(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var h,f=(""+u).toLowerCase(),A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+c}var b,m=0,v=0;if(A.hasOwnProperty(f))m=A[f][1]/h,v=A[f][0]/h;else try{m=u[1],v=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",v>m&&(b=v,v=m,m=b);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",m>v&&(b=v,v=m,m=b)}return{width:v,height:m,unit:c,k:h,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Vy):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Lt.API),Lt.API.addJS=function(e){return Mj=e,this.internal.events.subscribe("postPutResources",function(){Yp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Yp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Qj=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Mj+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Yp!==void 0&&Qj!==void 0&&this.internal.out("/Names <</JavaScript "+Yp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(i=0;i<u;i++){var h=r.internal.newObject();d.push(h);var f=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var A=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<d.length;i++)r.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+A+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,i){var o={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])}(Lt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,i,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(h){for(var f,A=256*h.charCodeAt(4)+h.charCodeAt(5),b=h.length,m={width:0,height:0,numcomponents:1},v=4;v<b;v+=2){if(v+=A,t.indexOf(h.charCodeAt(v+1))!==-1){f=256*h.charCodeAt(v+5)+h.charCodeAt(v+6),m={width:256*h.charCodeAt(v+7)+h.charCodeAt(v+8),height:f,numcomponents:h.charCodeAt(v+9)};break}A=256*h.charCodeAt(v+2)+h.charCodeAt(v+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:s}}return d}}(Lt.API),Lt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,i=HM(e,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,u=i.palette,d=i.depth;s=u&&c===1?function(C){for(var j=C.width,E=C.height,S=C.data,F=C.palette,I=C.depth,O=!1,M=[],P=[],X=void 0,J=!1,H=0,V=0;V<F.length;V++){var K=$4(F[V],4),B=K[0],L=K[1],U=K[2],D=K[3];M.push(B,L,U),D!=null&&(D===0?(H++,P.length<1&&P.push(V)):D<255&&(J=!0))}if(J||H>1){O=!0,P=void 0;var Q=j*E;X=new Uint8Array(Q);for(var z=new DataView(S.buffer),G=0;G<Q;G++){var Z=Wy(z,G,I),R=$4(F[Z],4)[3];X[G]=R}}else H===0&&(P=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:O?8:void 0,colorBytes:S,alphaBytes:X,needSMask:O,palette:M,mask:P}}(i):c===2||c===4?function(C){for(var j=C.data,E=C.width,S=C.height,F=C.channels,I=C.depth,O=F===2?"DeviceGray":"DeviceRGB",M=F-1,P=E*S,X=M,J=P*X,H=1*P,V=Math.ceil(J*I/8),K=Math.ceil(H*I/8),B=new Uint8Array(V),L=new Uint8Array(K),U=new DataView(j.buffer),D=new DataView(B.buffer),Q=new DataView(L.buffer),z=!1,G=0;G<P;G++){for(var Z=G*F,R=0;R<X;R++)Xj(D,Wy(U,Z+R,I),G*X+R,I);var le=Wy(U,Z+X,I);le<(1<<I)-1&&(z=!0),Xj(Q,le,1*G,I)}return{colorSpace:O,colorsPerPixel:M,sMaskBitsPerComponent:z?I:void 0,colorBytes:B,alphaBytes:L,needSMask:z}}(i):function(C){var j=C.data,E=C.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:E,colorsPerPixel:E==="DeviceGray"?1:3,colorBytes:j instanceof Uint16Array?function(S){for(var F=S.length,I=new Uint8Array(2*F),O=new DataView(I.buffer,I.byteOffset,I.byteLength),M=0;M<F;M++)O.setUint16(2*M,S[M],!1);return I}(j):j,needSMask:!1}}(i);var h,f,A,b=s,m=b.colorSpace,v=b.colorsPerPixel,p=b.sMaskBitsPerComponent,g=b.colorBytes,y=b.alphaBytes,x=b.needSMask,w=b.palette,N=b.mask,_=null;return n!==Lt.API.image_compression.NONE&&typeof aw=="function"?(_=function(C){var j;switch(C){case Lt.API.image_compression.FAST:j=11;break;case Lt.API.image_compression.MEDIUM:j=13;break;case Lt.API.image_compression.SLOW:j=14;break;default:j=12}return j}(n),h=this.decode.FLATE_DECODE,f="/Predictor ".concat(_," /Colors ").concat(v," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=$j(g,Math.ceil(o*v*d/8),v,d,n),x&&(A=$j(y,Math.ceil(o*p/8),1,p,n))):(h=void 0,f=void 0,e=g,x&&(A=y)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(A&&this.__addimage__.isArrayBuffer(A)||this.__addimage__.isArrayBufferView(A))&&(A=this.__addimage__.arrayBufferToBinaryString(A)),{alias:r,data:e,index:t,filter:h,decodeParameters:f,transparency:N,palette:w,sMask:A,predictor:_,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:p,colorSpace:m}}},function(e){e.processGIF89A=function(t,r,n,s){var i=new c9(t),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new zy(100).encode(u,100);return e.processJPEG.call(this,d,r,n,s)},e.processGIF87A=e.processGIF89A}(Lt.API),Yi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Yi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){qr.log("bit decode error:"+r)}},Yi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Yi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=i>>4,c=15&i,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Yi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Yi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},Yi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=s*this.width*4+4*i;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},Yi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Yi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},Yi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var i=new Yi(t,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new zy(100).encode(c,100);return e.processJPEG.call(this,u,r,n,s)}}(Lt.API),Jj.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var i=new Jj(t),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},u=new zy(100).encode(c,100);return e.processJPEG.call(this,u,r,n,s)}}(Lt.API),Lt.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,u=0;u<s;u+=4){var d=n[u],h=n[u+1],f=n[u+2],A=n[u+3];i[l++]=d,i[l++]=h,i[l++]=f,o[c++]=A}var b=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Lt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Cd=Lt.API,Jp=Cd.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,h=t.doKerning!==!1,f=0,A=e.length,b=0,m=l[0]||c,v=[];for(r=0;r<A;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?v.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(f=h&&Lr(u[n])==="object"&&!isNaN(parseInt(u[n][b],10))?u[n][b]/d:0,v.push((l[n]||m)/c+f)),b=n;return v},Hj=Cd.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return Cd.processArabic&&(e=Cd.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:Jp.apply(this,arguments).reduce(function(i,o){return i+o},0)},qj=function(e,t,r,n){for(var s=[],i=0,o=e.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;s.push(e.slice(0,i));var c=i;for(l=0;i!==o;)l+t[i]>n&&(s.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&s.push(e.slice(c,i)),s},Kj=function(e,t,r){r||(r={});var n,s,i,o,l,c,u,d=[],h=[d],f=r.textIndent||0,A=0,b=0,m=e.split(" "),v=Jp.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var p=Array(c).join(" "),g=[];m.map(function(x){(x=x.split(/\s*\n/)).length>1?g=g.concat(x.map(function(w,N){return(N&&w.length?`
`:"")+w})):g.push(x[0])}),m=g,c=Hj.apply(this,[p,r])}for(i=0,o=m.length;i<o;i++){var y=0;if(n=m[i],c&&n[0]==`
`&&(n=n.substr(1),y=1),f+A+(b=(s=Jp.apply(this,[n,r])).reduce(function(x,w){return x+w},0))>t||y){if(b>t){for(l=qj.apply(this,[n,s,t-(f+A),t]),d.push(l.shift()),d=[l.pop()];l.length;)h.push([l.shift()]);b=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(x,w){return x+w},0)}else d=[n];h.push(d),f=b+c,A=v}else d.push(n),f+=A+b,A=v}return u=c?function(x,w){return(w?p:"")+x.join(" ")}:function(x){return x.join(" ")},h.map(u)},Cd.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var h=this.internal.getFont(d.fontName,d.fontStyle),f="Unicode";return h.metadata[f]?{widths:h.metadata[f].widths||{0:1},kerning:h.metadata[f].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(Kj.apply(this,[n[l],o,i]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},i=0;i<16;i++)n[r[i]]=t[i],s[t[i]]=r[i];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=e.__fontmetrics__.compress=function(f){var A,b,m,v,p=["{"];for(var g in f){if(A=f[g],isNaN(parseInt(g,10))?b="'"+g+"'":(g=parseInt(g,10),b=(b=o(g).slice(2)).slice(0,-1)+s[b.slice(-1)]),typeof A=="number")A<0?(m=o(A).slice(3),v="-"):(m=o(A).slice(2),v=""),m=v+m.slice(0,-1)+s[m.slice(-1)];else{if(Lr(A)!=="object")throw new Error("Don't know what to do with value type "+Lr(A)+".");m=l(A)}p.push(b+m)}return p.push("}"),p.join("")},c=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var A,b,m,v,p={},g=1,y=p,x=[],w="",N="",_=f.length-1,C=1;C<_;C+=1)(v=f[C])=="'"?A?(m=A.join(""),A=void 0):A=[]:A?A.push(v):v=="{"?(x.push([y,m]),y={},m=void 0):v=="}"?((b=x.pop())[0][b[1]]=y,m=void 0,y=b[0]):v=="-"?g=-1:m===void 0?n.hasOwnProperty(v)?(w+=n[v],m=parseInt(w,16)*g,g=1,w=""):w+=v:n.hasOwnProperty(v)?(N+=n[v],y[m]=parseInt(N,16)*g,g=1,m=void 0,N=""):N+=v;return p},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},h={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var A=f.font,b=h.Unicode[A.postScriptName];b&&(A.metadata.Unicode={},A.metadata.Unicode.widths=b.widths,A.metadata.Unicode.kerning=b.kerning);var m=d.Unicode[A.postScriptName];m&&(A.metadata.Unicode.encoding=m,A.encoding=m.codePages[0])}])}(Lt.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=r.charCodeAt(i);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Xm(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(Lt),Lt.API.addSvgAsImage=function(e,t,r,n,s,i,o,l){if(isNaN(t)||isNaN(r))throw qr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw qr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(zt.canvg?Promise.resolve(zt.canvg):ky(()=>import("./index.es-BJvTPZa8.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(d)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,r,n,s,o,l)})},Lt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},Lt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,h=0;function f(b,m){var v,p=!1;for(v=0;v<b.length;v+=1)b[v]===m&&(p=!0);return p}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var A=l.length;for(h=0;h<A;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(Lr(e)==="object"){for(s in e)if(i=e[s],f(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&f(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(d=0;d<i[u].length;d+=1)typeof i[u][d]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,m=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?m.push("/"+b+" /"+r[b].value):m.push("/"+b+" "+r[b].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Lt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],h=0,f=i.length;h<f;++h){if(l=o.metadata.characterToGlyph(i.charCodeAt(h)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(i){var o,l,c,u,d,h,f;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,f=(l=Object.keys(i).sort(function(A,b){return A-b})).length;h<f;h++)o=l[h],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(u=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),A="",b=0;b<f.length;b++)A+=String.fromCharCode(f[b]);var m=u();d({data:A,addLength1:!0,objectId:m}),c("endobj");var v=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var p=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Rd(l.fontName)),c("/FontFile2 "+m+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var g=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Rd(l.fontName)),c("/FontDescriptor "+p+" 0 R"),c("/W "+e.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+v+" 0 R"),c("/BaseFont /"+Rd(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+g+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,f="",A=0;A<h.length;A++)f+=String.fromCharCode(h[A]);var b=u();d({data:f,addLength1:!0,objectId:b}),c("endobj");var m=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:m}),c("endobj");var v=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+b+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Rd(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var p=0;p<l.metadata.hmtx.widths.length;p++)l.metadata.hmtx.widths[p]=parseInt(l.metadata.hmtx.widths[p]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Rd(l.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,l=i.text||"",c=i.x,u=i.y,d=i.options||{},h=i.mutex||{},f=h.pdfEscape,A=h.activeFontKey,b=h.fonts,m=A,v="",p=0,g="",y=b[m].encoding;if(b[m].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:h};for(g=l,m=A,Array.isArray(l)&&(g=l[0]),p=0;p<g.length;p+=1)b[m].metadata.hasOwnProperty("cmap")&&(o=b[m].metadata.cmap.unicode.codeMap[g[p].charCodeAt(0)]),o||g[p].charCodeAt(0)<256&&b[m].metadata.hasOwnProperty("Unicode")?v+=g[p]:v+="";var x="";return parseInt(m.slice(1))<14||y==="WinAnsiEncoding"?x=f(v,m).split("").map(function(w){return w.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(x=r(v,b[m])),h.isHex=!0,{text:x,x:c,y:u,options:d,mutex:h}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([s(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(s(Object.assign({},c,{text:o[u]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:o})).text}])}(Lt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Lt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,i,o,l,c,u,d,h=t,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],A=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],p=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,y=0;this.__bidiEngine__={};var x=function(S){var F=S.charCodeAt(),I=F>>8,O=m[I];return O!==void 0?h[256*O+(255&F)]:I===252||I===253?"AL":p.test(I)?"L":I===8?"R":"N"},w=function(S){for(var F,I=0;I<S.length;I++){if((F=x(S.charAt(I)))==="L")return!1;if(F==="R")return!0}return!1},N=function(S,F,I,O){var M,P,X,J,H=F[O];switch(H){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(H="AN");break;case"AL":g=!0,H="R";break;case"WS":case"BN":H="N";break;case"CS":O<1||O+1>=F.length||(M=I[O-1])!=="EN"&&M!=="AN"||(P=F[O+1])!=="EN"&&P!=="AN"?H="N":g&&(P="AN"),H=P===M?P:"N";break;case"ES":H=(M=O>0?I[O-1]:"B")==="EN"&&O+1<F.length&&F[O+1]==="EN"?"EN":"N";break;case"ET":if(O>0&&I[O-1]==="EN"){H="EN";break}if(g){H="N";break}for(X=O+1,J=F.length;X<J&&F[X]==="ET";)X++;H=X<J&&F[X]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(J=F.length,X=O+1;X<J&&F[X]==="NSM";)X++;if(X<J){var V=S[O],K=V>=1425&&V<=2303||V===64286;if(M=F[X],K&&(M==="R"||M==="AL")){H="R";break}}}H=O<1||(M=F[O-1])==="B"?"N":I[O-1];break;case"B":g=!1,s=!0,H=y;break;case"S":i=!0,H="N"}return H},_=function(S,F,I){var O=S.split("");return I&&C(O,I,{hiLevel:y}),O.reverse(),F&&F.reverse(),O.join("")},C=function(S,F,I){var O,M,P,X,J,H=-1,V=S.length,K=0,B=[],L=y?A:f,U=[];for(g=!1,s=!1,i=!1,M=0;M<V;M++)U[M]=x(S[M]);for(P=0;P<V;P++){if(J=K,B[P]=N(S,U,B,P),O=240&(K=L[J][b[B[P]]]),K&=15,F[P]=X=L[K][5],O>0)if(O===16){for(M=H;M<P;M++)F[M]=1;H=-1}else H=-1;if(L[K][6])H===-1&&(H=P);else if(H>-1){for(M=H;M<P;M++)F[M]=X;H=-1}U[P]==="B"&&(F[P]=0),I.hiLevel|=X}i&&function(D,Q,z){for(var G=0;G<z;G++)if(D[G]==="S"){Q[G]=y;for(var Z=G-1;Z>=0&&D[Z]==="WS";Z--)Q[Z]=y}}(U,F,V)},j=function(S,F,I,O,M){if(!(M.hiLevel<S)){if(S===1&&y===1&&!s)return F.reverse(),void(I&&I.reverse());for(var P,X,J,H,V=F.length,K=0;K<V;){if(O[K]>=S){for(J=K+1;J<V&&O[J]>=S;)J++;for(H=K,X=J-1;H<X;H++,X--)P=F[H],F[H]=F[X],F[X]=P,I&&(P=I[H],I[H]=I[X],I[X]=P);K=J}K++}}},E=function(S,F,I){var O=S.split(""),M={hiLevel:y};return I||(I=[]),C(O,I,M),function(P,X,J){if(J.hiLevel!==0&&d)for(var H,V=0;V<P.length;V++)X[V]===1&&(H=v.indexOf(P[V]))>=0&&(P[V]=v[H+1])}(O,I,M),j(2,O,F,I,M),j(1,O,F,I,M),O.join("")};return this.__bidiEngine__.doBidiReorder=function(S,F,I){if(function(M,P){if(P)for(var X=0;X<M.length;X++)P[X]=X;l===void 0&&(l=w(M)),u===void 0&&(u=w(M))}(S,F),o||!c||u)if(o&&c&&l^u)y=l?1:0,S=_(S,F,I);else if(!o&&c&&u)y=l?1:0,S=E(S,F,I),S=_(S,F);else if(!o||l||c||u){if(o&&!c&&l^u)S=_(S,F),l?(y=0,S=E(S,F,I)):(y=1,S=E(S,F,I),S=_(S,F));else if(o&&l&&!c&&u)y=1,S=E(S,F,I),S=_(S,F);else if(!o&&!c&&l^u){var O=d;l?(y=1,S=E(S,F,I),y=0,d=!1,S=E(S,F,I),d=O):(y=0,S=E(S,F,I),S=_(S,F),y=1,d=!1,S=E(S,F,I),d=O,S=_(S,F))}}else y=0,S=E(S,F,I);else y=l?1:0,S=E(S,F,I);return S},this.__bidiEngine__.setOptions=function(S){S&&(o=S.isInputVisual,c=S.isOutputVisual,l=S.isInputRtl,u=S.isOutputRtl,d=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(Lt),Lt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Lc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new N9(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new u9(this.contents),this.head=new A9(this),this.name=new g9(this),this.cmap=new j6(this),this.toUnicode={},this.hhea=new f9(this),this.maxp=new x9(this),this.hmtx=new y9(this),this.post=new p9(this),this.os2=new h9(this),this.loca=new _9(this),this.glyf=new v9(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var vo,Lc=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,i,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*i+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,i;for(i=[],n=0,s=t.length;n<s;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),u9=function(){var e;function t(r){var n,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,i,o,l,c,u,d,h,f,A,b,m;for(m in A=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(A)/c),o=Math.floor(h/c),d=16*A-h,(s=new Lc).writeInt(this.scalarType),s.writeShort(A),s.writeShort(h),s.writeShort(o),s.writeShort(d),i=16*A,u=s.pos+i,l=null,b=[],r)for(f=r[m],s.writeString(m),s.writeInt(e(f)),s.writeInt(u),s.writeInt(f.length),b=b.concat(f),m==="head"&&(l=u),u+=f.length;u%4;)b.push(0),u++;return s.write(b),n=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(n),s.data},e=function(r){var n,s,i,o;for(r=C6.call(r);r.length%4;)r.push(0);for(i=new Lc(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=i.readUInt32();return 4294967295&s},t}(),d9={}.hasOwnProperty,qo=function(e,t){for(var r in t)d9.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};vo=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var A9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Lc).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),Zj=function(){function e(t,r){var n,s,i,o,l,c,u,d,h,f,A,b,m,v,p,g,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(A=t.readUInt16(),f=A/2,t.pos+=6,i=function(){var x,w;for(w=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)w.push(t.readUInt16());return w}(),t.pos+=2,m=function(){var x,w;for(w=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)w.push(t.readUInt16());return w}(),u=function(){var x,w;for(w=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)w.push(t.readUInt16());return w}(),d=function(){var x,w;for(w=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)w.push(t.readUInt16());return w}(),s=(this.length-t.pos+this.offset)/2,l=function(){var x,w;for(w=[],c=x=0;0<=s?x<s:x>s;c=0<=s?++x:--x)w.push(t.readUInt16());return w}(),c=p=0,y=i.length;p<y;c=++p)for(v=i[c],n=g=b=m[c];b<=v?g<=v:g>=v;n=b<=v?++g:--g)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-b)-(f-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=h}return e.encode=function(t,r){var n,s,i,o,l,c,u,d,h,f,A,b,m,v,p,g,y,x,w,N,_,C,j,E,S,F,I,O,M,P,X,J,H,V,K,B,L,U,D,Q,z,G,Z,R,le,ee;switch(O=new Lc,o=Object.keys(t).sort(function(_e,se){return _e-se}),r){case"macroman":for(m=0,v=function(){var _e=[];for(b=0;b<256;++b)_e.push(0);return _e}(),g={0:0},i={},M=0,H=o.length;M<H;M++)g[Z=t[s=o[M]]]==null&&(g[Z]=++m),i[s]={old:t[s],new:g[t[s]]},v[s]=g[t[s]];return O.writeUInt16(1),O.writeUInt16(0),O.writeUInt32(12),O.writeUInt16(0),O.writeUInt16(262),O.writeUInt16(0),O.write(v),{charMap:i,subtable:O.data,maxGlyphID:m+1};case"unicode":for(F=[],h=[],y=0,g={},n={},p=u=null,P=0,V=o.length;P<V;P++)g[w=t[s=o[P]]]==null&&(g[w]=++y),n[s]={old:w,new:g[w]},l=g[w]-s,p!=null&&l===u||(p&&h.push(p),F.push(s),u=l),p=s;for(p&&h.push(p),h.push(65535),F.push(65535),E=2*(j=F.length),C=2*Math.pow(Math.log(j)/Math.LN2,2),f=Math.log(C/2)/Math.LN2,_=2*j-C,c=[],N=[],A=[],b=X=0,K=F.length;X<K;b=++X){if(S=F[b],d=h[b],S===65535){c.push(0),N.push(0);break}if(S-(I=n[S].new)>=32768)for(c.push(0),N.push(2*(A.length+j-b)),s=J=S;S<=d?J<=d:J>=d;s=S<=d?++J:--J)A.push(n[s].new);else c.push(I-S),N.push(0)}for(O.writeUInt16(3),O.writeUInt16(1),O.writeUInt32(12),O.writeUInt16(4),O.writeUInt16(16+8*j+2*A.length),O.writeUInt16(0),O.writeUInt16(E),O.writeUInt16(C),O.writeUInt16(f),O.writeUInt16(_),z=0,B=h.length;z<B;z++)s=h[z],O.writeUInt16(s);for(O.writeUInt16(0),G=0,L=F.length;G<L;G++)s=F[G],O.writeUInt16(s);for(R=0,U=c.length;R<U;R++)l=c[R],O.writeUInt16(l);for(le=0,D=N.length;le<D;le++)x=N[le],O.writeUInt16(x);for(ee=0,Q=A.length;ee<Q;ee++)m=A[ee],O.writeUInt16(m);return{charMap:n,subtable:O.data,maxGlyphID:y+1}}},e}(),j6=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new Zj(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=Zj.encode(t,r),(s=new Lc).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),f9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),h9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),p9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),m9=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},g9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,i,o,l,c,u,d,h,f;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},i=d=0,h=n.length;d<h;i=++d)s=n[i],t.pos=s.offset,u=t.readString(s.length),o=new m9(u,s),c[f=s.nameID]==null&&(c[f]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),x9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),y9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,i,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=s?u<s:u>s;r=0<=s?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,h,f;for(f=[],u=0,d=(h=this.metrics).length;u<d;u++)i=h[u],f.push(i.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),C6=[].slice,v9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,i,o,l,c,u,d,h;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new Lc(r.read(s))).readShort(),u=l.readShort(),h=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new w9(l,u,h,c,d):new b9(l,o,u,h,c,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,i,o,l,c;for(o=[],i=[],l=0,c=r.length;l<c;l++)s=t[r[l]],i.push(o.length),s&&(o=o.concat(s.encode(n)));return i.push(o.length),{table:o,offsets:i}},e}(),b9=function(){function e(t,r,n,s,i,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),w9=function(){function e(t,r,n,s,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Lc(C6.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),_9=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return qo(e,vo),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,i=0,o=0;o<n.length;++o)if(n[o]=s,i<r.length&&r[i]==o){++i,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),N9=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,i;for(r in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,i,o,l,c;for(s={},o=0,l=t.length;o<l;o++)s[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(n=s[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],s[i]=n;return s},e.prototype.encode=function(t,r){var n,s,i,o,l,c,u,d,h,f,A,b,m,v,p;for(s in n=j6.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),A={0:0},p=n.charMap)A[(c=p[s]).old]=c.new;for(b in f=n.maxGlyphID,o)b in A||(A[b]=f++);return d=function(g){var y,x;for(y in x={},g)x[g[y]]=y;return x}(A),h=Object.keys(d).sort(function(g,y){return g-y}),m=function(){var g,y,x;for(x=[],g=0,y=h.length;g<y;g++)l=h[g],x.push(d[l]);return x}(),i=this.font.glyf.encode(o,m,A),u=this.font.loca.encode(i.offsets,m),v={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},e}();Lt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,i,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)o=r[s],i.push("/"+s+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Aw=function(e,t){return Aw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Aw(e,t)};function bo(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Aw(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var fw=function(){return fw=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},fw.apply(this,arguments)};function ps(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{u(n.next(d))}catch(h){o(h)}}function c(d){try{u(n.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((n=n.apply(e,[])).next())})}function Xa(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Zp(e,t,r){if(arguments.length===2)for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||t)}var Tl=function(){function e(t,r,n,s){this.left=t,this.top=r,this.width=n,this.height=s}return e.prototype.add=function(t,r,n,s){return new e(this.left+t,this.top+r,this.width+n,this.height+s)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(s){return s.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),Rx=function(e,t){return Tl.fromClientRect(e,t.getBoundingClientRect())},j9=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),s=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new Tl(0,0,n,s)},Qx=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},Un=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},eC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C9=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var em=0;em<eC.length;em++)C9[eC.charCodeAt(em)]=em;var tC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Jf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var tm=0;tm<tC.length;tm++)Jf[tC.charCodeAt(tm)]=tm;var B9=function(e){var t=e.length*.75,r=e.length,n,s=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)i=Jf[e.charCodeAt(n)],o=Jf[e.charCodeAt(n+1)],l=Jf[e.charCodeAt(n+2)],c=Jf[e.charCodeAt(n+3)],d[s++]=i<<2|o>>4,d[s++]=(o&15)<<4|l>>2,d[s++]=(l&3)<<6|c&63;return u},k9=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},S9=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Fu=5,u_=11,Xy=2,E9=u_-Fu,B6=65536>>Fu,F9=1<<Fu,Yy=F9-1,T9=1024>>Fu,I9=B6+T9,L9=I9,O9=32,U9=L9+O9,P9=65536>>u_,D9=1<<E9,R9=D9-1,rC=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},Q9=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},M9=function(e,t){var r=B9(e),n=Array.isArray(r)?S9(r):new Uint32Array(r),s=Array.isArray(r)?k9(r):new Uint16Array(r),i=24,o=rC(s,i/2,n[4]/2),l=n[5]===2?rC(s,(i+n[4])/2):Q9(n,Math.ceil((i+n[4])/4));return new H9(n[0],n[1],n[2],n[3],o,l)},H9=function(){function e(t,r,n,s,i,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Fu],r=(r<<Xy)+(t&Yy),this.data[r];if(t<=65535)return r=this.index[B6+(t-55296>>Fu)],r=(r<<Xy)+(t&Yy),this.data[r];if(t<this.highStart)return r=U9-P9+(t>>u_),r=this.index[r],r+=t>>Fu&R9,r=this.index[r],r=(r<<Xy)+(t&Yy),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),nC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",q9=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var rm=0;rm<nC.length;rm++)q9[nC.charCodeAt(rm)]=rm;var K9="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",aC=50,$9=1,k6=2,S6=3,V9=4,G9=5,sC=7,E6=8,iC=9,mc=10,hw=11,oC=12,pw=13,W9=14,Zf=15,mw=16,nm=17,Of=18,z9=19,lC=20,gw=21,Uf=22,Jy=23,Bd=24,Js=25,eh=26,th=27,kd=28,X9=29,vu=30,Y9=31,am=32,sm=33,xw=34,yw=35,vw=36,i0=37,bw=38,tg=39,rg=40,Zy=41,F6=42,J9=43,Z9=[9001,65288],T6="!",pr="",im="",ww=M9(K9),dl=[vu,vw],_w=[$9,k6,S6,G9],I6=[mc,E6],cC=[th,eh],eH=_w.concat(I6),uC=[bw,tg,rg,xw,yw],tH=[Zf,pw],rH=function(e,t){t===void 0&&(t="strict");var r=[],n=[],s=[];return e.forEach(function(i,o){var l=ww.get(i);if(l>aC?(s.push(!0),l-=aC):s.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return n.push(o),r.push(mw);if(l===V9||l===hw){if(o===0)return n.push(o),r.push(vu);var c=r[o-1];return eH.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(vu))}if(n.push(o),l===Y9)return r.push(t==="strict"?gw:i0);if(l===F6||l===X9)return r.push(vu);if(l===J9)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(i0):r.push(vu);r.push(l)}),[n,r,s]},ev=function(e,t,r,n){var s=n[r];if(Array.isArray(e)?e.indexOf(s)!==-1:e===s)for(var i=r;i<=n.length;){i++;var o=n[i];if(o===t)return!0;if(o!==mc)break}if(s===mc)for(var i=r;i>0;){i--;var l=n[i];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===t)return!0;if(o!==mc)break}if(l!==mc)break}return!1},dC=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===mc)r--;else return n}return 0},nH=function(e,t,r,n,s){if(r[n]===0)return pr;var i=n-1;if(Array.isArray(s)&&s[i]===!0)return pr;var o=i-1,l=i+1,c=t[i],u=o>=0?t[o]:0,d=t[l];if(c===k6&&d===S6)return pr;if(_w.indexOf(c)!==-1)return T6;if(_w.indexOf(d)!==-1||I6.indexOf(d)!==-1)return pr;if(dC(i,t)===E6)return im;if(ww.get(e[i])===hw||(c===am||c===sm)&&ww.get(e[l])===hw||c===sC||d===sC||c===iC||[mc,pw,Zf].indexOf(c)===-1&&d===iC||[nm,Of,z9,Bd,kd].indexOf(d)!==-1||dC(i,t)===Uf||ev(Jy,Uf,i,t)||ev([nm,Of],gw,i,t)||ev(oC,oC,i,t))return pr;if(c===mc)return im;if(c===Jy||d===Jy)return pr;if(d===mw||c===mw)return im;if([pw,Zf,gw].indexOf(d)!==-1||c===W9||u===vw&&tH.indexOf(c)!==-1||c===kd&&d===vw||d===lC||dl.indexOf(d)!==-1&&c===Js||dl.indexOf(c)!==-1&&d===Js||c===th&&[i0,am,sm].indexOf(d)!==-1||[i0,am,sm].indexOf(c)!==-1&&d===eh||dl.indexOf(c)!==-1&&cC.indexOf(d)!==-1||cC.indexOf(c)!==-1&&dl.indexOf(d)!==-1||[th,eh].indexOf(c)!==-1&&(d===Js||[Uf,Zf].indexOf(d)!==-1&&t[l+1]===Js)||[Uf,Zf].indexOf(c)!==-1&&d===Js||c===Js&&[Js,kd,Bd].indexOf(d)!==-1)return pr;if([Js,kd,Bd,nm,Of].indexOf(d)!==-1)for(var h=i;h>=0;){var f=t[h];if(f===Js)return pr;if([kd,Bd].indexOf(f)!==-1)h--;else break}if([th,eh].indexOf(d)!==-1)for(var h=[nm,Of].indexOf(c)!==-1?o:i;h>=0;){var f=t[h];if(f===Js)return pr;if([kd,Bd].indexOf(f)!==-1)h--;else break}if(bw===c&&[bw,tg,xw,yw].indexOf(d)!==-1||[tg,xw].indexOf(c)!==-1&&[tg,rg].indexOf(d)!==-1||[rg,yw].indexOf(c)!==-1&&d===rg||uC.indexOf(c)!==-1&&[lC,eh].indexOf(d)!==-1||uC.indexOf(d)!==-1&&c===th||dl.indexOf(c)!==-1&&dl.indexOf(d)!==-1||c===Bd&&dl.indexOf(d)!==-1||dl.concat(Js).indexOf(c)!==-1&&d===Uf&&Z9.indexOf(e[l])===-1||dl.concat(Js).indexOf(d)!==-1&&c===Of)return pr;if(c===Zy&&d===Zy){for(var A=r[i],b=1;A>0&&(A--,t[A]===Zy);)b++;if(b%2!==0)return pr}return c===am&&d===sm?pr:im},aH=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=rH(e,t.lineBreak),n=r[0],s=r[1],i=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(s=s.map(function(l){return[Js,vu,F6].indexOf(l)!==-1?i0:l}));var o=t.wordBreak==="keep-all"?i.map(function(l,c){return l&&e[c]>=19968&&e[c]<=40959}):void 0;return[n,s,o]},sH=function(){function e(t,r,n,s){this.codePoints=t,this.required=r===T6,this.start=n,this.end=s}return e.prototype.slice=function(){return Un.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),iH=function(e,t){var r=Qx(e),n=aH(r,t),s=n[0],i=n[1],o=n[2],l=r.length,c=0,u=0;return{next:function(){if(u>=l)return{done:!0,value:null};for(var d=pr;u<l&&(d=nH(r,i,s,++u,o))===pr;);if(d!==pr||u===l){var h=new sH(r,d,c,u);return c=u,{value:h,done:!1}}return{done:!0,value:null}}}},oH=1,lH=2,F0=4,AC=8,qg=10,fC=47,_h=92,cH=9,uH=32,om=34,Pf=61,dH=35,AH=36,fH=37,lm=39,cm=40,Df=41,hH=95,Es=45,pH=33,mH=60,gH=62,xH=64,yH=91,vH=93,bH=61,wH=123,um=63,_H=125,hC=124,NH=126,jH=128,pC=65533,tv=42,Cu=43,CH=44,BH=58,kH=59,o0=46,SH=0,EH=8,FH=11,TH=14,IH=31,LH=127,So=-1,L6=48,O6=97,U6=101,OH=102,UH=117,PH=122,P6=65,D6=69,R6=70,DH=85,RH=90,Za=function(e){return e>=L6&&e<=57},QH=function(e){return e>=55296&&e<=57343},Sd=function(e){return Za(e)||e>=P6&&e<=R6||e>=O6&&e<=OH},MH=function(e){return e>=O6&&e<=PH},HH=function(e){return e>=P6&&e<=RH},qH=function(e){return MH(e)||HH(e)},KH=function(e){return e>=jH},dm=function(e){return e===qg||e===cH||e===uH},Kg=function(e){return qH(e)||KH(e)||e===hH},mC=function(e){return Kg(e)||Za(e)||e===Es},$H=function(e){return e>=SH&&e<=EH||e===FH||e>=TH&&e<=IH||e===LH},cc=function(e,t){return e!==_h?!1:t!==qg},Am=function(e,t,r){return e===Es?Kg(t)||cc(t,r):Kg(e)?!0:!!(e===_h&&cc(e,t))},rv=function(e,t,r){return e===Cu||e===Es?Za(t)?!0:t===o0&&Za(r):Za(e===o0?t:e)},VH=function(e){var t=0,r=1;(e[t]===Cu||e[t]===Es)&&(e[t]===Es&&(r=-1),t++);for(var n=[];Za(e[t]);)n.push(e[t++]);var s=n.length?parseInt(Un.apply(void 0,n),10):0;e[t]===o0&&t++;for(var i=[];Za(e[t]);)i.push(e[t++]);var o=i.length,l=o?parseInt(Un.apply(void 0,i),10):0;(e[t]===D6||e[t]===U6)&&t++;var c=1;(e[t]===Cu||e[t]===Es)&&(e[t]===Es&&(c=-1),t++);for(var u=[];Za(e[t]);)u.push(e[t++]);var d=u.length?parseInt(Un.apply(void 0,u),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*d)},GH={type:2},WH={type:3},zH={type:4},XH={type:13},YH={type:8},JH={type:21},ZH={type:9},eq={type:10},tq={type:11},rq={type:12},nq={type:14},fm={type:23},aq={type:1},sq={type:25},iq={type:24},oq={type:26},lq={type:27},cq={type:28},uq={type:29},dq={type:31},Nw={type:32},Q6=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(Qx(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Nw;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case om:return this.consumeStringToken(om);case dH:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(mC(r)||cc(n,s)){var i=Am(r,n,s)?lH:oH,o=this.consumeName();return{type:5,value:o,flags:i}}break;case AH:if(this.peekCodePoint(0)===Pf)return this.consumeCodePoint(),XH;break;case lm:return this.consumeStringToken(lm);case cm:return GH;case Df:return WH;case tv:if(this.peekCodePoint(0)===Pf)return this.consumeCodePoint(),nq;break;case Cu:if(rv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case CH:return zH;case Es:var l=t,c=this.peekCodePoint(0),u=this.peekCodePoint(1);if(rv(l,c,u))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Am(l,c,u))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(c===Es&&u===gH)return this.consumeCodePoint(),this.consumeCodePoint(),iq;break;case o0:if(rv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case fC:if(this.peekCodePoint(0)===tv)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===tv&&(d=this.consumeCodePoint(),d===fC))return this.consumeToken();if(d===So)return this.consumeToken()}break;case BH:return oq;case kH:return lq;case mH:if(this.peekCodePoint(0)===pH&&this.peekCodePoint(1)===Es&&this.peekCodePoint(2)===Es)return this.consumeCodePoint(),this.consumeCodePoint(),sq;break;case xH:var h=this.peekCodePoint(0),f=this.peekCodePoint(1),A=this.peekCodePoint(2);if(Am(h,f,A)){var o=this.consumeName();return{type:7,value:o}}break;case yH:return cq;case _h:if(cc(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case vH:return uq;case bH:if(this.peekCodePoint(0)===Pf)return this.consumeCodePoint(),YH;break;case wH:return tq;case _H:return rq;case UH:case DH:var b=this.peekCodePoint(0),m=this.peekCodePoint(1);return b===Cu&&(Sd(m)||m===um)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case hC:if(this.peekCodePoint(0)===Pf)return this.consumeCodePoint(),ZH;if(this.peekCodePoint(0)===hC)return this.consumeCodePoint(),JH;break;case NH:if(this.peekCodePoint(0)===Pf)return this.consumeCodePoint(),eq;break;case So:return Nw}return dm(t)?(this.consumeWhiteSpace(),dq):Za(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Kg(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Un(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Sd(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===um&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(Un.apply(void 0,t.map(function(c){return c===um?L6:c})),16),i=parseInt(Un.apply(void 0,t.map(function(c){return c===um?R6:c})),16);return{type:30,start:s,end:i}}var o=parseInt(Un.apply(void 0,t),16);if(this.peekCodePoint(0)===Es&&Sd(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];Sd(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var i=parseInt(Un.apply(void 0,l),16);return{type:30,start:o,end:i}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===cm?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===cm?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===So)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===lm||r===om){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===So||this.peekCodePoint(0)===Df)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),fm)}for(;;){var s=this.consumeCodePoint();if(s===So||s===Df)return{type:22,value:Un.apply(void 0,t)};if(dm(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===So||this.peekCodePoint(0)===Df?(this.consumeCodePoint(),{type:22,value:Un.apply(void 0,t)}):(this.consumeBadUrlRemnants(),fm);if(s===om||s===lm||s===cm||$H(s))return this.consumeBadUrlRemnants(),fm;if(s===_h)if(cc(s,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),fm;else t.push(s)}},e.prototype.consumeWhiteSpace=function(){for(;dm(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Df||t===So)return;cc(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var s=Math.min(r,t);n+=Un.apply(void 0,this._value.splice(0,s)),t-=s}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var s=this._value[n];if(s===So||s===void 0||s===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(s===qg)return this._value.splice(0,n),aq;if(s===_h){var i=this._value[n+1];i!==So&&i!==void 0&&(i===qg?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):cc(s,i)&&(r+=this.consumeStringSlice(n),r+=Un(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=F0,n=this.peekCodePoint(0);for((n===Cu||n===Es)&&t.push(this.consumeCodePoint());Za(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===o0&&Za(s))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=AC;Za(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((n===D6||n===U6)&&((s===Cu||s===Es)&&Za(i)||Za(s)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=AC;Za(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[VH(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],s=this.peekCodePoint(0),i=this.peekCodePoint(1),o=this.peekCodePoint(2);if(Am(s,i,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return s===fH?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Sd(t)){for(var r=Un(t);Sd(this.peekCodePoint(0))&&r.length<6;)r+=Un(this.consumeCodePoint());dm(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||QH(n)||n>1114111?pC:n}return t===So?pC:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(mC(r))t+=Un(r);else if(cc(r,this.peekCodePoint(0)))t+=Un(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),M6=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new Q6;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||fq(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Nw:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),T0=function(e){return e.type===15},HA=function(e){return e.type===17},Pr=function(e){return e.type===20},Aq=function(e){return e.type===0},jw=function(e,t){return Pr(e)&&e.value===t},H6=function(e){return e.type!==31},EA=function(e){return e.type!==31&&e.type!==4},Ko=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},fq=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Oc=function(e){return e.type===17||e.type===15},Yn=function(e){return e.type===16||Oc(e)},q6=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Pa={type:17,number:0,flags:F0},d_={type:16,number:50,flags:F0},gc={type:16,number:100,flags:F0},rh=function(e,t,r){var n=e[0],s=e[1];return[Wr(n,t),Wr(typeof s<"u"?s:n,r)]},Wr=function(e,t){if(e.type===16)return e.number/100*t;if(T0(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},K6="deg",$6="grad",V6="rad",G6="turn",Mx={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case K6:return Math.PI*t.number/180;case $6:return Math.PI/200*t.number;case V6:return t.number;case G6:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},W6=function(e){return e.type===15&&(e.unit===K6||e.unit===$6||e.unit===V6||e.unit===G6)},z6=function(e){var t=e.filter(Pr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Pa,Pa];case"to top":case"bottom":return Ii(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Pa,gc];case"to right":case"left":return Ii(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[gc,gc];case"to bottom":case"top":return Ii(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[gc,Pa];case"to left":case"right":return Ii(270)}return 0},Ii=function(e){return Math.PI*e/180},Ec={name:"color",parse:function(e,t){if(t.type===18){var r=hq[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3);return xc(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3),o=t.value.substring(3,4);return xc(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6);return xc(parseInt(n,16),parseInt(s,16),parseInt(i,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6),o=t.value.substring(6,8);return xc(parseInt(n,16),parseInt(s,16),parseInt(i,16),parseInt(o,16)/255)}}if(t.type===20){var l=wl[t.value.toUpperCase()];if(typeof l<"u")return l}return wl.TRANSPARENT}},Fc=function(e){return(255&e)===0},ga=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,s=255&e>>24;return t<255?"rgba("+s+","+n+","+r+","+t/255+")":"rgb("+s+","+n+","+r+")"},xc=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},gC=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},xC=function(e,t){var r=t.filter(EA);if(r.length===3){var n=r.map(gC),s=n[0],i=n[1],o=n[2];return xc(s,i,o,1)}if(r.length===4){var l=r.map(gC),s=l[0],i=l[1],o=l[2],c=l[3];return xc(s,i,o,c)}return 0};function nv(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var yC=function(e,t){var r=t.filter(EA),n=r[0],s=r[1],i=r[2],o=r[3],l=(n.type===17?Ii(n.number):Mx.parse(e,n))/(Math.PI*2),c=Yn(s)?s.number/100:0,u=Yn(i)?i.number/100:0,d=typeof o<"u"&&Yn(o)?Wr(o,1):1;if(c===0)return xc(u*255,u*255,u*255,1);var h=u<=.5?u*(c+1):u+c-u*c,f=u*2-h,A=nv(f,h,l+1/3),b=nv(f,h,l),m=nv(f,h,l-1/3);return xc(A*255,b*255,m*255,d)},hq={hsl:yC,hsla:yC,rgb:xC,rgba:xC},Nh=function(e,t){return Ec.parse(e,M6.create(t).parseComponentValue())},wl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},pq={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Pr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},mq={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Hx=function(e,t){var r=Ec.parse(e,t[0]),n=t[1];return n&&Yn(n)?{color:r,stop:n}:{color:r,stop:null}},vC=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=Pa),n.stop===null&&(n.stop=gc);for(var s=[],i=0,o=0;o<e.length;o++){var l=e[o].stop;if(l!==null){var c=Wr(l,t);c>i?s.push(c):s.push(i),i=c}else s.push(null)}for(var u=null,o=0;o<s.length;o++){var d=s[o];if(d===null)u===null&&(u=o);else if(u!==null){for(var h=o-u,f=s[u-1],A=(d-f)/(h+1),b=1;b<=h;b++)s[u+b-1]=A*b;u=null}}return e.map(function(m,v){var p=m.color;return{color:p,stop:Math.max(Math.min(1,s[v]/t),0)}})},gq=function(e,t,r){var n=t/2,s=r/2,i=Wr(e[0],t)-n,o=s-Wr(e[1],r);return(Math.atan2(o,i)+Math.PI*2)%(Math.PI*2)},xq=function(e,t,r){var n=typeof e=="number"?e:gq(e,t,r),s=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),i=t/2,o=r/2,l=s/2,c=Math.sin(n-Math.PI/2)*l,u=Math.cos(n-Math.PI/2)*l;return[s,i-u,i+u,o-c,o+c]},eo=function(e,t){return Math.sqrt(e*e+t*t)},bC=function(e,t,r,n,s){var i=[[0,0],[0,t],[e,0],[e,t]];return i.reduce(function(o,l){var c=l[0],u=l[1],d=eo(r-c,n-u);return(s?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},yq=function(e,t,r,n,s){var i=0,o=0;switch(e.size){case 0:e.shape===0?i=o=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):e.shape===1&&(i=Math.min(Math.abs(t),Math.abs(t-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(e.shape===0)i=o=Math.min(eo(t,r),eo(t,r-s),eo(t-n,r),eo(t-n,r-s));else if(e.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(t),Math.abs(t-n)),c=bC(n,s,t,r,!0),u=c[0],d=c[1];i=eo(u-t,(d-r)/l),o=l*i}break;case 1:e.shape===0?i=o=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-s)):e.shape===1&&(i=Math.max(Math.abs(t),Math.abs(t-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(e.shape===0)i=o=Math.max(eo(t,r),eo(t,r-s),eo(t-n,r),eo(t-n,r-s));else if(e.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(t),Math.abs(t-n)),h=bC(n,s,t,r,!1),u=h[0],d=h[1];i=eo(u-t,(d-r)/l),o=l*i}break}return Array.isArray(e.size)&&(i=Wr(e.size[0],n),o=e.size.length===2?Wr(e.size[1],s):i),[i,o]},vq=function(e,t){var r=Ii(180),n=[];return Ko(t).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&o.value==="to"){r=z6(s);return}else if(W6(o)){r=Mx.parse(e,o);return}}var l=Hx(e,s);n.push(l)}),{angle:r,stops:n,type:1}},hm=function(e,t){var r=Ii(180),n=[];return Ko(t).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=z6(s);return}else if(W6(o)){r=(Mx.parse(e,o)+Ii(270))%Ii(360);return}}var l=Hx(e,s);n.push(l)}),{angle:r,stops:n,type:1}},bq=function(e,t){var r=Ii(180),n=[],s=1,i=0,o=3,l=[];return Ko(t).forEach(function(c,u){var d=c[0];if(u===0){if(Pr(d)&&d.value==="linear"){s=1;return}else if(Pr(d)&&d.value==="radial"){s=2;return}}if(d.type===18){if(d.name==="from"){var h=Ec.parse(e,d.values[0]);n.push({stop:Pa,color:h})}else if(d.name==="to"){var h=Ec.parse(e,d.values[0]);n.push({stop:gc,color:h})}else if(d.name==="color-stop"){var f=d.values.filter(EA);if(f.length===2){var h=Ec.parse(e,f[1]),A=f[0];HA(A)&&n.push({stop:{type:16,number:A.number*100,flags:A.flags},color:h})}}}}),s===1?{angle:(r+Ii(180))%Ii(360),stops:n,type:s}:{size:o,shape:i,stops:n,position:l,type:s}},X6="closest-side",Y6="farthest-side",J6="closest-corner",Z6="farthest-corner",eT="circle",tT="ellipse",rT="cover",nT="contain",wq=function(e,t){var r=0,n=3,s=[],i=[];return Ko(t).forEach(function(o,l){var c=!0;if(l===0){var u=!1;c=o.reduce(function(h,f){if(u)if(Pr(f))switch(f.value){case"center":return i.push(d_),h;case"top":case"left":return i.push(Pa),h;case"right":case"bottom":return i.push(gc),h}else(Yn(f)||Oc(f))&&i.push(f);else if(Pr(f))switch(f.value){case eT:return r=0,!1;case tT:return r=1,!1;case"at":return u=!0,!1;case X6:return n=0,!1;case rT:case Y6:return n=1,!1;case nT:case J6:return n=2,!1;case Z6:return n=3,!1}else if(Oc(f)||Yn(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return h},c)}if(c){var d=Hx(e,o);s.push(d)}}),{size:n,shape:r,stops:s,position:i,type:2}},pm=function(e,t){var r=0,n=3,s=[],i=[];return Ko(t).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,h){if(Pr(h))switch(h.value){case"center":return i.push(d_),!1;case"top":case"left":return i.push(Pa),!1;case"right":case"bottom":return i.push(gc),!1}else if(Yn(h)||Oc(h))return i.push(h),!1;return d},c):l===1&&(c=o.reduce(function(d,h){if(Pr(h))switch(h.value){case eT:return r=0,!1;case tT:return r=1,!1;case nT:case X6:return n=0,!1;case Y6:return n=1,!1;case J6:return n=2,!1;case rT:case Z6:return n=3,!1}else if(Oc(h)||Yn(h))return Array.isArray(n)||(n=[]),n.push(h),!1;return d},c)),c){var u=Hx(e,o);s.push(u)}}),{size:n,shape:r,stops:s,position:i,type:2}},_q=function(e){return e.type===1},Nq=function(e){return e.type===2},A_={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=aT[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function jq(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!aT[e.name])}var aT={"linear-gradient":vq,"-moz-linear-gradient":hm,"-ms-linear-gradient":hm,"-o-linear-gradient":hm,"-webkit-linear-gradient":hm,"radial-gradient":wq,"-moz-radial-gradient":pm,"-ms-radial-gradient":pm,"-o-radial-gradient":pm,"-webkit-radial-gradient":pm,"-webkit-gradient":bq},Cq={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return EA(n)&&jq(n)}).map(function(n){return A_.parse(e,n)})}},Bq={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Pr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},kq={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Ko(t).map(function(r){return r.filter(Yn)}).map(q6)}},Sq={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Ko(t).map(function(r){return r.filter(Pr).map(function(n){return n.value}).join(" ")}).map(Eq)}},Eq=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},mA;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(mA||(mA={}));var Fq={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Ko(t).map(function(r){return r.filter(Tq)})}},Tq=function(e){return Pr(e)||Yn(e)},qx=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Iq=qx("top"),Lq=qx("right"),Oq=qx("bottom"),Uq=qx("left"),Kx=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return q6(r.filter(Yn))}}},Pq=Kx("top-left"),Dq=Kx("top-right"),Rq=Kx("bottom-right"),Qq=Kx("bottom-left"),$x=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Mq=$x("top"),Hq=$x("right"),qq=$x("bottom"),Kq=$x("left"),Vx=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return T0(r)?r.number:0}}},$q=Vx("top"),Vq=Vx("right"),Gq=Vx("bottom"),Wq=Vx("left"),zq={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Xq={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Yq={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Pr).reduce(function(r,n){return r|Jq(n.value)},0)}},Jq=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Zq={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},eK={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},$g;(function(e){e.NORMAL="normal",e.STRICT="strict"})($g||($g={}));var tK={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return $g.STRICT;case"normal":default:return $g.NORMAL}}},rK={name:"line-height",initialValue:"normal",prefix:!1,type:4},wC=function(e,t){return Pr(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:Yn(e)?Wr(e,t):t},nK={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:A_.parse(e,t)}},aK={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},Cw={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Gx=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},sK=Gx("top"),iK=Gx("right"),oK=Gx("bottom"),lK=Gx("left"),cK={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Pr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},uK={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Wx=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},dK=Wx("top"),AK=Wx("right"),fK=Wx("bottom"),hK=Wx("left"),pK={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},mK={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},gK={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&jw(t[0],"none")?[]:Ko(t).map(function(r){for(var n={color:wl.TRANSPARENT,offsetX:Pa,offsetY:Pa,blur:Pa},s=0,i=0;i<r.length;i++){var o=r[i];Oc(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:n.blur=o,s++):n.color=Ec.parse(e,o)}return n})}},xK={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},yK={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=wK[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},vK=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},bK=function(e){var t=e.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=t[0],n=t[1];t[2],t[3];var s=t[4],i=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],l=t[13];return t[14],t[15],t.length===16?[r,n,s,i,o,l]:null},wK={matrix:vK,matrix3d:bK},_C={type:16,number:50,flags:F0},_K=[_C,_C],NK={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Yn);return r.length!==2?_K:[r[0],r[1]]}},jK={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},jh;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(jh||(jh={}));var CK={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return jh.BREAK_ALL;case"keep-all":return jh.KEEP_ALL;case"normal":default:return jh.NORMAL}}},BK={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(HA(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},sT={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},kK={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return HA(t)?t.number:1}},SK={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},EK={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Pr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},FK={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},TK={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},IK={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(HA(t))return t.number;if(Pr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},LK={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Pr).map(function(r){return r.value})}},OK={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},da=function(e,t){return(e&t)!==0},UK={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},PK={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],s=t.filter(H6),i=0;i<s.length;i++){var o=s[i],l=s[i+1];if(o.type===20){var c=l&&HA(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},DK={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(H6),s=0;s<n.length;s++){var i=n[s],o=n[s+1];if(Pr(i)&&i.value!=="none"){var l=o&&HA(o)?o.number:0;r.push({counter:i.value,reset:l})}}return r}},RK={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(T0).map(function(r){return sT.parse(e,r)})}},QK={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],s=t.filter(Aq);if(s.length%2!==0)return null;for(var i=0;i<s.length;i+=2){var o=s[i].value,l=s[i+1].value;n.push({open:o,close:l})}return n}},NC=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},MK={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&jw(t[0],"none")?[]:Ko(t).map(function(r){for(var n={color:255,offsetX:Pa,offsetY:Pa,blur:Pa,spread:Pa,inset:!1},s=0,i=0;i<r.length;i++){var o=r[i];jw(o,"inset")?n.inset=!0:Oc(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:s===2?n.blur=o:n.spread=o,s++):n.color=Ec.parse(e,o)}return n})}},HK={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(Pr).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},qK={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},KK={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return T0(t)?t.number:0}},$K=function(){function e(t,r){var n,s;this.animationDuration=St(t,RK,r.animationDuration),this.backgroundClip=St(t,pq,r.backgroundClip),this.backgroundColor=St(t,mq,r.backgroundColor),this.backgroundImage=St(t,Cq,r.backgroundImage),this.backgroundOrigin=St(t,Bq,r.backgroundOrigin),this.backgroundPosition=St(t,kq,r.backgroundPosition),this.backgroundRepeat=St(t,Sq,r.backgroundRepeat),this.backgroundSize=St(t,Fq,r.backgroundSize),this.borderTopColor=St(t,Iq,r.borderTopColor),this.borderRightColor=St(t,Lq,r.borderRightColor),this.borderBottomColor=St(t,Oq,r.borderBottomColor),this.borderLeftColor=St(t,Uq,r.borderLeftColor),this.borderTopLeftRadius=St(t,Pq,r.borderTopLeftRadius),this.borderTopRightRadius=St(t,Dq,r.borderTopRightRadius),this.borderBottomRightRadius=St(t,Rq,r.borderBottomRightRadius),this.borderBottomLeftRadius=St(t,Qq,r.borderBottomLeftRadius),this.borderTopStyle=St(t,Mq,r.borderTopStyle),this.borderRightStyle=St(t,Hq,r.borderRightStyle),this.borderBottomStyle=St(t,qq,r.borderBottomStyle),this.borderLeftStyle=St(t,Kq,r.borderLeftStyle),this.borderTopWidth=St(t,$q,r.borderTopWidth),this.borderRightWidth=St(t,Vq,r.borderRightWidth),this.borderBottomWidth=St(t,Gq,r.borderBottomWidth),this.borderLeftWidth=St(t,Wq,r.borderLeftWidth),this.boxShadow=St(t,MK,r.boxShadow),this.color=St(t,zq,r.color),this.direction=St(t,Xq,r.direction),this.display=St(t,Yq,r.display),this.float=St(t,Zq,r.cssFloat),this.fontFamily=St(t,FK,r.fontFamily),this.fontSize=St(t,TK,r.fontSize),this.fontStyle=St(t,OK,r.fontStyle),this.fontVariant=St(t,LK,r.fontVariant),this.fontWeight=St(t,IK,r.fontWeight),this.letterSpacing=St(t,eK,r.letterSpacing),this.lineBreak=St(t,tK,r.lineBreak),this.lineHeight=St(t,rK,r.lineHeight),this.listStyleImage=St(t,nK,r.listStyleImage),this.listStylePosition=St(t,aK,r.listStylePosition),this.listStyleType=St(t,Cw,r.listStyleType),this.marginTop=St(t,sK,r.marginTop),this.marginRight=St(t,iK,r.marginRight),this.marginBottom=St(t,oK,r.marginBottom),this.marginLeft=St(t,lK,r.marginLeft),this.opacity=St(t,kK,r.opacity);var i=St(t,cK,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=St(t,uK,r.overflowWrap),this.paddingTop=St(t,dK,r.paddingTop),this.paddingRight=St(t,AK,r.paddingRight),this.paddingBottom=St(t,fK,r.paddingBottom),this.paddingLeft=St(t,hK,r.paddingLeft),this.paintOrder=St(t,HK,r.paintOrder),this.position=St(t,mK,r.position),this.textAlign=St(t,pK,r.textAlign),this.textDecorationColor=St(t,SK,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=St(t,EK,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=St(t,gK,r.textShadow),this.textTransform=St(t,xK,r.textTransform),this.transform=St(t,yK,r.transform),this.transformOrigin=St(t,NK,r.transformOrigin),this.visibility=St(t,jK,r.visibility),this.webkitTextStrokeColor=St(t,qK,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=St(t,KK,r.webkitTextStrokeWidth),this.wordBreak=St(t,CK,r.wordBreak),this.zIndex=St(t,BK,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return Fc(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return da(this.display,4)||da(this.display,33554432)||da(this.display,268435456)||da(this.display,536870912)||da(this.display,67108864)||da(this.display,134217728)},e}(),VK=function(){function e(t,r){this.content=St(t,UK,r.content),this.quotes=St(t,QK,r.quotes)}return e}(),jC=function(){function e(t,r){this.counterIncrement=St(t,PK,r.counterIncrement),this.counterReset=St(t,DK,r.counterReset)}return e}(),St=function(e,t,r){var n=new Q6,s=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(s);var i=new M6(n.read());switch(t.type){case 2:var o=i.parseComponentValue();return t.parse(e,Pr(o)?o.value:t.initialValue);case 0:return t.parse(e,i.parseComponentValue());case 1:return t.parse(e,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(t.format){case"angle":return Mx.parse(e,i.parseComponentValue());case"color":return Ec.parse(e,i.parseComponentValue());case"image":return A_.parse(e,i.parseComponentValue());case"length":var l=i.parseComponentValue();return Oc(l)?l:Pa;case"length-percentage":var c=i.parseComponentValue();return Yn(c)?c:Pa;case"time":return sT.parse(e,i.parseComponentValue())}break}},GK="data-html2canvas-debug",WK=function(e){var t=e.getAttribute(GK);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Bw=function(e,t){var r=WK(e);return r===1||t===r},$o=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Bw(r,3))debugger;this.styles=new $K(t,window.getComputedStyle(r,null)),Ew(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Rx(this.context,r),Bw(r,4)&&(this.flags|=16)}return e}(),zK="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",CC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var mm=0;mm<CC.length;mm++)nh[CC.charCodeAt(mm)]=mm;var XK=function(e){var t=e.length*.75,r=e.length,n,s=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)i=nh[e.charCodeAt(n)],o=nh[e.charCodeAt(n+1)],l=nh[e.charCodeAt(n+2)],c=nh[e.charCodeAt(n+3)],d[s++]=i<<2|o>>4,d[s++]=(o&15)<<4|l>>2,d[s++]=(l&3)<<6|c&63;return u},YK=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},JK=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},Tu=5,f_=11,av=2,ZK=f_-Tu,iT=65536>>Tu,e$=1<<Tu,sv=e$-1,t$=1024>>Tu,r$=iT+t$,n$=r$,a$=32,s$=n$+a$,i$=65536>>f_,o$=1<<ZK,l$=o$-1,BC=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},c$=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},u$=function(e,t){var r=XK(e),n=Array.isArray(r)?JK(r):new Uint32Array(r),s=Array.isArray(r)?YK(r):new Uint16Array(r),i=24,o=BC(s,i/2,n[4]/2),l=n[5]===2?BC(s,(i+n[4])/2):c$(n,Math.ceil((i+n[4])/4));return new d$(n[0],n[1],n[2],n[3],o,l)},d$=function(){function e(t,r,n,s,i,o){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Tu],r=(r<<av)+(t&sv),this.data[r];if(t<=65535)return r=this.index[iT+(t-55296>>Tu)],r=(r<<av)+(t&sv),this.data[r];if(t<this.highStart)return r=s$-i$+(t>>f_),r=this.index[r],r+=t>>Tu&l$,r=this.index[r],r=(r<<av)+(t&sv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),kC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A$=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var gm=0;gm<kC.length;gm++)A$[kC.charCodeAt(gm)]=gm;var f$=1,iv=2,ov=3,SC=4,EC=5,h$=7,FC=8,lv=9,cv=10,TC=11,IC=12,LC=13,OC=14,uv=15,p$=function(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},m$=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},g$=u$(zK),ji="",dv="",x$=function(e){return g$.get(e)},y$=function(e,t,r){var n=r-2,s=t[n],i=t[r-1],o=t[r];if(i===iv&&o===ov)return ji;if(i===iv||i===ov||i===SC||o===iv||o===ov||o===SC)return dv;if(i===FC&&[FC,lv,TC,IC].indexOf(o)!==-1||(i===TC||i===lv)&&(o===lv||o===cv)||(i===IC||i===cv)&&o===cv||o===LC||o===EC||o===h$||i===f$)return ji;if(i===LC&&o===OC){for(;s===EC;)s=t[--n];if(s===OC)return ji}if(i===uv&&o===uv){for(var l=0;s===uv;)l++,s=t[--n];if(l%2===0)return ji}return dv},v$=function(e){var t=p$(e),r=t.length,n=0,s=0,i=t.map(x$);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=ji;n<r&&(o=y$(t,i,++n))===ji;);if(o!==ji||n===r){var l=m$.apply(null,t.slice(s,n));return s=n,{value:l,done:!1}}return{done:!0,value:null}}}},b$=function(e){for(var t=v$(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},w$=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),i=Math.round(s.height);if(e.body.removeChild(n),i===t)return!0}}return!1},_$=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,s=Qx(n.data).map(function(c){return Un(c)}),i=0,o={},l=s.every(function(c,u){r.setStart(n,i),r.setEnd(n,i+c.length);var d=r.getBoundingClientRect();i+=c.length;var h=d.x>o.x||d.y>o.y;return o=d,u===0?!0:h});return e.body.removeChild(t),l},N$=function(){return typeof new Image().crossOrigin<"u"},j$=function(){return typeof new XMLHttpRequest().responseType=="string"},C$=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},UC=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},B$=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,i=t.toDataURL();s.src=i;var o=kw(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),PC(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var u=e.createElement("div");return u.style.backgroundImage="url("+i+")",u.style.height=r+"px",UC(c)?PC(kw(r,r,0,0,u)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),UC(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},kw=function(e,t,r,n,s){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),l=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},PC=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},La={get SUPPORT_RANGE_BOUNDS(){var e=w$(document);return Object.defineProperty(La,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=La.SUPPORT_RANGE_BOUNDS&&_$(document);return Object.defineProperty(La,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=C$(document);return Object.defineProperty(La,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?B$(document):Promise.resolve(!1);return Object.defineProperty(La,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=N$();return Object.defineProperty(La,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=j$();return Object.defineProperty(La,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(La,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(La,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Ch=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),k$=function(e,t,r,n){var s=F$(t,r),i=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(La.SUPPORT_RANGE_BOUNDS){var c=DC(n,o,l.length).getClientRects();if(c.length>1){var u=h_(l),d=0;u.forEach(function(f){i.push(new Ch(f,Tl.fromDOMRectList(e,DC(n,d+o,f.length).getClientRects()))),d+=f.length})}else i.push(new Ch(l,Tl.fromDOMRectList(e,c)))}else{var h=n.splitText(l.length);i.push(new Ch(l,S$(e,n))),n=h}else La.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),i},S$=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var s=t.parentNode;if(s){s.replaceChild(n,t);var i=Rx(e,n);return n.firstChild&&s.replaceChild(n.firstChild,n),i}}return Tl.EMPTY},DC=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(e,t),s.setEnd(e,t+r),s},h_=function(e){if(La.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return b$(e)},E$=function(e,t){if(La.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return I$(e,t)},F$=function(e,t){return t.letterSpacing!==0?h_(e):E$(e,t)},T$=[32,160,4961,65792,65793,4153,4241],I$=function(e,t){for(var r=iH(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],s,i=function(){if(s.value){var o=s.value.slice(),l=Qx(o),c="";l.forEach(function(u){T$.indexOf(u)===-1?c+=Un(u):(c.length&&n.push(c),n.push(Un(u)),c="")}),c.length&&n.push(c)}};!(s=r.next()).done;)i();return n},L$=function(){function e(t,r,n){this.text=O$(r.data,n.textTransform),this.textBounds=k$(t,this.text,n,r)}return e}(),O$=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(U$,P$);case 2:return e.toUpperCase();default:return e}},U$=/(^|\s|:|-|\(|\))([a-z])/g,P$=function(e,t,r){return e.length>0?t+r.toUpperCase():e},oT=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return t}($o),lT=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return t}($o),cT=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this,i=new XMLSerializer,o=Rx(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return t}($o),uT=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.value=n.value,s}return t}($o),Sw=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return t}($o),D$=[{type:15,flags:0,unit:"px",number:3}],R$=[{type:16,flags:0,number:50}],Q$=function(e){return e.width>e.height?new Tl(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new Tl(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},M$=function(e){var t=e.type===H$?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},Vg="checkbox",Gg="radio",H$="password",RC=707406591,p_=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=M$(n),(s.type===Vg||s.type===Gg)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=Q$(s.bounds)),s.type){case Vg:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=D$;break;case Gg:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=R$;break}return s}return t}($o),dT=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this,i=n.options[n.selectedIndex||0];return s.value=i&&i.text||"",s}return t}($o),AT=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.value=n.value,s}return t}($o),fT=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=pT(r,n.contentWindow.document.documentElement);var i=n.contentWindow.document.documentElement?Nh(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):wl.TRANSPARENT,o=n.contentWindow.document.body?Nh(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):wl.TRANSPARENT;s.backgroundColor=Fc(i)?Fc(o)?s.styles.backgroundColor:o:i}}catch{}return s}return t}($o),q$=["OL","UL","MENU"],ng=function(e,t,r,n){for(var s=t.firstChild,i=void 0;s;s=i)if(i=s.nextSibling,mT(s)&&s.data.trim().length>0)r.textNodes.push(new L$(e,s,r.styles));else if(rA(s))if(vT(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return ng(e,l,r,n)});else{var o=hT(e,s);o.styles.isVisible()&&(K$(s,o,n)?o.flags|=4:$$(o.styles)&&(o.flags|=2),q$.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?ng(e,s.shadowRoot,o,n):!Wg(s)&&!gT(s)&&!zg(s)&&ng(e,s,o,n))}},hT=function(e,t){return Fw(t)?new oT(e,t):xT(t)?new lT(e,t):gT(t)?new cT(e,t):V$(t)?new uT(e,t):G$(t)?new Sw(e,t):W$(t)?new p_(e,t):zg(t)?new dT(e,t):Wg(t)?new AT(e,t):yT(t)?new fT(e,t):new $o(e,t)},pT=function(e,t){var r=hT(e,t);return r.flags|=4,ng(e,t,r,r),r},K$=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||m_(e)&&r.styles.isTransparent()},$$=function(e){return e.isPositioned()||e.isFloating()},mT=function(e){return e.nodeType===Node.TEXT_NODE},rA=function(e){return e.nodeType===Node.ELEMENT_NODE},Ew=function(e){return rA(e)&&typeof e.style<"u"&&!ag(e)},ag=function(e){return typeof e.className=="object"},V$=function(e){return e.tagName==="LI"},G$=function(e){return e.tagName==="OL"},W$=function(e){return e.tagName==="INPUT"},z$=function(e){return e.tagName==="HTML"},gT=function(e){return e.tagName==="svg"},m_=function(e){return e.tagName==="BODY"},xT=function(e){return e.tagName==="CANVAS"},QC=function(e){return e.tagName==="VIDEO"},Fw=function(e){return e.tagName==="IMG"},yT=function(e){return e.tagName==="IFRAME"},MC=function(e){return e.tagName==="STYLE"},X$=function(e){return e.tagName==="SCRIPT"},Wg=function(e){return e.tagName==="TEXTAREA"},zg=function(e){return e.tagName==="SELECT"},vT=function(e){return e.tagName==="SLOT"},HC=function(e){return e.tagName.indexOf("-")>0},Y$=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,s=t.counterReset,i=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(i=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return i&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},e}(),qC={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},KC={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},J$={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Z$={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Ed=function(e,t,r,n,s,i){return e<t||e>r?l0(e,s,i.length>0):n.integers.reduce(function(o,l,c){for(;e>=l;)e-=l,o+=n.values[c];return o},"")+i},bT=function(e,t,r,n){var s="";do r||e--,s=n(e)+s,e/=t;while(e*t>=t);return s},Ln=function(e,t,r,n,s){var i=r-t+1;return(e<0?"-":"")+(bT(Math.abs(e),i,n,function(o){return Un(Math.floor(o%i)+t)})+s)},uu=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return bT(Math.abs(e),n,!1,function(s){return t[Math.floor(s%n)]})+r},Qd=1,sc=2,ic=4,ah=8,Al=function(e,t,r,n,s,i){if(e<-9999||e>9999)return l0(e,4,s.length>0);var o=Math.abs(e),l=s;if(o===0)return t[0]+l;for(var c=0;o>0&&c<=4;c++){var u=o%10;u===0&&da(i,Qd)&&l!==""?l=t[u]+l:u>1||u===1&&c===0||u===1&&c===1&&da(i,sc)||u===1&&c===1&&da(i,ic)&&e>100||u===1&&c>1&&da(i,ah)?l=t[u]+(c>0?r[c-1]:"")+l:u===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(e<0?n:"")+l},$C="",VC="",GC="",Av="",l0=function(e,t,r){var n=r?". ":"",s=r?"":"",i=r?", ":"",o=r?" ":"";switch(t){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Ln(e,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return uu(e,"",s);case 6:return Ed(e,1,3999,qC,3,n).toLowerCase();case 7:return Ed(e,1,3999,qC,3,n);case 8:return Ln(e,945,969,!1,n);case 9:return Ln(e,97,122,!1,n);case 10:return Ln(e,65,90,!1,n);case 11:return Ln(e,1632,1641,!0,n);case 12:case 49:return Ed(e,1,9999,KC,3,n);case 35:return Ed(e,1,9999,KC,3,n).toLowerCase();case 13:return Ln(e,2534,2543,!0,n);case 14:case 30:return Ln(e,6112,6121,!0,n);case 15:return uu(e,"",s);case 16:return uu(e,"",s);case 17:case 48:return Al(e,"",$C,"",s,sc|ic|ah);case 47:return Al(e,"",VC,"",s,Qd|sc|ic|ah);case 42:return Al(e,"",$C,"",s,sc|ic|ah);case 41:return Al(e,"",VC,"",s,Qd|sc|ic|ah);case 26:return Al(e,"","",GC,s,0);case 25:return Al(e,"","",GC,s,Qd|sc|ic);case 31:return Al(e,"","",Av,i,Qd|sc|ic);case 33:return Al(e,"","",Av,i,0);case 32:return Al(e,"","",Av,i,Qd|sc|ic);case 18:return Ln(e,2406,2415,!0,n);case 20:return Ed(e,1,19999,Z$,3,n);case 21:return Ln(e,2790,2799,!0,n);case 22:return Ln(e,2662,2671,!0,n);case 22:return Ed(e,1,10999,J$,3,n);case 23:return uu(e,"");case 24:return uu(e,"");case 27:return Ln(e,3302,3311,!0,n);case 28:return uu(e,"",s);case 29:return uu(e,"",s);case 34:return Ln(e,3792,3801,!0,n);case 37:return Ln(e,6160,6169,!0,n);case 38:return Ln(e,4160,4169,!0,n);case 39:return Ln(e,2918,2927,!0,n);case 40:return Ln(e,1776,1785,!0,n);case 43:return Ln(e,3046,3055,!0,n);case 44:return Ln(e,3174,3183,!0,n);case 45:return Ln(e,3664,3673,!0,n);case 46:return Ln(e,3872,3881,!0,n);case 3:default:return Ln(e,48,57,!0,n)}},wT="data-html2canvas-ignore",WC=function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new Y$,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,s=eV(t,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var i=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,l=s.contentWindow,c=l.document,u=nV(s).then(function(){return ps(n,void 0,void 0,function(){var d,h;return Xa(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(oV),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,h=this.clonedReferenceElement,typeof h>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,rV(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,h)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(sV(document.doctype)+"<html></html>"),iV(this.referenceElement.ownerDocument,i,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),u},e.prototype.createElementClone=function(t){if(Bw(t,2))debugger;if(xT(t))return this.createCanvasClone(t);if(QC(t))return this.createVideoClone(t);if(MC(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return Fw(r)&&(Fw(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),HC(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return fv(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(i,o){return o&&typeof o.cssText=="string"?i+o.cssText:i},""),s=t.cloneNode(!1);return s.textContent=n,s}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var s=t.cloneNode(!1);try{s.width=t.width,s.height=t.height;var i=t.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&i)o.putImageData(i.getImageData(0,0,t.width,t.height),0,0);else{var l=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return s},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var s=t.ownerDocument.createElement("canvas");return s.width=t.offsetWidth,s.height=t.offsetHeight,s},e.prototype.appendChildNode=function(t,r,n){(!rA(r)||!X$(r)&&!r.hasAttribute(wT)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!rA(r)||!MC(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var s=this,i=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;i;i=i.nextSibling)if(rA(i)&&vT(i)&&typeof i.assignedNodes=="function"){var o=i.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,n)})}else this.appendChildNode(r,i,n)},e.prototype.cloneNode=function(t,r){if(mT(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&rA(t)&&(Ew(t)||ag(t))){var s=this.createElementClone(t);s.style.transitionProperty="none";var i=n.getComputedStyle(t),o=n.getComputedStyle(t,":before"),l=n.getComputedStyle(t,":after");this.referenceElement===t&&Ew(s)&&(this.clonedReferenceElement=s),m_(s)&&uV(s);var c=this.counters.parse(new jC(this.context,i)),u=this.resolvePseudoContent(t,s,o,Bh.BEFORE);HC(t)&&(r=!0),QC(t)||this.cloneChildNodes(t,s,r),u&&s.insertBefore(u,s.firstChild);var d=this.resolvePseudoContent(t,s,l,Bh.AFTER);return d&&s.appendChild(d),this.counters.pop(c),(i&&(this.options.copyStyles||ag(t))&&!yT(t)||r)&&fv(i,s),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([s,t.scrollLeft,t.scrollTop]),(Wg(t)||zg(t))&&(Wg(s)||zg(s))&&(s.value=t.value),s}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,s){var i=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new jC(this.context,n));var c=new VK(this.context,n),u=l.createElement("html2canvaspseudoelement");fv(n,u),c.content.forEach(function(h){if(h.type===0)u.appendChild(l.createTextNode(h.value));else if(h.type===22){var f=l.createElement("img");f.src=h.value,f.style.opacity="1",u.appendChild(f)}else if(h.type===18){if(h.name==="attr"){var A=h.values.filter(Pr);A.length&&u.appendChild(l.createTextNode(t.getAttribute(A[0].value)||""))}else if(h.name==="counter"){var b=h.values.filter(EA),m=b[0],v=b[1];if(m&&Pr(m)){var p=i.counters.getCounterValue(m.value),g=v&&Pr(v)?Cw.parse(i.context,v.value):3;u.appendChild(l.createTextNode(l0(p,g,!1)))}}else if(h.name==="counters"){var y=h.values.filter(EA),m=y[0],x=y[1],v=y[2];if(m&&Pr(m)){var w=i.counters.getCounterValues(m.value),N=v&&Pr(v)?Cw.parse(i.context,v.value):3,_=x&&x.type===0?x.value:"",C=w.map(function(S){return l0(S,N,!1)}).join(_);u.appendChild(l.createTextNode(C))}}}else if(h.type===20)switch(h.value){case"open-quote":u.appendChild(l.createTextNode(NC(c.quotes,i.quoteDepth++,!0)));break;case"close-quote":u.appendChild(l.createTextNode(NC(c.quotes,--i.quoteDepth,!1)));break;default:u.appendChild(l.createTextNode(h.value))}}),u.className=Tw+" "+Iw;var d=s===Bh.BEFORE?" "+Tw:" "+Iw;return ag(r)?r.className.baseValue+=d:r.className+=d,u}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),Bh;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(Bh||(Bh={}));var eV=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(wT,"true"),e.body.appendChild(r),r},tV=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},rV=function(e){return Promise.all([].slice.call(e.images,0).map(tV))},nV=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var i=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(i),t(e))},50)}})},aV=["all","d","content"],fv=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);aV.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},sV=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},iV=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},oV=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},lV=":before",cV=":after",Tw="___html2canvas___pseudoelement_before",Iw="___html2canvas___pseudoelement_after",zC=`{
    content: "" !important;
    display: none !important;
}`,uV=function(e){dV(e,"."+Tw+lV+zC+`
         .`+Iw+cV+zC)},dV=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},_T=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),AV=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(pv(t)||mV(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return ps(this,void 0,void 0,function(){var r,n,s,i,o=this;return Xa(this,function(l){switch(l.label){case 0:return r=_T.isSameOrigin(t),n=!hv(t)&&this._options.useCORS===!0&&La.SUPPORT_CORS_IMAGES&&!r,s=!hv(t)&&!r&&!pv(t)&&typeof this._options.proxy=="string"&&La.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!hv(t)&&!pv(t)&&!s&&!n?[2]:(i=t,s?[4,this.proxy(i)]:[3,2]);case 1:i=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(c,u){var d=new Image;d.onload=function(){return c(d)},d.onerror=u,(gV(i)||n)&&(d.crossOrigin="anonymous"),d.src=i,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return u("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=t.substring(0,256);return new Promise(function(i,o){var l=La.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")i(c.response);else{var h=new FileReader;h.addEventListener("load",function(){return i(h.result)},!1),h.addEventListener("error",function(f){return o(f)},!1),h.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var u=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+u+"url="+encodeURIComponent(t)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+s)}}c.send()})},e}(),fV=/^data:image\/svg\+xml/i,hV=/^data:image\/.*;base64,/i,pV=/^data:image\/.*/i,mV=function(e){return La.SUPPORT_SVG_DRAWING||!xV(e)},hv=function(e){return pV.test(e)},gV=function(e){return hV.test(e)},pv=function(e){return e.substr(0,4)==="blob"},xV=function(e){return e.substr(-3).toLowerCase()==="svg"||fV.test(e)},kt=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),Fd=function(e,t,r){return new kt(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},xm=function(){function e(t,r,n,s){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=s}return e.prototype.subdivide=function(t,r){var n=Fd(this.start,this.startControl,t),s=Fd(this.startControl,this.endControl,t),i=Fd(this.endControl,this.end,t),o=Fd(n,s,t),l=Fd(s,i,t),c=Fd(o,l,t);return r?new e(this.start,n,o,c):new e(c,l,i,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),Ei=function(e){return e.type===1},yV=function(){function e(t){var r=t.styles,n=t.bounds,s=rh(r.borderTopLeftRadius,n.width,n.height),i=s[0],o=s[1],l=rh(r.borderTopRightRadius,n.width,n.height),c=l[0],u=l[1],d=rh(r.borderBottomRightRadius,n.width,n.height),h=d[0],f=d[1],A=rh(r.borderBottomLeftRadius,n.width,n.height),b=A[0],m=A[1],v=[];v.push((i+c)/n.width),v.push((b+h)/n.width),v.push((o+m)/n.height),v.push((u+f)/n.height);var p=Math.max.apply(Math,v);p>1&&(i/=p,o/=p,c/=p,u/=p,h/=p,f/=p,b/=p,m/=p);var g=n.width-c,y=n.height-f,x=n.width-h,w=n.height-m,N=r.borderTopWidth,_=r.borderRightWidth,C=r.borderBottomWidth,j=r.borderLeftWidth,E=Wr(r.paddingTop,t.bounds.width),S=Wr(r.paddingRight,t.bounds.width),F=Wr(r.paddingBottom,t.bounds.width),I=Wr(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||o>0?ln(n.left+j/3,n.top+N/3,i-j/3,o-N/3,kr.TOP_LEFT):new kt(n.left+j/3,n.top+N/3),this.topRightBorderDoubleOuterBox=i>0||o>0?ln(n.left+g,n.top+N/3,c-_/3,u-N/3,kr.TOP_RIGHT):new kt(n.left+n.width-_/3,n.top+N/3),this.bottomRightBorderDoubleOuterBox=h>0||f>0?ln(n.left+x,n.top+y,h-_/3,f-C/3,kr.BOTTOM_RIGHT):new kt(n.left+n.width-_/3,n.top+n.height-C/3),this.bottomLeftBorderDoubleOuterBox=b>0||m>0?ln(n.left+j/3,n.top+w,b-j/3,m-C/3,kr.BOTTOM_LEFT):new kt(n.left+j/3,n.top+n.height-C/3),this.topLeftBorderDoubleInnerBox=i>0||o>0?ln(n.left+j*2/3,n.top+N*2/3,i-j*2/3,o-N*2/3,kr.TOP_LEFT):new kt(n.left+j*2/3,n.top+N*2/3),this.topRightBorderDoubleInnerBox=i>0||o>0?ln(n.left+g,n.top+N*2/3,c-_*2/3,u-N*2/3,kr.TOP_RIGHT):new kt(n.left+n.width-_*2/3,n.top+N*2/3),this.bottomRightBorderDoubleInnerBox=h>0||f>0?ln(n.left+x,n.top+y,h-_*2/3,f-C*2/3,kr.BOTTOM_RIGHT):new kt(n.left+n.width-_*2/3,n.top+n.height-C*2/3),this.bottomLeftBorderDoubleInnerBox=b>0||m>0?ln(n.left+j*2/3,n.top+w,b-j*2/3,m-C*2/3,kr.BOTTOM_LEFT):new kt(n.left+j*2/3,n.top+n.height-C*2/3),this.topLeftBorderStroke=i>0||o>0?ln(n.left+j/2,n.top+N/2,i-j/2,o-N/2,kr.TOP_LEFT):new kt(n.left+j/2,n.top+N/2),this.topRightBorderStroke=i>0||o>0?ln(n.left+g,n.top+N/2,c-_/2,u-N/2,kr.TOP_RIGHT):new kt(n.left+n.width-_/2,n.top+N/2),this.bottomRightBorderStroke=h>0||f>0?ln(n.left+x,n.top+y,h-_/2,f-C/2,kr.BOTTOM_RIGHT):new kt(n.left+n.width-_/2,n.top+n.height-C/2),this.bottomLeftBorderStroke=b>0||m>0?ln(n.left+j/2,n.top+w,b-j/2,m-C/2,kr.BOTTOM_LEFT):new kt(n.left+j/2,n.top+n.height-C/2),this.topLeftBorderBox=i>0||o>0?ln(n.left,n.top,i,o,kr.TOP_LEFT):new kt(n.left,n.top),this.topRightBorderBox=c>0||u>0?ln(n.left+g,n.top,c,u,kr.TOP_RIGHT):new kt(n.left+n.width,n.top),this.bottomRightBorderBox=h>0||f>0?ln(n.left+x,n.top+y,h,f,kr.BOTTOM_RIGHT):new kt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=b>0||m>0?ln(n.left,n.top+w,b,m,kr.BOTTOM_LEFT):new kt(n.left,n.top+n.height),this.topLeftPaddingBox=i>0||o>0?ln(n.left+j,n.top+N,Math.max(0,i-j),Math.max(0,o-N),kr.TOP_LEFT):new kt(n.left+j,n.top+N),this.topRightPaddingBox=c>0||u>0?ln(n.left+Math.min(g,n.width-_),n.top+N,g>n.width+_?0:Math.max(0,c-_),Math.max(0,u-N),kr.TOP_RIGHT):new kt(n.left+n.width-_,n.top+N),this.bottomRightPaddingBox=h>0||f>0?ln(n.left+Math.min(x,n.width-j),n.top+Math.min(y,n.height-C),Math.max(0,h-_),Math.max(0,f-C),kr.BOTTOM_RIGHT):new kt(n.left+n.width-_,n.top+n.height-C),this.bottomLeftPaddingBox=b>0||m>0?ln(n.left+j,n.top+Math.min(w,n.height-C),Math.max(0,b-j),Math.max(0,m-C),kr.BOTTOM_LEFT):new kt(n.left+j,n.top+n.height-C),this.topLeftContentBox=i>0||o>0?ln(n.left+j+I,n.top+N+E,Math.max(0,i-(j+I)),Math.max(0,o-(N+E)),kr.TOP_LEFT):new kt(n.left+j+I,n.top+N+E),this.topRightContentBox=c>0||u>0?ln(n.left+Math.min(g,n.width+j+I),n.top+N+E,g>n.width+j+I?0:c-j+I,u-(N+E),kr.TOP_RIGHT):new kt(n.left+n.width-(_+S),n.top+N+E),this.bottomRightContentBox=h>0||f>0?ln(n.left+Math.min(x,n.width-(j+I)),n.top+Math.min(y,n.height+N+E),Math.max(0,h-(_+S)),f-(C+F),kr.BOTTOM_RIGHT):new kt(n.left+n.width-(_+S),n.top+n.height-(C+F)),this.bottomLeftContentBox=b>0||m>0?ln(n.left+j+I,n.top+w,Math.max(0,b-(j+I)),m-(C+F),kr.BOTTOM_LEFT):new kt(n.left+j+I,n.top+n.height-(C+F))}return e}(),kr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(kr||(kr={}));var ln=function(e,t,r,n,s){var i=4*((Math.sqrt(2)-1)/3),o=r*i,l=n*i,c=e+r,u=t+n;switch(s){case kr.TOP_LEFT:return new xm(new kt(e,u),new kt(e,u-l),new kt(c-o,t),new kt(c,t));case kr.TOP_RIGHT:return new xm(new kt(e,t),new kt(e+o,t),new kt(c,u-l),new kt(c,u));case kr.BOTTOM_RIGHT:return new xm(new kt(c,t),new kt(c,t+l),new kt(e+o,u),new kt(e,u));case kr.BOTTOM_LEFT:default:return new xm(new kt(c,u),new kt(c-o,u),new kt(e,t+l),new kt(e,t))}},Xg=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},vV=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Yg=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},bV=function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e}(),ym=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),wV=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),_V=function(e){return e.type===0},NT=function(e){return e.type===1},NV=function(e){return e.type===2},XC=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},jV=function(e,t,r,n,s){return e.map(function(i,o){switch(o){case 0:return i.add(t,r);case 1:return i.add(t+n,r);case 2:return i.add(t+n,r+s);case 3:return i.add(t,r+s)}return i})},jT=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),CT=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new yV(this.container),this.container.styles.opacity<1&&this.effects.push(new wV(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new bV(n,s,i))}if(this.container.styles.overflowX!==0){var o=Xg(this.curves),l=Yg(this.curves);XC(o,l)?this.effects.push(new ym(o,6)):(this.effects.push(new ym(o,2)),this.effects.push(new ym(l,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var i=n.effects.filter(function(c){return!NT(c)});if(r||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,i),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=Xg(n.curves),l=Yg(n.curves);XC(o,l)||s.unshift(new ym(l,6))}}else s.unshift.apply(s,i);n=n.parent}return s.filter(function(c){return da(c.target,t)})},e}(),Lw=function(e,t,r,n){e.container.elements.forEach(function(s){var i=da(s.flags,4),o=da(s.flags,2),l=new CT(s,e);da(s.styles.display,2048)&&n.push(l);var c=da(s.flags,8)?[]:n;if(i||o){var u=i||s.styles.isPositioned()?r:t,d=new jT(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var h=s.styles.zIndex.order;if(h<0){var f=0;u.negativeZIndex.some(function(b,m){return h>b.element.container.styles.zIndex.order?(f=m,!1):f>0}),u.negativeZIndex.splice(f,0,d)}else if(h>0){var A=0;u.positiveZIndex.some(function(b,m){return h>=b.element.container.styles.zIndex.order?(A=m+1,!1):A>0}),u.positiveZIndex.splice(A,0,d)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else s.styles.isFloating()?u.nonPositionedFloats.push(d):u.nonPositionedInlineLevel.push(d);Lw(l,d,i?d:r,c)}else s.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),Lw(l,t,r,c);da(s.flags,8)&&BT(s,c)})},BT=function(e,t){for(var r=e instanceof Sw?e.start:1,n=e instanceof Sw?e.reversed:!1,s=0;s<t.length;s++){var i=t[s];i.container instanceof uT&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=l0(r,i.container.styles.listStyleType,!0),r+=n?-1:1}},CV=function(e){var t=new CT(e,null),r=new jT(t),n=[];return Lw(t,r,r,n),BT(t.container,n),r},YC=function(e,t){switch(t){case 0:return Li(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Li(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Li(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return Li(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},BV=function(e,t){switch(t){case 0:return Li(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Li(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Li(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return Li(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},kV=function(e,t){switch(t){case 0:return Li(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Li(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Li(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return Li(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},SV=function(e,t){switch(t){case 0:return vm(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return vm(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return vm(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return vm(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},vm=function(e,t){var r=[];return Ei(e)?r.push(e.subdivide(.5,!1)):r.push(e),Ei(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Li=function(e,t,r,n){var s=[];return Ei(e)?s.push(e.subdivide(.5,!1)):s.push(e),Ei(r)?s.push(r.subdivide(.5,!0)):s.push(r),Ei(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),Ei(t)?s.push(t.subdivide(.5,!1).reverse()):s.push(t),s},kT=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},Jg=function(e){var t=e.styles,r=e.bounds,n=Wr(t.paddingLeft,r.width),s=Wr(t.paddingRight,r.width),i=Wr(t.paddingTop,r.width),o=Wr(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,i+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+s),-(t.borderTopWidth+t.borderBottomWidth+i+o))},EV=function(e,t){return e===0?t.bounds:e===2?Jg(t):kT(t)},FV=function(e,t){return e===0?t.bounds:e===2?Jg(t):kT(t)},mv=function(e,t,r){var n=EV(Md(e.styles.backgroundOrigin,t),e),s=FV(Md(e.styles.backgroundClip,t),e),i=TV(Md(e.styles.backgroundSize,t),r,n),o=i[0],l=i[1],c=rh(Md(e.styles.backgroundPosition,t),n.width-o,n.height-l),u=IV(Md(e.styles.backgroundRepeat,t),c,i,n,s),d=Math.round(n.left+c[0]),h=Math.round(n.top+c[1]);return[u,d,h,o,l]},Td=function(e){return Pr(e)&&e.value===mA.AUTO},bm=function(e){return typeof e=="number"},TV=function(e,t,r){var n=t[0],s=t[1],i=t[2],o=e[0],l=e[1];if(!o)return[0,0];if(Yn(o)&&l&&Yn(l))return[Wr(o,r.width),Wr(l,r.height)];var c=bm(i);if(Pr(o)&&(o.value===mA.CONTAIN||o.value===mA.COVER)){if(bm(i)){var u=r.width/r.height;return u<i!=(o.value===mA.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var d=bm(n),h=bm(s),f=d||h;if(Td(o)&&(!l||Td(l))){if(d&&h)return[n,s];if(!c&&!f)return[r.width,r.height];if(f&&c){var A=d?n:s*i,b=h?s:n/i;return[A,b]}var m=d?n:r.width,v=h?s:r.height;return[m,v]}if(c){var p=0,g=0;return Yn(o)?p=Wr(o,r.width):Yn(l)&&(g=Wr(l,r.height)),Td(o)?p=g*i:(!l||Td(l))&&(g=p/i),[p,g]}var y=null,x=null;if(Yn(o)?y=Wr(o,r.width):l&&Yn(l)&&(x=Wr(l,r.height)),y!==null&&(!l||Td(l))&&(x=d&&h?y/n*s:r.height),x!==null&&Td(o)&&(y=d&&h?x/s*n:r.width),y!==null&&x!==null)return[y,x];throw new Error("Unable to calculate background-size for element")},Md=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},IV=function(e,t,r,n,s){var i=t[0],o=t[1],l=r[0],c=r[1];switch(e){case 2:return[new kt(Math.round(n.left),Math.round(n.top+o)),new kt(Math.round(n.left+n.width),Math.round(n.top+o)),new kt(Math.round(n.left+n.width),Math.round(c+n.top+o)),new kt(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new kt(Math.round(n.left+i),Math.round(n.top)),new kt(Math.round(n.left+i+l),Math.round(n.top)),new kt(Math.round(n.left+i+l),Math.round(n.height+n.top)),new kt(Math.round(n.left+i),Math.round(n.height+n.top))];case 1:return[new kt(Math.round(n.left+i),Math.round(n.top+o)),new kt(Math.round(n.left+i+l),Math.round(n.top+o)),new kt(Math.round(n.left+i+l),Math.round(n.top+o+c)),new kt(Math.round(n.left+i),Math.round(n.top+o+c))];default:return[new kt(Math.round(s.left),Math.round(s.top)),new kt(Math.round(s.left+s.width),Math.round(s.top)),new kt(Math.round(s.left+s.width),Math.round(s.height+s.top)),new kt(Math.round(s.left),Math.round(s.height+s.top))]}},LV="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",JC="Hidden Text",OV=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),s=this._document.createElement("img"),i=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),s.src=LV,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",i.style.fontFamily=t,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(JC)),n.appendChild(i),n.appendChild(s);var l=s.offsetTop-i.offsetTop+2;n.removeChild(i),n.appendChild(this._document.createTextNode(JC)),n.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e}(),ST=function(){function e(t,r){this.context=t,this.options=r}return e}(),UV=1e4,PV=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new OV(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return n.applyEffect(s)})},t.prototype.applyEffect=function(r){this.ctx.save(),NV(r)&&(this.ctx.globalAlpha=r.opacity),_V(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),NT(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return ps(this,void 0,void 0,function(){var n;return Xa(this,function(s){switch(s.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return ps(this,void 0,void 0,function(){return Xa(this,function(n){switch(n.label){case 0:if(da(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,s){var i=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=h_(r.text);o.reduce(function(l,c){return i.ctx.fillText(c,l,r.bounds.top+s),l+i.ctx.measureText(c).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=HV(r.fontFamily).join(", "),i=T0(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,i,s].join(" "),s,i]},t.prototype.renderTextNode=function(r,n){return ps(this,void 0,void 0,function(){var s,i,o,l,c,u,d,h,f=this;return Xa(this,function(A){return s=this.createFontStyle(n),i=s[0],o=s[1],l=s[2],this.ctx.font=i,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),u=c.baseline,d=c.middle,h=n.paintOrder,r.textBounds.forEach(function(b){h.forEach(function(m){switch(m){case 0:f.ctx.fillStyle=ga(n.color),f.renderTextWithLetterSpacing(b,n.letterSpacing,u);var v=n.textShadow;v.length&&b.text.trim().length&&(v.slice(0).reverse().forEach(function(p){f.ctx.shadowColor=ga(p.color),f.ctx.shadowOffsetX=p.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=p.offsetY.number*f.options.scale,f.ctx.shadowBlur=p.blur.number,f.renderTextWithLetterSpacing(b,n.letterSpacing,u)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),n.textDecorationLine.length&&(f.ctx.fillStyle=ga(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(p){switch(p){case 1:f.ctx.fillRect(b.bounds.left,Math.round(b.bounds.top+u),b.bounds.width,1);break;case 2:f.ctx.fillRect(b.bounds.left,Math.round(b.bounds.top),b.bounds.width,1);break;case 3:f.ctx.fillRect(b.bounds.left,Math.ceil(b.bounds.top+d),b.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&b.text.trim().length&&(f.ctx.strokeStyle=ga(n.webkitTextStrokeColor),f.ctx.lineWidth=n.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(b.text,b.bounds.left,b.bounds.top+u)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=Jg(r),o=Yg(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return ps(this,void 0,void 0,function(){var n,s,i,o,l,c,g,g,u,d,h,f,x,A,b,w,m,v,p,g,y,x,w;return Xa(this,function(N){switch(N.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,s=r.curves,i=n.styles,o=0,l=n.textNodes,N.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,i)]):[3,4];case 2:N.sent(),N.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof oT))return[3,8];N.label=5;case 5:return N.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return g=N.sent(),this.renderReplacedElement(n,s,g),[3,8];case 7:return N.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof lT&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof cT))return[3,12];N.label=9;case 9:return N.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return g=N.sent(),this.renderReplacedElement(n,s,g),[3,12];case 11:return N.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof fT&&n.tree?(u=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,u.render(n.tree)]):[3,14];case 13:d=N.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),N.label=14;case 14:if(n instanceof p_&&(h=Math.min(n.bounds.width,n.bounds.height),n.type===Vg?n.checked&&(this.ctx.save(),this.path([new kt(n.bounds.left+h*.39363,n.bounds.top+h*.79),new kt(n.bounds.left+h*.16,n.bounds.top+h*.5549),new kt(n.bounds.left+h*.27347,n.bounds.top+h*.44071),new kt(n.bounds.left+h*.39694,n.bounds.top+h*.5649),new kt(n.bounds.left+h*.72983,n.bounds.top+h*.23),new kt(n.bounds.left+h*.84,n.bounds.top+h*.34085),new kt(n.bounds.left+h*.39363,n.bounds.top+h*.79)]),this.ctx.fillStyle=ga(RC),this.ctx.fill(),this.ctx.restore()):n.type===Gg&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+h/2,n.bounds.top+h/2,h/4,0,Math.PI*2,!0),this.ctx.fillStyle=ga(RC),this.ctx.fill(),this.ctx.restore())),DV(n)&&n.value.length){switch(f=this.createFontStyle(i),x=f[0],A=f[1],b=this.fontMetrics.getMetrics(x,A).baseline,this.ctx.font=x,this.ctx.fillStyle=ga(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=QV(n.styles.textAlign),w=Jg(n),m=0,n.styles.textAlign){case 1:m+=w.width/2;break;case 2:m+=w.width;break}v=w.add(m,0,0,-w.height/2+1),this.ctx.save(),this.path([new kt(w.left,w.top),new kt(w.left+w.width,w.top),new kt(w.left+w.width,w.top+w.height),new kt(w.left,w.top+w.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Ch(n.value,v),i.letterSpacing,b),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!da(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(p=n.styles.listStyleImage,p.type!==0)return[3,18];g=void 0,y=p.url,N.label=15;case 15:return N.trys.push([15,17,,18]),[4,this.context.cache.match(y)];case 16:return g=N.sent(),this.ctx.drawImage(g,n.bounds.left-(g.width+10),n.bounds.top),[3,18];case 17:return N.sent(),this.context.logger.error("Error loading list-style-image "+y),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(x=this.createFontStyle(i)[0],this.ctx.font=x,this.ctx.fillStyle=ga(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",w=new Tl(n.bounds.left,n.bounds.top+Wr(n.styles.paddingTop,n.bounds.width),n.bounds.width,wC(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Ch(r.listValue,w),i.letterSpacing,wC(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),N.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return ps(this,void 0,void 0,function(){var n,s,p,i,o,p,l,c,p,u,d,p,h,f,p,A,b,p,m,v,p;return Xa(this,function(g){switch(g.label){case 0:if(da(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:g.sent(),n=0,s=r.negativeZIndex,g.label=2;case 2:return n<s.length?(p=s[n],[4,this.renderStack(p)]):[3,5];case 3:g.sent(),g.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:g.sent(),i=0,o=r.nonInlineLevel,g.label=7;case 7:return i<o.length?(p=o[i],[4,this.renderNode(p)]):[3,10];case 8:g.sent(),g.label=9;case 9:return i++,[3,7];case 10:l=0,c=r.nonPositionedFloats,g.label=11;case 11:return l<c.length?(p=c[l],[4,this.renderStack(p)]):[3,14];case 12:g.sent(),g.label=13;case 13:return l++,[3,11];case 14:u=0,d=r.nonPositionedInlineLevel,g.label=15;case 15:return u<d.length?(p=d[u],[4,this.renderStack(p)]):[3,18];case 16:g.sent(),g.label=17;case 17:return u++,[3,15];case 18:h=0,f=r.inlineLevel,g.label=19;case 19:return h<f.length?(p=f[h],[4,this.renderNode(p)]):[3,22];case 20:g.sent(),g.label=21;case 21:return h++,[3,19];case 22:A=0,b=r.zeroOrAutoZIndexOrTransformedOrOpacity,g.label=23;case 23:return A<b.length?(p=b[A],[4,this.renderStack(p)]):[3,26];case 24:g.sent(),g.label=25;case 25:return A++,[3,23];case 26:m=0,v=r.positiveZIndex,g.label=27;case 27:return m<v.length?(p=v[m],[4,this.renderStack(p)]):[3,30];case 28:g.sent(),g.label=29;case 29:return m++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(s,i){var o=Ei(s)?s.start:s;i===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),Ei(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},t.prototype.renderRepeat=function(r,n,s,i){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(s,i),this.ctx.fill(),this.ctx.translate(-s,-i)},t.prototype.resizeImage=function(r,n,s){var i;if(r.width===n&&r.height===s)return r;var o=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,s),l},t.prototype.renderBackgroundImage=function(r){return ps(this,void 0,void 0,function(){var n,s,i,o,l,c;return Xa(this,function(u){switch(u.label){case 0:n=r.styles.backgroundImage.length-1,s=function(d){var h,f,A,E,P,X,I,O,C,b,E,P,X,I,O,m,v,p,g,y,x,w,N,_,C,j,E,S,F,I,O,M,P,X,J,H,V,K,B,L,U,D;return Xa(this,function(Q){switch(Q.label){case 0:if(d.type!==0)return[3,5];h=void 0,f=d.url,Q.label=1;case 1:return Q.trys.push([1,3,,4]),[4,i.context.cache.match(f)];case 2:return h=Q.sent(),[3,4];case 3:return Q.sent(),i.context.logger.error("Error loading background-image "+f),[3,4];case 4:return h&&(A=mv(r,n,[h.width,h.height,h.width/h.height]),E=A[0],P=A[1],X=A[2],I=A[3],O=A[4],C=i.ctx.createPattern(i.resizeImage(h,I,O),"repeat"),i.renderRepeat(E,C,P,X)),[3,6];case 5:_q(d)?(b=mv(r,n,[null,null,null]),E=b[0],P=b[1],X=b[2],I=b[3],O=b[4],m=xq(d.angle,I,O),v=m[0],p=m[1],g=m[2],y=m[3],x=m[4],w=document.createElement("canvas"),w.width=I,w.height=O,N=w.getContext("2d"),_=N.createLinearGradient(p,y,g,x),vC(d.stops,v).forEach(function(z){return _.addColorStop(z.stop,ga(z.color))}),N.fillStyle=_,N.fillRect(0,0,I,O),I>0&&O>0&&(C=i.ctx.createPattern(w,"repeat"),i.renderRepeat(E,C,P,X))):Nq(d)&&(j=mv(r,n,[null,null,null]),E=j[0],S=j[1],F=j[2],I=j[3],O=j[4],M=d.position.length===0?[d_]:d.position,P=Wr(M[0],I),X=Wr(M[M.length-1],O),J=yq(d,P,X,I,O),H=J[0],V=J[1],H>0&&V>0&&(K=i.ctx.createRadialGradient(S+P,F+X,0,S+P,F+X,H),vC(d.stops,H*2).forEach(function(z){return K.addColorStop(z.stop,ga(z.color))}),i.path(E),i.ctx.fillStyle=K,H!==V?(B=r.bounds.left+.5*r.bounds.width,L=r.bounds.top+.5*r.bounds.height,U=V/H,D=1/U,i.ctx.save(),i.ctx.translate(B,L),i.ctx.transform(1,0,0,U,0,0),i.ctx.translate(-B,-L),i.ctx.fillRect(S,D*(F-L)+L,I,O*D),i.ctx.restore()):i.ctx.fill())),Q.label=6;case 6:return n--,[2]}})},i=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),u.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,s){return ps(this,void 0,void 0,function(){return Xa(this,function(i){return this.path(YC(s,n)),this.ctx.fillStyle=ga(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,s,i){return ps(this,void 0,void 0,function(){var o,l;return Xa(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,s,i)]:[3,2];case 1:return c.sent(),[2];case 2:return o=BV(i,s),this.path(o),this.ctx.fillStyle=ga(r),this.ctx.fill(),l=kV(i,s),this.path(l),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return ps(this,void 0,void 0,function(){var n,s,i,o,l,c,u,d,h=this;return Xa(this,function(f){switch(f.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,s=!Fc(n.backgroundColor)||n.backgroundImage.length,i=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=RV(Md(n.backgroundClip,0),r.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Fc(n.backgroundColor)||(this.ctx.fillStyle=ga(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(A){h.ctx.save();var b=Xg(r.curves),m=A.inset?0:UV,v=jV(b,-m+(A.inset?1:-1)*A.spread.number,(A.inset?1:-1)*A.spread.number,A.spread.number*(A.inset?-2:2),A.spread.number*(A.inset?-2:2));A.inset?(h.path(b),h.ctx.clip(),h.mask(v)):(h.mask(b),h.ctx.clip(),h.path(v)),h.ctx.shadowOffsetX=A.offsetX.number+m,h.ctx.shadowOffsetY=A.offsetY.number,h.ctx.shadowColor=ga(A.color),h.ctx.shadowBlur=A.blur.number,h.ctx.fillStyle=A.inset?ga(A.color):"rgba(0,0,0,1)",h.ctx.fill(),h.ctx.restore()}),f.label=2;case 2:l=0,c=0,u=i,f.label=3;case 3:return c<u.length?(d=u[c],d.style!==0&&!Fc(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return f.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:f.sent(),f.label=11;case 11:l++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,s,i,o){return ps(this,void 0,void 0,function(){var l,c,u,d,h,f,A,b,m,v,p,g,y,x,w,N,w,N;return Xa(this,function(_){return this.ctx.save(),l=SV(i,s),c=YC(i,s),o===2&&(this.path(c),this.ctx.clip()),Ei(c[0])?(u=c[0].start.x,d=c[0].start.y):(u=c[0].x,d=c[0].y),Ei(c[1])?(h=c[1].end.x,f=c[1].end.y):(h=c[1].x,f=c[1].y),s===0||s===2?A=Math.abs(u-h):A=Math.abs(d-f),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),b=n<3?n*3:n*2,m=n<3?n*2:n,o===3&&(b=n,m=n),v=!0,A<=b*2?v=!1:A<=b*2+m?(p=A/(2*b+m),b*=p,m*=p):(g=Math.floor((A+m)/(b+m)),y=(A-g*b)/(g-1),x=(A-(g+1)*b)/g,m=x<=0||Math.abs(m-y)<Math.abs(m-x)?y:x),v&&(o===3?this.ctx.setLineDash([0,b+m]):this.ctx.setLineDash([b,m])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=ga(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(Ei(c[0])&&(w=c[3],N=c[0],this.ctx.beginPath(),this.formatPath([new kt(w.end.x,w.end.y),new kt(N.start.x,N.start.y)]),this.ctx.stroke()),Ei(c[1])&&(w=c[1],N=c[2],this.ctx.beginPath(),this.formatPath([new kt(w.end.x,w.end.y),new kt(N.start.x,N.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return ps(this,void 0,void 0,function(){var n;return Xa(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ga(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=CV(r),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(ST),DV=function(e){return e instanceof AT||e instanceof dT?!0:e instanceof p_&&e.type!==Gg&&e.type!==Vg},RV=function(e,t){switch(e){case 0:return Xg(t);case 2:return vV(t);case 1:default:return Yg(t)}},QV=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},MV=["-apple-system","system-ui"],HV=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return MV.indexOf(t)===-1}):e},qV=function(e){bo(t,e);function t(r,n){var s=e.call(this,r,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return t.prototype.render=function(r){return ps(this,void 0,void 0,function(){var n,s;return Xa(this,function(i){switch(i.label){case 0:return n=kw(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,KV(n)];case 1:return s=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ga(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(ST),KV=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},$V=function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Zp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Zp([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Zp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Zp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),VV=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new $V({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new AV(this,t)}return e.instanceCount=1,e}(),td=function(e,t){return t===void 0&&(t={}),GV(e,t)};typeof window<"u"&&_T.setContext(window);var GV=function(e,t){return ps(void 0,void 0,void 0,function(){var r,n,s,i,o,l,c,u,d,h,f,A,b,m,v,p,g,y,x,w,_,N,_,C,j,E,S,F,I,O,M,P,X,J,H,V,K,B,L,U;return Xa(this,function(D){switch(D.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(C=t.allowTaint)!==null&&C!==void 0?C:!1,imageTimeout:(j=t.imageTimeout)!==null&&j!==void 0?j:15e3,proxy:t.proxy,useCORS:(E=t.useCORS)!==null&&E!==void 0?E:!1},i=fw({logging:(S=t.logging)!==null&&S!==void 0?S:!0,cache:t.cache},s),o={windowWidth:(F=t.windowWidth)!==null&&F!==void 0?F:n.innerWidth,windowHeight:(I=t.windowHeight)!==null&&I!==void 0?I:n.innerHeight,scrollX:(O=t.scrollX)!==null&&O!==void 0?O:n.pageXOffset,scrollY:(M=t.scrollY)!==null&&M!==void 0?M:n.pageYOffset},l=new Tl(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new VV(i,l),u=(P=t.foreignObjectRendering)!==null&&P!==void 0?P:!1,d={allowTaint:(X=t.allowTaint)!==null&&X!==void 0?X:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:u,copyStyles:u},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),h=new WC(c,e,d),f=h.clonedReferenceElement,f?[4,h.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return A=D.sent(),b=m_(f)||z$(f)?j9(f.ownerDocument):Rx(c,f),m=b.width,v=b.height,p=b.left,g=b.top,y=WV(c,f,t.backgroundColor),x={canvas:t.canvas,backgroundColor:y,scale:(H=(J=t.scale)!==null&&J!==void 0?J:n.devicePixelRatio)!==null&&H!==void 0?H:1,x:((V=t.x)!==null&&V!==void 0?V:0)+p,y:((K=t.y)!==null&&K!==void 0?K:0)+g,width:(B=t.width)!==null&&B!==void 0?B:Math.ceil(m),height:(L=t.height)!==null&&L!==void 0?L:Math.ceil(v)},u?(c.logger.debug("Document cloned, using foreign object rendering"),_=new qV(c,x),[4,_.render(f)]):[3,3];case 2:return w=D.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+p+","+g+" with size "+m+"x"+v+" using computed rendering"),c.logger.debug("Starting DOM parsing"),N=pT(c,f),y===N.styles.backgroundColor&&(N.styles.backgroundColor=wl.TRANSPARENT),c.logger.debug("Starting renderer for element at "+x.x+","+x.y+" with size "+x.width+"x"+x.height),_=new PV(c,x),[4,_.render(N)];case 4:w=D.sent(),D.label=5;case 5:return(!((U=t.removeContainer)!==null&&U!==void 0)||U)&&(WC.destroy(A)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,w]}})})},WV=function(e,t,r){var n=t.ownerDocument,s=n.documentElement?Nh(e,getComputedStyle(n.documentElement).backgroundColor):wl.TRANSPARENT,i=n.body?Nh(e,getComputedStyle(n.body).backgroundColor):wl.TRANSPARENT,o=typeof r=="string"?Nh(e,r):r===null?wl.TRANSPARENT:4294967295;return t===n.documentElement?Fc(s)?Fc(i)?o:i:s:o};const zV=Object.freeze(Object.defineProperty({__proto__:null,default:td},Symbol.toStringTag,{value:"Module"}));function XV({materialReturn:e,items:t,onClose:r}){const n=W.useRef(null),s=u=>{const d=new Date(u),h=d.getDate(),f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][d.getMonth()],A=d.getFullYear();return`${h} ${f} ${A}`},i=u=>u==null?"Rp 0":`Rp ${u.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,o=()=>{window.print()},l=async()=>{if(n.current)try{const u=await td(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:g=>{const y=g.getElementById("return-print-content");y&&(y.style.width="210mm")}}),d=u.toDataURL("image/png",1),h=new Lt("p","mm","a4"),f=h.internal.pageSize.getWidth(),A=h.internal.pageSize.getHeight(),b=u.width,m=u.height,v=f/b,p=m*v;if(p>A){let g=0,y=p;for(;y>0;)h.addImage(d,"PNG",0,g,f,p),y-=A,g-=A,y>0&&h.addPage()}else h.addImage(d,"PNG",0,0,f,p);h.save(`MaterialReturn-${e.return_number}.pdf`)}catch(u){console.error("Error generating PDF:",u),alert("Failed to generate PDF. Please try again.")}},c=e.customers;return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[a.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:a.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[a.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Material Return ",e.return_number]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:o,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(QA,{className:"h-4 w-4"}),"Print"]}),a.jsxs("button",{onClick:l,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[a.jsx(Ai,{className:"h-4 w-4"}),"PDF"]}),a.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:a.jsx(Kr,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{id:"return-print-content",ref:n,className:"p-8",children:[a.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[a.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:a.jsxs("g",{children:[a.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),a.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),a.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("h2",{className:"text-3xl font-bold text-orange-600 print:text-2xl",children:"MATERIAL RETURN"})})]}),a.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No izin PBF"}),a.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),a.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),a.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Customer:"}),a.jsxs("span",{className:"font-semibold",children:[" ",(c==null?void 0:c.company_name)||""]})]}),a.jsxs("div",{className:"pt-1 flex",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),a.jsxs("div",{children:[a.jsx("p",{children:(c==null?void 0:c.address)||""}),a.jsx("p",{children:(c==null?void 0:c.city)||""})]})]}),a.jsxs("div",{className:"flex pt-1",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),a.jsx("span",{children:(c==null?void 0:c.phone)||""})]})]}),a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"220px"},children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Return No:"}),a.jsx("span",{className:"ml-2",children:e.return_number})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Return Date:"}),a.jsx("span",{className:"ml-2",children:s(e.return_date)})]}),e.delivery_challans&&a.jsxs("div",{className:"pt-1",children:[a.jsx("span",{className:"font-bold",children:"Original DC:"}),a.jsx("span",{className:"ml-2",children:e.delivery_challans.challan_number})]}),a.jsxs("div",{className:"pt-1",children:[a.jsx("span",{className:"font-bold",children:"Return Type:"}),a.jsx("span",{className:"ml-2",children:e.return_type.replace("_"," ").toUpperCase()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Status:"}),a.jsx("span",{className:`ml-2 px-2 py-0.5 rounded text-xs font-semibold ${e.status==="approved"?"bg-green-100 text-green-800":e.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:e.status.replace("_"," ").toUpperCase()})]})]})]})}),a.jsx("div",{children:a.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),a.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Original Qty"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Return Qty"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Condition"}),a.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price"}),a.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Total"})]})}),a.jsxs("tbody",{children:[t.map((u,d)=>{var f,A;const h=u.quantity_returned*u.unit_price;return a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:d+1}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((f=u.products)==null?void 0:f.product_name)||"Unknown Product"}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((A=u.batches)==null?void 0:A.batch_number)||"N/A"}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:u.original_quantity.toLocaleString()}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:u.quantity_returned.toLocaleString()}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:u.condition.toUpperCase()}),a.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:i(u.unit_price)}),a.jsx("td",{className:"p-1.5 text-right print:p-1",children:i(h)})]},u.id||d)}),t.length<2&&Array.from({length:2-t.length}).map((u,d)=>a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${d}`))]})]})}),a.jsxs("div",{className:"border-2 border-black border-t-0",children:[a.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[a.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[a.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:"Return Reason:"}),a.jsx("p",{className:"text-xs mt-0.5 print:text-[10px] print:mt-0",children:e.return_reason})]}),a.jsx("div",{className:"w-64 text-xs p-2 print:text-[10px] print:p-1.5",children:a.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"Total Value"}),a.jsx("span",{className:"font-bold text-sm text-orange-600 print:text-xs",children:i(e.financial_impact||0)})]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-0 text-xs print:text-[10px]",children:[a.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[a.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Prepared By"}),a.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"Name & Signature"})]}),a.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[a.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Checked By"}),a.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"QC / Manager"})]}),a.jsxs("div",{className:"p-3 print:p-2 text-center",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Approved By"}),a.jsx("p",{className:"font-semibold mb-9 print:mb-7",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"Pharmacist"})]})]})]}),e.notes&&a.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:a.jsxs("p",{className:"text-xs print:text-[10px]",children:[a.jsx("span",{className:"font-bold",children:"Additional Notes: "}),a.jsx("span",{children:e.notes})]})})]})]})}),a.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #return-print-content,
          #return-print-content * {
            visibility: visible;
          }

          #return-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #return-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function ET(){const{user:e,profile:t}=jr(),{t:r}=kn(),[n,s]=W.useState([]),[i,o]=W.useState(!0),[l,c]=W.useState(!1),[u,d]=W.useState(!1),[h,f]=W.useState(null),[A,b]=W.useState([]),[m,v]=W.useState(!1),[p,g]=W.useState(null),[y,x]=W.useState([]),[w,N]=W.useState([]),[_,C]=W.useState([]),[j,E]=W.useState([]),[S,F]=W.useState({customer_id:"",original_dc_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""});W.useEffect(()=>{I(),O()},[]);const I=async()=>{try{const{data:R,error:le}=await ae.from("material_returns").select(`
          *,
          customers(company_name, address, city, phone),
          delivery_challans(challan_number)
        `).order("created_at",{ascending:!1});if(le)throw le;s(R||[])}catch(R){console.error("Error loading returns:",R)}finally{o(!1)}},O=async()=>{try{const{data:R,error:le}=await ae.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(le)throw le;x(R||[])}catch(R){console.error("Error loading customers:",R)}},M=async R=>{try{const{data:le,error:ee}=await ae.from("sales_invoices").select("linked_challan_ids").not("linked_challan_ids","is",null);if(ee)throw ee;const _e=new Set;(le||[]).forEach(Se=>{Se.linked_challan_ids&&Array.isArray(Se.linked_challan_ids)&&Se.linked_challan_ids.forEach(Ae=>_e.add(Ae))});const{data:se,error:te}=await ae.from("delivery_challans").select("id, challan_number, challan_date, customer_id").eq("customer_id",R).order("challan_date",{ascending:!1});if(te)throw te;const Ne=(se||[]).filter(Se=>!_e.has(Se.id));N(Ne)}catch(le){console.error("Error loading delivery challans:",le)}},P=async R=>{try{const{data:le,error:ee}=await ae.from("delivery_challan_items").select(`
          product_id,
          batch_id,
          quantity,
          products(product_name, product_code),
          batches(batch_number, import_price, duty_charges, freight_charges, other_charges, import_quantity)
        `).eq("challan_id",R);if(ee)throw ee;C(le||[]);const _e=(le||[]).map(se=>{const te=se.batches;let Ne=0;return te&&te.import_quantity>0&&(Ne=Math.round((te.import_price+te.duty_charges+te.freight_charges+te.other_charges)/te.import_quantity*1.25)),{product_id:se.product_id,batch_id:se.batch_id,quantity_returned:0,original_quantity:se.quantity,unit_price:Ne,condition:"good",disposition:"pending",notes:""}});E(_e)}catch(le){console.error("Error loading challan items:",le)}},X=R=>{F({...S,customer_id:R,original_dc_id:""}),C([]),E([]),R?M(R):N([])},J=R=>{F({...S,original_dc_id:R}),R?P(R):(C([]),E([]))},H=(R,le,ee)=>{const _e=[...j];_e[R]={..._e[R],[le]:ee},E(_e)},V=async R=>{if(R.preventDefault(),!S.customer_id||!S.original_dc_id||!S.return_reason){alert("Please complete all required fields");return}const le=j.filter(_e=>_e.quantity_returned>0);if(le.length===0){alert("Please enter at least one item with return quantity");return}if(le.some(_e=>_e.quantity_returned>_e.original_quantity)){alert("Return quantity cannot exceed original quantity");return}try{const _e=le.reduce((se,te)=>se+te.quantity_returned*te.unit_price,0);if(m&&p){const{error:se}=await ae.from("material_returns").update({customer_id:S.customer_id,original_dc_id:S.original_dc_id,return_date:S.return_date,return_type:S.return_type,return_reason:S.return_reason,notes:S.notes,financial_impact:_e}).eq("id",p).eq("status","pending_approval");if(se)throw se;const{error:te}=await ae.from("material_return_items").delete().eq("return_id",p);if(te)throw te;const Ne=le.map(Ae=>({return_id:p,product_id:Ae.product_id,batch_id:Ae.batch_id,quantity_returned:Ae.quantity_returned,original_quantity:Ae.original_quantity,unit_price:Ae.unit_price,condition:Ae.condition,disposition:Ae.disposition,notes:Ae.notes})),{error:Se}=await ae.from("material_return_items").insert(Ne);if(Se)throw Se;alert("Material return updated successfully.")}else{const{data:se,error:te}=await ae.from("material_returns").insert({customer_id:S.customer_id,original_dc_id:S.original_dc_id,return_date:S.return_date,return_type:S.return_type,return_reason:S.return_reason,notes:S.notes,financial_impact:_e,status:"pending_approval",created_by:e==null?void 0:e.id}).select().single();if(te)throw te;const Ne=le.map(Ae=>({return_id:se.id,product_id:Ae.product_id,batch_id:Ae.batch_id,quantity_returned:Ae.quantity_returned,original_quantity:Ae.original_quantity,unit_price:Ae.unit_price,condition:Ae.condition,disposition:Ae.disposition,notes:Ae.notes})),{error:Se}=await ae.from("material_return_items").insert(Ne);if(Se)throw Se;alert("Material return created successfully. Pending approval.")}c(!1),Q(),I()}catch(_e){console.error("Error saving return:",_e),alert(_e.message||"Failed to save material return")}},K=async R=>{try{const{data:le,error:ee}=await ae.from("material_return_items").select(`
          *,
          products(product_name, product_code),
          batches(batch_number)
        `).eq("return_id",R.id);if(ee)throw ee;f(R),b(le||[]),d(!0)}catch(le){console.error("Error loading return items:",le),alert("Failed to load return details")}},B=async R=>{try{const{data:le,error:ee}=await ae.from("material_return_items").select(`
          *,
          products(product_name, product_code),
          batches(batch_number, import_price, duty_charges, freight_charges, other_charges, import_quantity)
        `).eq("return_id",R.id);if(ee)throw ee;F({customer_id:R.customer_id,original_dc_id:R.original_dc_id,return_date:R.return_date,return_type:R.return_type,return_reason:R.return_reason,notes:R.notes||""}),await M(R.customer_id),await P(R.original_dc_id);const _e=(le||[]).map(se=>({product_id:se.product_id,batch_id:se.batch_id,quantity_returned:se.quantity_returned,original_quantity:se.original_quantity,unit_price:se.unit_price,condition:se.condition,disposition:se.disposition,notes:se.notes||""}));E(_e),v(!0),g(R.id),c(!0)}catch(le){console.error("Error loading return for edit:",le),alert("Failed to load return for editing")}},L=async R=>{if(confirm("Approve this material return? Stock will be added back to inventory based on disposition."))try{const{error:le}=await ae.from("material_returns").update({status:"approved",approved_by:e==null?void 0:e.id,restocked:!0}).eq("id",R);if(le)throw le;alert("Material return approved successfully"),I()}catch(le){console.error("Error approving return:",le),alert(le.message||"Failed to approve material return")}},U=async R=>{const le=prompt("Enter reason for rejection:");if(le)try{const{error:ee}=await ae.from("material_returns").update({status:"rejected",approved_by:e==null?void 0:e.id,notes:le}).eq("id",R);if(ee)throw ee;alert("Material return rejected"),I()}catch(ee){console.error("Error rejecting return:",ee),alert(ee.message||"Failed to reject material return")}},D=async R=>{if(confirm("Are you sure you want to delete this material return?"))try{const{error:le}=await ae.from("material_returns").delete().eq("id",R);if(le)throw le;I()}catch(le){console.error("Error deleting return:",le),alert("Failed to delete material return")}},Q=()=>{F({customer_id:"",original_dc_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""}),C([]),E([]),N([]),v(!1),g(null)},z=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales"||(t==null?void 0:t.role)==="manager",G=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="manager",Z=[{key:"return_number",label:"Return #",render:R=>R.return_number||"Pending"},{key:"return_date",label:"Date",render:R=>new Date(R.return_date).toLocaleDateString()},{key:"customer",label:"Customer",render:R=>{var le;return((le=R.customers)==null?void 0:le.company_name)||"N/A"}},{key:"dc_number",label:"Original DC",render:R=>{var le;return((le=R.delivery_challans)==null?void 0:le.challan_number)||"N/A"}},{key:"return_type",label:"Type",render:R=>R.return_type.replace("_"," ")},{key:"status",label:"Status",render:R=>a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${R.status==="approved"?"bg-green-100 text-green-800":R.status==="rejected"?"bg-red-100 text-red-800":R.status==="completed"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:R.status.replace("_"," ")})}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Material Returns"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage physical returns before invoicing"})]}),z&&a.jsxs("button",{onClick:()=>{Q(),c(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Create Material Return"]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex gap-3",children:[a.jsx(as,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium",children:"Material Returns vs Credit Notes:"}),a.jsx("p",{className:"mt-1",children:"Use Material Returns for physical goods returned BEFORE invoice is made (e.g., DC 100kg  return 20kg). For returns AFTER invoice filing, use Credit Notes."})]})]}),a.jsx(ws,{columns:Z,data:n,loading:i,actions:R=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>K(R),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Return",children:a.jsx(Kc,{className:"w-4 h-4"})}),z&&R.status==="pending_approval"&&a.jsx("button",{onClick:()=>B(R),className:"p-1 text-yellow-600 hover:bg-yellow-50 rounded",title:"Edit Return",children:a.jsx(Rs,{className:"w-4 h-4"})}),G&&R.status==="pending_approval"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>L(R.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Approve Return",children:a.jsx(yn,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>U(R.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject Return",children:a.jsx(un,{className:"w-4 h-4"})})]}),z&&R.status==="pending_approval"&&a.jsx("button",{onClick:()=>D(R.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Return",children:a.jsx(nn,{className:"w-4 h-4"})})]})}),a.jsx(qt,{isOpen:l,onClose:()=>{c(!1),Q()},title:m?"Edit Material Return":"Create Material Return",size:"xl",children:a.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(O4,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-blue-800",children:[a.jsx("p",{className:"font-medium",children:"How Material Returns Work:"}),a.jsxs("ol",{className:"mt-1 list-decimal list-inside space-y-1",children:[a.jsx("li",{children:"Select the customer who is returning goods"}),a.jsx("li",{children:"Choose the Delivery Challan that was originally dispatched"}),a.jsx("li",{children:"The system will show all products, batches, quantities, and prices from that DC"}),a.jsx("li",{children:"Enter the quantity being returned for each item"}),a.jsx("li",{children:"After approval, stock will be added back to inventory"})]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsxs("select",{value:S.customer_id,onChange:R=>X(R.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select Customer"}),y.map(R=>a.jsx("option",{value:R.id,children:R.company_name},R.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Original Delivery Challan *"}),a.jsxs("select",{value:S.original_dc_id,onChange:R=>J(R.target.value),required:!0,disabled:!S.customer_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-100",children:[a.jsx("option",{value:"",children:"Select Delivery Challan"}),w.map(R=>a.jsxs("option",{value:R.id,children:[R.challan_number," - ",new Date(R.challan_date).toLocaleDateString()]},R.id))]}),S.customer_id&&w.length===0&&a.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"No uninvoiced delivery challans found. All DCs are already invoiced - use Credit Notes for returns after invoicing."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Date *"}),a.jsx("input",{type:"date",value:S.return_date,onChange:R=>F({...S,return_date:R.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Type *"}),a.jsxs("select",{value:S.return_type,onChange:R=>F({...S,return_type:R.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[a.jsx("option",{value:"quality_issue",children:"Quality Issue"}),a.jsx("option",{value:"wrong_product",children:"Wrong Product"}),a.jsx("option",{value:"excess_quantity",children:"Excess Quantity"}),a.jsx("option",{value:"damaged",children:"Damaged"}),a.jsx("option",{value:"expired",children:"Expired"}),a.jsx("option",{value:"other",children:"Other"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Reason *"}),a.jsx("textarea",{value:S.return_reason,onChange:R=>F({...S,return_reason:R.target.value}),required:!0,rows:3,placeholder:"Explain why the goods are being returned...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),_.length>0&&a.jsxs("div",{className:"border-t pt-6",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Items from Delivery Challan"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the quantity being returned for each item. Leave as 0 if not returning that item."}),a.jsx("div",{className:"space-y-3",children:_.map((R,le)=>{const ee=j[le];return ee?a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[a.jsxs("div",{className:"col-span-3",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product"}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:R.products.product_name}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Code: ",R.products.product_code]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Batch"}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:R.batches.batch_number})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Dispatched Qty (Kg)"}),a.jsxs("div",{className:"text-sm font-medium text-blue-600",children:[R.quantity," Kg"]})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price (per Kg)"}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:ee.unit_price.toLocaleString()})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Return Qty (Kg) *"}),a.jsx("input",{type:"number",step:"0.01",value:ee.quantity_returned||"",onChange:_e=>H(le,"quantity_returned",parseFloat(_e.target.value)||0),max:R.quantity,min:"0",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500",placeholder:"Enter Kg"}),ee.quantity_returned>R.quantity&&a.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Cannot exceed ",R.quantity]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Condition"}),a.jsxs("select",{value:ee.condition,onChange:_e=>H(le,"condition",_e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"good",children:"Good"}),a.jsx("option",{value:"damaged",children:"Damaged"}),a.jsx("option",{value:"expired",children:"Expired"}),a.jsx("option",{value:"unusable",children:"Unusable"})]})]})]}),ee.quantity_returned>0&&a.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Disposition"}),a.jsxs("select",{value:ee.disposition,onChange:_e=>H(le,"disposition",_e.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"pending",children:"Pending Decision"}),a.jsx("option",{value:"restock",children:"Restock"}),a.jsx("option",{value:"scrap",children:"Scrap"}),a.jsx("option",{value:"return_to_supplier",children:"Return to Supplier"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Notes (optional)"}),a.jsx("input",{type:"text",value:ee.notes||"",onChange:_e=>H(le,"notes",_e.target.value),placeholder:"Any additional notes...",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"})]})]})]},le):null})})]}),_.length===0&&S.original_dc_id&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(O4,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),a.jsx("p",{children:"No items found in the selected delivery challan"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),a.jsx("textarea",{value:S.notes,onChange:R=>F({...S,notes:R.target.value}),rows:2,placeholder:"Any additional information...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{c(!1),Q()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:m?"Update Material Return":"Create Material Return"})]})]})}),u&&h&&a.jsx(XV,{materialReturn:h,items:A,onClose:()=>{d(!1),f(null),b([])}})]})}function YV({rejection:e,onClose:t}){const r=W.useRef(null),n=l=>{const c=new Date(l),u=c.getDate(),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][c.getMonth()],h=c.getFullYear();return`${u} ${d} ${h}`},s=l=>l==null?"Rp 0":`Rp ${l.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,i=()=>{window.print()},o=async()=>{if(r.current)try{const l=await td(r.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:r.current.scrollWidth,windowHeight:r.current.scrollHeight,onclone:v=>{const p=v.getElementById("rejection-print-content");p&&(p.style.width="210mm")}}),c=l.toDataURL("image/png",1),u=new Lt("p","mm","a4"),d=u.internal.pageSize.getWidth(),h=u.internal.pageSize.getHeight(),f=l.width,A=l.height,b=d/f,m=A*b;if(m>h){let v=0,p=m;for(;p>0;)u.addImage(c,"PNG",0,v,d,m),p-=h,v-=h,p>0&&u.addPage()}else u.addImage(c,"PNG",0,0,d,m);u.save(`StockRejection-${e.rejection_number}.pdf`)}catch(l){console.error("Error generating PDF:",l),alert("Failed to generate PDF. Please try again.")}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[a.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:a.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[a.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Stock Rejection ",e.rejection_number]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:i,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(QA,{className:"h-4 w-4"}),"Print"]}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[a.jsx(Ai,{className:"h-4 w-4"}),"PDF"]}),a.jsx("button",{onClick:t,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:a.jsx(Kr,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{id:"rejection-print-content",ref:r,className:"p-8",children:[a.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[a.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:a.jsxs("g",{children:[a.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),a.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),a.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("h2",{className:"text-3xl font-bold text-red-600 print:text-2xl",children:"STOCK REJECTION"})})]}),a.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No izin PBF"}),a.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),a.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),a.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Product:"}),a.jsxs("span",{className:"font-semibold",children:[" ",e.product.product_name]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Product Code:"}),a.jsx("span",{className:"ml-2",children:e.product.product_code})]}),a.jsxs("div",{className:"pt-1",children:[a.jsx("span",{className:"font-bold",children:"Batch Number:"}),a.jsx("span",{className:"ml-2",children:e.batch.batch_number})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Batch Stock:"}),a.jsxs("span",{className:"ml-2",children:[e.batch.current_stock.toLocaleString()," Kg"]})]})]}),a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"220px"},children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Rejection No:"}),a.jsx("span",{className:"ml-2",children:e.rejection_number})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Date:"}),a.jsx("span",{className:"ml-2",children:n(e.rejection_date)})]}),a.jsxs("div",{className:"pt-1",children:[a.jsx("span",{className:"font-bold",children:"Qty Rejected:"}),a.jsxs("span",{className:"ml-2 text-red-600 font-semibold",children:[e.quantity_rejected.toLocaleString()," Kg"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Status:"}),a.jsx("span",{className:`ml-2 px-2 py-0.5 rounded text-xs font-semibold ${e.status==="approved"?"bg-green-100 text-green-800":e.status==="rejected"?"bg-red-100 text-red-800":e.status==="disposed"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:e.status.replace("_"," ").toUpperCase()})]})]})]})}),a.jsx("div",{className:"mb-3 border-2 border-black print:mb-2",children:a.jsxs("table",{className:"w-full text-xs print:text-[10px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[a.jsx("th",{className:"border-r border-black p-2 text-left font-bold print:p-1",children:"Rejection Details"}),a.jsx("th",{className:"p-2 text-left font-bold print:p-1",children:"Financial Impact"})]})}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{className:"border-r border-black p-2 print:p-1 align-top",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Reason: "}),a.jsx("span",{className:"uppercase",children:e.rejection_reason.replace("_"," ")})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Details: "}),a.jsx("p",{className:"mt-1",children:e.rejection_details})]}),e.inspection_report&&a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Inspection Report: "}),a.jsx("p",{className:"mt-1",children:e.inspection_report})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Disposition: "}),a.jsx("span",{className:"uppercase",children:e.disposition.replace("_"," ")})]})]})}),a.jsx("td",{className:"p-2 print:p-1 align-top",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Unit Cost:"}),a.jsx("span",{className:"font-semibold",children:s(e.unit_cost)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Quantity:"}),a.jsxs("span",{className:"font-semibold",children:[e.quantity_rejected.toLocaleString()," Kg"]})]}),a.jsxs("div",{className:"flex justify-between pt-1 border-t-2 border-black",children:[a.jsx("span",{className:"font-bold",children:"Total Loss:"}),a.jsx("span",{className:"font-bold text-red-600",children:s(e.financial_loss)})]})]})})]})})]})}),e.photos&&e.photos.length>0&&a.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2 print:hidden",children:[a.jsx("h3",{className:"text-sm font-bold mb-2",children:"Rejection Photos"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:e.photos.map((l,c)=>a.jsxs("div",{className:"border border-gray-300 rounded overflow-hidden",children:[a.jsx("img",{src:l.url,alt:`Rejection photo ${c+1}`,className:"w-full h-32 object-cover"}),a.jsxs("div",{className:"text-xs p-1 bg-gray-50 text-center",children:["Photo ",c+1]})]},c))})]}),a.jsx("div",{className:"border-2 border-black",children:a.jsxs("div",{className:"grid grid-cols-3 gap-0 text-xs print:text-[10px]",children:[a.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[a.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Inspected By"}),a.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"QC Inspector"})]}),a.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[a.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Reviewed By"}),a.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"QC Manager"})]}),a.jsxs("div",{className:"p-3 print:p-2 text-center",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Approved By"}),a.jsx("p",{className:"font-semibold mb-9 print:mb-7",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"Management"})]})]})})]})]})}),a.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #rejection-print-content,
          #rejection-print-content * {
            visibility: visible;
          }

          #rejection-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #rejection-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function JV(){const{user:e,userProfile:t}=jr(),{t:r}=kn(),[n,s]=W.useState([]),[i,o]=W.useState([]),[l,c]=W.useState(""),[u,d]=W.useState("all"),[h,f]=W.useState(!1),[A,b]=W.useState(!1),[m,v]=W.useState(null),[p,g]=W.useState(!0),[y,x]=W.useState(!1),[w,N]=W.useState(null),[_,C]=W.useState([]),[j,E]=W.useState([]),[S,F]=W.useState([]),[I,O]=W.useState([]),[M,P]=W.useState({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",disposition:"pending",inspection_report:""});W.useEffect(()=>{X(),J()},[]),W.useEffect(()=>{V()},[l,u,n]);const X=async()=>{try{g(!0);const{data:R,error:le}=await ae.from("stock_rejections").select(`
          *,
          product:products(product_name, product_code),
          batch:batches(batch_number, current_stock)
        `).order("created_at",{ascending:!1});if(le)throw le;s(R||[])}catch(R){console.error("Error fetching rejections:",R),alert(r("errorFetchingRejections")||"Error fetching rejections")}finally{g(!1)}},J=async()=>{const{data:R}=await ae.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");C(R||[])},H=async R=>{const{data:le}=await ae.from("batches").select("id, batch_number, current_stock, import_price").eq("product_id",R).gt("current_stock",0).order("batch_number");E(le||[])},V=()=>{let R=n;u!=="all"&&(R=R.filter(le=>le.status===u)),l&&(R=R.filter(le=>le.rejection_number.toLowerCase().includes(l.toLowerCase())||le.product.product_name.toLowerCase().includes(l.toLowerCase())||le.batch.batch_number.toLowerCase().includes(l.toLowerCase())||le.rejection_details.toLowerCase().includes(l.toLowerCase()))),o(R)},K=R=>{P({...M,product_id:R,batch_id:""}),R&&H(R)},B=R=>{if(R.target.files){const le=Array.from(R.target.files);F([...S,...le]),le.forEach(ee=>{const _e=new FileReader;_e.onloadend=()=>{O(se=>[...se,_e.result])},_e.readAsDataURL(ee)})}},L=R=>{F(S.filter((le,ee)=>ee!==R)),O(I.filter((le,ee)=>ee!==R))},U=async R=>{try{if(P({product_id:R.product_id,batch_id:R.batch_id,rejection_date:R.rejection_date,quantity_rejected:R.quantity_rejected,rejection_reason:R.rejection_reason,rejection_details:R.rejection_details,disposition:R.disposition,inspection_report:R.inspection_report||""}),await H(R.product_id),R.photos&&Array.isArray(R.photos)){const le=R.photos.map(ee=>ee.url);O(le)}x(!0),N(R.id),f(!0)}catch(le){console.error("Error loading rejection for edit:",le),alert("Failed to load rejection for editing")}},D=async(R,le)=>{if(confirm("Are you sure you want to delete this stock rejection? This action cannot be undone."))try{if(le&&Array.isArray(le)&&le.length>0){for(const _e of le)if(_e.url){const se=_e.url.split("/").pop();se&&await ae.storage.from("rejection_photos").remove([`${R}/${se}`])}}const{error:ee}=await ae.from("stock_rejections").delete().eq("id",R).eq("status","pending_approval");if(ee)throw ee;alert("Stock rejection deleted successfully"),X()}catch(ee){console.error("Error deleting rejection:",ee),alert(ee.message||"Failed to delete stock rejection")}},Q=async R=>{const le=[];for(const ee of S){const _e=`${R}/${Date.now()}_${ee.name}`,{data:se,error:te}=await ae.storage.from("rejection_photos").upload(_e,ee);if(te){console.error("Error uploading photo:",te);continue}const{data:Ne}=ae.storage.from("rejection_photos").getPublicUrl(_e);le.push({url:Ne.publicUrl,filename:ee.name,uploaded_at:new Date().toISOString()})}return le},z=async R=>{if(R.preventDefault(),!M.product_id||!M.batch_id||!M.rejection_details){alert(r("pleaseCompleteAllFields")||"Please complete all required fields");return}try{const le=j.find(se=>se.id===M.batch_id);if(!le){alert(r("invalidBatch")||"Invalid batch selected");return}if(M.quantity_rejected>le.current_stock){alert(r("quantityExceedsStock")||`Rejection quantity cannot exceed available stock (${le.current_stock})`);return}const ee=le.import_price||0,_e=M.quantity_rejected*ee;if(y&&w){const{error:se}=await ae.from("stock_rejections").update({...M,unit_cost:ee,financial_loss:_e,inspected_by:e==null?void 0:e.id}).eq("id",w).eq("status","pending_approval");if(se)throw se;let te=[];if(S.length>0){te=await Q(w);const{data:Ne}=await ae.from("stock_rejections").select("photos").eq("id",w).single(),Ae=[...(Ne==null?void 0:Ne.photos)||[],...te];await ae.from("stock_rejections").update({photos:Ae}).eq("id",w)}alert("Stock rejection updated successfully")}else{const{data:se,error:te}=await ae.from("stock_rejections").insert({...M,unit_cost:ee,financial_loss:_e,created_by:e==null?void 0:e.id,inspected_by:e==null?void 0:e.id}).select().single();if(te)throw te;let Ne=[];if(S.length>0&&(Ne=await Q(se.id),await ae.from("stock_rejections").update({photos:Ne}).eq("id",se.id)),_e>=100){const Se=_e>=1e3?"admin":"manager";await ae.from("approval_workflows").insert({transaction_type:"stock_rejection",transaction_id:se.id,requested_by:e==null?void 0:e.id,amount:_e,quantity:M.quantity_rejected,status:"pending",metadata:{required_role:Se}})}alert(r("rejectionCreatedSuccessfully")||"Stock rejection created successfully")}f(!1),G(),X()}catch(le){console.error("Error saving rejection:",le),alert(le.message||r("errorCreatingRejection")||"Error saving stock rejection")}},G=()=>{P({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",disposition:"pending",inspection_report:""}),F([]),O([]),x(!1),N(null)},Z=R=>{const le={pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",disposed:"bg-gray-100 text-gray-800"},ee={pending_approval:a.jsx(Ra,{className:"w-3 h-3 mr-1"}),approved:a.jsx(yn,{className:"w-3 h-3 mr-1"}),rejected:a.jsx(un,{className:"w-3 h-3 mr-1"}),disposed:a.jsx(yn,{className:"w-3 h-3 mr-1"})};return a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${le[R]||"bg-gray-100 text-gray-800"}`,children:[ee[R],R.replace("_"," ").toUpperCase()]})};return p?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"text-lg",children:r("loading")||"Loading..."})}):a.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:r("stockRejections")||"Stock Rejections"}),a.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center justify-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[a.jsx(as,{className:"w-5 h-5 mr-2"}),r("newRejection")||"New Rejection"]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:r("searchRejections")||"Search rejections...",value:l,onChange:R=>c(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("select",{value:u,onChange:R=>d(R.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"all",children:r("allStatuses")||"All Statuses"}),a.jsx("option",{value:"pending_approval",children:r("pendingApproval")||"Pending Approval"}),a.jsx("option",{value:"approved",children:r("approved")||"Approved"}),a.jsx("option",{value:"rejected",children:r("rejected")||"Rejected"}),a.jsx("option",{value:"disposed",children:r("disposed")||"Disposed"})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("rejectionNumber")||"Rejection #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("date")||"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("product")||"Product"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("batch")||"Batch"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("quantity")||"Quantity"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("reason")||"Reason"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("loss")||"Loss"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("status")||"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("actions")||"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(R=>{var le;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:R.rejection_number}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(R.rejection_date).toLocaleDateString()}),a.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[a.jsx("div",{children:R.product.product_name}),a.jsx("div",{className:"text-xs text-gray-500",children:R.product.product_code})]}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:R.batch.batch_number}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:R.quantity_rejected}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:R.rejection_reason.replace("_"," ")}),a.jsxs("td",{className:"px-4 py-3 text-sm text-red-600 font-medium",children:["$",((le=R.financial_loss)==null?void 0:le.toFixed(2))||"0.00"]}),a.jsx("td",{className:"px-4 py-3 text-sm",children:Z(R.status)}),a.jsx("td",{className:"px-4 py-3 text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>{v(R),b(!0)},className:"text-blue-600 hover:text-blue-800 inline-flex items-center",children:[a.jsx(Kc,{className:"w-4 h-4 mr-1"}),r("view")||"View"]}),R.status==="pending_approval"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>U(R),className:"text-yellow-600 hover:text-yellow-800 inline-flex items-center",title:"Edit Rejection",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>D(R.id,R.photos),className:"text-red-600 hover:text-red-800 inline-flex items-center",title:"Delete Rejection",children:a.jsx(nn,{className:"w-4 h-4"})})]})]})})]},R.id)})})]}),i.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:r("noRejectionsFound")||"No rejections found"})]})]}),h&&a.jsx(qt,{isOpen:h,onClose:()=>{f(!1),G()},title:y?r("editStockRejection")||"Edit Stock Rejection":r("createStockRejection")||"Create Stock Rejection",children:a.jsxs("form",{onSubmit:z,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("product")||"Product"," *"]}),a.jsxs("select",{value:M.product_id,onChange:R=>K(R.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:r("selectProduct")||"Select Product"}),_.map(R=>a.jsxs("option",{value:R.id,children:[R.product_name," (",R.product_code,")"]},R.id))]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("batch")||"Batch"," *"]}),a.jsxs("select",{value:M.batch_id,onChange:R=>P({...M,batch_id:R.target.value}),required:!0,disabled:!M.product_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",children:[a.jsx("option",{value:"",children:r("selectBatch")||"Select Batch"}),j.map(R=>a.jsxs("option",{value:R.id,children:[R.batch_number," (Stock: ",R.current_stock,")"]},R.id))]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("rejectionDate")||"Rejection Date"," *"]}),a.jsx("input",{type:"date",value:M.rejection_date,onChange:R=>P({...M,rejection_date:R.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("quantityRejected")||"Quantity Rejected (Kg)"," *"]}),a.jsx("input",{type:"number",step:"0.01",value:M.quantity_rejected||"",onChange:R=>P({...M,quantity_rejected:parseFloat(R.target.value)}),required:!0,min:"0.01",placeholder:"Enter quantity in Kg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("rejectionReason")||"Rejection Reason"," *"]}),a.jsxs("select",{value:M.rejection_reason,onChange:R=>P({...M,rejection_reason:R.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"quality_failed",children:r("qualityFailed")||"Quality Failed"}),a.jsx("option",{value:"expired",children:r("expired")||"Expired"}),a.jsx("option",{value:"damaged",children:r("damaged")||"Damaged"}),a.jsx("option",{value:"contaminated",children:r("contaminated")||"Contaminated"}),a.jsx("option",{value:"other",children:r("other")||"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("disposition")||"Disposition"}),a.jsxs("select",{value:M.disposition,onChange:R=>P({...M,disposition:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"pending",children:r("pending")||"Pending"}),a.jsx("option",{value:"scrap",children:r("scrap")||"Scrap"}),a.jsx("option",{value:"return_to_supplier",children:r("returnToSupplier")||"Return to Supplier"}),a.jsx("option",{value:"rework",children:r("rework")||"Rework"})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("rejectionDetails")||"Rejection Details"," *"]}),a.jsx("textarea",{value:M.rejection_details,onChange:R=>P({...M,rejection_details:R.target.value}),required:!0,rows:3,placeholder:r("describeRejectionReason")||"Describe the reason for rejection in detail...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("inspectionReport")||"Inspection Report"," (Optional)"]}),a.jsx("textarea",{value:M.inspection_report,onChange:R=>P({...M,inspection_report:R.target.value}),rows:3,placeholder:r("enterInspectionReport")||"Enter inspection report details...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r("photos")||"Photos"," (",S.length,")"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center justify-center px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 transition-colors",children:[a.jsx(aR,{className:"w-5 h-5 mr-2 text-gray-400"}),a.jsx("span",{className:"text-sm text-gray-600",children:r("uploadPhotos")||"Upload Photos"}),a.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:B,className:"hidden"})]}),I.length>0&&a.jsx("div",{className:"grid grid-cols-3 gap-2",children:I.map((R,le)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:R,alt:`Photo ${le+1}`,className:"w-full h-24 object-cover rounded-lg"}),a.jsx("button",{type:"button",onClick:()=>L(le),className:"absolute top-1 right-1 bg-red-600 text-white rounded-full p-1 hover:bg-red-700",children:a.jsx(un,{className:"w-4 h-4"})})]},le))})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start",children:[a.jsx(as,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium",children:r("approvalRequired")||"Approval Required"}),a.jsx("p",{className:"mt-1",children:r("rejectionApprovalNote")||"Rejections under $100 require manager approval. Over $100 require manager approval. Over $1000 require admin approval."})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{f(!1),G()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:r("cancel")||"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:y?r("updateRejection")||"Update Rejection":r("createRejection")||"Create Rejection"})]})]})}),A&&m&&a.jsx(YV,{rejection:m,onClose:()=>{b(!1),v(null)}})]})}function ZV(){const{t:e}=kn(),{profile:t}=jr(),[r,n]=W.useState("transactions"),[s,i]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState([]),[d,h]=W.useState([]),[f,A]=W.useState([]),[b,m]=W.useState([]),[v,p]=W.useState(!0),[g,y]=W.useState(null),[x,w]=W.useState(!1),[N,_]=W.useState("transaction"),[C,j]=W.useState({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]}),[E,S]=W.useState({customer_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""}),[F,I]=W.useState({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",unit_cost:0});W.useEffect(()=>{O()},[r]);const O=async()=>{p(!0),y(null);try{await J(),await H(),await V(),r==="transactions"?await M():r==="returns"?await P():r==="rejections"&&await X()}catch{y("Failed to load inventory data. Please try again.")}p(!1)},M=async()=>{const{data:G,error:Z}=await ae.from("inventory_transactions").select(`
        *,
        products(product_name, product_code),
        batches(batch_number),
        user_profiles(full_name)
      `).order("transaction_date",{ascending:!1}).order("created_at",{ascending:!1});if(Z)throw Z;i(G||[])},P=async()=>{const{data:G,error:Z}=await ae.from("material_returns").select(`
        *,
        customer:customers(company_name)
      `).order("return_date",{ascending:!1});if(Z)throw Z;l(G||[])},X=async()=>{const{data:G,error:Z}=await ae.from("stock_rejections").select(`
        *,
        product:products(product_name, product_code),
        batch:batches(batch_number)
      `).order("rejection_date",{ascending:!1});if(Z)throw Z;u(G||[])},J=async()=>{const{data:G,error:Z}=await ae.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(Z)throw Z;h(G||[])},H=async()=>{const{data:G,error:Z}=await ae.from("batches").select("id, batch_number, product_id, current_stock").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!1});if(Z)throw Z;A(G||[])},V=async()=>{const{data:G,error:Z}=await ae.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(Z)throw Z;m(G||[])},K=async G=>{G.preventDefault();try{const{data:{user:Z}}=await ae.auth.getUser();if(!Z)throw new Error("Not authenticated");const{error:R}=await ae.from("inventory_transactions").insert([{...C,batch_id:C.batch_id||null,reference_number:C.reference_number||null,notes:C.notes||null,created_by:Z.id}]);if(R)throw R;if(C.batch_id){const le=f.find(ee=>ee.id===C.batch_id);if(le){let ee=le.current_stock;C.transaction_type==="purchase"||C.transaction_type==="adjustment"?ee+=C.quantity:C.transaction_type==="sale"&&(ee-=C.quantity);const{error:_e}=await ae.from("batches").update({current_stock:ee}).eq("id",C.batch_id);if(_e)throw _e}}w(!1),U(),O(),alert("Transaction added successfully")}catch(Z){console.error("Error saving transaction:",Z),alert("Failed to save transaction. Please try again.")}},B=async G=>{G.preventDefault();try{const{data:{user:Z}}=await ae.auth.getUser();if(!Z)throw new Error("Not authenticated");const{error:R}=await ae.from("material_returns").insert([{...E,created_by:Z.id}]);if(R)throw R;w(!1),U(),O(),alert("Material return created successfully. Awaiting approval.")}catch(Z){console.error("Error creating return:",Z),alert("Failed to create return. Please try again.")}},L=async G=>{G.preventDefault();try{const{data:{user:Z}}=await ae.auth.getUser();if(!Z)throw new Error("Not authenticated");const{error:R}=await ae.from("stock_rejections").insert([{...F,created_by:Z.id}]);if(R)throw R;w(!1),U(),O(),alert("Stock rejection created successfully. Awaiting approval.")}catch(Z){console.error("Error creating rejection:",Z),alert("Failed to create rejection. Please try again.")}},U=()=>{j({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]}),S({customer_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""}),I({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",unit_cost:0})},D=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse"||(t==null?void 0:t.role)==="manager",Q=[{key:"transaction_date",label:"Date",render:G=>new Date(G.transaction_date).toLocaleDateString()},{key:"transaction_type",label:"Type",render:G=>a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${G.transaction_type==="purchase"?"bg-green-100 text-green-800":G.transaction_type==="sale"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[G.transaction_type==="purchase"&&a.jsx(ui,{className:"w-3 h-3"}),G.transaction_type==="sale"&&a.jsx(FF,{className:"w-3 h-3"}),G.transaction_type==="adjustment"&&a.jsx(go,{className:"w-3 h-3"}),G.transaction_type.charAt(0).toUpperCase()+G.transaction_type.slice(1)]})},{key:"product",label:"Product",render:G=>{var Z,R;return a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:(Z=G.products)==null?void 0:Z.product_name}),a.jsx("div",{className:"text-xs text-gray-500",children:(R=G.products)==null?void 0:R.product_code})]})}},{key:"batch_number",label:"Batch",render:G=>{var Z;return((Z=G.batches)==null?void 0:Z.batch_number)||"N/A"}},{key:"quantity",label:"Quantity",render:G=>a.jsxs("span",{className:`font-semibold ${G.transaction_type==="purchase"?"text-green-600":G.transaction_type==="sale"?"text-red-600":"text-blue-600"}`,children:[G.transaction_type==="purchase"?"+":G.transaction_type==="sale"?"-":"",G.quantity]})},{key:"reference_number",label:"Reference",render:G=>G.reference_number||(G.transaction_type==="purchase"?"Batch Import":"-")}],z=f.filter(G=>r==="transactions"?G.product_id===C.product_id:r==="rejections"?G.product_id===F.product_id:!1);return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Inventory Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Track transactions, returns, and rejections"})]}),D&&r==="transactions"&&a.jsxs("button",{onClick:()=>{U(),_("transaction"),w(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Add Transaction"]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex gap-8",children:[a.jsxs("button",{onClick:()=>n("transactions"),className:`flex items-center gap-2 pb-4 border-b-2 transition ${r==="transactions"?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[a.jsx(Ps,{className:"w-5 h-5"}),"Transactions"]}),a.jsxs("button",{onClick:()=>n("returns"),className:`flex items-center gap-2 pb-4 border-b-2 transition ${r==="returns"?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[a.jsx(Jb,{className:"w-5 h-5"}),"Material Returns"]}),a.jsxs("button",{onClick:()=>n("rejections"),className:`flex items-center gap-2 pb-4 border-b-2 transition ${r==="rejections"?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[a.jsx(as,{className:"w-5 h-5"}),"Stock Rejections"]})]})}),g&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(as,{className:"w-5 h-5 text-red-500"}),a.jsx("p",{className:"text-red-700",children:g})]}),a.jsx("button",{onClick:O,className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm",children:"Retry"})]}),r==="transactions"&&a.jsx(ws,{columns:Q,data:s,loading:v}),r==="returns"&&a.jsx(ET,{}),r==="rejections"&&a.jsx(JV,{}),a.jsxs(qt,{isOpen:x,onClose:()=>{w(!1),U()},title:N==="transaction"?"Add Inventory Transaction":N==="return"?"Create Material Return":"Report Stock Rejection",children:[N==="transaction"&&a.jsxs("form",{onSubmit:K,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type *"}),a.jsxs("select",{value:C.transaction_type,onChange:G=>j({...C,transaction_type:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"purchase",children:"Purchase"}),a.jsx("option",{value:"sale",children:"Sale"}),a.jsx("option",{value:"adjustment",children:"Adjustment"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),a.jsxs("select",{value:C.product_id,onChange:G=>j({...C,product_id:G.target.value,batch_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Product"}),d.map(G=>a.jsxs("option",{value:G.id,children:[G.product_name," (",G.product_code,")"]},G.id))]})]}),C.product_id&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch (Optional)"}),a.jsxs("select",{value:C.batch_id,onChange:G=>j({...C,batch_id:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select Batch"}),z.map(G=>a.jsxs("option",{value:G.id,children:[G.batch_number," (Stock: ",G.current_stock,")"]},G.id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),a.jsx("input",{type:"number",value:C.quantity,onChange:G=>j({...C,quantity:Number(G.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Date *"}),a.jsx("input",{type:"date",value:C.transaction_date,onChange:G=>j({...C,transaction_date:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),a.jsx("input",{type:"text",value:C.reference_number,onChange:G=>j({...C,reference_number:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., SAPJ-001, PO-002"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:C.notes,onChange:G=>j({...C,notes:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{w(!1),U()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Transaction"})]})]}),N==="return"&&a.jsxs("form",{onSubmit:B,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsxs("select",{value:E.customer_id,onChange:G=>S({...E,customer_id:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Customer"}),b.map(G=>a.jsx("option",{value:G.id,children:G.company_name},G.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Type *"}),a.jsxs("select",{value:E.return_type,onChange:G=>S({...E,return_type:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"quality_issue",children:"Quality Issue"}),a.jsx("option",{value:"wrong_product",children:"Wrong Product"}),a.jsx("option",{value:"excess_quantity",children:"Excess Quantity"}),a.jsx("option",{value:"damaged",children:"Damaged"}),a.jsx("option",{value:"expired",children:"Expired"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Date *"}),a.jsx("input",{type:"date",value:E.return_date,onChange:G=>S({...E,return_date:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Reason *"}),a.jsx("textarea",{value:E.return_reason,onChange:G=>S({...E,return_reason:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),a.jsx("textarea",{value:E.notes,onChange:G=>S({...E,notes:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{w(!1),U()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Create Return"})]})]}),N==="rejection"&&a.jsxs("form",{onSubmit:L,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),a.jsxs("select",{value:F.product_id,onChange:G=>I({...F,product_id:G.target.value,batch_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Product"}),d.map(G=>a.jsxs("option",{value:G.id,children:[G.product_name," (",G.product_code,")"]},G.id))]})]}),F.product_id&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch *"}),a.jsxs("select",{value:F.batch_id,onChange:G=>I({...F,batch_id:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Batch"}),z.map(G=>a.jsxs("option",{value:G.id,children:[G.batch_number," (Stock: ",G.current_stock,")"]},G.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejection Reason *"}),a.jsxs("select",{value:F.rejection_reason,onChange:G=>I({...F,rejection_reason:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"quality_failed",children:"Quality Failed"}),a.jsx("option",{value:"expired",children:"Expired"}),a.jsx("option",{value:"damaged",children:"Damaged"}),a.jsx("option",{value:"contaminated",children:"Contaminated"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity Rejected *"}),a.jsx("input",{type:"number",value:F.quantity_rejected,onChange:G=>I({...F,quantity_rejected:Number(G.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Cost *"}),a.jsx("input",{type:"number",step:"0.01",value:F.unit_cost,onChange:G=>I({...F,unit_cost:Number(G.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejection Date *"}),a.jsx("input",{type:"date",value:F.rejection_date,onChange:G=>I({...F,rejection_date:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Detailed Description *"}),a.jsx("textarea",{value:F.rejection_details,onChange:G=>I({...F,rejection_details:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{w(!1),U()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Report Rejection"})]})]})]})]})})}function eG(){this.__data__=[],this.size=0}var tG=eG;function rG(e,t){return e===t||e!==e&&t!==t}var FT=rG,nG=FT;function aG(e,t){for(var r=e.length;r--;)if(nG(e[r][0],t))return r;return-1}var zx=aG,sG=zx,iG=Array.prototype,oG=iG.splice;function lG(e){var t=this.__data__,r=sG(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():oG.call(t,r,1),--this.size,!0}var cG=lG,uG=zx;function dG(e){var t=this.__data__,r=uG(t,e);return r<0?void 0:t[r][1]}var AG=dG,fG=zx;function hG(e){return fG(this.__data__,e)>-1}var pG=hG,mG=zx;function gG(e,t){var r=this.__data__,n=mG(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var xG=gG,yG=tG,vG=cG,bG=AG,wG=pG,_G=xG;function qA(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}qA.prototype.clear=yG;qA.prototype.delete=vG;qA.prototype.get=bG;qA.prototype.has=wG;qA.prototype.set=_G;var Xx=qA,NG=Xx;function jG(){this.__data__=new NG,this.size=0}var CG=jG;function BG(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var kG=BG;function SG(e){return this.__data__.get(e)}var EG=SG;function FG(e){return this.__data__.has(e)}var TG=FG,IG=typeof ii=="object"&&ii&&ii.Object===Object&&ii,TT=IG,LG=TT,OG=typeof self=="object"&&self&&self.Object===Object&&self,UG=LG||OG||Function("return this")(),Ol=UG,PG=Ol,DG=PG.Symbol,g_=DG,ZC=g_,IT=Object.prototype,RG=IT.hasOwnProperty,QG=IT.toString,Rf=ZC?ZC.toStringTag:void 0;function MG(e){var t=RG.call(e,Rf),r=e[Rf];try{e[Rf]=void 0;var n=!0}catch{}var s=QG.call(e);return n&&(t?e[Rf]=r:delete e[Rf]),s}var HG=MG,qG=Object.prototype,KG=qG.toString;function $G(e){return KG.call(e)}var VG=$G,eB=g_,GG=HG,WG=VG,zG="[object Null]",XG="[object Undefined]",tB=eB?eB.toStringTag:void 0;function YG(e){return e==null?e===void 0?XG:zG:tB&&tB in Object(e)?GG(e):WG(e)}var Yx=YG;function JG(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var LT=JG,ZG=Yx,eW=LT,tW="[object AsyncFunction]",rW="[object Function]",nW="[object GeneratorFunction]",aW="[object Proxy]";function sW(e){if(!eW(e))return!1;var t=ZG(e);return t==rW||t==nW||t==tW||t==aW}var OT=sW,iW=Ol,oW=iW["__core-js_shared__"],lW=oW,gv=lW,rB=function(){var e=/[^.]+$/.exec(gv&&gv.keys&&gv.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function cW(e){return!!rB&&rB in e}var uW=cW,dW=Function.prototype,AW=dW.toString;function fW(e){if(e!=null){try{return AW.call(e)}catch{}try{return e+""}catch{}}return""}var UT=fW,hW=OT,pW=uW,mW=LT,gW=UT,xW=/[\\^$.*+?()[\]{}|]/g,yW=/^\[object .+?Constructor\]$/,vW=Function.prototype,bW=Object.prototype,wW=vW.toString,_W=bW.hasOwnProperty,NW=RegExp("^"+wW.call(_W).replace(xW,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jW(e){if(!mW(e)||pW(e))return!1;var t=hW(e)?NW:yW;return t.test(gW(e))}var CW=jW;function BW(e,t){return e==null?void 0:e[t]}var kW=BW,SW=CW,EW=kW;function FW(e,t){var r=EW(e,t);return SW(r)?r:void 0}var KA=FW,TW=KA,IW=Ol,LW=TW(IW,"Map"),x_=LW,OW=KA,UW=OW(Object,"create"),Jx=UW,nB=Jx;function PW(){this.__data__=nB?nB(null):{},this.size=0}var DW=PW;function RW(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var QW=RW,MW=Jx,HW="__lodash_hash_undefined__",qW=Object.prototype,KW=qW.hasOwnProperty;function $W(e){var t=this.__data__;if(MW){var r=t[e];return r===HW?void 0:r}return KW.call(t,e)?t[e]:void 0}var VW=$W,GW=Jx,WW=Object.prototype,zW=WW.hasOwnProperty;function XW(e){var t=this.__data__;return GW?t[e]!==void 0:zW.call(t,e)}var YW=XW,JW=Jx,ZW="__lodash_hash_undefined__";function ez(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=JW&&t===void 0?ZW:t,this}var tz=ez,rz=DW,nz=QW,az=VW,sz=YW,iz=tz;function $A(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}$A.prototype.clear=rz;$A.prototype.delete=nz;$A.prototype.get=az;$A.prototype.has=sz;$A.prototype.set=iz;var oz=$A,aB=oz,lz=Xx,cz=x_;function uz(){this.size=0,this.__data__={hash:new aB,map:new(cz||lz),string:new aB}}var dz=uz;function Az(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var fz=Az,hz=fz;function pz(e,t){var r=e.__data__;return hz(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Zx=pz,mz=Zx;function gz(e){var t=mz(this,e).delete(e);return this.size-=t?1:0,t}var xz=gz,yz=Zx;function vz(e){return yz(this,e).get(e)}var bz=vz,wz=Zx;function _z(e){return wz(this,e).has(e)}var Nz=_z,jz=Zx;function Cz(e,t){var r=jz(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Bz=Cz,kz=dz,Sz=xz,Ez=bz,Fz=Nz,Tz=Bz;function VA(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}VA.prototype.clear=kz;VA.prototype.delete=Sz;VA.prototype.get=Ez;VA.prototype.has=Fz;VA.prototype.set=Tz;var PT=VA,Iz=Xx,Lz=x_,Oz=PT,Uz=200;function Pz(e,t){var r=this.__data__;if(r instanceof Iz){var n=r.__data__;if(!Lz||n.length<Uz-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Oz(n)}return r.set(e,t),this.size=r.size,this}var Dz=Pz,Rz=Xx,Qz=CG,Mz=kG,Hz=EG,qz=TG,Kz=Dz;function GA(e){var t=this.__data__=new Rz(e);this.size=t.size}GA.prototype.clear=Qz;GA.prototype.delete=Mz;GA.prototype.get=Hz;GA.prototype.has=qz;GA.prototype.set=Kz;var $z=GA,Vz="__lodash_hash_undefined__";function Gz(e){return this.__data__.set(e,Vz),this}var Wz=Gz;function zz(e){return this.__data__.has(e)}var Xz=zz,Yz=PT,Jz=Wz,Zz=Xz;function Zg(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Yz;++t<r;)this.add(e[t])}Zg.prototype.add=Zg.prototype.push=Jz;Zg.prototype.has=Zz;var eX=Zg;function tX(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var rX=tX;function nX(e,t){return e.has(t)}var aX=nX,sX=eX,iX=rX,oX=aX,lX=1,cX=2;function uX(e,t,r,n,s,i){var o=r&lX,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var h=-1,f=!0,A=r&cX?new sX:void 0;for(i.set(e,t),i.set(t,e);++h<l;){var b=e[h],m=t[h];if(n)var v=o?n(m,b,h,t,e,i):n(b,m,h,e,t,i);if(v!==void 0){if(v)continue;f=!1;break}if(A){if(!iX(t,function(p,g){if(!oX(A,g)&&(b===p||s(b,p,r,n,i)))return A.push(g)})){f=!1;break}}else if(!(b===m||s(b,m,r,n,i))){f=!1;break}}return i.delete(e),i.delete(t),f}var DT=uX,dX=Ol,AX=dX.Uint8Array,fX=AX;function hX(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}var pX=hX;function mX(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var gX=mX,sB=g_,iB=fX,xX=FT,yX=DT,vX=pX,bX=gX,wX=1,_X=2,NX="[object Boolean]",jX="[object Date]",CX="[object Error]",BX="[object Map]",kX="[object Number]",SX="[object RegExp]",EX="[object Set]",FX="[object String]",TX="[object Symbol]",IX="[object ArrayBuffer]",LX="[object DataView]",oB=sB?sB.prototype:void 0,xv=oB?oB.valueOf:void 0;function OX(e,t,r,n,s,i,o){switch(r){case LX:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case IX:return!(e.byteLength!=t.byteLength||!i(new iB(e),new iB(t)));case NX:case jX:case kX:return xX(+e,+t);case CX:return e.name==t.name&&e.message==t.message;case SX:case FX:return e==t+"";case BX:var l=vX;case EX:var c=n&wX;if(l||(l=bX),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;n|=_X,o.set(e,t);var d=yX(l(e),l(t),n,s,i,o);return o.delete(e),d;case TX:if(xv)return xv.call(e)==xv.call(t)}return!1}var UX=OX;function PX(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var DX=PX,RX=Array.isArray,y_=RX,QX=DX,MX=y_;function HX(e,t,r){var n=t(e);return MX(e)?n:QX(n,r(e))}var qX=HX;function KX(e,t){for(var r=-1,n=e==null?0:e.length,s=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}var $X=KX;function VX(){return[]}var GX=VX,WX=$X,zX=GX,XX=Object.prototype,YX=XX.propertyIsEnumerable,lB=Object.getOwnPropertySymbols,JX=lB?function(e){return e==null?[]:(e=Object(e),WX(lB(e),function(t){return YX.call(e,t)}))}:zX,ZX=JX;function eY(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var tY=eY;function rY(e){return e!=null&&typeof e=="object"}var e1=rY,nY=Yx,aY=e1,sY="[object Arguments]";function iY(e){return aY(e)&&nY(e)==sY}var oY=iY,cB=oY,lY=e1,RT=Object.prototype,cY=RT.hasOwnProperty,uY=RT.propertyIsEnumerable,dY=cB(function(){return arguments}())?cB:function(e){return lY(e)&&cY.call(e,"callee")&&!uY.call(e,"callee")},AY=dY,ex={exports:{}};function fY(){return!1}var hY=fY;ex.exports;(function(e,t){var r=Ol,n=hY,s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===s,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u})(ex,ex.exports);var QT=ex.exports,pY=9007199254740991,mY=/^(?:0|[1-9]\d*)$/;function gY(e,t){var r=typeof e;return t=t??pY,!!t&&(r=="number"||r!="symbol"&&mY.test(e))&&e>-1&&e%1==0&&e<t}var xY=gY,yY=9007199254740991;function vY(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=yY}var MT=vY,bY=Yx,wY=MT,_Y=e1,NY="[object Arguments]",jY="[object Array]",CY="[object Boolean]",BY="[object Date]",kY="[object Error]",SY="[object Function]",EY="[object Map]",FY="[object Number]",TY="[object Object]",IY="[object RegExp]",LY="[object Set]",OY="[object String]",UY="[object WeakMap]",PY="[object ArrayBuffer]",DY="[object DataView]",RY="[object Float32Array]",QY="[object Float64Array]",MY="[object Int8Array]",HY="[object Int16Array]",qY="[object Int32Array]",KY="[object Uint8Array]",$Y="[object Uint8ClampedArray]",VY="[object Uint16Array]",GY="[object Uint32Array]",Zr={};Zr[RY]=Zr[QY]=Zr[MY]=Zr[HY]=Zr[qY]=Zr[KY]=Zr[$Y]=Zr[VY]=Zr[GY]=!0;Zr[NY]=Zr[jY]=Zr[PY]=Zr[CY]=Zr[DY]=Zr[BY]=Zr[kY]=Zr[SY]=Zr[EY]=Zr[FY]=Zr[TY]=Zr[IY]=Zr[LY]=Zr[OY]=Zr[UY]=!1;function WY(e){return _Y(e)&&wY(e.length)&&!!Zr[bY(e)]}var zY=WY;function XY(e){return function(t){return e(t)}}var YY=XY,tx={exports:{}};tx.exports;(function(e,t){var r=TT,n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===n,o=i&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(tx,tx.exports);var JY=tx.exports,ZY=zY,eJ=YY,uB=JY,dB=uB&&uB.isTypedArray,tJ=dB?eJ(dB):ZY,HT=tJ,rJ=tY,nJ=AY,aJ=y_,sJ=QT,iJ=xY,oJ=HT,lJ=Object.prototype,cJ=lJ.hasOwnProperty;function uJ(e,t){var r=aJ(e),n=!r&&nJ(e),s=!r&&!n&&sJ(e),i=!r&&!n&&!s&&oJ(e),o=r||n||s||i,l=o?rJ(e.length,String):[],c=l.length;for(var u in e)(t||cJ.call(e,u))&&!(o&&(u=="length"||s&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||iJ(u,c)))&&l.push(u);return l}var dJ=uJ,AJ=Object.prototype;function fJ(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||AJ;return e===r}var hJ=fJ;function pJ(e,t){return function(r){return e(t(r))}}var mJ=pJ,gJ=mJ,xJ=gJ(Object.keys,Object),yJ=xJ,vJ=hJ,bJ=yJ,wJ=Object.prototype,_J=wJ.hasOwnProperty;function NJ(e){if(!vJ(e))return bJ(e);var t=[];for(var r in Object(e))_J.call(e,r)&&r!="constructor"&&t.push(r);return t}var jJ=NJ,CJ=OT,BJ=MT;function kJ(e){return e!=null&&BJ(e.length)&&!CJ(e)}var SJ=kJ,EJ=dJ,FJ=jJ,TJ=SJ;function IJ(e){return TJ(e)?EJ(e):FJ(e)}var LJ=IJ,OJ=qX,UJ=ZX,PJ=LJ;function DJ(e){return OJ(e,PJ,UJ)}var RJ=DJ,AB=RJ,QJ=1,MJ=Object.prototype,HJ=MJ.hasOwnProperty;function qJ(e,t,r,n,s,i){var o=r&QJ,l=AB(e),c=l.length,u=AB(t),d=u.length;if(c!=d&&!o)return!1;for(var h=c;h--;){var f=l[h];if(!(o?f in t:HJ.call(t,f)))return!1}var A=i.get(e),b=i.get(t);if(A&&b)return A==t&&b==e;var m=!0;i.set(e,t),i.set(t,e);for(var v=o;++h<c;){f=l[h];var p=e[f],g=t[f];if(n)var y=o?n(g,p,f,t,e,i):n(p,g,f,e,t,i);if(!(y===void 0?p===g||s(p,g,r,n,i):y)){m=!1;break}v||(v=f=="constructor")}if(m&&!v){var x=e.constructor,w=t.constructor;x!=w&&"constructor"in e&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof w=="function"&&w instanceof w)&&(m=!1)}return i.delete(e),i.delete(t),m}var KJ=qJ,$J=KA,VJ=Ol,GJ=$J(VJ,"DataView"),WJ=GJ,zJ=KA,XJ=Ol,YJ=zJ(XJ,"Promise"),JJ=YJ,ZJ=KA,eZ=Ol,tZ=ZJ(eZ,"Set"),rZ=tZ,nZ=KA,aZ=Ol,sZ=nZ(aZ,"WeakMap"),iZ=sZ,Ow=WJ,Uw=x_,Pw=JJ,Dw=rZ,Rw=iZ,qT=Yx,WA=UT,fB="[object Map]",oZ="[object Object]",hB="[object Promise]",pB="[object Set]",mB="[object WeakMap]",gB="[object DataView]",lZ=WA(Ow),cZ=WA(Uw),uZ=WA(Pw),dZ=WA(Dw),AZ=WA(Rw),pu=qT;(Ow&&pu(new Ow(new ArrayBuffer(1)))!=gB||Uw&&pu(new Uw)!=fB||Pw&&pu(Pw.resolve())!=hB||Dw&&pu(new Dw)!=pB||Rw&&pu(new Rw)!=mB)&&(pu=function(e){var t=qT(e),r=t==oZ?e.constructor:void 0,n=r?WA(r):"";if(n)switch(n){case lZ:return gB;case cZ:return fB;case uZ:return hB;case dZ:return pB;case AZ:return mB}return t});var fZ=pu,yv=$z,hZ=DT,pZ=UX,mZ=KJ,xB=fZ,yB=y_,vB=QT,gZ=HT,xZ=1,bB="[object Arguments]",wB="[object Array]",wm="[object Object]",yZ=Object.prototype,_B=yZ.hasOwnProperty;function vZ(e,t,r,n,s,i){var o=yB(e),l=yB(t),c=o?wB:xB(e),u=l?wB:xB(t);c=c==bB?wm:c,u=u==bB?wm:u;var d=c==wm,h=u==wm,f=c==u;if(f&&vB(e)){if(!vB(t))return!1;o=!0,d=!1}if(f&&!d)return i||(i=new yv),o||gZ(e)?hZ(e,t,r,n,s,i):pZ(e,t,c,r,n,s,i);if(!(r&xZ)){var A=d&&_B.call(e,"__wrapped__"),b=h&&_B.call(t,"__wrapped__");if(A||b){var m=A?e.value():e,v=b?t.value():t;return i||(i=new yv),s(m,v,r,n,i)}}return f?(i||(i=new yv),mZ(e,t,r,n,s,i)):!1}var bZ=vZ,wZ=bZ,NB=e1;function KT(e,t,r,n,s){return e===t?!0:e==null||t==null||!NB(e)&&!NB(t)?e!==e&&t!==t:wZ(e,t,r,n,KT,s)}var _Z=KT,NZ=_Z;function jZ(e,t){return NZ(e,t)}var CZ=jZ,$T={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(e,t){(function(n,s){e.exports=s()})(typeof self<"u"?self:ii,function(){return function(r){var n={};function s(i){if(n[i])return n[i].exports;var o=n[i]={i,l:!1,exports:{}};return r[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=r,s.c=n,s.d=function(i,o,l){s.o(i,o)||Object.defineProperty(i,o,{configurable:!1,enumerable:!0,get:l})},s.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(o,"a",o),o},s.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},s.p="",s(s.s=109)}([function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(17),o=s(18),l=s(19),c=s(45),u=s(46),d=s(47),h=s(48),f=s(49),A=s(12),b=s(32),m=s(33),v=s(31),p=s(1),g={Scope:p.Scope,create:p.create,find:p.find,query:p.query,register:p.register,Container:i.default,Format:o.default,Leaf:l.default,Embed:h.default,Scroll:c.default,Block:d.default,Inline:u.default,Text:f.default,Attributor:{Attribute:A.default,Class:b.default,Style:m.default,Store:v.default}};n.default=g},function(r,n,s){var i=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var y in g)g.hasOwnProperty(y)&&(p[y]=g[y])};return function(p,g){v(p,g);function y(){this.constructor=p}p.prototype=g===null?Object.create(g):(y.prototype=g.prototype,new y)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(v){i(p,v);function p(g){var y=this;return g="[Parchment] "+g,y=v.call(this,g)||this,y.message=g,y.name=y.constructor.name,y}return p}(Error);n.ParchmentError=o;var l={},c={},u={},d={};n.DATA_KEY="__blot";var h;(function(v){v[v.TYPE=3]="TYPE",v[v.LEVEL=12]="LEVEL",v[v.ATTRIBUTE=13]="ATTRIBUTE",v[v.BLOT=14]="BLOT",v[v.INLINE=7]="INLINE",v[v.BLOCK=11]="BLOCK",v[v.BLOCK_BLOT=10]="BLOCK_BLOT",v[v.INLINE_BLOT=6]="INLINE_BLOT",v[v.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",v[v.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",v[v.ANY=15]="ANY"})(h=n.Scope||(n.Scope={}));function f(v,p){var g=b(v);if(g==null)throw new o("Unable to create "+v+" blot");var y=g,x=v instanceof Node||v.nodeType===Node.TEXT_NODE?v:y.create(p);return new y(x,p)}n.create=f;function A(v,p){return p===void 0&&(p=!1),v==null?null:v[n.DATA_KEY]!=null?v[n.DATA_KEY].blot:p?A(v.parentNode,p):null}n.find=A;function b(v,p){p===void 0&&(p=h.ANY);var g;if(typeof v=="string")g=d[v]||l[v];else if(v instanceof Text||v.nodeType===Node.TEXT_NODE)g=d.text;else if(typeof v=="number")v&h.LEVEL&h.BLOCK?g=d.block:v&h.LEVEL&h.INLINE&&(g=d.inline);else if(v instanceof HTMLElement){var y=(v.getAttribute("class")||"").split(/\s+/);for(var x in y)if(g=c[y[x]],g)break;g=g||u[v.tagName]}return g==null?null:p&h.LEVEL&g.scope&&p&h.TYPE&g.scope?g:null}n.query=b;function m(){for(var v=[],p=0;p<arguments.length;p++)v[p]=arguments[p];if(v.length>1)return v.map(function(x){return m(x)});var g=v[0];if(typeof g.blotName!="string"&&typeof g.attrName!="string")throw new o("Invalid definition");if(g.blotName==="abstract")throw new o("Cannot register abstract class");if(d[g.blotName||g.attrName]=g,typeof g.keyName=="string")l[g.keyName]=g;else if(g.className!=null&&(c[g.className]=g),g.tagName!=null){Array.isArray(g.tagName)?g.tagName=g.tagName.map(function(x){return x.toUpperCase()}):g.tagName=g.tagName.toUpperCase();var y=Array.isArray(g.tagName)?g.tagName:[g.tagName];y.forEach(function(x){(u[x]==null||g.className==null)&&(u[x]=g)})}return g}n.register=m},function(r,n,s){var i=s(51),o=s(11),l=s(3),c=s(20),u="\0",d=function(h){Array.isArray(h)?this.ops=h:h!=null&&Array.isArray(h.ops)?this.ops=h.ops:this.ops=[]};d.prototype.insert=function(h,f){var A={};return h.length===0?this:(A.insert=h,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(A.attributes=f),this.push(A))},d.prototype.delete=function(h){return h<=0?this:this.push({delete:h})},d.prototype.retain=function(h,f){if(h<=0)return this;var A={retain:h};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(A.attributes=f),this.push(A)},d.prototype.push=function(h){var f=this.ops.length,A=this.ops[f-1];if(h=l(!0,{},h),typeof A=="object"){if(typeof h.delete=="number"&&typeof A.delete=="number")return this.ops[f-1]={delete:A.delete+h.delete},this;if(typeof A.delete=="number"&&h.insert!=null&&(f-=1,A=this.ops[f-1],typeof A!="object"))return this.ops.unshift(h),this;if(o(h.attributes,A.attributes)){if(typeof h.insert=="string"&&typeof A.insert=="string")return this.ops[f-1]={insert:A.insert+h.insert},typeof h.attributes=="object"&&(this.ops[f-1].attributes=h.attributes),this;if(typeof h.retain=="number"&&typeof A.retain=="number")return this.ops[f-1]={retain:A.retain+h.retain},typeof h.attributes=="object"&&(this.ops[f-1].attributes=h.attributes),this}}return f===this.ops.length?this.ops.push(h):this.ops.splice(f,0,h),this},d.prototype.chop=function(){var h=this.ops[this.ops.length-1];return h&&h.retain&&!h.attributes&&this.ops.pop(),this},d.prototype.filter=function(h){return this.ops.filter(h)},d.prototype.forEach=function(h){this.ops.forEach(h)},d.prototype.map=function(h){return this.ops.map(h)},d.prototype.partition=function(h){var f=[],A=[];return this.forEach(function(b){var m=h(b)?f:A;m.push(b)}),[f,A]},d.prototype.reduce=function(h,f){return this.ops.reduce(h,f)},d.prototype.changeLength=function(){return this.reduce(function(h,f){return f.insert?h+c.length(f):f.delete?h-f.delete:h},0)},d.prototype.length=function(){return this.reduce(function(h,f){return h+c.length(f)},0)},d.prototype.slice=function(h,f){h=h||0,typeof f!="number"&&(f=1/0);for(var A=[],b=c.iterator(this.ops),m=0;m<f&&b.hasNext();){var v;m<h?v=b.next(h-m):(v=b.next(f-m),A.push(v)),m+=c.length(v)}return new d(A)},d.prototype.compose=function(h){var f=c.iterator(this.ops),A=c.iterator(h.ops),b=[],m=A.peek();if(m!=null&&typeof m.retain=="number"&&m.attributes==null){for(var v=m.retain;f.peekType()==="insert"&&f.peekLength()<=v;)v-=f.peekLength(),b.push(f.next());m.retain-v>0&&A.next(m.retain-v)}for(var p=new d(b);f.hasNext()||A.hasNext();)if(A.peekType()==="insert")p.push(A.next());else if(f.peekType()==="delete")p.push(f.next());else{var g=Math.min(f.peekLength(),A.peekLength()),y=f.next(g),x=A.next(g);if(typeof x.retain=="number"){var w={};typeof y.retain=="number"?w.retain=g:w.insert=y.insert;var N=c.attributes.compose(y.attributes,x.attributes,typeof y.retain=="number");if(N&&(w.attributes=N),p.push(w),!A.hasNext()&&o(p.ops[p.ops.length-1],w)){var _=new d(f.rest());return p.concat(_).chop()}}else typeof x.delete=="number"&&typeof y.retain=="number"&&p.push(x)}return p.chop()},d.prototype.concat=function(h){var f=new d(this.ops.slice());return h.ops.length>0&&(f.push(h.ops[0]),f.ops=f.ops.concat(h.ops.slice(1))),f},d.prototype.diff=function(h,f){if(this.ops===h.ops)return new d;var A=[this,h].map(function(g){return g.map(function(y){if(y.insert!=null)return typeof y.insert=="string"?y.insert:u;var x=g===h?"on":"with";throw new Error("diff() called "+x+" non-document")}).join("")}),b=new d,m=i(A[0],A[1],f),v=c.iterator(this.ops),p=c.iterator(h.ops);return m.forEach(function(g){for(var y=g[1].length;y>0;){var x=0;switch(g[0]){case i.INSERT:x=Math.min(p.peekLength(),y),b.push(p.next(x));break;case i.DELETE:x=Math.min(y,v.peekLength()),v.next(x),b.delete(x);break;case i.EQUAL:x=Math.min(v.peekLength(),p.peekLength(),y);var w=v.next(x),N=p.next(x);o(w.insert,N.insert)?b.retain(x,c.attributes.diff(w.attributes,N.attributes)):b.push(N).delete(x);break}y-=x}}),b.chop()},d.prototype.eachLine=function(h,f){f=f||`
`;for(var A=c.iterator(this.ops),b=new d,m=0;A.hasNext();){if(A.peekType()!=="insert")return;var v=A.peek(),p=c.length(v)-A.peekLength(),g=typeof v.insert=="string"?v.insert.indexOf(f,p)-p:-1;if(g<0)b.push(A.next());else if(g>0)b.push(A.next(g));else{if(h(b,A.next(1).attributes||{},m)===!1)return;m+=1,b=new d}}b.length()>0&&h(b,{},m)},d.prototype.transform=function(h,f){if(f=!!f,typeof h=="number")return this.transformPosition(h,f);for(var A=c.iterator(this.ops),b=c.iterator(h.ops),m=new d;A.hasNext()||b.hasNext();)if(A.peekType()==="insert"&&(f||b.peekType()!=="insert"))m.retain(c.length(A.next()));else if(b.peekType()==="insert")m.push(b.next());else{var v=Math.min(A.peekLength(),b.peekLength()),p=A.next(v),g=b.next(v);if(p.delete)continue;g.delete?m.push(g):m.retain(v,c.attributes.transform(p.attributes,g.attributes,f))}return m.chop()},d.prototype.transformPosition=function(h,f){f=!!f;for(var A=c.iterator(this.ops),b=0;A.hasNext()&&b<=h;){var m=A.peekLength(),v=A.peekType();if(A.next(),v==="delete"){h-=Math.min(m,h-b);continue}else v==="insert"&&(b<h||!f)&&(h+=m);b+=m}return h},r.exports=d},function(r,n){var s=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,c=function(A){return typeof Array.isArray=="function"?Array.isArray(A):i.call(A)==="[object Array]"},u=function(A){if(!A||i.call(A)!=="[object Object]")return!1;var b=s.call(A,"constructor"),m=A.constructor&&A.constructor.prototype&&s.call(A.constructor.prototype,"isPrototypeOf");if(A.constructor&&!b&&!m)return!1;var v;for(v in A);return typeof v>"u"||s.call(A,v)},d=function(A,b){o&&b.name==="__proto__"?o(A,b.name,{enumerable:!0,configurable:!0,value:b.newValue,writable:!0}):A[b.name]=b.newValue},h=function(A,b){if(b==="__proto__")if(s.call(A,b)){if(l)return l(A,b).value}else return;return A[b]};r.exports=function f(){var A,b,m,v,p,g,y=arguments[0],x=1,w=arguments.length,N=!1;for(typeof y=="boolean"&&(N=y,y=arguments[1]||{},x=2),(y==null||typeof y!="object"&&typeof y!="function")&&(y={});x<w;++x)if(A=arguments[x],A!=null)for(b in A)m=h(y,b),v=h(A,b),y!==v&&(N&&v&&(u(v)||(p=c(v)))?(p?(p=!1,g=m&&c(m)?m:[]):g=m&&u(m)?m:{},d(y,{name:b,newValue:f(N,g,v)})):typeof v<"u"&&d(y,{name:b,newValue:v}));return y}},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var i=function(){function S(F,I){for(var O=0;O<I.length;O++){var M=I[O];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(F,M.key,M)}}return function(F,I,O){return I&&S(F.prototype,I),O&&S(F,O),F}}(),o=function S(F,I,O){F===null&&(F=Function.prototype);var M=Object.getOwnPropertyDescriptor(F,I);if(M===void 0){var P=Object.getPrototypeOf(F);return P===null?void 0:S(P,I,O)}else{if("value"in M)return M.value;var X=M.get;return X===void 0?void 0:X.call(O)}},l=s(3),c=y(l),u=s(2),d=y(u),h=s(0),f=y(h),A=s(16),b=y(A),m=s(6),v=y(m),p=s(7),g=y(p);function y(S){return S&&S.__esModule?S:{default:S}}function x(S,F){if(!(S instanceof F))throw new TypeError("Cannot call a class as a function")}function w(S,F){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:S}function N(S,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);S.prototype=Object.create(F&&F.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(S,F):S.__proto__=F)}var _=1,C=function(S){N(F,S);function F(){return x(this,F),w(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return i(F,[{key:"attach",value:function(){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"attach",this).call(this),this.attributes=new f.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new d.default().insert(this.value(),(0,c.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(O,M){var P=f.default.query(O,f.default.Scope.BLOCK_ATTRIBUTE);P!=null&&this.attributes.attribute(P,M)}},{key:"formatAt",value:function(O,M,P,X){this.format(P,X)}},{key:"insertAt",value:function(O,M,P){if(typeof M=="string"&&M.endsWith(`
`)){var X=f.default.create(j.blotName);this.parent.insertBefore(X,O===0?this:this.next),X.insertAt(0,M.slice(0,-1))}else o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,O,M,P)}}]),F}(f.default.Embed);C.scope=f.default.Scope.BLOCK_BLOT;var j=function(S){N(F,S);function F(I){x(this,F);var O=w(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,I));return O.cache={},O}return i(F,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(f.default.Leaf).reduce(function(O,M){return M.length()===0?O:O.insert(M.value(),E(M))},new d.default).insert(`
`,E(this))),this.cache.delta}},{key:"deleteAt",value:function(O,M){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"deleteAt",this).call(this,O,M),this.cache={}}},{key:"formatAt",value:function(O,M,P,X){M<=0||(f.default.query(P,f.default.Scope.BLOCK)?O+M===this.length()&&this.format(P,X):o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"formatAt",this).call(this,O,Math.min(M,this.length()-O-1),P,X),this.cache={})}},{key:"insertAt",value:function(O,M,P){if(P!=null)return o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,O,M,P);if(M.length!==0){var X=M.split(`
`),J=X.shift();J.length>0&&(O<this.length()-1||this.children.tail==null?o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,Math.min(O,this.length()-1),J):this.children.tail.insertAt(this.children.tail.length(),J),this.cache={});var H=this;X.reduce(function(V,K){return H=H.split(V,!0),H.insertAt(0,K),K.length},O+J.length)}}},{key:"insertBefore",value:function(O,M){var P=this.children.head;o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertBefore",this).call(this,O,M),P instanceof b.default&&P.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"length",this).call(this)+_),this.cache.length}},{key:"moveChildren",value:function(O,M){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"moveChildren",this).call(this,O,M),this.cache={}}},{key:"optimize",value:function(O){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"optimize",this).call(this,O),this.cache={}}},{key:"path",value:function(O){return o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"path",this).call(this,O,!0)}},{key:"removeChild",value:function(O){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"removeChild",this).call(this,O),this.cache={}}},{key:"split",value:function(O){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(M&&(O===0||O>=this.length()-_)){var P=this.clone();return O===0?(this.parent.insertBefore(P,this),this):(this.parent.insertBefore(P,this.next),P)}else{var X=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"split",this).call(this,O,M);return this.cache={},X}}}]),F}(f.default.Block);j.blotName="block",j.tagName="P",j.defaultChild="break",j.allowedChildren=[v.default,f.default.Embed,g.default];function E(S){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return S==null||(typeof S.formats=="function"&&(F=(0,c.default)(F,S.formats())),S.parent==null||S.parent.blotName=="scroll"||S.parent.statics.scope!==S.statics.scope)?F:E(S.parent,F)}n.bubbleFormats=E,n.BlockEmbed=C,n.default=j},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},o=function(){function H(V,K){var B=[],L=!0,U=!1,D=void 0;try{for(var Q=V[Symbol.iterator](),z;!(L=(z=Q.next()).done)&&(B.push(z.value),!(K&&B.length===K));L=!0);}catch(G){U=!0,D=G}finally{try{!L&&Q.return&&Q.return()}finally{if(U)throw D}}return B}return function(V,K){if(Array.isArray(V))return V;if(Symbol.iterator in Object(V))return H(V,K);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function H(V,K){for(var B=0;B<K.length;B++){var L=K[B];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(V,L.key,L)}}return function(V,K,B){return K&&H(V.prototype,K),B&&H(V,B),V}}();s(50);var c=s(2),u=E(c),d=s(14),h=E(d),f=s(8),A=E(f),b=s(9),m=E(b),v=s(0),p=E(v),g=s(15),y=E(g),x=s(3),w=E(x),N=s(10),_=E(N),C=s(34),j=E(C);function E(H){return H&&H.__esModule?H:{default:H}}function S(H,V,K){return V in H?Object.defineProperty(H,V,{value:K,enumerable:!0,configurable:!0,writable:!0}):H[V]=K,H}function F(H,V){if(!(H instanceof V))throw new TypeError("Cannot call a class as a function")}var I=(0,_.default)("quill"),O=function(){l(H,null,[{key:"debug",value:function(K){K===!0&&(K="log"),_.default.level(K)}},{key:"find",value:function(K){return K.__quill||p.default.find(K)}},{key:"import",value:function(K){return this.imports[K]==null&&I.error("Cannot import "+K+". Are you sure it was registered?"),this.imports[K]}},{key:"register",value:function(K,B){var L=this,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof K!="string"){var D=K.attrName||K.blotName;typeof D=="string"?this.register("formats/"+D,K,B):Object.keys(K).forEach(function(Q){L.register(Q,K[Q],B)})}else this.imports[K]!=null&&!U&&I.warn("Overwriting "+K+" with",B),this.imports[K]=B,(K.startsWith("blots/")||K.startsWith("formats/"))&&B.blotName!=="abstract"?p.default.register(B):K.startsWith("modules")&&typeof B.register=="function"&&B.register()}}]);function H(V){var K=this,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(F(this,H),this.options=M(V,B),this.container=this.options.container,this.container==null)return I.error("Invalid Quill container",V);this.options.debug&&H.debug(this.options.debug);var L=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new A.default,this.scroll=p.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new h.default(this.scroll),this.selection=new y.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(A.default.events.EDITOR_CHANGE,function(D){D===A.default.events.TEXT_CHANGE&&K.root.classList.toggle("ql-blank",K.editor.isBlank())}),this.emitter.on(A.default.events.SCROLL_UPDATE,function(D,Q){var z=K.selection.lastRange,G=z&&z.length===0?z.index:void 0;P.call(K,function(){return K.editor.update(null,Q,G)},D)});var U=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+L+"<p><br></p></div>");this.setContents(U),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(H,[{key:"addContainer",value:function(K){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof K=="string"){var L=K;K=document.createElement("div"),K.classList.add(L)}return this.container.insertBefore(K,B),K}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(K,B,L){var U=this,D=X(K,B,L),Q=o(D,4);return K=Q[0],B=Q[1],L=Q[3],P.call(this,function(){return U.editor.deleteText(K,B)},L,K,-1*B)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(K),this.container.classList.toggle("ql-disabled",!K)}},{key:"focus",value:function(){var K=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=K,this.scrollIntoView()}},{key:"format",value:function(K,B){var L=this,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:A.default.sources.API;return P.call(this,function(){var D=L.getSelection(!0),Q=new u.default;if(D==null)return Q;if(p.default.query(K,p.default.Scope.BLOCK))Q=L.editor.formatLine(D.index,D.length,S({},K,B));else{if(D.length===0)return L.selection.format(K,B),Q;Q=L.editor.formatText(D.index,D.length,S({},K,B))}return L.setSelection(D,A.default.sources.SILENT),Q},U)}},{key:"formatLine",value:function(K,B,L,U,D){var Q=this,z=void 0,G=X(K,B,L,U,D),Z=o(G,4);return K=Z[0],B=Z[1],z=Z[2],D=Z[3],P.call(this,function(){return Q.editor.formatLine(K,B,z)},D,K,0)}},{key:"formatText",value:function(K,B,L,U,D){var Q=this,z=void 0,G=X(K,B,L,U,D),Z=o(G,4);return K=Z[0],B=Z[1],z=Z[2],D=Z[3],P.call(this,function(){return Q.editor.formatText(K,B,z)},D,K,0)}},{key:"getBounds",value:function(K){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,L=void 0;typeof K=="number"?L=this.selection.getBounds(K,B):L=this.selection.getBounds(K.index,K.length);var U=this.container.getBoundingClientRect();return{bottom:L.bottom-U.top,height:L.height,left:L.left-U.left,right:L.right-U.left,top:L.top-U.top,width:L.width}}},{key:"getContents",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-K,L=X(K,B),U=o(L,2);return K=U[0],B=U[1],this.editor.getContents(K,B)}},{key:"getFormat",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof K=="number"?this.editor.getFormat(K,B):this.editor.getFormat(K.index,K.length)}},{key:"getIndex",value:function(K){return K.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(K){return this.scroll.leaf(K)}},{key:"getLine",value:function(K){return this.scroll.line(K)}},{key:"getLines",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof K!="number"?this.scroll.lines(K.index,K.length):this.scroll.lines(K,B)}},{key:"getModule",value:function(K){return this.theme.modules[K]}},{key:"getSelection",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return K&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-K,L=X(K,B),U=o(L,2);return K=U[0],B=U[1],this.editor.getText(K,B)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(K,B,L){var U=this,D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:H.sources.API;return P.call(this,function(){return U.editor.insertEmbed(K,B,L)},D,K)}},{key:"insertText",value:function(K,B,L,U,D){var Q=this,z=void 0,G=X(K,0,L,U,D),Z=o(G,4);return K=Z[0],z=Z[2],D=Z[3],P.call(this,function(){return Q.editor.insertText(K,B,z)},D,K,B.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(K,B,L){this.clipboard.dangerouslyPasteHTML(K,B,L)}},{key:"removeFormat",value:function(K,B,L){var U=this,D=X(K,B,L),Q=o(D,4);return K=Q[0],B=Q[1],L=Q[3],P.call(this,function(){return U.editor.removeFormat(K,B)},L,K)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(K){var B=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.default.sources.API;return P.call(this,function(){K=new u.default(K);var U=B.getLength(),D=B.editor.deleteText(0,U),Q=B.editor.applyDelta(K),z=Q.ops[Q.ops.length-1];z!=null&&typeof z.insert=="string"&&z.insert[z.insert.length-1]===`
`&&(B.editor.deleteText(B.getLength()-1,1),Q.delete(1));var G=D.compose(Q);return G},L)}},{key:"setSelection",value:function(K,B,L){if(K==null)this.selection.setRange(null,B||H.sources.API);else{var U=X(K,B,L),D=o(U,4);K=D[0],B=D[1],L=D[3],this.selection.setRange(new g.Range(K,B),L),L!==A.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(K){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.default.sources.API,L=new u.default().insert(K);return this.setContents(L,B)}},{key:"update",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A.default.sources.USER,B=this.scroll.update(K);return this.selection.update(K),B}},{key:"updateContents",value:function(K){var B=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.default.sources.API;return P.call(this,function(){return K=new u.default(K),B.editor.applyDelta(K,L)},L,!0)}}]),H}();O.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},O.events=A.default.events,O.sources=A.default.sources,O.version="1.3.7",O.imports={delta:u.default,parchment:p.default,"core/module":m.default,"core/theme":j.default};function M(H,V){if(V=(0,w.default)(!0,{container:H,modules:{clipboard:!0,keyboard:!0,history:!0}},V),!V.theme||V.theme===O.DEFAULTS.theme)V.theme=j.default;else if(V.theme=O.import("themes/"+V.theme),V.theme==null)throw new Error("Invalid theme "+V.theme+". Did you register it?");var K=(0,w.default)(!0,{},V.theme.DEFAULTS);[K,V].forEach(function(U){U.modules=U.modules||{},Object.keys(U.modules).forEach(function(D){U.modules[D]===!0&&(U.modules[D]={})})});var B=Object.keys(K.modules).concat(Object.keys(V.modules)),L=B.reduce(function(U,D){var Q=O.import("modules/"+D);return Q==null?I.error("Cannot load "+D+" module. Are you sure you registered it?"):U[D]=Q.DEFAULTS||{},U},{});return V.modules!=null&&V.modules.toolbar&&V.modules.toolbar.constructor!==Object&&(V.modules.toolbar={container:V.modules.toolbar}),V=(0,w.default)(!0,{},O.DEFAULTS,{modules:L},K,V),["bounds","container","scrollingContainer"].forEach(function(U){typeof V[U]=="string"&&(V[U]=document.querySelector(V[U]))}),V.modules=Object.keys(V.modules).reduce(function(U,D){return V.modules[D]&&(U[D]=V.modules[D]),U},{}),V}function P(H,V,K,B){if(this.options.strict&&!this.isEnabled()&&V===A.default.sources.USER)return new u.default;var L=K==null?null:this.getSelection(),U=this.editor.delta,D=H();if(L!=null&&(K===!0&&(K=L.index),B==null?L=J(L,D,V):B!==0&&(L=J(L,K,B,V)),this.setSelection(L,A.default.sources.SILENT)),D.length()>0){var Q,z=[A.default.events.TEXT_CHANGE,D,U,V];if((Q=this.emitter).emit.apply(Q,[A.default.events.EDITOR_CHANGE].concat(z)),V!==A.default.sources.SILENT){var G;(G=this.emitter).emit.apply(G,z)}}return D}function X(H,V,K,B,L){var U={};return typeof H.index=="number"&&typeof H.length=="number"?typeof V!="number"?(L=B,B=K,K=V,V=H.length,H=H.index):(V=H.length,H=H.index):typeof V!="number"&&(L=B,B=K,K=V,V=0),(typeof K>"u"?"undefined":i(K))==="object"?(U=K,L=B):typeof K=="string"&&(B!=null?U[K]=B:L=K),L=L||A.default.sources.API,[H,V,U,L]}function J(H,V,K,B){if(H==null)return null;var L=void 0,U=void 0;if(V instanceof u.default){var D=[H.index,H.index+H.length].map(function(Z){return V.transformPosition(Z,B!==A.default.sources.USER)}),Q=o(D,2);L=Q[0],U=Q[1]}else{var z=[H.index,H.index+H.length].map(function(Z){return Z<V||Z===V&&B===A.default.sources.USER?Z:K>=0?Z+K:Math.max(V,Z+K)}),G=o(z,2);L=G[0],U=G[1]}return new g.Range(L,U-L)}n.expandConfig=M,n.overload=X,n.default=O},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function v(p,g){for(var y=0;y<g.length;y++){var x=g[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,g,y){return g&&v(p.prototype,g),y&&v(p,y),p}}(),o=function v(p,g,y){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,g);if(x===void 0){var w=Object.getPrototypeOf(p);return w===null?void 0:v(w,g,y)}else{if("value"in x)return x.value;var N=x.get;return N===void 0?void 0:N.call(y)}},l=s(7),c=h(l),u=s(0),d=h(u);function h(v){return v&&v.__esModule?v:{default:v}}function f(v,p){if(!(v instanceof p))throw new TypeError("Cannot call a class as a function")}function A(v,p){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:v}function b(v,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);v.prototype=Object.create(p&&p.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(v,p):v.__proto__=p)}var m=function(v){b(p,v);function p(){return f(this,p),A(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return i(p,[{key:"formatAt",value:function(y,x,w,N){if(p.compare(this.statics.blotName,w)<0&&d.default.query(w,d.default.Scope.BLOT)){var _=this.isolate(y,x);N&&_.wrap(w,N)}else o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"formatAt",this).call(this,y,x,w,N)}},{key:"optimize",value:function(y){if(o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"optimize",this).call(this,y),this.parent instanceof p&&p.compare(this.statics.blotName,this.parent.statics.blotName)>0){var x=this.parent.isolate(this.offset(),this.length());this.moveChildren(x),x.wrap(this)}}}],[{key:"compare",value:function(y,x){var w=p.order.indexOf(y),N=p.order.indexOf(x);return w>=0||N>=0?w-N:y===x?0:y<x?-1:1}}]),p}(d.default.Inline);m.allowedChildren=[m,d.default.Embed,c.default],m.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=m},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(0),o=l(i);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,A){if(!(f instanceof A))throw new TypeError("Cannot call a class as a function")}function u(f,A){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:f}function d(f,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);f.prototype=Object.create(A&&A.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(f,A):f.__proto__=A)}var h=function(f){d(A,f);function A(){return c(this,A),u(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default.Text);n.default=h},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function g(y,x){for(var w=0;w<x.length;w++){var N=x[w];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(y,N.key,N)}}return function(y,x,w){return x&&g(y.prototype,x),w&&g(y,w),y}}(),o=function g(y,x,w){y===null&&(y=Function.prototype);var N=Object.getOwnPropertyDescriptor(y,x);if(N===void 0){var _=Object.getPrototypeOf(y);return _===null?void 0:g(_,x,w)}else{if("value"in N)return N.value;var C=N.get;return C===void 0?void 0:C.call(w)}},l=s(54),c=h(l),u=s(10),d=h(u);function h(g){return g&&g.__esModule?g:{default:g}}function f(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function A(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function b(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var m=(0,d.default)("quill:events"),v=["selectionchange","mousedown","mouseup","click"];v.forEach(function(g){document.addEventListener(g,function(){for(var y=arguments.length,x=Array(y),w=0;w<y;w++)x[w]=arguments[w];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(N){if(N.__quill&&N.__quill.emitter){var _;(_=N.__quill.emitter).handleDOM.apply(_,x)}})})});var p=function(g){b(y,g);function y(){f(this,y);var x=A(this,(y.__proto__||Object.getPrototypeOf(y)).call(this));return x.listeners={},x.on("error",m.error),x}return i(y,[{key:"emit",value:function(){m.log.apply(m,arguments),o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(w){for(var N=arguments.length,_=Array(N>1?N-1:0),C=1;C<N;C++)_[C-1]=arguments[C];(this.listeners[w.type]||[]).forEach(function(j){var E=j.node,S=j.handler;(w.target===E||E.contains(w.target))&&S.apply(void 0,[w].concat(_))})}},{key:"listenDOM",value:function(w,N,_){this.listeners[w]||(this.listeners[w]=[]),this.listeners[w].push({node:N,handler:_})}}]),y}(c.default);p.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},p.sources={API:"api",SILENT:"silent",USER:"user"},n.default=p},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});function i(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i(this,l),this.quill=c,this.options=u};o.DEFAULTS={},n.default=o},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=["error","warn","log","info"],o="warn";function l(u){if(i.indexOf(u)<=i.indexOf(o)){for(var d,h=arguments.length,f=Array(h>1?h-1:0),A=1;A<h;A++)f[A-1]=arguments[A];(d=console)[u].apply(d,f)}}function c(u){return i.reduce(function(d,h){return d[h]=l.bind(console,h,u),d},{})}l.level=c.level=function(u){o=u},n.default=c},function(r,n,s){var i=Array.prototype.slice,o=s(52),l=s(53),c=r.exports=function(f,A,b){return b||(b={}),f===A?!0:f instanceof Date&&A instanceof Date?f.getTime()===A.getTime():!f||!A||typeof f!="object"&&typeof A!="object"?b.strict?f===A:f==A:h(f,A,b)};function u(f){return f==null}function d(f){return!(!f||typeof f!="object"||typeof f.length!="number"||typeof f.copy!="function"||typeof f.slice!="function"||f.length>0&&typeof f[0]!="number")}function h(f,A,b){var m,v;if(u(f)||u(A)||f.prototype!==A.prototype)return!1;if(l(f))return l(A)?(f=i.call(f),A=i.call(A),c(f,A,b)):!1;if(d(f)){if(!d(A)||f.length!==A.length)return!1;for(m=0;m<f.length;m++)if(f[m]!==A[m])return!1;return!0}try{var p=o(f),g=o(A)}catch{return!1}if(p.length!=g.length)return!1;for(p.sort(),g.sort(),m=p.length-1;m>=0;m--)if(p[m]!=g[m])return!1;for(m=p.length-1;m>=0;m--)if(v=p[m],!c(f[v],A[v],b))return!1;return typeof f==typeof A}},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(1),o=function(){function l(c,u,d){d===void 0&&(d={}),this.attrName=c,this.keyName=u;var h=i.Scope.TYPE&i.Scope.ATTRIBUTE;d.scope!=null?this.scope=d.scope&i.Scope.LEVEL|h:this.scope=i.Scope.ATTRIBUTE,d.whitelist!=null&&(this.whitelist=d.whitelist)}return l.keys=function(c){return[].map.call(c.attributes,function(u){return u.name})},l.prototype.add=function(c,u){return this.canAdd(c,u)?(c.setAttribute(this.keyName,u),!0):!1},l.prototype.canAdd=function(c,u){var d=i.query(c,i.Scope.BLOT&(this.scope|i.Scope.TYPE));return d==null?!1:this.whitelist==null?!0:typeof u=="string"?this.whitelist.indexOf(u.replace(/["']/g,""))>-1:this.whitelist.indexOf(u)>-1},l.prototype.remove=function(c){c.removeAttribute(this.keyName)},l.prototype.value=function(c){var u=c.getAttribute(this.keyName);return this.canAdd(c,u)&&u?u:""},l}();n.default=o},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var i=function(){function C(j,E){var S=[],F=!0,I=!1,O=void 0;try{for(var M=j[Symbol.iterator](),P;!(F=(P=M.next()).done)&&(S.push(P.value),!(E&&S.length===E));F=!0);}catch(X){I=!0,O=X}finally{try{!F&&M.return&&M.return()}finally{if(I)throw O}}return S}return function(j,E){if(Array.isArray(j))return j;if(Symbol.iterator in Object(j))return C(j,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function C(j,E){for(var S=0;S<E.length;S++){var F=E[S];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(j,F.key,F)}}return function(j,E,S){return E&&C(j.prototype,E),S&&C(j,S),j}}(),l=function C(j,E,S){j===null&&(j=Function.prototype);var F=Object.getOwnPropertyDescriptor(j,E);if(F===void 0){var I=Object.getPrototypeOf(j);return I===null?void 0:C(I,E,S)}else{if("value"in F)return F.value;var O=F.get;return O===void 0?void 0:O.call(S)}},c=s(2),u=g(c),d=s(0),h=g(d),f=s(4),A=g(f),b=s(6),m=g(b),v=s(7),p=g(v);function g(C){return C&&C.__esModule?C:{default:C}}function y(C,j){if(!(C instanceof j))throw new TypeError("Cannot call a class as a function")}function x(C,j){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:C}function w(C,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);C.prototype=Object.create(j&&j.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(C,j):C.__proto__=j)}var N=function(C){w(j,C);function j(){return y(this,j),x(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return j}(m.default);N.blotName="code",N.tagName="CODE";var _=function(C){w(j,C);function j(){return y(this,j),x(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return o(j,[{key:"delta",value:function(){var S=this,F=this.domNode.textContent;return F.endsWith(`
`)&&(F=F.slice(0,-1)),F.split(`
`).reduce(function(I,O){return I.insert(O).insert(`
`,S.formats())},new u.default)}},{key:"format",value:function(S,F){if(!(S===this.statics.blotName&&F)){var I=this.descendant(p.default,this.length()-1),O=i(I,1),M=O[0];M!=null&&M.deleteAt(M.length()-1,1),l(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"format",this).call(this,S,F)}}},{key:"formatAt",value:function(S,F,I,O){if(F!==0&&!(h.default.query(I,h.default.Scope.BLOCK)==null||I===this.statics.blotName&&O===this.statics.formats(this.domNode))){var M=this.newlineIndex(S);if(!(M<0||M>=S+F)){var P=this.newlineIndex(S,!0)+1,X=M-P+1,J=this.isolate(P,X),H=J.next;J.format(I,O),H instanceof j&&H.formatAt(0,S-P+F-X,I,O)}}}},{key:"insertAt",value:function(S,F,I){if(I==null){var O=this.descendant(p.default,S),M=i(O,2),P=M[0],X=M[1];P.insertAt(X,F)}}},{key:"length",value:function(){var S=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?S:S+1}},{key:"newlineIndex",value:function(S){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(F)return this.domNode.textContent.slice(0,S).lastIndexOf(`
`);var I=this.domNode.textContent.slice(S).indexOf(`
`);return I>-1?S+I:-1}},{key:"optimize",value:function(S){this.domNode.textContent.endsWith(`
`)||this.appendChild(h.default.create("text",`
`)),l(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"optimize",this).call(this,S);var F=this.next;F!=null&&F.prev===this&&F.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===F.statics.formats(F.domNode)&&(F.optimize(S),F.moveChildren(this),F.remove())}},{key:"replace",value:function(S){l(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replace",this).call(this,S),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(F){var I=h.default.find(F);I==null?F.parentNode.removeChild(F):I instanceof h.default.Embed?I.remove():I.unwrap()})}}],[{key:"create",value:function(S){var F=l(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,S);return F.setAttribute("spellcheck",!1),F}},{key:"formats",value:function(){return!0}}]),j}(A.default);_.blotName="code-block",_.tagName="PRE",_.TAB="  ",n.Code=N,n.default=_},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},o=function(){function H(V,K){var B=[],L=!0,U=!1,D=void 0;try{for(var Q=V[Symbol.iterator](),z;!(L=(z=Q.next()).done)&&(B.push(z.value),!(K&&B.length===K));L=!0);}catch(G){U=!0,D=G}finally{try{!L&&Q.return&&Q.return()}finally{if(U)throw D}}return B}return function(V,K){if(Array.isArray(V))return V;if(Symbol.iterator in Object(V))return H(V,K);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function H(V,K){for(var B=0;B<K.length;B++){var L=K[B];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(V,L.key,L)}}return function(V,K,B){return K&&H(V.prototype,K),B&&H(V,B),V}}(),c=s(2),u=F(c),d=s(20),h=F(d),f=s(0),A=F(f),b=s(13),m=F(b),v=s(24),p=F(v),g=s(4),y=F(g),x=s(16),w=F(x),N=s(21),_=F(N),C=s(11),j=F(C),E=s(3),S=F(E);function F(H){return H&&H.__esModule?H:{default:H}}function I(H,V,K){return V in H?Object.defineProperty(H,V,{value:K,enumerable:!0,configurable:!0,writable:!0}):H[V]=K,H}function O(H,V){if(!(H instanceof V))throw new TypeError("Cannot call a class as a function")}var M=/^[ -~]*$/,P=function(){function H(V){O(this,H),this.scroll=V,this.delta=this.getDelta()}return l(H,[{key:"applyDelta",value:function(K){var B=this,L=!1;this.scroll.update();var U=this.scroll.length();return this.scroll.batchStart(),K=J(K),K.reduce(function(D,Q){var z=Q.retain||Q.delete||Q.insert.length||1,G=Q.attributes||{};if(Q.insert!=null){if(typeof Q.insert=="string"){var Z=Q.insert;Z.endsWith(`
`)&&L&&(L=!1,Z=Z.slice(0,-1)),D>=U&&!Z.endsWith(`
`)&&(L=!0),B.scroll.insertAt(D,Z);var R=B.scroll.line(D),le=o(R,2),ee=le[0],_e=le[1],se=(0,S.default)({},(0,g.bubbleFormats)(ee));if(ee instanceof y.default){var te=ee.descendant(A.default.Leaf,_e),Ne=o(te,1),Se=Ne[0];se=(0,S.default)(se,(0,g.bubbleFormats)(Se))}G=h.default.attributes.diff(se,G)||{}}else if(i(Q.insert)==="object"){var Ae=Object.keys(Q.insert)[0];if(Ae==null)return D;B.scroll.insertAt(D,Ae,Q.insert[Ae])}U+=z}return Object.keys(G).forEach(function(ye){B.scroll.formatAt(D,z,ye,G[ye])}),D+z},0),K.reduce(function(D,Q){return typeof Q.delete=="number"?(B.scroll.deleteAt(D,Q.delete),D):D+(Q.retain||Q.insert.length||1)},0),this.scroll.batchEnd(),this.update(K)}},{key:"deleteText",value:function(K,B){return this.scroll.deleteAt(K,B),this.update(new u.default().retain(K).delete(B))}},{key:"formatLine",value:function(K,B){var L=this,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(U).forEach(function(D){if(!(L.scroll.whitelist!=null&&!L.scroll.whitelist[D])){var Q=L.scroll.lines(K,Math.max(B,1)),z=B;Q.forEach(function(G){var Z=G.length();if(!(G instanceof m.default))G.format(D,U[D]);else{var R=K-G.offset(L.scroll),le=G.newlineIndex(R+z)-R+1;G.formatAt(R,le,D,U[D])}z-=Z})}}),this.scroll.optimize(),this.update(new u.default().retain(K).retain(B,(0,_.default)(U)))}},{key:"formatText",value:function(K,B){var L=this,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(U).forEach(function(D){L.scroll.formatAt(K,B,D,U[D])}),this.update(new u.default().retain(K).retain(B,(0,_.default)(U)))}},{key:"getContents",value:function(K,B){return this.delta.slice(K,K+B)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(K,B){return K.concat(B.delta())},new u.default)}},{key:"getFormat",value:function(K){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,L=[],U=[];B===0?this.scroll.path(K).forEach(function(Q){var z=o(Q,1),G=z[0];G instanceof y.default?L.push(G):G instanceof A.default.Leaf&&U.push(G)}):(L=this.scroll.lines(K,B),U=this.scroll.descendants(A.default.Leaf,K,B));var D=[L,U].map(function(Q){if(Q.length===0)return{};for(var z=(0,g.bubbleFormats)(Q.shift());Object.keys(z).length>0;){var G=Q.shift();if(G==null)return z;z=X((0,g.bubbleFormats)(G),z)}return z});return S.default.apply(S.default,D)}},{key:"getText",value:function(K,B){return this.getContents(K,B).filter(function(L){return typeof L.insert=="string"}).map(function(L){return L.insert}).join("")}},{key:"insertEmbed",value:function(K,B,L){return this.scroll.insertAt(K,B,L),this.update(new u.default().retain(K).insert(I({},B,L)))}},{key:"insertText",value:function(K,B){var L=this,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return B=B.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(K,B),Object.keys(U).forEach(function(D){L.scroll.formatAt(K,B.length,D,U[D])}),this.update(new u.default().retain(K).insert(B,(0,_.default)(U)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var K=this.scroll.children.head;return K.statics.blotName!==y.default.blotName||K.children.length>1?!1:K.children.head instanceof w.default}},{key:"removeFormat",value:function(K,B){var L=this.getText(K,B),U=this.scroll.line(K+B),D=o(U,2),Q=D[0],z=D[1],G=0,Z=new u.default;Q!=null&&(Q instanceof m.default?G=Q.newlineIndex(z)-z+1:G=Q.length()-z,Z=Q.delta().slice(z,z+G-1).insert(`
`));var R=this.getContents(K,B+G),le=R.diff(new u.default().insert(L).concat(Z)),ee=new u.default().retain(K).concat(le);return this.applyDelta(ee)}},{key:"update",value:function(K){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,U=this.delta;if(B.length===1&&B[0].type==="characterData"&&B[0].target.data.match(M)&&A.default.find(B[0].target)){var D=A.default.find(B[0].target),Q=(0,g.bubbleFormats)(D),z=D.offset(this.scroll),G=B[0].oldValue.replace(p.default.CONTENTS,""),Z=new u.default().insert(G),R=new u.default().insert(D.value()),le=new u.default().retain(z).concat(Z.diff(R,L));K=le.reduce(function(ee,_e){return _e.insert?ee.insert(_e.insert,Q):ee.push(_e)},new u.default),this.delta=U.compose(K)}else this.delta=this.getDelta(),(!K||!(0,j.default)(U.compose(K),this.delta))&&(K=U.diff(this.delta,L));return K}}]),H}();function X(H,V){return Object.keys(V).reduce(function(K,B){return H[B]==null||(V[B]===H[B]?K[B]=V[B]:Array.isArray(V[B])?V[B].indexOf(H[B])<0&&(K[B]=V[B].concat([H[B]])):K[B]=[V[B],H[B]]),K},{})}function J(H){return H.reduce(function(V,K){if(K.insert===1){var B=(0,_.default)(K.attributes);return delete B.image,V.insert({image:K.attributes.image},B)}if(K.attributes!=null&&(K.attributes.list===!0||K.attributes.bullet===!0)&&(K=(0,_.default)(K),K.attributes.list?K.attributes.list="ordered":(K.attributes.list="bullet",delete K.attributes.bullet)),typeof K.insert=="string"){var L=K.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return V.insert(L,K.attributes)}return V.push(K)},new u.default)}n.default=P},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var i=function(){function C(j,E){var S=[],F=!0,I=!1,O=void 0;try{for(var M=j[Symbol.iterator](),P;!(F=(P=M.next()).done)&&(S.push(P.value),!(E&&S.length===E));F=!0);}catch(X){I=!0,O=X}finally{try{!F&&M.return&&M.return()}finally{if(I)throw O}}return S}return function(j,E){if(Array.isArray(j))return j;if(Symbol.iterator in Object(j))return C(j,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function C(j,E){for(var S=0;S<E.length;S++){var F=E[S];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(j,F.key,F)}}return function(j,E,S){return E&&C(j.prototype,E),S&&C(j,S),j}}(),l=s(0),c=p(l),u=s(21),d=p(u),h=s(11),f=p(h),A=s(8),b=p(A),m=s(10),v=p(m);function p(C){return C&&C.__esModule?C:{default:C}}function g(C){if(Array.isArray(C)){for(var j=0,E=Array(C.length);j<C.length;j++)E[j]=C[j];return E}else return Array.from(C)}function y(C,j){if(!(C instanceof j))throw new TypeError("Cannot call a class as a function")}var x=(0,v.default)("quill:selection"),w=function C(j){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;y(this,C),this.index=j,this.length=E},N=function(){function C(j,E){var S=this;y(this,C),this.emitter=E,this.scroll=j,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=c.default.create("cursor",this),this.lastRange=this.savedRange=new w(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){S.mouseDown||setTimeout(S.update.bind(S,b.default.sources.USER),1)}),this.emitter.on(b.default.events.EDITOR_CHANGE,function(F,I){F===b.default.events.TEXT_CHANGE&&I.length()>0&&S.update(b.default.sources.SILENT)}),this.emitter.on(b.default.events.SCROLL_BEFORE_UPDATE,function(){if(S.hasFocus()){var F=S.getNativeRange();F!=null&&F.start.node!==S.cursor.textNode&&S.emitter.once(b.default.events.SCROLL_UPDATE,function(){try{S.setNativeRange(F.start.node,F.start.offset,F.end.node,F.end.offset)}catch{}})}}),this.emitter.on(b.default.events.SCROLL_OPTIMIZE,function(F,I){if(I.range){var O=I.range,M=O.startNode,P=O.startOffset,X=O.endNode,J=O.endOffset;S.setNativeRange(M,P,X,J)}}),this.update(b.default.sources.SILENT)}return o(C,[{key:"handleComposition",value:function(){var E=this;this.root.addEventListener("compositionstart",function(){E.composing=!0}),this.root.addEventListener("compositionend",function(){if(E.composing=!1,E.cursor.parent){var S=E.cursor.restore();if(!S)return;setTimeout(function(){E.setNativeRange(S.startNode,S.startOffset,S.endNode,S.endOffset)},1)}})}},{key:"handleDragging",value:function(){var E=this;this.emitter.listenDOM("mousedown",document.body,function(){E.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){E.mouseDown=!1,E.update(b.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(E,S){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[E])){this.scroll.update();var F=this.getNativeRange();if(!(F==null||!F.native.collapsed||c.default.query(E,c.default.Scope.BLOCK))){if(F.start.node!==this.cursor.textNode){var I=c.default.find(F.start.node,!1);if(I==null)return;if(I instanceof c.default.Leaf){var O=I.split(F.start.offset);I.parent.insertBefore(this.cursor,O)}else I.insertBefore(this.cursor,F.start.node);this.cursor.attach()}this.cursor.format(E,S),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(E){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=this.scroll.length();E=Math.min(E,F-1),S=Math.min(E+S,F-1)-E;var I=void 0,O=this.scroll.leaf(E),M=i(O,2),P=M[0],X=M[1];if(P==null)return null;var J=P.position(X,!0),H=i(J,2);I=H[0],X=H[1];var V=document.createRange();if(S>0){V.setStart(I,X);var K=this.scroll.leaf(E+S),B=i(K,2);if(P=B[0],X=B[1],P==null)return null;var L=P.position(X,!0),U=i(L,2);return I=U[0],X=U[1],V.setEnd(I,X),V.getBoundingClientRect()}else{var D="left",Q=void 0;return I instanceof Text?(X<I.data.length?(V.setStart(I,X),V.setEnd(I,X+1)):(V.setStart(I,X-1),V.setEnd(I,X),D="right"),Q=V.getBoundingClientRect()):(Q=P.domNode.getBoundingClientRect(),X>0&&(D="right")),{bottom:Q.top+Q.height,height:Q.height,left:Q[D],right:Q[D],top:Q.top,width:0}}}},{key:"getNativeRange",value:function(){var E=document.getSelection();if(E==null||E.rangeCount<=0)return null;var S=E.getRangeAt(0);if(S==null)return null;var F=this.normalizeNative(S);return x.info("getNativeRange",F),F}},{key:"getRange",value:function(){var E=this.getNativeRange();if(E==null)return[null,null];var S=this.normalizedToRange(E);return[S,E]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(E){var S=this,F=[[E.start.node,E.start.offset]];E.native.collapsed||F.push([E.end.node,E.end.offset]);var I=F.map(function(P){var X=i(P,2),J=X[0],H=X[1],V=c.default.find(J,!0),K=V.offset(S.scroll);return H===0?K:V instanceof c.default.Container?K+V.length():K+V.index(J,H)}),O=Math.min(Math.max.apply(Math,g(I)),this.scroll.length()-1),M=Math.min.apply(Math,[O].concat(g(I)));return new w(M,O-M)}},{key:"normalizeNative",value:function(E){if(!_(this.root,E.startContainer)||!E.collapsed&&!_(this.root,E.endContainer))return null;var S={start:{node:E.startContainer,offset:E.startOffset},end:{node:E.endContainer,offset:E.endOffset},native:E};return[S.start,S.end].forEach(function(F){for(var I=F.node,O=F.offset;!(I instanceof Text)&&I.childNodes.length>0;)if(I.childNodes.length>O)I=I.childNodes[O],O=0;else if(I.childNodes.length===O)I=I.lastChild,O=I instanceof Text?I.data.length:I.childNodes.length+1;else break;F.node=I,F.offset=O}),S}},{key:"rangeToNative",value:function(E){var S=this,F=E.collapsed?[E.index]:[E.index,E.index+E.length],I=[],O=this.scroll.length();return F.forEach(function(M,P){M=Math.min(O-1,M);var X=void 0,J=S.scroll.leaf(M),H=i(J,2),V=H[0],K=H[1],B=V.position(K,P!==0),L=i(B,2);X=L[0],K=L[1],I.push(X,K)}),I.length<2&&(I=I.concat(I)),I}},{key:"scrollIntoView",value:function(E){var S=this.lastRange;if(S!=null){var F=this.getBounds(S.index,S.length);if(F!=null){var I=this.scroll.length()-1,O=this.scroll.line(Math.min(S.index,I)),M=i(O,1),P=M[0],X=P;if(S.length>0){var J=this.scroll.line(Math.min(S.index+S.length,I)),H=i(J,1);X=H[0]}if(!(P==null||X==null)){var V=E.getBoundingClientRect();F.top<V.top?E.scrollTop-=V.top-F.top:F.bottom>V.bottom&&(E.scrollTop+=F.bottom-V.bottom)}}}}},{key:"setNativeRange",value:function(E,S){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E,I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:S,O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(x.info("setNativeRange",E,S,F,I),!(E!=null&&(this.root.parentNode==null||E.parentNode==null||F.parentNode==null))){var M=document.getSelection();if(M!=null)if(E!=null){this.hasFocus()||this.root.focus();var P=(this.getNativeRange()||{}).native;if(P==null||O||E!==P.startContainer||S!==P.startOffset||F!==P.endContainer||I!==P.endOffset){E.tagName=="BR"&&(S=[].indexOf.call(E.parentNode.childNodes,E),E=E.parentNode),F.tagName=="BR"&&(I=[].indexOf.call(F.parentNode.childNodes,F),F=F.parentNode);var X=document.createRange();X.setStart(E,S),X.setEnd(F,I),M.removeAllRanges(),M.addRange(X)}}else M.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(E){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:b.default.sources.API;if(typeof S=="string"&&(F=S,S=!1),x.info("setRange",E),E!=null){var I=this.rangeToNative(E);this.setNativeRange.apply(this,g(I).concat([S]))}else this.setNativeRange(null);this.update(F)}},{key:"update",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b.default.sources.USER,S=this.lastRange,F=this.getRange(),I=i(F,2),O=I[0],M=I[1];if(this.lastRange=O,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,f.default)(S,this.lastRange)){var P;!this.composing&&M!=null&&M.native.collapsed&&M.start.node!==this.cursor.textNode&&this.cursor.restore();var X=[b.default.events.SELECTION_CHANGE,(0,d.default)(this.lastRange),(0,d.default)(S),E];if((P=this.emitter).emit.apply(P,[b.default.events.EDITOR_CHANGE].concat(X)),E!==b.default.sources.SILENT){var J;(J=this.emitter).emit.apply(J,X)}}}}]),C}();function _(C,j){try{j.parentNode}catch{return!1}return j instanceof Text&&(j=j.parentNode),C.contains(j)}n.Range=w,n.default=N},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function b(m,v){for(var p=0;p<v.length;p++){var g=v[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(m,g.key,g)}}return function(m,v,p){return v&&b(m.prototype,v),p&&b(m,p),m}}(),o=function b(m,v,p){m===null&&(m=Function.prototype);var g=Object.getOwnPropertyDescriptor(m,v);if(g===void 0){var y=Object.getPrototypeOf(m);return y===null?void 0:b(y,v,p)}else{if("value"in g)return g.value;var x=g.get;return x===void 0?void 0:x.call(p)}},l=s(0),c=u(l);function u(b){return b&&b.__esModule?b:{default:b}}function d(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function f(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var A=function(b){f(m,b);function m(){return d(this,m),h(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return i(m,[{key:"insertInto",value:function(p,g){p.children.length===0?o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"insertInto",this).call(this,p,g):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),m}(c.default.Embed);A.blotName="break",A.tagName="BR",n.default=A},function(r,n,s){var i=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,A){f.__proto__=A}||function(f,A){for(var b in A)A.hasOwnProperty(b)&&(f[b]=A[b])};return function(f,A){h(f,A);function b(){this.constructor=f}f.prototype=A===null?Object.create(A):(b.prototype=A.prototype,new b)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(44),l=s(30),c=s(1),u=function(h){i(f,h);function f(A){var b=h.call(this,A)||this;return b.build(),b}return f.prototype.appendChild=function(A){this.insertBefore(A)},f.prototype.attach=function(){h.prototype.attach.call(this),this.children.forEach(function(A){A.attach()})},f.prototype.build=function(){var A=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(b){try{var m=d(b);A.insertBefore(m,A.children.head||void 0)}catch(v){if(v instanceof c.ParchmentError)return;throw v}})},f.prototype.deleteAt=function(A,b){if(A===0&&b===this.length())return this.remove();this.children.forEachAt(A,b,function(m,v,p){m.deleteAt(v,p)})},f.prototype.descendant=function(A,b){var m=this.children.find(b),v=m[0],p=m[1];return A.blotName==null&&A(v)||A.blotName!=null&&v instanceof A?[v,p]:v instanceof f?v.descendant(A,p):[null,-1]},f.prototype.descendants=function(A,b,m){b===void 0&&(b=0),m===void 0&&(m=Number.MAX_VALUE);var v=[],p=m;return this.children.forEachAt(b,m,function(g,y,x){(A.blotName==null&&A(g)||A.blotName!=null&&g instanceof A)&&v.push(g),g instanceof f&&(v=v.concat(g.descendants(A,y,p))),p-=x}),v},f.prototype.detach=function(){this.children.forEach(function(A){A.detach()}),h.prototype.detach.call(this)},f.prototype.formatAt=function(A,b,m,v){this.children.forEachAt(A,b,function(p,g,y){p.formatAt(g,y,m,v)})},f.prototype.insertAt=function(A,b,m){var v=this.children.find(A),p=v[0],g=v[1];if(p)p.insertAt(g,b,m);else{var y=m==null?c.create("text",b):c.create(b,m);this.appendChild(y)}},f.prototype.insertBefore=function(A,b){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(m){return A instanceof m}))throw new c.ParchmentError("Cannot insert "+A.statics.blotName+" into "+this.statics.blotName);A.insertInto(this,b)},f.prototype.length=function(){return this.children.reduce(function(A,b){return A+b.length()},0)},f.prototype.moveChildren=function(A,b){this.children.forEach(function(m){A.insertBefore(m,b)})},f.prototype.optimize=function(A){if(h.prototype.optimize.call(this,A),this.children.length===0)if(this.statics.defaultChild!=null){var b=c.create(this.statics.defaultChild);this.appendChild(b),b.optimize(A)}else this.remove()},f.prototype.path=function(A,b){b===void 0&&(b=!1);var m=this.children.find(A,b),v=m[0],p=m[1],g=[[this,A]];return v instanceof f?g.concat(v.path(p,b)):(v!=null&&g.push([v,p]),g)},f.prototype.removeChild=function(A){this.children.remove(A)},f.prototype.replace=function(A){A instanceof f&&A.moveChildren(this),h.prototype.replace.call(this,A)},f.prototype.split=function(A,b){if(b===void 0&&(b=!1),!b){if(A===0)return this;if(A===this.length())return this.next}var m=this.clone();return this.parent.insertBefore(m,this.next),this.children.forEachAt(A,this.length(),function(v,p,g){v=v.split(p,b),m.appendChild(v)}),m},f.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},f.prototype.update=function(A,b){var m=this,v=[],p=[];A.forEach(function(g){g.target===m.domNode&&g.type==="childList"&&(v.push.apply(v,g.addedNodes),p.push.apply(p,g.removedNodes))}),p.forEach(function(g){if(!(g.parentNode!=null&&g.tagName!=="IFRAME"&&document.body.compareDocumentPosition(g)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var y=c.find(g);y!=null&&(y.domNode.parentNode==null||y.domNode.parentNode===m.domNode)&&y.detach()}}),v.filter(function(g){return g.parentNode==m.domNode}).sort(function(g,y){return g===y?0:g.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(g){var y=null;g.nextSibling!=null&&(y=c.find(g.nextSibling));var x=d(g);(x.next!=y||x.next==null)&&(x.parent!=null&&x.parent.removeChild(m),m.insertBefore(x,y||void 0))})},f}(l.default);function d(h){var f=c.find(h);if(f==null)try{f=c.create(h)}catch{f=c.create(c.Scope.INLINE),[].slice.call(h.childNodes).forEach(function(b){f.domNode.appendChild(b)}),h.parentNode&&h.parentNode.replaceChild(f.domNode,h),f.attach()}return f}n.default=u},function(r,n,s){var i=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,A){f.__proto__=A}||function(f,A){for(var b in A)A.hasOwnProperty(b)&&(f[b]=A[b])};return function(f,A){h(f,A);function b(){this.constructor=f}f.prototype=A===null?Object.create(A):(b.prototype=A.prototype,new b)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(12),l=s(31),c=s(17),u=s(1),d=function(h){i(f,h);function f(A){var b=h.call(this,A)||this;return b.attributes=new l.default(b.domNode),b}return f.formats=function(A){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return A.tagName.toLowerCase()},f.prototype.format=function(A,b){var m=u.query(A);m instanceof o.default?this.attributes.attribute(m,b):b&&m!=null&&(A!==this.statics.blotName||this.formats()[A]!==b)&&this.replaceWith(A,b)},f.prototype.formats=function(){var A=this.attributes.values(),b=this.statics.formats(this.domNode);return b!=null&&(A[this.statics.blotName]=b),A},f.prototype.replaceWith=function(A,b){var m=h.prototype.replaceWith.call(this,A,b);return this.attributes.copy(m),m},f.prototype.update=function(A,b){var m=this;h.prototype.update.call(this,A,b),A.some(function(v){return v.target===m.domNode&&v.type==="attributes"})&&this.attributes.build()},f.prototype.wrap=function(A,b){var m=h.prototype.wrap.call(this,A,b);return m instanceof f&&m.statics.scope===this.statics.scope&&this.attributes.move(m),m},f}(c.default);n.default=d},function(r,n,s){var i=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var f in h)h.hasOwnProperty(f)&&(d[f]=h[f])};return function(d,h){u(d,h);function f(){this.constructor=d}d.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(30),l=s(1),c=function(u){i(d,u);function d(){return u!==null&&u.apply(this,arguments)||this}return d.value=function(h){return!0},d.prototype.index=function(h,f){return this.domNode===h||this.domNode.compareDocumentPosition(h)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(f,1):-1},d.prototype.position=function(h,f){var A=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return h>0&&(A+=1),[this.parent.domNode,A]},d.prototype.value=function(){var h;return h={},h[this.statics.blotName]=this.statics.value(this.domNode)||!0,h},d.scope=l.Scope.INLINE_BLOT,d}(o.default);n.default=c},function(r,n,s){var i=s(11),o=s(3),l={attributes:{compose:function(u,d,h){typeof u!="object"&&(u={}),typeof d!="object"&&(d={});var f=o(!0,{},d);h||(f=Object.keys(f).reduce(function(b,m){return f[m]!=null&&(b[m]=f[m]),b},{}));for(var A in u)u[A]!==void 0&&d[A]===void 0&&(f[A]=u[A]);return Object.keys(f).length>0?f:void 0},diff:function(u,d){typeof u!="object"&&(u={}),typeof d!="object"&&(d={});var h=Object.keys(u).concat(Object.keys(d)).reduce(function(f,A){return i(u[A],d[A])||(f[A]=d[A]===void 0?null:d[A]),f},{});return Object.keys(h).length>0?h:void 0},transform:function(u,d,h){if(typeof u!="object")return d;if(typeof d=="object"){if(!h)return d;var f=Object.keys(d).reduce(function(A,b){return u[b]===void 0&&(A[b]=d[b]),A},{});return Object.keys(f).length>0?f:void 0}}},iterator:function(u){return new c(u)},length:function(u){return typeof u.delete=="number"?u.delete:typeof u.retain=="number"?u.retain:typeof u.insert=="string"?u.insert.length:1}};function c(u){this.ops=u,this.index=0,this.offset=0}c.prototype.hasNext=function(){return this.peekLength()<1/0},c.prototype.next=function(u){u||(u=1/0);var d=this.ops[this.index];if(d){var h=this.offset,f=l.length(d);if(u>=f-h?(u=f-h,this.index+=1,this.offset=0):this.offset+=u,typeof d.delete=="number")return{delete:u};var A={};return d.attributes&&(A.attributes=d.attributes),typeof d.retain=="number"?A.retain=u:typeof d.insert=="string"?A.insert=d.insert.substr(h,u):A.insert=d.insert,A}else return{retain:1/0}},c.prototype.peek=function(){return this.ops[this.index]},c.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},c.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},c.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var u=this.offset,d=this.index,h=this.next(),f=this.ops.slice(this.index);return this.offset=u,this.index=d,[h].concat(f)}else return[]},r.exports=l},function(r,n){var s=function(){function i(m,v){return v!=null&&m instanceof v}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var c;try{c=Promise}catch{c=function(){}}function u(m,v,p,g,y){typeof v=="object"&&(p=v.depth,g=v.prototype,y=v.includeNonEnumerable,v=v.circular);var x=[],w=[],N=typeof Buffer<"u";typeof v>"u"&&(v=!0),typeof p>"u"&&(p=1/0);function _(C,j){if(C===null)return null;if(j===0)return C;var E,S;if(typeof C!="object")return C;if(i(C,o))E=new o;else if(i(C,l))E=new l;else if(i(C,c))E=new c(function(V,K){C.then(function(B){V(_(B,j-1))},function(B){K(_(B,j-1))})});else if(u.__isArray(C))E=[];else if(u.__isRegExp(C))E=new RegExp(C.source,b(C)),C.lastIndex&&(E.lastIndex=C.lastIndex);else if(u.__isDate(C))E=new Date(C.getTime());else{if(N&&Buffer.isBuffer(C))return Buffer.allocUnsafe?E=Buffer.allocUnsafe(C.length):E=new Buffer(C.length),C.copy(E),E;i(C,Error)?E=Object.create(C):typeof g>"u"?(S=Object.getPrototypeOf(C),E=Object.create(S)):(E=Object.create(g),S=g)}if(v){var F=x.indexOf(C);if(F!=-1)return w[F];x.push(C),w.push(E)}i(C,o)&&C.forEach(function(V,K){var B=_(K,j-1),L=_(V,j-1);E.set(B,L)}),i(C,l)&&C.forEach(function(V){var K=_(V,j-1);E.add(K)});for(var I in C){var O;S&&(O=Object.getOwnPropertyDescriptor(S,I)),!(O&&O.set==null)&&(E[I]=_(C[I],j-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(C),I=0;I<M.length;I++){var P=M[I],X=Object.getOwnPropertyDescriptor(C,P);X&&!X.enumerable&&!y||(E[P]=_(C[P],j-1),X.enumerable||Object.defineProperty(E,P,{enumerable:!1}))}if(y)for(var J=Object.getOwnPropertyNames(C),I=0;I<J.length;I++){var H=J[I],X=Object.getOwnPropertyDescriptor(C,H);X&&X.enumerable||(E[H]=_(C[H],j-1),Object.defineProperty(E,H,{enumerable:!1}))}return E}return _(m,p)}u.clonePrototype=function(v){if(v===null)return null;var p=function(){};return p.prototype=v,new p};function d(m){return Object.prototype.toString.call(m)}u.__objToStr=d;function h(m){return typeof m=="object"&&d(m)==="[object Date]"}u.__isDate=h;function f(m){return typeof m=="object"&&d(m)==="[object Array]"}u.__isArray=f;function A(m){return typeof m=="object"&&d(m)==="[object RegExp]"}u.__isRegExp=A;function b(m){var v="";return m.global&&(v+="g"),m.ignoreCase&&(v+="i"),m.multiline&&(v+="m"),v}return u.__getRegExpFlags=b,u}();typeof r=="object"&&r.exports&&(r.exports=s)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function E(S,F){var I=[],O=!0,M=!1,P=void 0;try{for(var X=S[Symbol.iterator](),J;!(O=(J=X.next()).done)&&(I.push(J.value),!(F&&I.length===F));O=!0);}catch(H){M=!0,P=H}finally{try{!O&&X.return&&X.return()}finally{if(M)throw P}}return I}return function(S,F){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return E(S,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function E(S,F){for(var I=0;I<F.length;I++){var O=F[I];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(S,O.key,O)}}return function(S,F,I){return F&&E(S.prototype,F),I&&E(S,I),S}}(),l=function E(S,F,I){S===null&&(S=Function.prototype);var O=Object.getOwnPropertyDescriptor(S,F);if(O===void 0){var M=Object.getPrototypeOf(S);return M===null?void 0:E(M,F,I)}else{if("value"in O)return O.value;var P=O.get;return P===void 0?void 0:P.call(I)}},c=s(0),u=x(c),d=s(8),h=x(d),f=s(4),A=x(f),b=s(16),m=x(b),v=s(13),p=x(v),g=s(25),y=x(g);function x(E){return E&&E.__esModule?E:{default:E}}function w(E,S){if(!(E instanceof S))throw new TypeError("Cannot call a class as a function")}function N(E,S){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:E}function _(E,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);E.prototype=Object.create(S&&S.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(E,S):E.__proto__=S)}function C(E){return E instanceof A.default||E instanceof f.BlockEmbed}var j=function(E){_(S,E);function S(F,I){w(this,S);var O=N(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,F));return O.emitter=I.emitter,Array.isArray(I.whitelist)&&(O.whitelist=I.whitelist.reduce(function(M,P){return M[P]=!0,M},{})),O.domNode.addEventListener("DOMNodeInserted",function(){}),O.optimize(),O.enable(),O}return o(S,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(I,O){var M=this.line(I),P=i(M,2),X=P[0],J=P[1],H=this.line(I+O),V=i(H,1),K=V[0];if(l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"deleteAt",this).call(this,I,O),K!=null&&X!==K&&J>0){if(X instanceof f.BlockEmbed||K instanceof f.BlockEmbed){this.optimize();return}if(X instanceof p.default){var B=X.newlineIndex(X.length(),!0);if(B>-1&&(X=X.split(B+1),X===K)){this.optimize();return}}else if(K instanceof p.default){var L=K.newlineIndex(0);L>-1&&K.split(L+1)}var U=K.children.head instanceof m.default?null:K.children.head;X.moveChildren(K,U),X.remove()}this.optimize()}},{key:"enable",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",I)}},{key:"formatAt",value:function(I,O,M,P){this.whitelist!=null&&!this.whitelist[M]||(l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,I,O,M,P),this.optimize())}},{key:"insertAt",value:function(I,O,M){if(!(M!=null&&this.whitelist!=null&&!this.whitelist[O])){if(I>=this.length())if(M==null||u.default.query(O,u.default.Scope.BLOCK)==null){var P=u.default.create(this.statics.defaultChild);this.appendChild(P),M==null&&O.endsWith(`
`)&&(O=O.slice(0,-1)),P.insertAt(0,O,M)}else{var X=u.default.create(O,M);this.appendChild(X)}else l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,I,O,M);this.optimize()}}},{key:"insertBefore",value:function(I,O){if(I.statics.scope===u.default.Scope.INLINE_BLOT){var M=u.default.create(this.statics.defaultChild);M.appendChild(I),I=M}l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertBefore",this).call(this,I,O)}},{key:"leaf",value:function(I){return this.path(I).pop()||[null,-1]}},{key:"line",value:function(I){return I===this.length()?this.line(I-1):this.descendant(C,I)}},{key:"lines",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,M=function P(X,J,H){var V=[],K=H;return X.children.forEachAt(J,H,function(B,L,U){C(B)?V.push(B):B instanceof u.default.Container&&(V=V.concat(P(B,L,K))),K-=U}),V};return M(this,I,O)}},{key:"optimize",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,I,O),I.length>0&&this.emitter.emit(h.default.events.SCROLL_OPTIMIZE,I,O))}},{key:"path",value:function(I){return l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"path",this).call(this,I).slice(1)}},{key:"update",value:function(I){if(this.batch!==!0){var O=h.default.sources.USER;typeof I=="string"&&(O=I),Array.isArray(I)||(I=this.observer.takeRecords()),I.length>0&&this.emitter.emit(h.default.events.SCROLL_BEFORE_UPDATE,O,I),l(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"update",this).call(this,I.concat([])),I.length>0&&this.emitter.emit(h.default.events.SCROLL_UPDATE,O,I)}}}]),S}(u.default.Scroll);j.blotName="scroll",j.className="ql-editor",j.tagName="DIV",j.defaultChild="block",j.allowedChildren=[A.default,f.BlockEmbed,y.default],n.default=j},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},o=function(){function Q(z,G){var Z=[],R=!0,le=!1,ee=void 0;try{for(var _e=z[Symbol.iterator](),se;!(R=(se=_e.next()).done)&&(Z.push(se.value),!(G&&Z.length===G));R=!0);}catch(te){le=!0,ee=te}finally{try{!R&&_e.return&&_e.return()}finally{if(le)throw ee}}return Z}return function(z,G){if(Array.isArray(z))return z;if(Symbol.iterator in Object(z))return Q(z,G);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Q(z,G){for(var Z=0;Z<G.length;Z++){var R=G[Z];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(z,R.key,R)}}return function(z,G,Z){return G&&Q(z.prototype,G),Z&&Q(z,Z),z}}(),c=s(21),u=E(c),d=s(11),h=E(d),f=s(3),A=E(f),b=s(2),m=E(b),v=s(20),p=E(v),g=s(0),y=E(g),x=s(5),w=E(x),N=s(10),_=E(N),C=s(9),j=E(C);function E(Q){return Q&&Q.__esModule?Q:{default:Q}}function S(Q,z,G){return z in Q?Object.defineProperty(Q,z,{value:G,enumerable:!0,configurable:!0,writable:!0}):Q[z]=G,Q}function F(Q,z){if(!(Q instanceof z))throw new TypeError("Cannot call a class as a function")}function I(Q,z){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z&&(typeof z=="object"||typeof z=="function")?z:Q}function O(Q,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof z);Q.prototype=Object.create(z&&z.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),z&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,z):Q.__proto__=z)}var M=(0,_.default)("quill:keyboard"),P=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",X=function(Q){O(z,Q),l(z,null,[{key:"match",value:function(Z,R){return R=D(R),["altKey","ctrlKey","metaKey","shiftKey"].some(function(le){return!!R[le]!==Z[le]&&R[le]!==null})?!1:R.key===(Z.which||Z.keyCode)}}]);function z(G,Z){F(this,z);var R=I(this,(z.__proto__||Object.getPrototypeOf(z)).call(this,G,Z));return R.bindings={},Object.keys(R.options.bindings).forEach(function(le){le==="list autofill"&&G.scroll.whitelist!=null&&!G.scroll.whitelist.list||R.options.bindings[le]&&R.addBinding(R.options.bindings[le])}),R.addBinding({key:z.keys.ENTER,shiftKey:null},B),R.addBinding({key:z.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(R.addBinding({key:z.keys.BACKSPACE},{collapsed:!0},H),R.addBinding({key:z.keys.DELETE},{collapsed:!0},V)):(R.addBinding({key:z.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},H),R.addBinding({key:z.keys.DELETE},{collapsed:!0,suffix:/^.?$/},V)),R.addBinding({key:z.keys.BACKSPACE},{collapsed:!1},K),R.addBinding({key:z.keys.DELETE},{collapsed:!1},K),R.addBinding({key:z.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},H),R.listen(),R}return l(z,[{key:"addBinding",value:function(Z){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ee=D(Z);if(ee==null||ee.key==null)return M.warn("Attempted to add invalid keyboard binding",ee);typeof R=="function"&&(R={handler:R}),typeof le=="function"&&(le={handler:le}),ee=(0,A.default)(ee,R,le),this.bindings[ee.key]=this.bindings[ee.key]||[],this.bindings[ee.key].push(ee)}},{key:"listen",value:function(){var Z=this;this.quill.root.addEventListener("keydown",function(R){if(!R.defaultPrevented){var le=R.which||R.keyCode,ee=(Z.bindings[le]||[]).filter(function(Xe){return z.match(R,Xe)});if(ee.length!==0){var _e=Z.quill.getSelection();if(!(_e==null||!Z.quill.hasFocus())){var se=Z.quill.getLine(_e.index),te=o(se,2),Ne=te[0],Se=te[1],Ae=Z.quill.getLeaf(_e.index),ye=o(Ae,2),Le=ye[0],Re=ye[1],we=_e.length===0?[Le,Re]:Z.quill.getLeaf(_e.index+_e.length),Pe=o(we,2),ze=Pe[0],Ve=Pe[1],lt=Le instanceof y.default.Text?Le.value().slice(0,Re):"",pe=ze instanceof y.default.Text?ze.value().slice(Ve):"",Fe={collapsed:_e.length===0,empty:_e.length===0&&Ne.length()<=1,format:Z.quill.getFormat(_e),offset:Se,prefix:lt,suffix:pe},Ke=ee.some(function(Xe){if(Xe.collapsed!=null&&Xe.collapsed!==Fe.collapsed||Xe.empty!=null&&Xe.empty!==Fe.empty||Xe.offset!=null&&Xe.offset!==Fe.offset)return!1;if(Array.isArray(Xe.format)){if(Xe.format.every(function(tt){return Fe.format[tt]==null}))return!1}else if(i(Xe.format)==="object"&&!Object.keys(Xe.format).every(function(tt){return Xe.format[tt]===!0?Fe.format[tt]!=null:Xe.format[tt]===!1?Fe.format[tt]==null:(0,h.default)(Xe.format[tt],Fe.format[tt])}))return!1;return Xe.prefix!=null&&!Xe.prefix.test(Fe.prefix)||Xe.suffix!=null&&!Xe.suffix.test(Fe.suffix)?!1:Xe.handler.call(Z,_e,Fe)!==!0});Ke&&R.preventDefault()}}}})}}]),z}(j.default);X.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},X.DEFAULTS={bindings:{bold:U("bold"),italic:U("italic"),underline:U("underline"),indent:{key:X.keys.TAB,format:["blockquote","indent","list"],handler:function(z,G){if(G.collapsed&&G.offset!==0)return!0;this.quill.format("indent","+1",w.default.sources.USER)}},outdent:{key:X.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(z,G){if(G.collapsed&&G.offset!==0)return!0;this.quill.format("indent","-1",w.default.sources.USER)}},"outdent backspace":{key:X.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(z,G){G.format.indent!=null?this.quill.format("indent","-1",w.default.sources.USER):G.format.list!=null&&this.quill.format("list",!1,w.default.sources.USER)}},"indent code-block":L(!0),"outdent code-block":L(!1),"remove tab":{key:X.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(z){this.quill.deleteText(z.index-1,1,w.default.sources.USER)}},tab:{key:X.keys.TAB,handler:function(z){this.quill.history.cutoff();var G=new m.default().retain(z.index).delete(z.length).insert("	");this.quill.updateContents(G,w.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(z.index+1,w.default.sources.SILENT)}},"list empty enter":{key:X.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(z,G){this.quill.format("list",!1,w.default.sources.USER),G.format.indent&&this.quill.format("indent",!1,w.default.sources.USER)}},"checklist enter":{key:X.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(z){var G=this.quill.getLine(z.index),Z=o(G,2),R=Z[0],le=Z[1],ee=(0,A.default)({},R.formats(),{list:"checked"}),_e=new m.default().retain(z.index).insert(`
`,ee).retain(R.length()-le-1).retain(1,{list:"unchecked"});this.quill.updateContents(_e,w.default.sources.USER),this.quill.setSelection(z.index+1,w.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:X.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(z,G){var Z=this.quill.getLine(z.index),R=o(Z,2),le=R[0],ee=R[1],_e=new m.default().retain(z.index).insert(`
`,G.format).retain(le.length()-ee-1).retain(1,{header:null});this.quill.updateContents(_e,w.default.sources.USER),this.quill.setSelection(z.index+1,w.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(z,G){var Z=G.prefix.length,R=this.quill.getLine(z.index),le=o(R,2),ee=le[0],_e=le[1];if(_e>Z)return!0;var se=void 0;switch(G.prefix.trim()){case"[]":case"[ ]":se="unchecked";break;case"[x]":se="checked";break;case"-":case"*":se="bullet";break;default:se="ordered"}this.quill.insertText(z.index," ",w.default.sources.USER),this.quill.history.cutoff();var te=new m.default().retain(z.index-_e).delete(Z+1).retain(ee.length()-2-_e).retain(1,{list:se});this.quill.updateContents(te,w.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(z.index-Z,w.default.sources.SILENT)}},"code exit":{key:X.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(z){var G=this.quill.getLine(z.index),Z=o(G,2),R=Z[0],le=Z[1],ee=new m.default().retain(z.index+R.length()-le-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(ee,w.default.sources.USER)}},"embed left":J(X.keys.LEFT,!1),"embed left shift":J(X.keys.LEFT,!0),"embed right":J(X.keys.RIGHT,!1),"embed right shift":J(X.keys.RIGHT,!0)}};function J(Q,z){var G,Z=Q===X.keys.LEFT?"prefix":"suffix";return G={key:Q,shiftKey:z,altKey:null},S(G,Z,/^$/),S(G,"handler",function(le){var ee=le.index;Q===X.keys.RIGHT&&(ee+=le.length+1);var _e=this.quill.getLeaf(ee),se=o(_e,1),te=se[0];return te instanceof y.default.Embed?(Q===X.keys.LEFT?z?this.quill.setSelection(le.index-1,le.length+1,w.default.sources.USER):this.quill.setSelection(le.index-1,w.default.sources.USER):z?this.quill.setSelection(le.index,le.length+1,w.default.sources.USER):this.quill.setSelection(le.index+le.length+1,w.default.sources.USER),!1):!0}),G}function H(Q,z){if(!(Q.index===0||this.quill.getLength()<=1)){var G=this.quill.getLine(Q.index),Z=o(G,1),R=Z[0],le={};if(z.offset===0){var ee=this.quill.getLine(Q.index-1),_e=o(ee,1),se=_e[0];if(se!=null&&se.length()>1){var te=R.formats(),Ne=this.quill.getFormat(Q.index-1,1);le=p.default.attributes.diff(te,Ne)||{}}}var Se=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(z.prefix)?2:1;this.quill.deleteText(Q.index-Se,Se,w.default.sources.USER),Object.keys(le).length>0&&this.quill.formatLine(Q.index-Se,Se,le,w.default.sources.USER),this.quill.focus()}}function V(Q,z){var G=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(z.suffix)?2:1;if(!(Q.index>=this.quill.getLength()-G)){var Z={},R=0,le=this.quill.getLine(Q.index),ee=o(le,1),_e=ee[0];if(z.offset>=_e.length()-1){var se=this.quill.getLine(Q.index+1),te=o(se,1),Ne=te[0];if(Ne){var Se=_e.formats(),Ae=this.quill.getFormat(Q.index,1);Z=p.default.attributes.diff(Se,Ae)||{},R=Ne.length()}}this.quill.deleteText(Q.index,G,w.default.sources.USER),Object.keys(Z).length>0&&this.quill.formatLine(Q.index+R-1,G,Z,w.default.sources.USER)}}function K(Q){var z=this.quill.getLines(Q),G={};if(z.length>1){var Z=z[0].formats(),R=z[z.length-1].formats();G=p.default.attributes.diff(R,Z)||{}}this.quill.deleteText(Q,w.default.sources.USER),Object.keys(G).length>0&&this.quill.formatLine(Q.index,1,G,w.default.sources.USER),this.quill.setSelection(Q.index,w.default.sources.SILENT),this.quill.focus()}function B(Q,z){var G=this;Q.length>0&&this.quill.scroll.deleteAt(Q.index,Q.length);var Z=Object.keys(z.format).reduce(function(R,le){return y.default.query(le,y.default.Scope.BLOCK)&&!Array.isArray(z.format[le])&&(R[le]=z.format[le]),R},{});this.quill.insertText(Q.index,`
`,Z,w.default.sources.USER),this.quill.setSelection(Q.index+1,w.default.sources.SILENT),this.quill.focus(),Object.keys(z.format).forEach(function(R){Z[R]==null&&(Array.isArray(z.format[R])||R!=="link"&&G.quill.format(R,z.format[R],w.default.sources.USER))})}function L(Q){return{key:X.keys.TAB,shiftKey:!Q,format:{"code-block":!0},handler:function(G){var Z=y.default.query("code-block"),R=G.index,le=G.length,ee=this.quill.scroll.descendant(Z,R),_e=o(ee,2),se=_e[0],te=_e[1];if(se!=null){var Ne=this.quill.getIndex(se),Se=se.newlineIndex(te,!0)+1,Ae=se.newlineIndex(Ne+te+le),ye=se.domNode.textContent.slice(Se,Ae).split(`
`);te=0,ye.forEach(function(Le,Re){Q?(se.insertAt(Se+te,Z.TAB),te+=Z.TAB.length,Re===0?R+=Z.TAB.length:le+=Z.TAB.length):Le.startsWith(Z.TAB)&&(se.deleteAt(Se+te,Z.TAB.length),te-=Z.TAB.length,Re===0?R-=Z.TAB.length:le-=Z.TAB.length),te+=Le.length+1}),this.quill.update(w.default.sources.USER),this.quill.setSelection(R,le,w.default.sources.SILENT)}}}}function U(Q){return{key:Q[0].toUpperCase(),shortKey:!0,handler:function(G,Z){this.quill.format(Q,!Z.format[Q],w.default.sources.USER)}}}function D(Q){if(typeof Q=="string"||typeof Q=="number")return D({key:Q});if((typeof Q>"u"?"undefined":i(Q))==="object"&&(Q=(0,u.default)(Q,!1)),typeof Q.key=="string")if(X.keys[Q.key.toUpperCase()]!=null)Q.key=X.keys[Q.key.toUpperCase()];else if(Q.key.length===1)Q.key=Q.key.toUpperCase().charCodeAt(0);else return null;return Q.shortKey&&(Q[P]=Q.shortKey,delete Q.shortKey),Q}n.default=X,n.SHORTKEY=P},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function p(g,y){var x=[],w=!0,N=!1,_=void 0;try{for(var C=g[Symbol.iterator](),j;!(w=(j=C.next()).done)&&(x.push(j.value),!(y&&x.length===y));w=!0);}catch(E){N=!0,_=E}finally{try{!w&&C.return&&C.return()}finally{if(N)throw _}}return x}return function(g,y){if(Array.isArray(g))return g;if(Symbol.iterator in Object(g))return p(g,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function p(g,y,x){g===null&&(g=Function.prototype);var w=Object.getOwnPropertyDescriptor(g,y);if(w===void 0){var N=Object.getPrototypeOf(g);return N===null?void 0:p(N,y,x)}else{if("value"in w)return w.value;var _=w.get;return _===void 0?void 0:_.call(x)}},l=function(){function p(g,y){for(var x=0;x<y.length;x++){var w=y[x];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}return function(g,y,x){return y&&p(g.prototype,y),x&&p(g,x),g}}(),c=s(0),u=f(c),d=s(7),h=f(d);function f(p){return p&&p.__esModule?p:{default:p}}function A(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function b(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function m(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var v=function(p){m(g,p),l(g,null,[{key:"value",value:function(){}}]);function g(y,x){A(this,g);var w=b(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return w.selection=x,w.textNode=document.createTextNode(g.CONTENTS),w.domNode.appendChild(w.textNode),w._length=0,w}return l(g,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(x,w){if(this._length!==0)return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"format",this).call(this,x,w);for(var N=this,_=0;N!=null&&N.statics.scope!==u.default.Scope.BLOCK_BLOT;)_+=N.offset(N.parent),N=N.parent;N!=null&&(this._length=g.CONTENTS.length,N.optimize(),N.formatAt(_,g.CONTENTS.length,x,w),this._length=0)}},{key:"index",value:function(x,w){return x===this.textNode?0:o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"index",this).call(this,x,w)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var x=this.textNode,w=this.selection.getNativeRange(),N=void 0,_=void 0,C=void 0;if(w!=null&&w.start.node===x&&w.end.node===x){var j=[x,w.start.offset,w.end.offset];N=j[0],_=j[1],C=j[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==g.CONTENTS){var E=this.textNode.data.split(g.CONTENTS).join("");this.next instanceof h.default?(N=this.next.domNode,this.next.insertAt(0,E),this.textNode.data=g.CONTENTS):(this.textNode.data=E,this.parent.insertBefore(u.default.create(this.textNode),this),this.textNode=document.createTextNode(g.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),_!=null){var S=[_,C].map(function(I){return Math.max(0,Math.min(N.data.length,I-1))}),F=i(S,2);return _=F[0],C=F[1],{startNode:N,startOffset:_,endNode:N,endOffset:C}}}}},{key:"update",value:function(x,w){var N=this;if(x.some(function(C){return C.type==="characterData"&&C.target===N.textNode})){var _=this.restore();_&&(w.range=_)}}},{key:"value",value:function(){return""}}]),g}(u.default.Embed);v.blotName="cursor",v.className="ql-cursor",v.tagName="span",v.CONTENTS="\uFEFF",n.default=v},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(0),o=u(i),l=s(4),c=u(l);function u(b){return b&&b.__esModule?b:{default:b}}function d(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function f(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var A=function(b){f(m,b);function m(){return d(this,m),h(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return m}(o.default.Container);A.allowedChildren=[c.default,l.BlockEmbed,A],n.default=A},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var i=function(){function v(p,g){for(var y=0;y<g.length;y++){var x=g[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,g,y){return g&&v(p.prototype,g),y&&v(p,y),p}}(),o=function v(p,g,y){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,g);if(x===void 0){var w=Object.getPrototypeOf(p);return w===null?void 0:v(w,g,y)}else{if("value"in x)return x.value;var N=x.get;return N===void 0?void 0:N.call(y)}},l=s(0),c=u(l);function u(v){return v&&v.__esModule?v:{default:v}}function d(v,p){if(!(v instanceof p))throw new TypeError("Cannot call a class as a function")}function h(v,p){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:v}function f(v,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);v.prototype=Object.create(p&&p.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(v,p):v.__proto__=p)}var A=function(v){f(p,v);function p(){return d(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return i(p,[{key:"value",value:function(y){var x=o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"value",this).call(this,y);return x.startsWith("rgb(")?(x=x.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+x.split(",").map(function(w){return("00"+parseInt(w).toString(16)).slice(-2)}).join("")):x}}]),p}(c.default.Attributor.Style),b=new c.default.Attributor.Class("color","ql-color",{scope:c.default.Scope.INLINE}),m=new A("color","color",{scope:c.default.Scope.INLINE});n.ColorAttributor=A,n.ColorClass=b,n.ColorStyle=m},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var i=function(){function m(v,p){for(var g=0;g<p.length;g++){var y=p[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(v,y.key,y)}}return function(v,p,g){return p&&m(v.prototype,p),g&&m(v,g),v}}(),o=function m(v,p,g){v===null&&(v=Function.prototype);var y=Object.getOwnPropertyDescriptor(v,p);if(y===void 0){var x=Object.getPrototypeOf(v);return x===null?void 0:m(x,p,g)}else{if("value"in y)return y.value;var w=y.get;return w===void 0?void 0:w.call(g)}},l=s(6),c=u(l);function u(m){return m&&m.__esModule?m:{default:m}}function d(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function h(m,v){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:m}function f(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);m.prototype=Object.create(v&&v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(m,v):m.__proto__=v)}var A=function(m){f(v,m);function v(){return d(this,v),h(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return i(v,[{key:"format",value:function(g,y){if(g!==this.statics.blotName||!y)return o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"format",this).call(this,g,y);y=this.constructor.sanitize(y),this.domNode.setAttribute("href",y)}}],[{key:"create",value:function(g){var y=o(v.__proto__||Object.getPrototypeOf(v),"create",this).call(this,g);return g=this.sanitize(g),y.setAttribute("href",g),y.setAttribute("rel","noopener noreferrer"),y.setAttribute("target","_blank"),y}},{key:"formats",value:function(g){return g.getAttribute("href")}},{key:"sanitize",value:function(g){return b(g,this.PROTOCOL_WHITELIST)?g:this.SANITIZED_URL}}]),v}(c.default);A.blotName="link",A.tagName="A",A.SANITIZED_URL="about:blank",A.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function b(m,v){var p=document.createElement("a");p.href=m;var g=p.href.slice(0,p.href.indexOf(":"));return v.indexOf(g)>-1}n.default=A,n.sanitize=b},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},o=function(){function v(p,g){for(var y=0;y<g.length;y++){var x=g[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,g,y){return g&&v(p.prototype,g),y&&v(p,y),p}}(),l=s(23),c=h(l),u=s(107),d=h(u);function h(v){return v&&v.__esModule?v:{default:v}}function f(v,p){if(!(v instanceof p))throw new TypeError("Cannot call a class as a function")}var A=0;function b(v,p){v.setAttribute(p,v.getAttribute(p)!=="true")}var m=function(){function v(p){var g=this;f(this,v),this.select=p,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){g.togglePicker()}),this.label.addEventListener("keydown",function(y){switch(y.keyCode){case c.default.keys.ENTER:g.togglePicker();break;case c.default.keys.ESCAPE:g.escape(),y.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(v,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),b(this.label,"aria-expanded"),b(this.options,"aria-hidden")}},{key:"buildItem",value:function(g){var y=this,x=document.createElement("span");return x.tabIndex="0",x.setAttribute("role","button"),x.classList.add("ql-picker-item"),g.hasAttribute("value")&&x.setAttribute("data-value",g.getAttribute("value")),g.textContent&&x.setAttribute("data-label",g.textContent),x.addEventListener("click",function(){y.selectItem(x,!0)}),x.addEventListener("keydown",function(w){switch(w.keyCode){case c.default.keys.ENTER:y.selectItem(x,!0),w.preventDefault();break;case c.default.keys.ESCAPE:y.escape(),w.preventDefault();break}}),x}},{key:"buildLabel",value:function(){var g=document.createElement("span");return g.classList.add("ql-picker-label"),g.innerHTML=d.default,g.tabIndex="0",g.setAttribute("role","button"),g.setAttribute("aria-expanded","false"),this.container.appendChild(g),g}},{key:"buildOptions",value:function(){var g=this,y=document.createElement("span");y.classList.add("ql-picker-options"),y.setAttribute("aria-hidden","true"),y.tabIndex="-1",y.id="ql-picker-options-"+A,A+=1,this.label.setAttribute("aria-controls",y.id),this.options=y,[].slice.call(this.select.options).forEach(function(x){var w=g.buildItem(x);y.appendChild(w),x.selected===!0&&g.selectItem(w)}),this.container.appendChild(y)}},{key:"buildPicker",value:function(){var g=this;[].slice.call(this.select.attributes).forEach(function(y){g.container.setAttribute(y.name,y.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var g=this;this.close(),setTimeout(function(){return g.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(g){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,x=this.container.querySelector(".ql-selected");if(g!==x&&(x!=null&&x.classList.remove("ql-selected"),g!=null&&(g.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(g.parentNode.children,g),g.hasAttribute("data-value")?this.label.setAttribute("data-value",g.getAttribute("data-value")):this.label.removeAttribute("data-value"),g.hasAttribute("data-label")?this.label.setAttribute("data-label",g.getAttribute("data-label")):this.label.removeAttribute("data-label"),y))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":i(Event))==="object"){var w=document.createEvent("Event");w.initEvent("change",!0,!0),this.select.dispatchEvent(w)}this.close()}}},{key:"update",value:function(){var g=void 0;if(this.select.selectedIndex>-1){var y=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];g=this.select.options[this.select.selectedIndex],this.selectItem(y)}else this.selectItem(null);var x=g!=null&&g!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",x)}}]),v}();n.default=m},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(0),o=M(i),l=s(5),c=M(l),u=s(4),d=M(u),h=s(16),f=M(h),A=s(25),b=M(A),m=s(24),v=M(m),p=s(35),g=M(p),y=s(6),x=M(y),w=s(22),N=M(w),_=s(7),C=M(_),j=s(55),E=M(j),S=s(42),F=M(S),I=s(23),O=M(I);function M(P){return P&&P.__esModule?P:{default:P}}c.default.register({"blots/block":d.default,"blots/block/embed":u.BlockEmbed,"blots/break":f.default,"blots/container":b.default,"blots/cursor":v.default,"blots/embed":g.default,"blots/inline":x.default,"blots/scroll":N.default,"blots/text":C.default,"modules/clipboard":E.default,"modules/history":F.default,"modules/keyboard":O.default}),o.default.register(d.default,f.default,v.default,x.default,N.default,C.default),n.default=c.default},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(1),o=function(){function l(c){this.domNode=c,this.domNode[i.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(c){if(this.tagName==null)throw new i.ParchmentError("Blot definition missing tagName");var u;return Array.isArray(this.tagName)?(typeof c=="string"&&(c=c.toUpperCase(),parseInt(c).toString()===c&&(c=parseInt(c))),typeof c=="number"?u=document.createElement(this.tagName[c-1]):this.tagName.indexOf(c)>-1?u=document.createElement(c):u=document.createElement(this.tagName[0])):u=document.createElement(this.tagName),this.className&&u.classList.add(this.className),u},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var c=this.domNode.cloneNode(!1);return i.create(c)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[i.DATA_KEY]},l.prototype.deleteAt=function(c,u){var d=this.isolate(c,u);d.remove()},l.prototype.formatAt=function(c,u,d,h){var f=this.isolate(c,u);if(i.query(d,i.Scope.BLOT)!=null&&h)f.wrap(d,h);else if(i.query(d,i.Scope.ATTRIBUTE)!=null){var A=i.create(this.statics.scope);f.wrap(A),A.format(d,h)}},l.prototype.insertAt=function(c,u,d){var h=d==null?i.create("text",u):i.create(u,d),f=this.split(c);this.parent.insertBefore(h,f)},l.prototype.insertInto=function(c,u){u===void 0&&(u=null),this.parent!=null&&this.parent.children.remove(this);var d=null;c.children.insertBefore(this,u),u!=null&&(d=u.domNode),(this.domNode.parentNode!=c.domNode||this.domNode.nextSibling!=d)&&c.domNode.insertBefore(this.domNode,d),this.parent=c,this.attach()},l.prototype.isolate=function(c,u){var d=this.split(c);return d.split(u),d},l.prototype.length=function(){return 1},l.prototype.offset=function(c){return c===void 0&&(c=this.parent),this.parent==null||this==c?0:this.parent.children.offset(this)+this.parent.offset(c)},l.prototype.optimize=function(c){this.domNode[i.DATA_KEY]!=null&&delete this.domNode[i.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(c){c.parent!=null&&(c.parent.insertBefore(this,c.next),c.remove())},l.prototype.replaceWith=function(c,u){var d=typeof c=="string"?i.create(c,u):c;return d.replace(this),d},l.prototype.split=function(c,u){return c===0?this:this.next},l.prototype.update=function(c,u){},l.prototype.wrap=function(c,u){var d=typeof c=="string"?i.create(c,u):c;return this.parent!=null&&this.parent.insertBefore(d,this.next),d.appendChild(this),d},l.blotName="abstract",l}();n.default=o},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(12),o=s(32),l=s(33),c=s(1),u=function(){function d(h){this.attributes={},this.domNode=h,this.build()}return d.prototype.attribute=function(h,f){f?h.add(this.domNode,f)&&(h.value(this.domNode)!=null?this.attributes[h.attrName]=h:delete this.attributes[h.attrName]):(h.remove(this.domNode),delete this.attributes[h.attrName])},d.prototype.build=function(){var h=this;this.attributes={};var f=i.default.keys(this.domNode),A=o.default.keys(this.domNode),b=l.default.keys(this.domNode);f.concat(A).concat(b).forEach(function(m){var v=c.query(m,c.Scope.ATTRIBUTE);v instanceof i.default&&(h.attributes[v.attrName]=v)})},d.prototype.copy=function(h){var f=this;Object.keys(this.attributes).forEach(function(A){var b=f.attributes[A].value(f.domNode);h.format(A,b)})},d.prototype.move=function(h){var f=this;this.copy(h),Object.keys(this.attributes).forEach(function(A){f.attributes[A].remove(f.domNode)}),this.attributes={}},d.prototype.values=function(){var h=this;return Object.keys(this.attributes).reduce(function(f,A){return f[A]=h.attributes[A].value(h.domNode),f},{})},d}();n.default=u},function(r,n,s){var i=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var f in h)h.hasOwnProperty(f)&&(d[f]=h[f])};return function(d,h){u(d,h);function f(){this.constructor=d}d.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(12);function l(u,d){var h=u.getAttribute("class")||"";return h.split(/\s+/).filter(function(f){return f.indexOf(d+"-")===0})}var c=function(u){i(d,u);function d(){return u!==null&&u.apply(this,arguments)||this}return d.keys=function(h){return(h.getAttribute("class")||"").split(/\s+/).map(function(f){return f.split("-").slice(0,-1).join("-")})},d.prototype.add=function(h,f){return this.canAdd(h,f)?(this.remove(h),h.classList.add(this.keyName+"-"+f),!0):!1},d.prototype.remove=function(h){var f=l(h,this.keyName);f.forEach(function(A){h.classList.remove(A)}),h.classList.length===0&&h.removeAttribute("class")},d.prototype.value=function(h){var f=l(h,this.keyName)[0]||"",A=f.slice(this.keyName.length+1);return this.canAdd(h,A)?A:""},d}(o.default);n.default=c},function(r,n,s){var i=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var f in h)h.hasOwnProperty(f)&&(d[f]=h[f])};return function(d,h){u(d,h);function f(){this.constructor=d}d.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(12);function l(u){var d=u.split("-"),h=d.slice(1).map(function(f){return f[0].toUpperCase()+f.slice(1)}).join("");return d[0]+h}var c=function(u){i(d,u);function d(){return u!==null&&u.apply(this,arguments)||this}return d.keys=function(h){return(h.getAttribute("style")||"").split(";").map(function(f){var A=f.split(":");return A[0].trim()})},d.prototype.add=function(h,f){return this.canAdd(h,f)?(h.style[l(this.keyName)]=f,!0):!1},d.prototype.remove=function(h){h.style[l(this.keyName)]="",h.getAttribute("style")||h.removeAttribute("style")},d.prototype.value=function(h){var f=h.style[l(this.keyName)];return this.canAdd(h,f)?f:""},d}(o.default);n.default=c},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function c(u,d){for(var h=0;h<d.length;h++){var f=d[h];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}return function(u,d,h){return d&&c(u.prototype,d),h&&c(u,h),u}}();function o(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(u,d){o(this,c),this.quill=u,this.options=d,this.modules={}}return i(c,[{key:"init",value:function(){var d=this;Object.keys(this.options.modules).forEach(function(h){d.modules[h]==null&&d.addModule(h)})}},{key:"addModule",value:function(d){var h=this.quill.constructor.import("modules/"+d);return this.modules[d]=new h(this.quill,this.options.modules[d]||{}),this.modules[d]}}]),c}();l.DEFAULTS={modules:{}},l.themes={default:l},n.default=l},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function p(g,y){for(var x=0;x<y.length;x++){var w=y[x];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}return function(g,y,x){return y&&p(g.prototype,y),x&&p(g,x),g}}(),o=function p(g,y,x){g===null&&(g=Function.prototype);var w=Object.getOwnPropertyDescriptor(g,y);if(w===void 0){var N=Object.getPrototypeOf(g);return N===null?void 0:p(N,y,x)}else{if("value"in w)return w.value;var _=w.get;return _===void 0?void 0:_.call(x)}},l=s(0),c=h(l),u=s(7),d=h(u);function h(p){return p&&p.__esModule?p:{default:p}}function f(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function A(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function b(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var m="\uFEFF",v=function(p){b(g,p);function g(y){f(this,g);var x=A(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return x.contentNode=document.createElement("span"),x.contentNode.setAttribute("contenteditable",!1),[].slice.call(x.domNode.childNodes).forEach(function(w){x.contentNode.appendChild(w)}),x.leftGuard=document.createTextNode(m),x.rightGuard=document.createTextNode(m),x.domNode.appendChild(x.leftGuard),x.domNode.appendChild(x.contentNode),x.domNode.appendChild(x.rightGuard),x}return i(g,[{key:"index",value:function(x,w){return x===this.leftGuard?0:x===this.rightGuard?1:o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"index",this).call(this,x,w)}},{key:"restore",value:function(x){var w=void 0,N=void 0,_=x.data.split(m).join("");if(x===this.leftGuard)if(this.prev instanceof d.default){var C=this.prev.length();this.prev.insertAt(C,_),w={startNode:this.prev.domNode,startOffset:C+_.length}}else N=document.createTextNode(_),this.parent.insertBefore(c.default.create(N),this),w={startNode:N,startOffset:_.length};else x===this.rightGuard&&(this.next instanceof d.default?(this.next.insertAt(0,_),w={startNode:this.next.domNode,startOffset:_.length}):(N=document.createTextNode(_),this.parent.insertBefore(c.default.create(N),this.next),w={startNode:N,startOffset:_.length}));return x.data=m,w}},{key:"update",value:function(x,w){var N=this;x.forEach(function(_){if(_.type==="characterData"&&(_.target===N.leftGuard||_.target===N.rightGuard)){var C=N.restore(_.target);C&&(w.range=C)}})}}]),g}(c.default.Embed);n.default=v},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var i=s(0),o=l(i);function l(f){return f&&f.__esModule?f:{default:f}}var c={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},u=new o.default.Attributor.Attribute("align","align",c),d=new o.default.Attributor.Class("align","ql-align",c),h=new o.default.Attributor.Style("align","text-align",c);n.AlignAttribute=u,n.AlignClass=d,n.AlignStyle=h},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var i=s(0),o=c(i),l=s(26);function c(h){return h&&h.__esModule?h:{default:h}}var u=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),d=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=u,n.BackgroundStyle=d},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var i=s(0),o=l(i);function l(f){return f&&f.__esModule?f:{default:f}}var c={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},u=new o.default.Attributor.Attribute("direction","dir",c),d=new o.default.Attributor.Class("direction","ql-direction",c),h=new o.default.Attributor.Style("direction","direction",c);n.DirectionAttribute=u,n.DirectionClass=d,n.DirectionStyle=h},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var i=function(){function p(g,y){for(var x=0;x<y.length;x++){var w=y[x];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}return function(g,y,x){return y&&p(g.prototype,y),x&&p(g,x),g}}(),o=function p(g,y,x){g===null&&(g=Function.prototype);var w=Object.getOwnPropertyDescriptor(g,y);if(w===void 0){var N=Object.getPrototypeOf(g);return N===null?void 0:p(N,y,x)}else{if("value"in w)return w.value;var _=w.get;return _===void 0?void 0:_.call(x)}},l=s(0),c=u(l);function u(p){return p&&p.__esModule?p:{default:p}}function d(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function h(p,g){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:p}function f(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}var A={scope:c.default.Scope.INLINE,whitelist:["serif","monospace"]},b=new c.default.Attributor.Class("font","ql-font",A),m=function(p){f(g,p);function g(){return d(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return i(g,[{key:"value",value:function(x){return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"value",this).call(this,x).replace(/["']/g,"")}}]),g}(c.default.Attributor.Style),v=new m("font","font-family",A);n.FontStyle=v,n.FontClass=b},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var i=s(0),o=l(i);function l(d){return d&&d.__esModule?d:{default:d}}var c=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),u=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=c,n.SizeStyle=u},function(r,n,s){r.exports={align:{"":s(76),center:s(77),right:s(78),justify:s(79)},background:s(80),blockquote:s(81),bold:s(82),clean:s(83),code:s(58),"code-block":s(58),color:s(84),direction:{"":s(85),rtl:s(86)},float:{center:s(87),full:s(88),left:s(89),right:s(90)},formula:s(91),header:{1:s(92),2:s(93)},italic:s(94),image:s(95),indent:{"+1":s(96),"-1":s(97)},link:s(98),list:{ordered:s(99),bullet:s(100),check:s(101)},script:{sub:s(102),super:s(103)},strike:s(104),underline:s(105),video:s(106)}},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var i=function(){function y(x,w){for(var N=0;N<w.length;N++){var _=w[N];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,_.key,_)}}return function(x,w,N){return w&&y(x.prototype,w),N&&y(x,N),x}}(),o=s(0),l=f(o),c=s(5),u=f(c),d=s(9),h=f(d);function f(y){return y&&y.__esModule?y:{default:y}}function A(y,x){if(!(y instanceof x))throw new TypeError("Cannot call a class as a function")}function b(y,x){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:y}function m(y,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(y,x):y.__proto__=x)}var v=function(y){m(x,y);function x(w,N){A(this,x);var _=b(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,w,N));return _.lastRecorded=0,_.ignoreChange=!1,_.clear(),_.quill.on(u.default.events.EDITOR_CHANGE,function(C,j,E,S){C!==u.default.events.TEXT_CHANGE||_.ignoreChange||(!_.options.userOnly||S===u.default.sources.USER?_.record(j,E):_.transform(j))}),_.quill.keyboard.addBinding({key:"Z",shortKey:!0},_.undo.bind(_)),_.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},_.redo.bind(_)),/Win/i.test(navigator.platform)&&_.quill.keyboard.addBinding({key:"Y",shortKey:!0},_.redo.bind(_)),_}return i(x,[{key:"change",value:function(N,_){if(this.stack[N].length!==0){var C=this.stack[N].pop();this.stack[_].push(C),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(C[N],u.default.sources.USER),this.ignoreChange=!1;var j=g(C[N]);this.quill.setSelection(j)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(N,_){if(N.ops.length!==0){this.stack.redo=[];var C=this.quill.getContents().diff(_),j=Date.now();if(this.lastRecorded+this.options.delay>j&&this.stack.undo.length>0){var E=this.stack.undo.pop();C=C.compose(E.undo),N=E.redo.compose(N)}else this.lastRecorded=j;this.stack.undo.push({redo:N,undo:C}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(N){this.stack.undo.forEach(function(_){_.undo=N.transform(_.undo,!0),_.redo=N.transform(_.redo,!0)}),this.stack.redo.forEach(function(_){_.undo=N.transform(_.undo,!0),_.redo=N.transform(_.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),x}(h.default);v.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function p(y){var x=y.ops[y.ops.length-1];return x==null?!1:x.insert!=null?typeof x.insert=="string"&&x.insert.endsWith(`
`):x.attributes!=null?Object.keys(x.attributes).some(function(w){return l.default.query(w,l.default.Scope.BLOCK)!=null}):!1}function g(y){var x=y.reduce(function(N,_){return N+=_.delete||0,N},0),w=y.length()-x;return p(y)&&(w-=1),w}n.default=v,n.getLastChangeIndex=g},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var i=function(){function B(L,U){for(var D=0;D<U.length;D++){var Q=U[D];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(L,Q.key,Q)}}return function(L,U,D){return U&&B(L.prototype,U),D&&B(L,D),L}}(),o=function B(L,U,D){L===null&&(L=Function.prototype);var Q=Object.getOwnPropertyDescriptor(L,U);if(Q===void 0){var z=Object.getPrototypeOf(L);return z===null?void 0:B(z,U,D)}else{if("value"in Q)return Q.value;var G=Q.get;return G===void 0?void 0:G.call(D)}},l=s(3),c=j(l),u=s(2),d=j(u),h=s(8),f=j(h),A=s(23),b=j(A),m=s(34),v=j(m),p=s(59),g=j(p),y=s(60),x=j(y),w=s(28),N=j(w),_=s(61),C=j(_);function j(B){return B&&B.__esModule?B:{default:B}}function E(B,L){if(!(B instanceof L))throw new TypeError("Cannot call a class as a function")}function S(B,L){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L&&(typeof L=="object"||typeof L=="function")?L:B}function F(B,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof L);B.prototype=Object.create(L&&L.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),L&&(Object.setPrototypeOf?Object.setPrototypeOf(B,L):B.__proto__=L)}var I=[!1,"center","right","justify"],O=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],M=[!1,"serif","monospace"],P=["1","2","3",!1],X=["small",!1,"large","huge"],J=function(B){F(L,B);function L(U,D){E(this,L);var Q=S(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,U,D)),z=function G(Z){if(!document.body.contains(U.root))return document.body.removeEventListener("click",G);Q.tooltip!=null&&!Q.tooltip.root.contains(Z.target)&&document.activeElement!==Q.tooltip.textbox&&!Q.quill.hasFocus()&&Q.tooltip.hide(),Q.pickers!=null&&Q.pickers.forEach(function(R){R.container.contains(Z.target)||R.close()})};return U.emitter.listenDOM("click",document.body,z),Q}return i(L,[{key:"addModule",value:function(D){var Q=o(L.prototype.__proto__||Object.getPrototypeOf(L.prototype),"addModule",this).call(this,D);return D==="toolbar"&&this.extendToolbar(Q),Q}},{key:"buildButtons",value:function(D,Q){D.forEach(function(z){var G=z.getAttribute("class")||"";G.split(/\s+/).forEach(function(Z){if(Z.startsWith("ql-")&&(Z=Z.slice(3),Q[Z]!=null))if(Z==="direction")z.innerHTML=Q[Z][""]+Q[Z].rtl;else if(typeof Q[Z]=="string")z.innerHTML=Q[Z];else{var R=z.value||"";R!=null&&Q[Z][R]&&(z.innerHTML=Q[Z][R])}})})}},{key:"buildPickers",value:function(D,Q){var z=this;this.pickers=D.map(function(Z){if(Z.classList.contains("ql-align"))return Z.querySelector("option")==null&&K(Z,I),new x.default(Z,Q.align);if(Z.classList.contains("ql-background")||Z.classList.contains("ql-color")){var R=Z.classList.contains("ql-background")?"background":"color";return Z.querySelector("option")==null&&K(Z,O,R==="background"?"#ffffff":"#000000"),new g.default(Z,Q[R])}else return Z.querySelector("option")==null&&(Z.classList.contains("ql-font")?K(Z,M):Z.classList.contains("ql-header")?K(Z,P):Z.classList.contains("ql-size")&&K(Z,X)),new N.default(Z)});var G=function(){z.pickers.forEach(function(R){R.update()})};this.quill.on(f.default.events.EDITOR_CHANGE,G)}}]),L}(v.default);J.DEFAULTS=(0,c.default)(!0,{},v.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var L=this,U=this.container.querySelector("input.ql-image[type=file]");U==null&&(U=document.createElement("input"),U.setAttribute("type","file"),U.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),U.classList.add("ql-image"),U.addEventListener("change",function(){if(U.files!=null&&U.files[0]!=null){var D=new FileReader;D.onload=function(Q){var z=L.quill.getSelection(!0);L.quill.updateContents(new d.default().retain(z.index).delete(z.length).insert({image:Q.target.result}),f.default.sources.USER),L.quill.setSelection(z.index+1,f.default.sources.SILENT),U.value=""},D.readAsDataURL(U.files[0])}}),this.container.appendChild(U)),U.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var H=function(B){F(L,B);function L(U,D){E(this,L);var Q=S(this,(L.__proto__||Object.getPrototypeOf(L)).call(this,U,D));return Q.textbox=Q.root.querySelector('input[type="text"]'),Q.listen(),Q}return i(L,[{key:"listen",value:function(){var D=this;this.textbox.addEventListener("keydown",function(Q){b.default.match(Q,"enter")?(D.save(),Q.preventDefault()):b.default.match(Q,"escape")&&(D.cancel(),Q.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),Q!=null?this.textbox.value=Q:D!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+D)||""),this.root.setAttribute("data-mode",D)}},{key:"restoreFocus",value:function(){var D=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=D}},{key:"save",value:function(){var D=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var Q=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",D,f.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",D,f.default.sources.USER)),this.quill.root.scrollTop=Q;break}case"video":D=V(D);case"formula":{if(!D)break;var z=this.quill.getSelection(!0);if(z!=null){var G=z.index+z.length;this.quill.insertEmbed(G,this.root.getAttribute("data-mode"),D,f.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(G+1," ",f.default.sources.USER),this.quill.setSelection(G+2,f.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),L}(C.default);function V(B){var L=B.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||B.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return L?(L[1]||"https")+"://www.youtube.com/embed/"+L[2]+"?showinfo=0":(L=B.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(L[1]||"https")+"://player.vimeo.com/video/"+L[2]+"/":B}function K(B,L){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;L.forEach(function(D){var Q=document.createElement("option");D===U?Q.setAttribute("selected","selected"):Q.setAttribute("value",D),B.appendChild(Q)})}n.BaseTooltip=H,n.default=J},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var c,u=this.iterator();c=u();)if(c===l)return!0;return!1},o.prototype.insertBefore=function(l,c){l&&(l.next=c,c!=null?(l.prev=c.prev,c.prev!=null&&(c.prev.next=l),c.prev=l,c===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var c=0,u=this.head;u!=null;){if(u===l)return c;c+=u.length(),u=u.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var c=l;return l!=null&&(l=l.next),c}},o.prototype.find=function(l,c){c===void 0&&(c=!1);for(var u,d=this.iterator();u=d();){var h=u.length();if(l<h||c&&l===h&&(u.next==null||u.next.length()!==0))return[u,l];l-=h}return[null,0]},o.prototype.forEach=function(l){for(var c,u=this.iterator();c=u();)l(c)},o.prototype.forEachAt=function(l,c,u){if(!(c<=0))for(var d=this.find(l),h=d[0],f=d[1],A,b=l-f,m=this.iterator(h);(A=m())&&b<l+c;){var v=A.length();l>b?u(A,l-b,Math.min(c,b+v-l)):u(A,0,Math.min(v,l+c-b)),b+=v}},o.prototype.map=function(l){return this.reduce(function(c,u){return c.push(l(u)),c},[])},o.prototype.reduce=function(l,c){for(var u,d=this.iterator();u=d();)c=l(c,u);return c},o}();n.default=i},function(r,n,s){var i=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,A){f.__proto__=A}||function(f,A){for(var b in A)A.hasOwnProperty(b)&&(f[b]=A[b])};return function(f,A){h(f,A);function b(){this.constructor=f}f.prototype=A===null?Object.create(A):(b.prototype=A.prototype,new b)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(17),l=s(1),c={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},u=100,d=function(h){i(f,h);function f(A){var b=h.call(this,A)||this;return b.scroll=b,b.observer=new MutationObserver(function(m){b.update(m)}),b.observer.observe(b.domNode,c),b.attach(),b}return f.prototype.detach=function(){h.prototype.detach.call(this),this.observer.disconnect()},f.prototype.deleteAt=function(A,b){this.update(),A===0&&b===this.length()?this.children.forEach(function(m){m.remove()}):h.prototype.deleteAt.call(this,A,b)},f.prototype.formatAt=function(A,b,m,v){this.update(),h.prototype.formatAt.call(this,A,b,m,v)},f.prototype.insertAt=function(A,b,m){this.update(),h.prototype.insertAt.call(this,A,b,m)},f.prototype.optimize=function(A,b){var m=this;A===void 0&&(A=[]),b===void 0&&(b={}),h.prototype.optimize.call(this,b);for(var v=[].slice.call(this.observer.takeRecords());v.length>0;)A.push(v.pop());for(var p=function(w,N){N===void 0&&(N=!0),!(w==null||w===m)&&w.domNode.parentNode!=null&&(w.domNode[l.DATA_KEY].mutations==null&&(w.domNode[l.DATA_KEY].mutations=[]),N&&p(w.parent))},g=function(w){w.domNode[l.DATA_KEY]==null||w.domNode[l.DATA_KEY].mutations==null||(w instanceof o.default&&w.children.forEach(g),w.optimize(b))},y=A,x=0;y.length>0;x+=1){if(x>=u)throw new Error("[Parchment] Maximum optimize iterations reached");for(y.forEach(function(w){var N=l.find(w.target,!0);N!=null&&(N.domNode===w.target&&(w.type==="childList"?(p(l.find(w.previousSibling,!1)),[].forEach.call(w.addedNodes,function(_){var C=l.find(_,!1);p(C,!1),C instanceof o.default&&C.children.forEach(function(j){p(j,!1)})})):w.type==="attributes"&&p(N.prev)),p(N))}),this.children.forEach(g),y=[].slice.call(this.observer.takeRecords()),v=y.slice();v.length>0;)A.push(v.pop())}},f.prototype.update=function(A,b){var m=this;b===void 0&&(b={}),A=A||this.observer.takeRecords(),A.map(function(v){var p=l.find(v.target,!0);return p==null?null:p.domNode[l.DATA_KEY].mutations==null?(p.domNode[l.DATA_KEY].mutations=[v],p):(p.domNode[l.DATA_KEY].mutations.push(v),null)}).forEach(function(v){v==null||v===m||v.domNode[l.DATA_KEY]==null||v.update(v.domNode[l.DATA_KEY].mutations||[],b)}),this.domNode[l.DATA_KEY].mutations!=null&&h.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,b),this.optimize(A,b)},f.blotName="scroll",f.defaultChild="block",f.scope=l.Scope.BLOCK_BLOT,f.tagName="DIV",f}(o.default);n.default=d},function(r,n,s){var i=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var A in f)f.hasOwnProperty(A)&&(h[A]=f[A])};return function(h,f){d(h,f);function A(){this.constructor=h}h.prototype=f===null?Object.create(f):(A.prototype=f.prototype,new A)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(18),l=s(1);function c(d,h){if(Object.keys(d).length!==Object.keys(h).length)return!1;for(var f in d)if(d[f]!==h[f])return!1;return!0}var u=function(d){i(h,d);function h(){return d!==null&&d.apply(this,arguments)||this}return h.formats=function(f){if(f.tagName!==h.tagName)return d.formats.call(this,f)},h.prototype.format=function(f,A){var b=this;f===this.statics.blotName&&!A?(this.children.forEach(function(m){m instanceof o.default||(m=m.wrap(h.blotName,!0)),b.attributes.copy(m)}),this.unwrap()):d.prototype.format.call(this,f,A)},h.prototype.formatAt=function(f,A,b,m){if(this.formats()[b]!=null||l.query(b,l.Scope.ATTRIBUTE)){var v=this.isolate(f,A);v.format(b,m)}else d.prototype.formatAt.call(this,f,A,b,m)},h.prototype.optimize=function(f){d.prototype.optimize.call(this,f);var A=this.formats();if(Object.keys(A).length===0)return this.unwrap();var b=this.next;b instanceof h&&b.prev===this&&c(A,b.formats())&&(b.moveChildren(this),b.remove())},h.blotName="inline",h.scope=l.Scope.INLINE_BLOT,h.tagName="SPAN",h}(o.default);n.default=u},function(r,n,s){var i=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var f in h)h.hasOwnProperty(f)&&(d[f]=h[f])};return function(d,h){u(d,h);function f(){this.constructor=d}d.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(18),l=s(1),c=function(u){i(d,u);function d(){return u!==null&&u.apply(this,arguments)||this}return d.formats=function(h){var f=l.query(d.blotName).tagName;if(h.tagName!==f)return u.formats.call(this,h)},d.prototype.format=function(h,f){l.query(h,l.Scope.BLOCK)!=null&&(h===this.statics.blotName&&!f?this.replaceWith(d.blotName):u.prototype.format.call(this,h,f))},d.prototype.formatAt=function(h,f,A,b){l.query(A,l.Scope.BLOCK)!=null?this.format(A,b):u.prototype.formatAt.call(this,h,f,A,b)},d.prototype.insertAt=function(h,f,A){if(A==null||l.query(f,l.Scope.INLINE)!=null)u.prototype.insertAt.call(this,h,f,A);else{var b=this.split(h),m=l.create(f,A);b.parent.insertBefore(m,b)}},d.prototype.update=function(h,f){navigator.userAgent.match(/Trident/)?this.build():u.prototype.update.call(this,h,f)},d.blotName="block",d.scope=l.Scope.BLOCK_BLOT,d.tagName="P",d}(o.default);n.default=c},function(r,n,s){var i=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){c(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(19),l=function(c){i(u,c);function u(){return c!==null&&c.apply(this,arguments)||this}return u.formats=function(d){},u.prototype.format=function(d,h){c.prototype.formatAt.call(this,0,this.length(),d,h)},u.prototype.formatAt=function(d,h,f,A){d===0&&h===this.length()?this.format(f,A):c.prototype.formatAt.call(this,d,h,f,A)},u.prototype.formats=function(){return this.statics.formats(this.domNode)},u}(o.default);n.default=l},function(r,n,s){var i=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var f in h)h.hasOwnProperty(f)&&(d[f]=h[f])};return function(d,h){u(d,h);function f(){this.constructor=d}d.prototype=h===null?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=s(19),l=s(1),c=function(u){i(d,u);function d(h){var f=u.call(this,h)||this;return f.text=f.statics.value(f.domNode),f}return d.create=function(h){return document.createTextNode(h)},d.value=function(h){var f=h.data;return f.normalize&&(f=f.normalize()),f},d.prototype.deleteAt=function(h,f){this.domNode.data=this.text=this.text.slice(0,h)+this.text.slice(h+f)},d.prototype.index=function(h,f){return this.domNode===h?f:-1},d.prototype.insertAt=function(h,f,A){A==null?(this.text=this.text.slice(0,h)+f+this.text.slice(h),this.domNode.data=this.text):u.prototype.insertAt.call(this,h,f,A)},d.prototype.length=function(){return this.text.length},d.prototype.optimize=function(h){u.prototype.optimize.call(this,h),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof d&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},d.prototype.position=function(h,f){return[this.domNode,h]},d.prototype.split=function(h,f){if(f===void 0&&(f=!1),!f){if(h===0)return this;if(h===this.length())return this.next}var A=l.create(this.domNode.splitText(h));return this.parent.insertBefore(A,this.next),this.text=this.statics.value(this.domNode),A},d.prototype.update=function(h,f){var A=this;h.some(function(b){return b.type==="characterData"&&b.target===A.domNode})&&(this.text=this.statics.value(this.domNode))},d.prototype.value=function(){return this.text},d.blotName="text",d.scope=l.Scope.INLINE_BLOT,d}(o.default);n.default=c},function(r,n,s){var i=document.createElement("div");if(i.classList.toggle("test-class",!1),i.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,c){return arguments.length>1&&!this.contains(l)==!c?c:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,c){return c=c||0,this.substr(c,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,c){var u=this.toString();(typeof c!="number"||!isFinite(c)||Math.floor(c)!==c||c>u.length)&&(c=u.length),c-=l.length;var d=u.indexOf(l,c);return d!==-1&&d===c}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(c){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof c!="function")throw new TypeError("predicate must be a function");for(var u=Object(this),d=u.length>>>0,h=arguments[1],f,A=0;A<d;A++)if(f=u[A],c.call(h,f,A,u))return f}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(r,n){var s=-1,i=1,o=0;function l(x,w,N){if(x==w)return x?[[o,x]]:[];(N<0||x.length<N)&&(N=null);var _=h(x,w),C=x.substring(0,_);x=x.substring(_),w=w.substring(_),_=f(x,w);var j=x.substring(x.length-_);x=x.substring(0,x.length-_),w=w.substring(0,w.length-_);var E=c(x,w);return C&&E.unshift([o,C]),j&&E.push([o,j]),b(E),N!=null&&(E=p(E,N)),E=g(E),E}function c(x,w){var N;if(!x)return[[i,w]];if(!w)return[[s,x]];var _=x.length>w.length?x:w,C=x.length>w.length?w:x,j=_.indexOf(C);if(j!=-1)return N=[[i,_.substring(0,j)],[o,C],[i,_.substring(j+C.length)]],x.length>w.length&&(N[0][0]=N[2][0]=s),N;if(C.length==1)return[[s,x],[i,w]];var E=A(x,w);if(E){var S=E[0],F=E[1],I=E[2],O=E[3],M=E[4],P=l(S,I),X=l(F,O);return P.concat([[o,M]],X)}return u(x,w)}function u(x,w){for(var N=x.length,_=w.length,C=Math.ceil((N+_)/2),j=C,E=2*C,S=new Array(E),F=new Array(E),I=0;I<E;I++)S[I]=-1,F[I]=-1;S[j+1]=0,F[j+1]=0;for(var O=N-_,M=O%2!=0,P=0,X=0,J=0,H=0,V=0;V<C;V++){for(var K=-V+P;K<=V-X;K+=2){var B=j+K,L;K==-V||K!=V&&S[B-1]<S[B+1]?L=S[B+1]:L=S[B-1]+1;for(var U=L-K;L<N&&U<_&&x.charAt(L)==w.charAt(U);)L++,U++;if(S[B]=L,L>N)X+=2;else if(U>_)P+=2;else if(M){var D=j+O-K;if(D>=0&&D<E&&F[D]!=-1){var Q=N-F[D];if(L>=Q)return d(x,w,L,U)}}}for(var z=-V+J;z<=V-H;z+=2){var D=j+z,Q;z==-V||z!=V&&F[D-1]<F[D+1]?Q=F[D+1]:Q=F[D-1]+1;for(var G=Q-z;Q<N&&G<_&&x.charAt(N-Q-1)==w.charAt(_-G-1);)Q++,G++;if(F[D]=Q,Q>N)H+=2;else if(G>_)J+=2;else if(!M){var B=j+O-z;if(B>=0&&B<E&&S[B]!=-1){var L=S[B],U=j+L-B;if(Q=N-Q,L>=Q)return d(x,w,L,U)}}}}return[[s,x],[i,w]]}function d(x,w,N,_){var C=x.substring(0,N),j=w.substring(0,_),E=x.substring(N),S=w.substring(_),F=l(C,j),I=l(E,S);return F.concat(I)}function h(x,w){if(!x||!w||x.charAt(0)!=w.charAt(0))return 0;for(var N=0,_=Math.min(x.length,w.length),C=_,j=0;N<C;)x.substring(j,C)==w.substring(j,C)?(N=C,j=N):_=C,C=Math.floor((_-N)/2+N);return C}function f(x,w){if(!x||!w||x.charAt(x.length-1)!=w.charAt(w.length-1))return 0;for(var N=0,_=Math.min(x.length,w.length),C=_,j=0;N<C;)x.substring(x.length-C,x.length-j)==w.substring(w.length-C,w.length-j)?(N=C,j=N):_=C,C=Math.floor((_-N)/2+N);return C}function A(x,w){var N=x.length>w.length?x:w,_=x.length>w.length?w:x;if(N.length<4||_.length*2<N.length)return null;function C(X,J,H){for(var V=X.substring(H,H+Math.floor(X.length/4)),K=-1,B="",L,U,D,Q;(K=J.indexOf(V,K+1))!=-1;){var z=h(X.substring(H),J.substring(K)),G=f(X.substring(0,H),J.substring(0,K));B.length<G+z&&(B=J.substring(K-G,K)+J.substring(K,K+z),L=X.substring(0,H-G),U=X.substring(H+z),D=J.substring(0,K-G),Q=J.substring(K+z))}return B.length*2>=X.length?[L,U,D,Q,B]:null}var j=C(N,_,Math.ceil(N.length/4)),E=C(N,_,Math.ceil(N.length/2)),S;if(!j&&!E)return null;E?j?S=j[4].length>E[4].length?j:E:S=E:S=j;var F,I,O,M;x.length>w.length?(F=S[0],I=S[1],O=S[2],M=S[3]):(O=S[0],M=S[1],F=S[2],I=S[3]);var P=S[4];return[F,I,O,M,P]}function b(x){x.push([o,""]);for(var w=0,N=0,_=0,C="",j="",E;w<x.length;)switch(x[w][0]){case i:_++,j+=x[w][1],w++;break;case s:N++,C+=x[w][1],w++;break;case o:N+_>1?(N!==0&&_!==0&&(E=h(j,C),E!==0&&(w-N-_>0&&x[w-N-_-1][0]==o?x[w-N-_-1][1]+=j.substring(0,E):(x.splice(0,0,[o,j.substring(0,E)]),w++),j=j.substring(E),C=C.substring(E)),E=f(j,C),E!==0&&(x[w][1]=j.substring(j.length-E)+x[w][1],j=j.substring(0,j.length-E),C=C.substring(0,C.length-E))),N===0?x.splice(w-_,N+_,[i,j]):_===0?x.splice(w-N,N+_,[s,C]):x.splice(w-N-_,N+_,[s,C],[i,j]),w=w-N-_+(N?1:0)+(_?1:0)+1):w!==0&&x[w-1][0]==o?(x[w-1][1]+=x[w][1],x.splice(w,1)):w++,_=0,N=0,C="",j="";break}x[x.length-1][1]===""&&x.pop();var S=!1;for(w=1;w<x.length-1;)x[w-1][0]==o&&x[w+1][0]==o&&(x[w][1].substring(x[w][1].length-x[w-1][1].length)==x[w-1][1]?(x[w][1]=x[w-1][1]+x[w][1].substring(0,x[w][1].length-x[w-1][1].length),x[w+1][1]=x[w-1][1]+x[w+1][1],x.splice(w-1,1),S=!0):x[w][1].substring(0,x[w+1][1].length)==x[w+1][1]&&(x[w-1][1]+=x[w+1][1],x[w][1]=x[w][1].substring(x[w+1][1].length)+x[w+1][1],x.splice(w+1,1),S=!0)),w++;S&&b(x)}var m=l;m.INSERT=i,m.DELETE=s,m.EQUAL=o,r.exports=m;function v(x,w){if(w===0)return[o,x];for(var N=0,_=0;_<x.length;_++){var C=x[_];if(C[0]===s||C[0]===o){var j=N+C[1].length;if(w===j)return[_+1,x];if(w<j){x=x.slice();var E=w-N,S=[C[0],C[1].slice(0,E)],F=[C[0],C[1].slice(E)];return x.splice(_,1,S,F),[_+1,x]}else N=j}}throw new Error("cursor_pos is out of bounds!")}function p(x,w){var N=v(x,w),_=N[1],C=N[0],j=_[C],E=_[C+1];if(j==null)return x;if(j[0]!==o)return x;if(E!=null&&j[1]+E[1]===E[1]+j[1])return _.splice(C,2,E,j),y(_,C,2);if(E!=null&&E[1].indexOf(j[1])===0){_.splice(C,2,[E[0],j[1]],[0,j[1]]);var S=E[1].slice(j[1].length);return S.length>0&&_.splice(C+2,0,[E[0],S]),y(_,C,3)}else return x}function g(x){for(var w=!1,N=function(E){return E.charCodeAt(0)>=56320&&E.charCodeAt(0)<=57343},_=function(E){return E.charCodeAt(E.length-1)>=55296&&E.charCodeAt(E.length-1)<=56319},C=2;C<x.length;C+=1)x[C-2][0]===o&&_(x[C-2][1])&&x[C-1][0]===s&&N(x[C-1][1])&&x[C][0]===i&&N(x[C][1])&&(w=!0,x[C-1][1]=x[C-2][1].slice(-1)+x[C-1][1],x[C][1]=x[C-2][1].slice(-1)+x[C][1],x[C-2][1]=x[C-2][1].slice(0,-1));if(!w)return x;for(var j=[],C=0;C<x.length;C+=1)x[C][1].length>0&&j.push(x[C]);return j}function y(x,w,N){for(var _=w+N-1;_>=0&&_>=w-1;_--)if(_+1<x.length){var C=x[_],j=x[_+1];C[0]===j[1]&&x.splice(_,2,[C[0],C[1]+j[1]])}return x}},function(r,n){n=r.exports=typeof Object.keys=="function"?Object.keys:s,n.shim=s;function s(i){var o=[];for(var l in i)o.push(l);return o}},function(r,n){var s=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=r.exports=s?i:o,n.supported=i;function i(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(r,n){var s=Object.prototype.hasOwnProperty,i="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(i=!1));function l(u,d,h){this.fn=u,this.context=d,this.once=h||!1}function c(){this._events=new o,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],h,f;if(this._eventsCount===0)return d;for(f in h=this._events)s.call(h,f)&&d.push(i?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},c.prototype.listeners=function(d,h){var f=i?i+d:d,A=this._events[f];if(h)return!!A;if(!A)return[];if(A.fn)return[A.fn];for(var b=0,m=A.length,v=new Array(m);b<m;b++)v[b]=A[b].fn;return v},c.prototype.emit=function(d,h,f,A,b,m){var v=i?i+d:d;if(!this._events[v])return!1;var p=this._events[v],g=arguments.length,y,x;if(p.fn){switch(p.once&&this.removeListener(d,p.fn,void 0,!0),g){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,h),!0;case 3:return p.fn.call(p.context,h,f),!0;case 4:return p.fn.call(p.context,h,f,A),!0;case 5:return p.fn.call(p.context,h,f,A,b),!0;case 6:return p.fn.call(p.context,h,f,A,b,m),!0}for(x=1,y=new Array(g-1);x<g;x++)y[x-1]=arguments[x];p.fn.apply(p.context,y)}else{var w=p.length,N;for(x=0;x<w;x++)switch(p[x].once&&this.removeListener(d,p[x].fn,void 0,!0),g){case 1:p[x].fn.call(p[x].context);break;case 2:p[x].fn.call(p[x].context,h);break;case 3:p[x].fn.call(p[x].context,h,f);break;case 4:p[x].fn.call(p[x].context,h,f,A);break;default:if(!y)for(N=1,y=new Array(g-1);N<g;N++)y[N-1]=arguments[N];p[x].fn.apply(p[x].context,y)}}return!0},c.prototype.on=function(d,h,f){var A=new l(h,f||this),b=i?i+d:d;return this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],A]:this._events[b].push(A):(this._events[b]=A,this._eventsCount++),this},c.prototype.once=function(d,h,f){var A=new l(h,f||this,!0),b=i?i+d:d;return this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],A]:this._events[b].push(A):(this._events[b]=A,this._eventsCount++),this},c.prototype.removeListener=function(d,h,f,A){var b=i?i+d:d;if(!this._events[b])return this;if(!h)return--this._eventsCount===0?this._events=new o:delete this._events[b],this;var m=this._events[b];if(m.fn)m.fn===h&&(!A||m.once)&&(!f||m.context===f)&&(--this._eventsCount===0?this._events=new o:delete this._events[b]);else{for(var v=0,p=[],g=m.length;v<g;v++)(m[v].fn!==h||A&&!m[v].once||f&&m[v].context!==f)&&p.push(m[v]);p.length?this._events[b]=p.length===1?p[0]:p:--this._eventsCount===0?this._events=new o:delete this._events[b]}return this},c.prototype.removeAllListeners=function(d){var h;return d?(h=i?i+d:d,this._events[h]&&(--this._eventsCount===0?this._events=new o:delete this._events[h])):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prototype.setMaxListeners=function(){return this},c.prefixed=i,c.EventEmitter=c,typeof r<"u"&&(r.exports=c)},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ae){return typeof Ae}:function(Ae){return Ae&&typeof Symbol=="function"&&Ae.constructor===Symbol&&Ae!==Symbol.prototype?"symbol":typeof Ae},o=function(){function Ae(ye,Le){var Re=[],we=!0,Pe=!1,ze=void 0;try{for(var Ve=ye[Symbol.iterator](),lt;!(we=(lt=Ve.next()).done)&&(Re.push(lt.value),!(Le&&Re.length===Le));we=!0);}catch(pe){Pe=!0,ze=pe}finally{try{!we&&Ve.return&&Ve.return()}finally{if(Pe)throw ze}}return Re}return function(ye,Le){if(Array.isArray(ye))return ye;if(Symbol.iterator in Object(ye))return Ae(ye,Le);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Ae(ye,Le){for(var Re=0;Re<Le.length;Re++){var we=Le[Re];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(ye,we.key,we)}}return function(ye,Le,Re){return Le&&Ae(ye.prototype,Le),Re&&Ae(ye,Re),ye}}(),c=s(3),u=F(c),d=s(2),h=F(d),f=s(0),A=F(f),b=s(5),m=F(b),v=s(10),p=F(v),g=s(9),y=F(g),x=s(36),w=s(37),N=s(13),_=F(N),C=s(26),j=s(38),E=s(39),S=s(40);function F(Ae){return Ae&&Ae.__esModule?Ae:{default:Ae}}function I(Ae,ye,Le){return ye in Ae?Object.defineProperty(Ae,ye,{value:Le,enumerable:!0,configurable:!0,writable:!0}):Ae[ye]=Le,Ae}function O(Ae,ye){if(!(Ae instanceof ye))throw new TypeError("Cannot call a class as a function")}function M(Ae,ye){if(!Ae)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ye&&(typeof ye=="object"||typeof ye=="function")?ye:Ae}function P(Ae,ye){if(typeof ye!="function"&&ye!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ye);Ae.prototype=Object.create(ye&&ye.prototype,{constructor:{value:Ae,enumerable:!1,writable:!0,configurable:!0}}),ye&&(Object.setPrototypeOf?Object.setPrototypeOf(Ae,ye):Ae.__proto__=ye)}var X=(0,p.default)("quill:clipboard"),J="__ql-matcher",H=[[Node.TEXT_NODE,Se],[Node.TEXT_NODE,se],["br",le],[Node.ELEMENT_NODE,se],[Node.ELEMENT_NODE,R],[Node.ELEMENT_NODE,te],[Node.ELEMENT_NODE,Z],[Node.ELEMENT_NODE,Ne],["li",_e],["b",G.bind(G,"bold")],["i",G.bind(G,"italic")],["style",ee]],V=[x.AlignAttribute,j.DirectionAttribute].reduce(function(Ae,ye){return Ae[ye.keyName]=ye,Ae},{}),K=[x.AlignStyle,w.BackgroundStyle,C.ColorStyle,j.DirectionStyle,E.FontStyle,S.SizeStyle].reduce(function(Ae,ye){return Ae[ye.keyName]=ye,Ae},{}),B=function(Ae){P(ye,Ae);function ye(Le,Re){O(this,ye);var we=M(this,(ye.__proto__||Object.getPrototypeOf(ye)).call(this,Le,Re));return we.quill.root.addEventListener("paste",we.onPaste.bind(we)),we.container=we.quill.addContainer("ql-clipboard"),we.container.setAttribute("contenteditable",!0),we.container.setAttribute("tabindex",-1),we.matchers=[],H.concat(we.options.matchers).forEach(function(Pe){var ze=o(Pe,2),Ve=ze[0],lt=ze[1];!Re.matchVisual&&lt===te||we.addMatcher(Ve,lt)}),we}return l(ye,[{key:"addMatcher",value:function(Re,we){this.matchers.push([Re,we])}},{key:"convert",value:function(Re){if(typeof Re=="string")return this.container.innerHTML=Re.replace(/\>\r?\n +\</g,"><"),this.convert();var we=this.quill.getFormat(this.quill.selection.savedRange.index);if(we[_.default.blotName]){var Pe=this.container.innerText;return this.container.innerHTML="",new h.default().insert(Pe,I({},_.default.blotName,we[_.default.blotName]))}var ze=this.prepareMatching(),Ve=o(ze,2),lt=Ve[0],pe=Ve[1],Fe=z(this.container,lt,pe);return D(Fe,`
`)&&Fe.ops[Fe.ops.length-1].attributes==null&&(Fe=Fe.compose(new h.default().retain(Fe.length()-1).delete(1))),X.log("convert",this.container.innerHTML,Fe),this.container.innerHTML="",Fe}},{key:"dangerouslyPasteHTML",value:function(Re,we){var Pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.default.sources.API;if(typeof Re=="string")this.quill.setContents(this.convert(Re),we),this.quill.setSelection(0,m.default.sources.SILENT);else{var ze=this.convert(we);this.quill.updateContents(new h.default().retain(Re).concat(ze),Pe),this.quill.setSelection(Re+ze.length(),m.default.sources.SILENT)}}},{key:"onPaste",value:function(Re){var we=this;if(!(Re.defaultPrevented||!this.quill.isEnabled())){var Pe=this.quill.getSelection(),ze=new h.default().retain(Pe.index),Ve=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(m.default.sources.SILENT),setTimeout(function(){ze=ze.concat(we.convert()).delete(Pe.length),we.quill.updateContents(ze,m.default.sources.USER),we.quill.setSelection(ze.length()-Pe.length,m.default.sources.SILENT),we.quill.scrollingContainer.scrollTop=Ve,we.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Re=this,we=[],Pe=[];return this.matchers.forEach(function(ze){var Ve=o(ze,2),lt=Ve[0],pe=Ve[1];switch(lt){case Node.TEXT_NODE:Pe.push(pe);break;case Node.ELEMENT_NODE:we.push(pe);break;default:[].forEach.call(Re.container.querySelectorAll(lt),function(Fe){Fe[J]=Fe[J]||[],Fe[J].push(pe)});break}}),[we,Pe]}}]),ye}(y.default);B.DEFAULTS={matchers:[],matchVisual:!0};function L(Ae,ye,Le){return(typeof ye>"u"?"undefined":i(ye))==="object"?Object.keys(ye).reduce(function(Re,we){return L(Re,we,ye[we])},Ae):Ae.reduce(function(Re,we){return we.attributes&&we.attributes[ye]?Re.push(we):Re.insert(we.insert,(0,u.default)({},I({},ye,Le),we.attributes))},new h.default)}function U(Ae){if(Ae.nodeType!==Node.ELEMENT_NODE)return{};var ye="__ql-computed-style";return Ae[ye]||(Ae[ye]=window.getComputedStyle(Ae))}function D(Ae,ye){for(var Le="",Re=Ae.ops.length-1;Re>=0&&Le.length<ye.length;--Re){var we=Ae.ops[Re];if(typeof we.insert!="string")break;Le=we.insert+Le}return Le.slice(-1*ye.length)===ye}function Q(Ae){if(Ae.childNodes.length===0)return!1;var ye=U(Ae);return["block","list-item"].indexOf(ye.display)>-1}function z(Ae,ye,Le){return Ae.nodeType===Ae.TEXT_NODE?Le.reduce(function(Re,we){return we(Ae,Re)},new h.default):Ae.nodeType===Ae.ELEMENT_NODE?[].reduce.call(Ae.childNodes||[],function(Re,we){var Pe=z(we,ye,Le);return we.nodeType===Ae.ELEMENT_NODE&&(Pe=ye.reduce(function(ze,Ve){return Ve(we,ze)},Pe),Pe=(we[J]||[]).reduce(function(ze,Ve){return Ve(we,ze)},Pe)),Re.concat(Pe)},new h.default):new h.default}function G(Ae,ye,Le){return L(Le,Ae,!0)}function Z(Ae,ye){var Le=A.default.Attributor.Attribute.keys(Ae),Re=A.default.Attributor.Class.keys(Ae),we=A.default.Attributor.Style.keys(Ae),Pe={};return Le.concat(Re).concat(we).forEach(function(ze){var Ve=A.default.query(ze,A.default.Scope.ATTRIBUTE);Ve!=null&&(Pe[Ve.attrName]=Ve.value(Ae),Pe[Ve.attrName])||(Ve=V[ze],Ve!=null&&(Ve.attrName===ze||Ve.keyName===ze)&&(Pe[Ve.attrName]=Ve.value(Ae)||void 0),Ve=K[ze],Ve!=null&&(Ve.attrName===ze||Ve.keyName===ze)&&(Ve=K[ze],Pe[Ve.attrName]=Ve.value(Ae)||void 0))}),Object.keys(Pe).length>0&&(ye=L(ye,Pe)),ye}function R(Ae,ye){var Le=A.default.query(Ae);if(Le==null)return ye;if(Le.prototype instanceof A.default.Embed){var Re={},we=Le.value(Ae);we!=null&&(Re[Le.blotName]=we,ye=new h.default().insert(Re,Le.formats(Ae)))}else typeof Le.formats=="function"&&(ye=L(ye,Le.blotName,Le.formats(Ae)));return ye}function le(Ae,ye){return D(ye,`
`)||ye.insert(`
`),ye}function ee(){return new h.default}function _e(Ae,ye){var Le=A.default.query(Ae);if(Le==null||Le.blotName!=="list-item"||!D(ye,`
`))return ye;for(var Re=-1,we=Ae.parentNode;!we.classList.contains("ql-clipboard");)(A.default.query(we)||{}).blotName==="list"&&(Re+=1),we=we.parentNode;return Re<=0?ye:ye.compose(new h.default().retain(ye.length()-1).retain(1,{indent:Re}))}function se(Ae,ye){return D(ye,`
`)||(Q(Ae)||ye.length()>0&&Ae.nextSibling&&Q(Ae.nextSibling))&&ye.insert(`
`),ye}function te(Ae,ye){if(Q(Ae)&&Ae.nextElementSibling!=null&&!D(ye,`

`)){var Le=Ae.offsetHeight+parseFloat(U(Ae).marginTop)+parseFloat(U(Ae).marginBottom);Ae.nextElementSibling.offsetTop>Ae.offsetTop+Le*1.5&&ye.insert(`
`)}return ye}function Ne(Ae,ye){var Le={},Re=Ae.style||{};return Re.fontStyle&&U(Ae).fontStyle==="italic"&&(Le.italic=!0),Re.fontWeight&&(U(Ae).fontWeight.startsWith("bold")||parseInt(U(Ae).fontWeight)>=700)&&(Le.bold=!0),Object.keys(Le).length>0&&(ye=L(ye,Le)),parseFloat(Re.textIndent||0)>0&&(ye=new h.default().insert("	").concat(ye)),ye}function Se(Ae,ye){var Le=Ae.data;if(Ae.parentNode.tagName==="O:P")return ye.insert(Le.trim());if(Le.trim().length===0&&Ae.parentNode.classList.contains("ql-clipboard"))return ye;if(!U(Ae.parentNode).whiteSpace.startsWith("pre")){var Re=function(Pe,ze){return ze=ze.replace(/[^\u00a0]/g,""),ze.length<1&&Pe?" ":ze};Le=Le.replace(/\r\n/g," ").replace(/\n/g," "),Le=Le.replace(/\s\s+/g,Re.bind(Re,!0)),(Ae.previousSibling==null&&Q(Ae.parentNode)||Ae.previousSibling!=null&&Q(Ae.previousSibling))&&(Le=Le.replace(/^\s+/,Re.bind(Re,!1))),(Ae.nextSibling==null&&Q(Ae.parentNode)||Ae.nextSibling!=null&&Q(Ae.nextSibling))&&(Le=Le.replace(/\s+$/,Re.bind(Re,!1)))}return ye.insert(Le)}n.default=B,n.matchAttributor=Z,n.matchBlot=R,n.matchNewline=se,n.matchSpacing=te,n.matchText=Se},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function b(m,v){for(var p=0;p<v.length;p++){var g=v[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(m,g.key,g)}}return function(m,v,p){return v&&b(m.prototype,v),p&&b(m,p),m}}(),o=function b(m,v,p){m===null&&(m=Function.prototype);var g=Object.getOwnPropertyDescriptor(m,v);if(g===void 0){var y=Object.getPrototypeOf(m);return y===null?void 0:b(y,v,p)}else{if("value"in g)return g.value;var x=g.get;return x===void 0?void 0:x.call(p)}},l=s(6),c=u(l);function u(b){return b&&b.__esModule?b:{default:b}}function d(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function f(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var A=function(b){f(m,b);function m(){return d(this,m),h(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return i(m,[{key:"optimize",value:function(p){o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"optimize",this).call(this,p),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),m}(c.default);A.blotName="bold",A.tagName=["STRONG","B"],n.default=A},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var i=function(){function S(F,I){var O=[],M=!0,P=!1,X=void 0;try{for(var J=F[Symbol.iterator](),H;!(M=(H=J.next()).done)&&(O.push(H.value),!(I&&O.length===I));M=!0);}catch(V){P=!0,X=V}finally{try{!M&&J.return&&J.return()}finally{if(P)throw X}}return O}return function(F,I){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return S(F,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function S(F,I){for(var O=0;O<I.length;O++){var M=I[O];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(F,M.key,M)}}return function(F,I,O){return I&&S(F.prototype,I),O&&S(F,O),F}}(),l=s(2),c=p(l),u=s(0),d=p(u),h=s(5),f=p(h),A=s(10),b=p(A),m=s(9),v=p(m);function p(S){return S&&S.__esModule?S:{default:S}}function g(S,F,I){return F in S?Object.defineProperty(S,F,{value:I,enumerable:!0,configurable:!0,writable:!0}):S[F]=I,S}function y(S,F){if(!(S instanceof F))throw new TypeError("Cannot call a class as a function")}function x(S,F){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:S}function w(S,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);S.prototype=Object.create(F&&F.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(S,F):S.__proto__=F)}var N=(0,b.default)("quill:toolbar"),_=function(S){w(F,S);function F(I,O){y(this,F);var M=x(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,I,O));if(Array.isArray(M.options.container)){var P=document.createElement("div");j(P,M.options.container),I.container.parentNode.insertBefore(P,I.container),M.container=P}else typeof M.options.container=="string"?M.container=document.querySelector(M.options.container):M.container=M.options.container;if(!(M.container instanceof HTMLElement)){var X;return X=N.error("Container required for toolbar",M.options),x(M,X)}return M.container.classList.add("ql-toolbar"),M.controls=[],M.handlers={},Object.keys(M.options.handlers).forEach(function(J){M.addHandler(J,M.options.handlers[J])}),[].forEach.call(M.container.querySelectorAll("button, select"),function(J){M.attach(J)}),M.quill.on(f.default.events.EDITOR_CHANGE,function(J,H){J===f.default.events.SELECTION_CHANGE&&M.update(H)}),M.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){var J=M.quill.selection.getRange(),H=i(J,1),V=H[0];M.update(V)}),M}return o(F,[{key:"addHandler",value:function(O,M){this.handlers[O]=M}},{key:"attach",value:function(O){var M=this,P=[].find.call(O.classList,function(J){return J.indexOf("ql-")===0});if(P){if(P=P.slice(3),O.tagName==="BUTTON"&&O.setAttribute("type","button"),this.handlers[P]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[P]==null){N.warn("ignoring attaching to disabled format",P,O);return}if(d.default.query(P)==null){N.warn("ignoring attaching to nonexistent format",P,O);return}}var X=O.tagName==="SELECT"?"change":"click";O.addEventListener(X,function(J){var H=void 0;if(O.tagName==="SELECT"){if(O.selectedIndex<0)return;var V=O.options[O.selectedIndex];V.hasAttribute("selected")?H=!1:H=V.value||!1}else O.classList.contains("ql-active")?H=!1:H=O.value||!O.hasAttribute("value"),J.preventDefault();M.quill.focus();var K=M.quill.selection.getRange(),B=i(K,1),L=B[0];if(M.handlers[P]!=null)M.handlers[P].call(M,H);else if(d.default.query(P).prototype instanceof d.default.Embed){if(H=prompt("Enter "+P),!H)return;M.quill.updateContents(new c.default().retain(L.index).delete(L.length).insert(g({},P,H)),f.default.sources.USER)}else M.quill.format(P,H,f.default.sources.USER);M.update(L)}),this.controls.push([P,O])}}},{key:"update",value:function(O){var M=O==null?{}:this.quill.getFormat(O);this.controls.forEach(function(P){var X=i(P,2),J=X[0],H=X[1];if(H.tagName==="SELECT"){var V=void 0;if(O==null)V=null;else if(M[J]==null)V=H.querySelector("option[selected]");else if(!Array.isArray(M[J])){var K=M[J];typeof K=="string"&&(K=K.replace(/\"/g,'\\"')),V=H.querySelector('option[value="'+K+'"]')}V==null?(H.value="",H.selectedIndex=-1):V.selected=!0}else if(O==null)H.classList.remove("ql-active");else if(H.hasAttribute("value")){var B=M[J]===H.getAttribute("value")||M[J]!=null&&M[J].toString()===H.getAttribute("value")||M[J]==null&&!H.getAttribute("value");H.classList.toggle("ql-active",B)}else H.classList.toggle("ql-active",M[J]!=null)})}}]),F}(v.default);_.DEFAULTS={};function C(S,F,I){var O=document.createElement("button");O.setAttribute("type","button"),O.classList.add("ql-"+F),I!=null&&(O.value=I),S.appendChild(O)}function j(S,F){Array.isArray(F[0])||(F=[F]),F.forEach(function(I){var O=document.createElement("span");O.classList.add("ql-formats"),I.forEach(function(M){if(typeof M=="string")C(O,M);else{var P=Object.keys(M)[0],X=M[P];Array.isArray(X)?E(O,P,X):C(O,P,X)}}),S.appendChild(O)})}function E(S,F,I){var O=document.createElement("select");O.classList.add("ql-"+F),I.forEach(function(M){var P=document.createElement("option");M!==!1?P.setAttribute("value",M):P.setAttribute("selected","selected"),O.appendChild(P)}),S.appendChild(O)}_.DEFAULTS={container:null,handlers:{clean:function(){var F=this,I=this.quill.getSelection();if(I!=null)if(I.length==0){var O=this.quill.getFormat();Object.keys(O).forEach(function(M){d.default.query(M,d.default.Scope.INLINE)!=null&&F.quill.format(M,!1)})}else this.quill.removeFormat(I,f.default.sources.USER)},direction:function(F){var I=this.quill.getFormat().align;F==="rtl"&&I==null?this.quill.format("align","right",f.default.sources.USER):!F&&I==="right"&&this.quill.format("align",!1,f.default.sources.USER),this.quill.format("direction",F,f.default.sources.USER)},indent:function(F){var I=this.quill.getSelection(),O=this.quill.getFormat(I),M=parseInt(O.indent||0);if(F==="+1"||F==="-1"){var P=F==="+1"?1:-1;O.direction==="rtl"&&(P*=-1),this.quill.format("indent",M+P,f.default.sources.USER)}},link:function(F){F===!0&&(F=prompt("Enter link URL:")),this.quill.format("link",F,f.default.sources.USER)},list:function(F){var I=this.quill.getSelection(),O=this.quill.getFormat(I);F==="check"?O.list==="checked"||O.list==="unchecked"?this.quill.format("list",!1,f.default.sources.USER):this.quill.format("list","unchecked",f.default.sources.USER):this.quill.format("list",F,f.default.sources.USER)}}},n.default=_,n.addControls=j},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function b(m,v){for(var p=0;p<v.length;p++){var g=v[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(m,g.key,g)}}return function(m,v,p){return v&&b(m.prototype,v),p&&b(m,p),m}}(),o=function b(m,v,p){m===null&&(m=Function.prototype);var g=Object.getOwnPropertyDescriptor(m,v);if(g===void 0){var y=Object.getPrototypeOf(m);return y===null?void 0:b(y,v,p)}else{if("value"in g)return g.value;var x=g.get;return x===void 0?void 0:x.call(p)}},l=s(28),c=u(l);function u(b){return b&&b.__esModule?b:{default:b}}function d(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function f(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var A=function(b){f(m,b);function m(v,p){d(this,m);var g=h(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,v));return g.label.innerHTML=p,g.container.classList.add("ql-color-picker"),[].slice.call(g.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(y){y.classList.add("ql-primary")}),g}return i(m,[{key:"buildItem",value:function(p){var g=o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"buildItem",this).call(this,p);return g.style.backgroundColor=p.getAttribute("value")||"",g}},{key:"selectItem",value:function(p,g){o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"selectItem",this).call(this,p,g);var y=this.label.querySelector(".ql-color-label"),x=p&&p.getAttribute("data-value")||"";y&&(y.tagName==="line"?y.style.stroke=x:y.style.fill=x)}}]),m}(c.default);n.default=A},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function b(m,v){for(var p=0;p<v.length;p++){var g=v[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(m,g.key,g)}}return function(m,v,p){return v&&b(m.prototype,v),p&&b(m,p),m}}(),o=function b(m,v,p){m===null&&(m=Function.prototype);var g=Object.getOwnPropertyDescriptor(m,v);if(g===void 0){var y=Object.getPrototypeOf(m);return y===null?void 0:b(y,v,p)}else{if("value"in g)return g.value;var x=g.get;return x===void 0?void 0:x.call(p)}},l=s(28),c=u(l);function u(b){return b&&b.__esModule?b:{default:b}}function d(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function f(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var A=function(b){f(m,b);function m(v,p){d(this,m);var g=h(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,v));return g.container.classList.add("ql-icon-picker"),[].forEach.call(g.container.querySelectorAll(".ql-picker-item"),function(y){y.innerHTML=p[y.getAttribute("data-value")||""]}),g.defaultItem=g.container.querySelector(".ql-selected"),g.selectItem(g.defaultItem),g}return i(m,[{key:"selectItem",value:function(p,g){o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"selectItem",this).call(this,p,g),p=p||this.defaultItem,this.label.innerHTML=p.innerHTML}}]),m}(c.default);n.default=A},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function c(u,d){for(var h=0;h<d.length;h++){var f=d[h];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}return function(u,d,h){return d&&c(u.prototype,d),h&&c(u,h),u}}();function o(c,u){if(!(c instanceof u))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(u,d){var h=this;o(this,c),this.quill=u,this.boundsContainer=d||document.body,this.root=u.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){h.root.style.marginTop=-1*h.quill.root.scrollTop+"px"}),this.hide()}return i(c,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(d){var h=d.left+d.width/2-this.root.offsetWidth/2,f=d.bottom+this.quill.root.scrollTop;this.root.style.left=h+"px",this.root.style.top=f+"px",this.root.classList.remove("ql-flip");var A=this.boundsContainer.getBoundingClientRect(),b=this.root.getBoundingClientRect(),m=0;if(b.right>A.right&&(m=A.right-b.right,this.root.style.left=h+m+"px"),b.left<A.left&&(m=A.left-b.left,this.root.style.left=h+m+"px"),b.bottom>A.bottom){var v=b.bottom-b.top,p=d.bottom-d.top+v;this.root.style.top=f-p+"px",this.root.classList.add("ql-flip")}return m}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),c}();n.default=l},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function E(S,F){var I=[],O=!0,M=!1,P=void 0;try{for(var X=S[Symbol.iterator](),J;!(O=(J=X.next()).done)&&(I.push(J.value),!(F&&I.length===F));O=!0);}catch(H){M=!0,P=H}finally{try{!O&&X.return&&X.return()}finally{if(M)throw P}}return I}return function(S,F){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return E(S,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function E(S,F,I){S===null&&(S=Function.prototype);var O=Object.getOwnPropertyDescriptor(S,F);if(O===void 0){var M=Object.getPrototypeOf(S);return M===null?void 0:E(M,F,I)}else{if("value"in O)return O.value;var P=O.get;return P===void 0?void 0:P.call(I)}},l=function(){function E(S,F){for(var I=0;I<F.length;I++){var O=F[I];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(S,O.key,O)}}return function(S,F,I){return F&&E(S.prototype,F),I&&E(S,I),S}}(),c=s(3),u=y(c),d=s(8),h=y(d),f=s(43),A=y(f),b=s(27),m=y(b),v=s(15),p=s(41),g=y(p);function y(E){return E&&E.__esModule?E:{default:E}}function x(E,S){if(!(E instanceof S))throw new TypeError("Cannot call a class as a function")}function w(E,S){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:E}function N(E,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);E.prototype=Object.create(S&&S.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(E,S):E.__proto__=S)}var _=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],C=function(E){N(S,E);function S(F,I){x(this,S),I.modules.toolbar!=null&&I.modules.toolbar.container==null&&(I.modules.toolbar.container=_);var O=w(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,F,I));return O.quill.container.classList.add("ql-snow"),O}return l(S,[{key:"extendToolbar",value:function(I){I.container.classList.add("ql-snow"),this.buildButtons([].slice.call(I.container.querySelectorAll("button")),g.default),this.buildPickers([].slice.call(I.container.querySelectorAll("select")),g.default),this.tooltip=new j(this.quill,this.options.bounds),I.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(O,M){I.handlers.link.call(I,!M.format.link)})}}]),S}(A.default);C.DEFAULTS=(0,u.default)(!0,{},A.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(S){if(S){var F=this.quill.getSelection();if(F==null||F.length==0)return;var I=this.quill.getText(F);/^\S+@\S+\.\S+$/.test(I)&&I.indexOf("mailto:")!==0&&(I="mailto:"+I);var O=this.quill.theme.tooltip;O.edit("link",I)}else this.quill.format("link",!1)}}}}});var j=function(E){N(S,E);function S(F,I){x(this,S);var O=w(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,F,I));return O.preview=O.root.querySelector("a.ql-preview"),O}return l(S,[{key:"listen",value:function(){var I=this;o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(O){I.root.classList.contains("ql-editing")?I.save():I.edit("link",I.preview.textContent),O.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(O){if(I.linkRange!=null){var M=I.linkRange;I.restoreFocus(),I.quill.formatText(M,"link",!1,h.default.sources.USER),delete I.linkRange}O.preventDefault(),I.hide()}),this.quill.on(h.default.events.SELECTION_CHANGE,function(O,M,P){if(O!=null){if(O.length===0&&P===h.default.sources.USER){var X=I.quill.scroll.descendant(m.default,O.index),J=i(X,2),H=J[0],V=J[1];if(H!=null){I.linkRange=new v.Range(O.index-V,H.length());var K=m.default.formats(H.domNode);I.preview.textContent=K,I.preview.setAttribute("href",K),I.show(),I.position(I.quill.getBounds(I.linkRange));return}}else delete I.linkRange;I.hide()}})}},{key:"show",value:function(){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),S}(f.BaseTooltip);j.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=C},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(29),o=we(i),l=s(36),c=s(38),u=s(64),d=s(65),h=we(d),f=s(66),A=we(f),b=s(67),m=we(b),v=s(37),p=s(26),g=s(39),y=s(40),x=s(56),w=we(x),N=s(68),_=we(N),C=s(27),j=we(C),E=s(69),S=we(E),F=s(70),I=we(F),O=s(71),M=we(O),P=s(72),X=we(P),J=s(73),H=we(J),V=s(13),K=we(V),B=s(74),L=we(B),U=s(75),D=we(U),Q=s(57),z=we(Q),G=s(41),Z=we(G),R=s(28),le=we(R),ee=s(59),_e=we(ee),se=s(60),te=we(se),Ne=s(61),Se=we(Ne),Ae=s(108),ye=we(Ae),Le=s(62),Re=we(Le);function we(Pe){return Pe&&Pe.__esModule?Pe:{default:Pe}}o.default.register({"attributors/attribute/direction":c.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":v.BackgroundClass,"attributors/class/color":p.ColorClass,"attributors/class/direction":c.DirectionClass,"attributors/class/font":g.FontClass,"attributors/class/size":y.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":v.BackgroundStyle,"attributors/style/color":p.ColorStyle,"attributors/style/direction":c.DirectionStyle,"attributors/style/font":g.FontStyle,"attributors/style/size":y.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":c.DirectionClass,"formats/indent":u.IndentClass,"formats/background":v.BackgroundStyle,"formats/color":p.ColorStyle,"formats/font":g.FontClass,"formats/size":y.SizeClass,"formats/blockquote":h.default,"formats/code-block":K.default,"formats/header":A.default,"formats/list":m.default,"formats/bold":w.default,"formats/code":V.Code,"formats/italic":_.default,"formats/link":j.default,"formats/script":S.default,"formats/strike":I.default,"formats/underline":M.default,"formats/image":X.default,"formats/video":H.default,"formats/list/item":b.ListItem,"modules/formula":L.default,"modules/syntax":D.default,"modules/toolbar":z.default,"themes/bubble":ye.default,"themes/snow":Re.default,"ui/icons":Z.default,"ui/picker":le.default,"ui/icon-picker":te.default,"ui/color-picker":_e.default,"ui/tooltip":Se.default},!0),n.default=o.default},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var i=function(){function m(v,p){for(var g=0;g<p.length;g++){var y=p[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(v,y.key,y)}}return function(v,p,g){return p&&m(v.prototype,p),g&&m(v,g),v}}(),o=function m(v,p,g){v===null&&(v=Function.prototype);var y=Object.getOwnPropertyDescriptor(v,p);if(y===void 0){var x=Object.getPrototypeOf(v);return x===null?void 0:m(x,p,g)}else{if("value"in y)return y.value;var w=y.get;return w===void 0?void 0:w.call(g)}},l=s(0),c=u(l);function u(m){return m&&m.__esModule?m:{default:m}}function d(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function h(m,v){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:m}function f(m,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);m.prototype=Object.create(v&&v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(m,v):m.__proto__=v)}var A=function(m){f(v,m);function v(){return d(this,v),h(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return i(v,[{key:"add",value:function(g,y){if(y==="+1"||y==="-1"){var x=this.value(g)||0;y=y==="+1"?x+1:x-1}return y===0?(this.remove(g),!0):o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"add",this).call(this,g,y)}},{key:"canAdd",value:function(g,y){return o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"canAdd",this).call(this,g,y)||o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"canAdd",this).call(this,g,parseInt(y))}},{key:"value",value:function(g){return parseInt(o(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"value",this).call(this,g))||void 0}}]),v}(c.default.Attributor.Class),b=new A("indent","ql-indent",{scope:c.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=b},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(4),o=l(i);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,A){if(!(f instanceof A))throw new TypeError("Cannot call a class as a function")}function u(f,A){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:f}function d(f,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);f.prototype=Object.create(A&&A.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(f,A):f.__proto__=A)}var h=function(f){d(A,f);function A(){return c(this,A),u(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);h.blotName="blockquote",h.tagName="blockquote",n.default=h},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function A(b,m){for(var v=0;v<m.length;v++){var p=m[v];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(b,p.key,p)}}return function(b,m,v){return m&&A(b.prototype,m),v&&A(b,v),b}}(),o=s(4),l=c(o);function c(A){return A&&A.__esModule?A:{default:A}}function u(A,b){if(!(A instanceof b))throw new TypeError("Cannot call a class as a function")}function d(A,b){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:A}function h(A,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);A.prototype=Object.create(b&&b.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(A,b):A.__proto__=b)}var f=function(A){h(b,A);function b(){return u(this,b),d(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return i(b,null,[{key:"formats",value:function(v){return this.tagName.indexOf(v.tagName)+1}}]),b}(l.default);f.blotName="header",f.tagName=["H1","H2","H3","H4","H5","H6"],n.default=f},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var i=function(){function x(w,N){for(var _=0;_<N.length;_++){var C=N[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(w,C.key,C)}}return function(w,N,_){return N&&x(w.prototype,N),_&&x(w,_),w}}(),o=function x(w,N,_){w===null&&(w=Function.prototype);var C=Object.getOwnPropertyDescriptor(w,N);if(C===void 0){var j=Object.getPrototypeOf(w);return j===null?void 0:x(j,N,_)}else{if("value"in C)return C.value;var E=C.get;return E===void 0?void 0:E.call(_)}},l=s(0),c=A(l),u=s(4),d=A(u),h=s(25),f=A(h);function A(x){return x&&x.__esModule?x:{default:x}}function b(x,w,N){return w in x?Object.defineProperty(x,w,{value:N,enumerable:!0,configurable:!0,writable:!0}):x[w]=N,x}function m(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function v(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function p(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var g=function(x){p(w,x);function w(){return m(this,w),v(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return i(w,[{key:"format",value:function(_,C){_===y.blotName&&!C?this.replaceWith(c.default.create(this.statics.scope)):o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"format",this).call(this,_,C)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(_,C){return this.parent.isolate(this.offset(this.parent),this.length()),_===this.parent.statics.blotName?(this.parent.replaceWith(_,C),this):(this.parent.unwrap(),o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"replaceWith",this).call(this,_,C))}}],[{key:"formats",value:function(_){return _.tagName===this.tagName?void 0:o(w.__proto__||Object.getPrototypeOf(w),"formats",this).call(this,_)}}]),w}(d.default);g.blotName="list-item",g.tagName="LI";var y=function(x){p(w,x),i(w,null,[{key:"create",value:function(_){var C=_==="ordered"?"OL":"UL",j=o(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,C);return(_==="checked"||_==="unchecked")&&j.setAttribute("data-checked",_==="checked"),j}},{key:"formats",value:function(_){if(_.tagName==="OL")return"ordered";if(_.tagName==="UL")return _.hasAttribute("data-checked")?_.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function w(N){m(this,w);var _=v(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,N)),C=function(E){if(E.target.parentNode===N){var S=_.statics.formats(N),F=c.default.find(E.target);S==="checked"?F.format("list","unchecked"):S==="unchecked"&&F.format("list","checked")}};return N.addEventListener("touchstart",C),N.addEventListener("mousedown",C),_}return i(w,[{key:"format",value:function(_,C){this.children.length>0&&this.children.tail.format(_,C)}},{key:"formats",value:function(){return b({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(_,C){if(_ instanceof g)o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertBefore",this).call(this,_,C);else{var j=C==null?this.length():C.offset(this),E=this.split(j);E.parent.insertBefore(_,E)}}},{key:"optimize",value:function(_){o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"optimize",this).call(this,_);var C=this.next;C!=null&&C.prev===this&&C.statics.blotName===this.statics.blotName&&C.domNode.tagName===this.domNode.tagName&&C.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(C.moveChildren(this),C.remove())}},{key:"replace",value:function(_){if(_.statics.blotName!==this.statics.blotName){var C=c.default.create(this.statics.defaultChild);_.moveChildren(C),this.appendChild(C)}o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"replace",this).call(this,_)}}]),w}(f.default);y.blotName="list",y.scope=c.default.Scope.BLOCK_BLOT,y.tagName=["OL","UL"],y.defaultChild="list-item",y.allowedChildren=[g],n.ListItem=g,n.default=y},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(56),o=l(i);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,A){if(!(f instanceof A))throw new TypeError("Cannot call a class as a function")}function u(f,A){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:f}function d(f,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);f.prototype=Object.create(A&&A.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(f,A):f.__proto__=A)}var h=function(f){d(A,f);function A(){return c(this,A),u(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);h.blotName="italic",h.tagName=["EM","I"],n.default=h},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function b(m,v){for(var p=0;p<v.length;p++){var g=v[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(m,g.key,g)}}return function(m,v,p){return v&&b(m.prototype,v),p&&b(m,p),m}}(),o=function b(m,v,p){m===null&&(m=Function.prototype);var g=Object.getOwnPropertyDescriptor(m,v);if(g===void 0){var y=Object.getPrototypeOf(m);return y===null?void 0:b(y,v,p)}else{if("value"in g)return g.value;var x=g.get;return x===void 0?void 0:x.call(p)}},l=s(6),c=u(l);function u(b){return b&&b.__esModule?b:{default:b}}function d(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function f(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var A=function(b){f(m,b);function m(){return d(this,m),h(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return i(m,null,[{key:"create",value:function(p){return p==="super"?document.createElement("sup"):p==="sub"?document.createElement("sub"):o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,p)}},{key:"formats",value:function(p){if(p.tagName==="SUB")return"sub";if(p.tagName==="SUP")return"super"}}]),m}(c.default);A.blotName="script",A.tagName=["SUB","SUP"],n.default=A},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(6),o=l(i);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,A){if(!(f instanceof A))throw new TypeError("Cannot call a class as a function")}function u(f,A){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:f}function d(f,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);f.prototype=Object.create(A&&A.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(f,A):f.__proto__=A)}var h=function(f){d(A,f);function A(){return c(this,A),u(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);h.blotName="strike",h.tagName="S",n.default=h},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=s(6),o=l(i);function l(f){return f&&f.__esModule?f:{default:f}}function c(f,A){if(!(f instanceof A))throw new TypeError("Cannot call a class as a function")}function u(f,A){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:f}function d(f,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);f.prototype=Object.create(A&&A.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(f,A):f.__proto__=A)}var h=function(f){d(A,f);function A(){return c(this,A),u(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);h.blotName="underline",h.tagName="U",n.default=h},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function v(p,g){for(var y=0;y<g.length;y++){var x=g[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,g,y){return g&&v(p.prototype,g),y&&v(p,y),p}}(),o=function v(p,g,y){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,g);if(x===void 0){var w=Object.getPrototypeOf(p);return w===null?void 0:v(w,g,y)}else{if("value"in x)return x.value;var N=x.get;return N===void 0?void 0:N.call(y)}},l=s(0),c=d(l),u=s(27);function d(v){return v&&v.__esModule?v:{default:v}}function h(v,p){if(!(v instanceof p))throw new TypeError("Cannot call a class as a function")}function f(v,p){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:v}function A(v,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);v.prototype=Object.create(p&&p.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(v,p):v.__proto__=p)}var b=["alt","height","width"],m=function(v){A(p,v);function p(){return h(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return i(p,[{key:"format",value:function(y,x){b.indexOf(y)>-1?x?this.domNode.setAttribute(y,x):this.domNode.removeAttribute(y):o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"format",this).call(this,y,x)}}],[{key:"create",value:function(y){var x=o(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,y);return typeof y=="string"&&x.setAttribute("src",this.sanitize(y)),x}},{key:"formats",value:function(y){return b.reduce(function(x,w){return y.hasAttribute(w)&&(x[w]=y.getAttribute(w)),x},{})}},{key:"match",value:function(y){return/\.(jpe?g|gif|png)$/.test(y)||/^data:image\/.+;base64/.test(y)}},{key:"sanitize",value:function(y){return(0,u.sanitize)(y,["http","https","data"])?y:"//:0"}},{key:"value",value:function(y){return y.getAttribute("src")}}]),p}(c.default.Embed);m.blotName="image",m.tagName="IMG",n.default=m},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function v(p,g){for(var y=0;y<g.length;y++){var x=g[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(p,x.key,x)}}return function(p,g,y){return g&&v(p.prototype,g),y&&v(p,y),p}}(),o=function v(p,g,y){p===null&&(p=Function.prototype);var x=Object.getOwnPropertyDescriptor(p,g);if(x===void 0){var w=Object.getPrototypeOf(p);return w===null?void 0:v(w,g,y)}else{if("value"in x)return x.value;var N=x.get;return N===void 0?void 0:N.call(y)}},l=s(4),c=s(27),u=d(c);function d(v){return v&&v.__esModule?v:{default:v}}function h(v,p){if(!(v instanceof p))throw new TypeError("Cannot call a class as a function")}function f(v,p){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:v}function A(v,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);v.prototype=Object.create(p&&p.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(v,p):v.__proto__=p)}var b=["height","width"],m=function(v){A(p,v);function p(){return h(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return i(p,[{key:"format",value:function(y,x){b.indexOf(y)>-1?x?this.domNode.setAttribute(y,x):this.domNode.removeAttribute(y):o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"format",this).call(this,y,x)}}],[{key:"create",value:function(y){var x=o(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,y);return x.setAttribute("frameborder","0"),x.setAttribute("allowfullscreen",!0),x.setAttribute("src",this.sanitize(y)),x}},{key:"formats",value:function(y){return b.reduce(function(x,w){return y.hasAttribute(w)&&(x[w]=y.getAttribute(w)),x},{})}},{key:"sanitize",value:function(y){return u.default.sanitize(y)}},{key:"value",value:function(y){return y.getAttribute("src")}}]),p}(l.BlockEmbed);m.blotName="video",m.className="ql-video",m.tagName="IFRAME",n.default=m},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var i=function(){function y(x,w){for(var N=0;N<w.length;N++){var _=w[N];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,_.key,_)}}return function(x,w,N){return w&&y(x.prototype,w),N&&y(x,N),x}}(),o=function y(x,w,N){x===null&&(x=Function.prototype);var _=Object.getOwnPropertyDescriptor(x,w);if(_===void 0){var C=Object.getPrototypeOf(x);return C===null?void 0:y(C,w,N)}else{if("value"in _)return _.value;var j=_.get;return j===void 0?void 0:j.call(N)}},l=s(35),c=A(l),u=s(5),d=A(u),h=s(9),f=A(h);function A(y){return y&&y.__esModule?y:{default:y}}function b(y,x){if(!(y instanceof x))throw new TypeError("Cannot call a class as a function")}function m(y,x){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:y}function v(y,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(y,x):y.__proto__=x)}var p=function(y){v(x,y);function x(){return b(this,x),m(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return i(x,null,[{key:"create",value:function(N){var _=o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,N);return typeof N=="string"&&(window.katex.render(N,_,{throwOnError:!1,errorColor:"#f00"}),_.setAttribute("data-value",N)),_}},{key:"value",value:function(N){return N.getAttribute("data-value")}}]),x}(c.default);p.blotName="formula",p.className="ql-formula",p.tagName="SPAN";var g=function(y){v(x,y),i(x,null,[{key:"register",value:function(){d.default.register(p,!0)}}]);function x(){b(this,x);var w=m(this,(x.__proto__||Object.getPrototypeOf(x)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return w}return x}(f.default);n.FormulaBlot=p,n.default=g},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var i=function(){function N(_,C){for(var j=0;j<C.length;j++){var E=C[j];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(_,E.key,E)}}return function(_,C,j){return C&&N(_.prototype,C),j&&N(_,j),_}}(),o=function N(_,C,j){_===null&&(_=Function.prototype);var E=Object.getOwnPropertyDescriptor(_,C);if(E===void 0){var S=Object.getPrototypeOf(_);return S===null?void 0:N(S,C,j)}else{if("value"in E)return E.value;var F=E.get;return F===void 0?void 0:F.call(j)}},l=s(0),c=m(l),u=s(5),d=m(u),h=s(9),f=m(h),A=s(13),b=m(A);function m(N){return N&&N.__esModule?N:{default:N}}function v(N,_){if(!(N instanceof _))throw new TypeError("Cannot call a class as a function")}function p(N,_){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:N}function g(N,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);N.prototype=Object.create(_&&_.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(N,_):N.__proto__=_)}var y=function(N){g(_,N);function _(){return v(this,_),p(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return i(_,[{key:"replaceWith",value:function(j){this.domNode.textContent=this.domNode.textContent,this.attach(),o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"replaceWith",this).call(this,j)}},{key:"highlight",value:function(j){var E=this.domNode.textContent;this.cachedText!==E&&((E.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=j(E),this.domNode.normalize(),this.attach()),this.cachedText=E)}}]),_}(b.default);y.className="ql-syntax";var x=new c.default.Attributor.Class("token","hljs",{scope:c.default.Scope.INLINE}),w=function(N){g(_,N),i(_,null,[{key:"register",value:function(){d.default.register(x,!0),d.default.register(y,!0)}}]);function _(C,j){v(this,_);var E=p(this,(_.__proto__||Object.getPrototypeOf(_)).call(this,C,j));if(typeof E.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var S=null;return E.quill.on(d.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(S),S=setTimeout(function(){E.highlight(),S=null},E.options.interval)}),E.highlight(),E}return i(_,[{key:"highlight",value:function(){var j=this;if(!this.quill.selection.composing){this.quill.update(d.default.sources.USER);var E=this.quill.getSelection();this.quill.scroll.descendants(y).forEach(function(S){S.highlight(j.options.highlight)}),this.quill.update(d.default.sources.SILENT),E!=null&&this.quill.setSelection(E,d.default.sources.SILENT)}}}]),_}(f.default);w.DEFAULTS={highlight:function(){return window.hljs==null?null:function(N){var _=window.hljs.highlightAuto(N);return _.value}}(),interval:1e3},n.CodeBlock=y,n.CodeToken=x,n.default=w},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(r,n,s){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var i=function _(C,j,E){C===null&&(C=Function.prototype);var S=Object.getOwnPropertyDescriptor(C,j);if(S===void 0){var F=Object.getPrototypeOf(C);return F===null?void 0:_(F,j,E)}else{if("value"in S)return S.value;var I=S.get;return I===void 0?void 0:I.call(E)}},o=function(){function _(C,j){for(var E=0;E<j.length;E++){var S=j[E];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(C,S.key,S)}}return function(C,j,E){return j&&_(C.prototype,j),E&&_(C,E),C}}(),l=s(3),c=v(l),u=s(8),d=v(u),h=s(43),f=v(h),A=s(15),b=s(41),m=v(b);function v(_){return _&&_.__esModule?_:{default:_}}function p(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}function g(_,C){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:_}function y(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(_,C):_.__proto__=C)}var x=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],w=function(_){y(C,_);function C(j,E){p(this,C),E.modules.toolbar!=null&&E.modules.toolbar.container==null&&(E.modules.toolbar.container=x);var S=g(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,j,E));return S.quill.container.classList.add("ql-bubble"),S}return o(C,[{key:"extendToolbar",value:function(E){this.tooltip=new N(this.quill,this.options.bounds),this.tooltip.root.appendChild(E.container),this.buildButtons([].slice.call(E.container.querySelectorAll("button")),m.default),this.buildPickers([].slice.call(E.container.querySelectorAll("select")),m.default)}}]),C}(f.default);w.DEFAULTS=(0,c.default)(!0,{},f.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(C){C?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var N=function(_){y(C,_);function C(j,E){p(this,C);var S=g(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,j,E));return S.quill.on(d.default.events.EDITOR_CHANGE,function(F,I,O,M){if(F===d.default.events.SELECTION_CHANGE)if(I!=null&&I.length>0&&M===d.default.sources.USER){S.show(),S.root.style.left="0px",S.root.style.width="",S.root.style.width=S.root.offsetWidth+"px";var P=S.quill.getLines(I.index,I.length);if(P.length===1)S.position(S.quill.getBounds(I));else{var X=P[P.length-1],J=S.quill.getIndex(X),H=Math.min(X.length()-1,I.index+I.length-J),V=S.quill.getBounds(new A.Range(J,H));S.position(V)}}else document.activeElement!==S.textbox&&S.quill.hasFocus()&&S.hide()}),S}return o(C,[{key:"listen",value:function(){var E=this;i(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){E.root.classList.remove("ql-editing")}),this.quill.on(d.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!E.root.classList.contains("ql-hidden")){var S=E.quill.getSelection();S!=null&&E.position(E.quill.getBounds(S))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(E){var S=i(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"position",this).call(this,E),F=this.root.querySelector(".ql-tooltip-arrow");if(F.style.marginLeft="",S===0)return S;F.style.marginLeft=-1*S-F.offsetWidth/2+"px"}}]),C}(h.BaseTooltip);N.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=N,n.default=w},function(r,n,s){r.exports=s(63)}]).default})})($T);var BZ=$T.exports,kZ=ii&&ii.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rx=ii&&ii.__assign||function(){return rx=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},rx.apply(this,arguments)},SZ=ii&&ii.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,l=i.length;o<l;o++,s++)n[s]=i[o];return n},t1=ii&&ii.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Eo=t1(W),EZ=t1(cE),Qf=t1(CZ),jB=t1(BZ),FZ=function(e){kZ(t,e);function t(r){var n=e.call(this,r)||this;n.dirtyProps=["modules","formats","bounds","theme","children"],n.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],n.state={generation:0},n.selection=null,n.onEditorChange=function(i,o,l,c){var u,d,h,f;i==="text-change"?(d=(u=n).onEditorChangeText)===null||d===void 0||d.call(u,n.editor.root.innerHTML,o,c,n.unprivilegedEditor):i==="selection-change"&&((f=(h=n).onEditorChangeSelection)===null||f===void 0||f.call(h,o,c,n.unprivilegedEditor))};var s=n.isControlled()?r.value:r.defaultValue;return n.value=s??"",n}return t.prototype.validateProps=function(r){var n;if(Eo.default.Children.count(r.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Eo.default.Children.count(r.children)){var s=Eo.default.Children.only(r.children);if(((n=s)===null||n===void 0?void 0:n.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&r.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},t.prototype.shouldComponentUpdate=function(r,n){var s=this,i;if(this.validateProps(r),!this.editor||this.state.generation!==n.generation)return!0;if("value"in r){var o=this.getEditorContents(),l=(i=r.value,i??"");this.isEqualValue(l,o)||this.setEditorContents(this.editor,l)}return r.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,r.readOnly),SZ(this.cleanProps,this.dirtyProps).some(function(c){return!Qf.default(r[c],s.props[c])})},t.prototype.shouldComponentRegenerate=function(r){var n=this;return this.dirtyProps.some(function(s){return!Qf.default(r[s],n.props[s])})},t.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},t.prototype.componentWillUnmount=function(){this.destroyEditor()},t.prototype.componentDidUpdate=function(r,n){var s=this;if(this.editor&&this.shouldComponentRegenerate(r)){var i=this.editor.getContents(),o=this.editor.getSelection();this.regenerationSnapshot={delta:i,selection:o},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==n.generation){var l=this.regenerationSnapshot,i=l.delta,c=l.selection;delete this.regenerationSnapshot,this.instantiateEditor();var u=this.editor;u.setContents(i),CB(function(){return s.setEditorSelection(u,c)})}},t.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},t.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},t.prototype.isControlled=function(){return"value"in this.props},t.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},t.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},t.prototype.createEditor=function(r,n){var s=new jB.default(r,n);return n.tabIndex!=null&&this.setEditorTabIndex(s,n.tabIndex),this.hookEditor(s),s},t.prototype.hookEditor=function(r){this.unprivilegedEditor=this.makeUnprivilegedEditor(r),r.on("editor-change",this.onEditorChange)},t.prototype.unhookEditor=function(r){r.off("editor-change",this.onEditorChange)},t.prototype.getEditorContents=function(){return this.value},t.prototype.getEditorSelection=function(){return this.selection},t.prototype.isDelta=function(r){return r&&r.ops},t.prototype.isEqualValue=function(r,n){return this.isDelta(r)&&this.isDelta(n)?Qf.default(r.ops,n.ops):Qf.default(r,n)},t.prototype.setEditorContents=function(r,n){var s=this;this.value=n;var i=this.getEditorSelection();typeof n=="string"?r.setContents(r.clipboard.convert(n)):r.setContents(n),CB(function(){return s.setEditorSelection(r,i)})},t.prototype.setEditorSelection=function(r,n){if(this.selection=n,n){var s=r.getLength();n.index=Math.max(0,Math.min(n.index,s-1)),n.length=Math.max(0,Math.min(n.length,s-1-n.index)),r.setSelection(n)}},t.prototype.setEditorTabIndex=function(r,n){var s,i;!((i=(s=r)===null||s===void 0?void 0:s.scroll)===null||i===void 0)&&i.domNode&&(r.scroll.domNode.tabIndex=n)},t.prototype.setEditorReadOnly=function(r,n){n?r.disable():r.enable()},t.prototype.makeUnprivilegedEditor=function(r){var n=r;return{getHTML:function(){return n.root.innerHTML},getLength:n.getLength.bind(n),getText:n.getText.bind(n),getContents:n.getContents.bind(n),getSelection:n.getSelection.bind(n),getBounds:n.getBounds.bind(n)}},t.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var r=EZ.default.findDOMNode(this.editingArea);if(!r)throw new Error("Cannot find element for editing area");if(r.nodeType===3)throw new Error("Editing area cannot be a text node");return r},t.prototype.renderEditingArea=function(){var r=this,n=this.props,s=n.children,i=n.preserveWhitespace,o=this.state.generation,l={key:o,ref:function(c){r.editingArea=c}};return Eo.default.Children.count(s)?Eo.default.cloneElement(Eo.default.Children.only(s),l):i?Eo.default.createElement("pre",rx({},l)):Eo.default.createElement("div",rx({},l))},t.prototype.render=function(){var r;return Eo.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(r=this.props.className,r??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},t.prototype.onEditorChangeText=function(r,n,s,i){var o,l;if(this.editor){var c=this.isDelta(this.value)?i.getContents():i.getHTML();c!==this.getEditorContents()&&(this.lastDeltaChangeSet=n,this.value=c,(l=(o=this.props).onChange)===null||l===void 0||l.call(o,r,n,s,i))}},t.prototype.onEditorChangeSelection=function(r,n,s){var i,o,l,c,u,d;if(this.editor){var h=this.getEditorSelection(),f=!h&&r,A=h&&!r;Qf.default(r,h)||(this.selection=r,(o=(i=this.props).onChangeSelection)===null||o===void 0||o.call(i,r,n,s),f?(c=(l=this.props).onFocus)===null||c===void 0||c.call(l,r,n,s):A&&((d=(u=this.props).onBlur)===null||d===void 0||d.call(u,h,n,s)))}},t.prototype.focus=function(){this.editor&&this.editor.focus()},t.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},t.displayName="React Quill",t.Quill=jB.default,t.defaultProps={theme:"snow",modules:{},readOnly:!1},t}(Eo.default.Component);function CB(e){Promise.resolve().then(e)}var TZ=FZ;const IZ=Xk(TZ);function LZ({isOpen:e,onClose:t,mode:r="compose",replyTo:n,onSend:s}){const[i,o]=W.useState([]),[l,c]=W.useState([]),[u,d]=W.useState([]),[h,f]=W.useState(!1),[A,b]=W.useState(!1),[m,v]=W.useState(""),[p,g]=W.useState(""),[y,x]=W.useState(""),[w,N]=W.useState(""),[_,C]=W.useState(""),[j,E]=W.useState([]),[S,F]=W.useState(!1),[I,O]=W.useState(!1),[M,P]=W.useState(!1),[X,J]=W.useState([]),[H,V]=W.useState(!1),[K,B]=W.useState(null),[L,U]=W.useState(!1),D=W.useRef(null),Q=W.useRef(null),z=W.useRef(null),G=W.useRef(null);W.useEffect(()=>{if(r==="reply"&&n){N(n.subject.startsWith("Re: ")?n.subject:`Re: ${n.subject}`),o([{name:n.from,email:n.fromEmail}]);const we=Z(n);C(we)}else if(r==="forward"&&n){N(n.subject.startsWith("Fwd: ")?n.subject:`Fwd: ${n.subject}`);const we=R(n);C(we)}},[r,n]),W.useEffect(()=>{const we=Pe=>{G.current&&!G.current.contains(Pe.target)&&V(!1)};if(H)return document.addEventListener("mousedown",we),()=>document.removeEventListener("mousedown",we)},[H]);const Z=we=>{var pe;if(!we)return"";const Pe=we.date.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),ze=we.date.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),Ve=`<div style="margin-top: 20px; color: #666;">On ${Pe} at ${ze}, ${we.from} &lt;${we.fromEmail}&gt; wrote:</div>`,lt=`<blockquote style="margin: 10px 0 0 0; padding-left: 16px; border-left: 4px solid #ccc; color: #666;">${we.htmlBody||((pe=we.body)==null?void 0:pe.replace(/\n/g,"<br>"))||""}</blockquote>`;return`<p><br></p><p><br></p>${Ve}${lt}`},R=we=>{var Ve;if(!we)return"";const Pe=we.date.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});return`<p><br></p><p><br></p>${`<div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ccc;">
      <div style="color: #666; margin-bottom: 10px;">---------- Forwarded message ---------</div>
      <div style="color: #666;"><strong>From:</strong> ${we.from} &lt;${we.fromEmail}&gt;</div>
      <div style="color: #666;"><strong>Date:</strong> ${Pe}</div>
      <div style="color: #666;"><strong>Subject:</strong> ${we.subject}</div>
      <div style="margin-top: 15px;">${we.htmlBody||((Ve=we.body)==null?void 0:Ve.replace(/\n/g,"<br>"))||""}</div>
    </div>`}`},le=W.useCallback(async we=>{if(!we||we.length<2){J([]);return}try{const{data:Pe}=await ae.from("customers").select("customer_name, email, company_name").eq("is_active",!0).or(`customer_name.ilike.%${we}%,email.ilike.%${we}%,company_name.ilike.%${we}%`).limit(5),{data:ze}=await ae.from("crm_contacts").select("contact_person, email, company_name").eq("is_active",!0).or(`contact_person.ilike.%${we}%,email.ilike.%${we}%,company_name.ilike.%${we}%`).limit(5),Ve=[...(Pe||[]).map(lt=>({name:lt.customer_name,email:lt.email,company:lt.company_name})),...(ze||[]).map(lt=>({name:lt.contact_person,email:lt.email,company:lt.company_name}))];J(Ve),V(Ve.length>0)}catch(Pe){console.error("Error searching customers:",Pe)}},[]),ee=(we,Pe)=>{Pe==="to"?v(we):Pe==="cc"?g(we):x(we),B(Pe),le(we)},_e=(we,Pe)=>{const ze={name:we.name,email:we.email};Pe==="to"?(o([...i,ze]),v("")):Pe==="cc"?(c([...l,ze]),g("")):(d([...u,ze]),x("")),V(!1),J([])},se=(we,Pe)=>{Pe==="to"?o(i.filter((ze,Ve)=>Ve!==we)):Pe==="cc"?c(l.filter((ze,Ve)=>Ve!==we)):d(u.filter((ze,Ve)=>Ve!==we))},te=(we,Pe)=>{const ze=Pe==="to"?m:Pe==="cc"?p:y;if((we.key==="Enter"||we.key===","||we.key===" ")&&ze.trim()){if(we.preventDefault(),Ne(ze.trim())){const Ve={name:ze.trim(),email:ze.trim()};Pe==="to"?(o([...i,Ve]),v("")):Pe==="cc"?(c([...l,Ve]),g("")):(d([...u,Ve]),x("")),V(!1)}}else we.key==="Backspace"&&!ze&&(Pe==="to"&&i.length>0?o(i.slice(0,-1)):Pe==="cc"&&l.length>0?c(l.slice(0,-1)):Pe==="bcc"&&u.length>0&&d(u.slice(0,-1)))},Ne=we=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(we),Se=we=>{const Pe=we.target.files;if(!Pe)return;const ze=[];for(let Ve=0;Ve<Pe.length;Ve++){const lt=Pe[Ve];if(lt.size>25*1024*1024){alert(`File ${lt.name} is too large. Maximum size is 25MB.`);continue}ze.push({file:lt,name:lt.name,size:lt.size})}E(Ve=>[...Ve,...ze])},Ae=we=>{E(Pe=>Pe.filter((ze,Ve)=>Ve!==we))},ye=we=>we<1024?we+" B":we<1024*1024?(we/1024).toFixed(1)+" KB":(we/(1024*1024)).toFixed(1)+" MB",Le=async()=>{const we=[...i.map(Ve=>Ve.email)],Pe=[...l.map(Ve=>Ve.email)],ze=[...u.map(Ve=>Ve.email)];if(m.trim()&&Ne(m.trim())&&we.push(m.trim()),p.trim()&&Ne(p.trim())&&Pe.push(p.trim()),y.trim()&&Ne(y.trim())&&ze.push(y.trim()),we.length===0||!w||!_){alert("Please fill in recipient, subject, and message");return}F(!0);try{s&&await s({to:we,cc:Pe,bcc:ze,subject:w,body:_,attachments:j.map(Ve=>Ve.file)}),alert("Email sent successfully!"),t()}catch(Ve){console.error("Error sending email:",Ve),alert("Failed to send email. Please try again.")}finally{F(!1)}},Re={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image"],["clean"]]};return e?I?a.jsx("div",{className:"fixed bottom-0 right-4 w-64 bg-gray-800 text-white rounded-t-lg shadow-xl z-50",children:a.jsxs("div",{className:"flex items-center justify-between px-4 py-2 cursor-pointer",onClick:()=>O(!1),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ri,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium truncate",children:w||"New Message"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:we=>{we.stopPropagation(),O(!1)},className:"p-1 hover:bg-gray-700 rounded",children:a.jsx(I4,{className:"w-4 h-4"})}),a.jsx("button",{onClick:we=>{we.stopPropagation(),t()},className:"p-1 hover:bg-gray-700 rounded",children:a.jsx(Kr,{className:"w-4 h-4"})})]})]})}):a.jsxs("div",{className:`fixed ${M?"inset-0":"bottom-0 right-6 w-[480px] h-[600px]"} bg-white rounded-t-lg shadow-2xl z-40 flex flex-col`,children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-50 border-b border-gray-200 rounded-t-lg",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:r==="reply"?"Reply":r==="forward"?"Forward":"New Message"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>O(!0),className:"p-1.5 hover:bg-gray-200 rounded transition",title:"Minimize",children:a.jsx(Ug,{className:"w-4 h-4 text-gray-600"})}),a.jsx("button",{onClick:()=>P(!M),className:"p-1.5 hover:bg-gray-200 rounded transition",title:M?"Exit fullscreen":"Fullscreen",children:M?a.jsx(yR,{className:"w-4 h-4 text-gray-600"}):a.jsx(I4,{className:"w-4 h-4 text-gray-600"})}),a.jsx("button",{onClick:t,className:"p-1.5 hover:bg-gray-200 rounded transition",title:"Close",children:a.jsx(Kr,{className:"w-4 h-4 text-gray-600"})})]})]}),a.jsxs("div",{className:"border-b border-gray-200 bg-white",children:[a.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[a.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"To"}),a.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[i.map((we,Pe)=>a.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[a.jsx("span",{children:we.name}),a.jsx("button",{onClick:()=>se(Pe,"to"),className:"hover:text-blue-900",children:a.jsx(Kr,{className:"w-3 h-3"})})]},Pe)),a.jsx("input",{ref:z,type:"text",value:m,onChange:we=>ee(we.target.value,"to"),onKeyDown:we=>te(we,"to"),onFocus:()=>B("to"),onBlur:()=>{setTimeout(()=>V(!1),200)},placeholder:i.length===0?"Type or search recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs ml-2",children:[!h&&a.jsx("button",{onClick:()=>f(!0),className:"text-blue-600 hover:text-blue-700",children:"Cc"}),!A&&a.jsx("button",{onClick:()=>b(!0),className:"text-blue-600 hover:text-blue-700",children:"Bcc"})]})]}),h&&a.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[a.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"Cc"}),a.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[l.map((we,Pe)=>a.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[a.jsx("span",{children:we.name}),a.jsx("button",{onClick:()=>se(Pe,"cc"),className:"hover:text-blue-900",children:a.jsx(Kr,{className:"w-3 h-3"})})]},Pe)),a.jsx("input",{type:"text",value:p,onChange:we=>ee(we.target.value,"cc"),onKeyDown:we=>te(we,"cc"),onFocus:()=>B("cc"),onBlur:()=>{setTimeout(()=>V(!1),200)},placeholder:l.length===0?"Type or search Cc recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]})]}),A&&a.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[a.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"Bcc"}),a.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[u.map((we,Pe)=>a.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[a.jsx("span",{children:we.name}),a.jsx("button",{onClick:()=>se(Pe,"bcc"),className:"hover:text-blue-900",children:a.jsx(Kr,{className:"w-3 h-3"})})]},Pe)),a.jsx("input",{type:"text",value:y,onChange:we=>ee(we.target.value,"bcc"),onKeyDown:we=>te(we,"bcc"),onFocus:()=>B("bcc"),onBlur:()=>{setTimeout(()=>V(!1),200)},placeholder:u.length===0?"Type or search Bcc recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]})]}),H&&X.length>0&&K&&a.jsx("div",{ref:G,className:"absolute bg-white border border-gray-200 shadow-lg rounded-lg mt-1 max-h-48 overflow-y-auto z-50 w-96 ml-16",children:X.map((we,Pe)=>a.jsxs("button",{onMouseDown:ze=>{ze.preventDefault(),_e(we,K)},className:"w-full px-4 py-2 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:we.name}),a.jsx("div",{className:"text-xs text-gray-500",children:we.email}),we.company&&a.jsx("div",{className:"text-xs text-gray-400",children:we.company})]},Pe))}),a.jsx("div",{className:"px-4 pb-2 text-[11px] text-gray-500 italic",children:"Tip: Type email addresses and press Enter, comma, or space to add. Or search from contacts."}),a.jsxs("div",{className:"flex items-center px-4 py-2",children:[a.jsx("span",{className:"text-sm text-gray-600 w-12",children:"Subject"}),a.jsx("input",{type:"text",value:w,onChange:we=>N(we.target.value),placeholder:"Subject",className:"flex-1 outline-none text-sm"})]})]}),a.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[a.jsx("style",{children:`
          .quill-editor-container .ql-container {
            font-size: 14px;
            font-family: Arial, sans-serif;
            overflow-y: auto !important;
            max-height: 100%;
          }
          .quill-editor-container .ql-editor {
            min-height: 200px;
            overflow-y: auto !important;
          }
          .quill-editor-container .ql-editor table {
            border-collapse: collapse;
            width: 100%;
            margin: 12px 0;
          }
          .quill-editor-container .ql-editor table td,
          .quill-editor-container .ql-editor table th {
            border: 1px solid #ddd;
            padding: 8px;
          }
          .quill-editor-container .ql-editor blockquote {
            border-left: 4px solid #ccc;
            padding-left: 16px;
            color: #666;
            margin: 10px 0;
          }
          .quill-editor-container .ql-editor img {
            max-width: 100%;
            height: auto;
          }
        `}),a.jsx(IZ,{ref:Q,theme:"snow",value:_,onChange:C,modules:Re,className:"quill-editor-container flex-1",style:{display:"flex",flexDirection:"column",height:"100%"}})]}),j.length>0&&a.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 max-h-32 overflow-y-auto",children:a.jsx("div",{className:"space-y-1",children:j.map((we,Pe)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx(fo,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),a.jsx("span",{className:"text-sm text-gray-700 truncate",children:we.name}),a.jsxs("span",{className:"text-xs text-gray-500 flex-shrink-0",children:["(",ye(we.size),")"]})]}),a.jsx("button",{onClick:()=>Ae(Pe),className:"text-red-600 hover:text-red-700 ml-2",children:a.jsx(Kr,{className:"w-4 h-4"})})]},Pe))})}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white rounded-b-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:Le,disabled:S||i.length===0&&(!m.trim()||!Ne(m.trim()))||!w||!_,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:S?a.jsxs(a.Fragment,{children:[a.jsx(Mo,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ri,{className:"w-4 h-4"}),"Send"]})}),a.jsx("input",{ref:D,type:"file",multiple:!0,onChange:Se,className:"hidden"}),a.jsx("button",{onClick:()=>{var we;return(we=D.current)==null?void 0:we.click()},className:"p-2 hover:bg-gray-100 rounded transition",title:"Attach files",children:a.jsx(fo,{className:"w-5 h-5 text-gray-600"})})]}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded transition",title:"Discard",children:a.jsx(nn,{className:"w-5 h-5 text-gray-600"})})]})]}):null}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:VT,setPrototypeOf:BB,isFrozen:OZ,getPrototypeOf:UZ,getOwnPropertyDescriptor:PZ}=Object;let{freeze:_s,seal:Mi,create:Qw}=Object,{apply:Mw,construct:Hw}=typeof Reflect<"u"&&Reflect;_s||(_s=function(t){return t});Mi||(Mi=function(t){return t});Mw||(Mw=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];return t.apply(r,s)});Hw||(Hw=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return new t(...n)});const _m=Ns(Array.prototype.forEach),DZ=Ns(Array.prototype.lastIndexOf),kB=Ns(Array.prototype.pop),Mf=Ns(Array.prototype.push),RZ=Ns(Array.prototype.splice),sg=Ns(String.prototype.toLowerCase),vv=Ns(String.prototype.toString),bv=Ns(String.prototype.match),Hf=Ns(String.prototype.replace),QZ=Ns(String.prototype.indexOf),MZ=Ns(String.prototype.trim),to=Ns(Object.prototype.hasOwnProperty),hs=Ns(RegExp.prototype.test),qf=HZ(TypeError);function Ns(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return Mw(e,t,n)}}function HZ(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Hw(e,r)}}function fr(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sg;BB&&BB(e,null);let n=t.length;for(;n--;){let s=t[n];if(typeof s=="string"){const i=r(s);i!==s&&(OZ(t)||(t[n]=i),s=i)}e[s]=!0}return e}function qZ(e){for(let t=0;t<e.length;t++)to(e,t)||(e[t]=null);return e}function fl(e){const t=Qw(null);for(const[r,n]of VT(e))to(e,r)&&(Array.isArray(n)?t[r]=qZ(n):n&&typeof n=="object"&&n.constructor===Object?t[r]=fl(n):t[r]=n);return t}function Kf(e,t){for(;e!==null;){const n=PZ(e,t);if(n){if(n.get)return Ns(n.get);if(typeof n.value=="function")return Ns(n.value)}e=UZ(e)}function r(){return null}return r}const SB=_s(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),wv=_s(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),_v=_s(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),KZ=_s(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Nv=_s(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),$Z=_s(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),EB=_s(["#text"]),FB=_s(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),jv=_s(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),TB=_s(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Nm=_s(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),VZ=Mi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),GZ=Mi(/<%[\w\W]*|[\w\W]*%>/gm),WZ=Mi(/\$\{[\w\W]*/gm),zZ=Mi(/^data-[\-\w.\u00B7-\uFFFF]+$/),XZ=Mi(/^aria-[\-\w]+$/),GT=Mi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),YZ=Mi(/^(?:\w+script|data):/i),JZ=Mi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),WT=Mi(/^html$/i),ZZ=Mi(/^[a-z][.\w]*(-[.\w]+)+$/i);var IB=Object.freeze({__proto__:null,ARIA_ATTR:XZ,ATTR_WHITESPACE:JZ,CUSTOM_ELEMENT:ZZ,DATA_ATTR:zZ,DOCTYPE_NAME:WT,ERB_EXPR:GZ,IS_ALLOWED_URI:GT,IS_SCRIPT_OR_DATA:YZ,MUSTACHE_EXPR:VZ,TMPLIT_EXPR:WZ});const $f={element:1,text:3,progressingInstruction:7,comment:8,document:9},eee=function(){return typeof window>"u"?null:window},tee=function(t,r){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";r&&r.hasAttribute(s)&&(n=r.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},LB=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function zT(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eee();const t=Te=>zT(Te);if(t.version="3.3.0",t.removed=[],!e||!e.document||e.document.nodeType!==$f.document||!e.Element)return t.isSupported=!1,t;let{document:r}=e;const n=r,s=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:u,NamedNodeMap:d=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:A}=e,b=c.prototype,m=Kf(b,"cloneNode"),v=Kf(b,"remove"),p=Kf(b,"nextSibling"),g=Kf(b,"childNodes"),y=Kf(b,"parentNode");if(typeof o=="function"){const Te=r.createElement("template");Te.content&&Te.content.ownerDocument&&(r=Te.content.ownerDocument)}let x,w="";const{implementation:N,createNodeIterator:_,createDocumentFragment:C,getElementsByTagName:j}=r,{importNode:E}=n;let S=LB();t.isSupported=typeof VT=="function"&&typeof y=="function"&&N&&N.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:F,ERB_EXPR:I,TMPLIT_EXPR:O,DATA_ATTR:M,ARIA_ATTR:P,IS_SCRIPT_OR_DATA:X,ATTR_WHITESPACE:J,CUSTOM_ELEMENT:H}=IB;let{IS_ALLOWED_URI:V}=IB,K=null;const B=fr({},[...SB,...wv,..._v,...Nv,...EB]);let L=null;const U=fr({},[...FB,...jv,...TB,...Nm]);let D=Object.seal(Qw(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,z=null;const G=Object.seal(Qw(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Z=!0,R=!0,le=!1,ee=!0,_e=!1,se=!0,te=!1,Ne=!1,Se=!1,Ae=!1,ye=!1,Le=!1,Re=!0,we=!1;const Pe="user-content-";let ze=!0,Ve=!1,lt={},pe=null;const Fe=fr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ke=null;const Xe=fr({},["audio","video","img","source","image","track"]);let tt=null;const st=fr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ke="http://www.w3.org/1998/Math/MathML",Ee="http://www.w3.org/2000/svg",Je="http://www.w3.org/1999/xhtml";let rt=Je,Ze=!1,xt=null;const mt=fr({},[ke,Ee,Je],vv);let bt=fr({},["mi","mo","mn","ms","mtext"]),vt=fr({},["annotation-xml"]);const Nt=fr({},["title","style","font","a","script"]);let Bt=null;const tr=["application/xhtml+xml","text/html"],Ma="text/html";let rr=null,dn=null;const ta=r.createElement("form"),Pt=function(be){return be instanceof RegExp||be instanceof Function},qn=function(){let be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(dn&&dn===be)){if((!be||typeof be!="object")&&(be={}),be=fl(be),Bt=tr.indexOf(be.PARSER_MEDIA_TYPE)===-1?Ma:be.PARSER_MEDIA_TYPE,rr=Bt==="application/xhtml+xml"?vv:sg,K=to(be,"ALLOWED_TAGS")?fr({},be.ALLOWED_TAGS,rr):B,L=to(be,"ALLOWED_ATTR")?fr({},be.ALLOWED_ATTR,rr):U,xt=to(be,"ALLOWED_NAMESPACES")?fr({},be.ALLOWED_NAMESPACES,vv):mt,tt=to(be,"ADD_URI_SAFE_ATTR")?fr(fl(st),be.ADD_URI_SAFE_ATTR,rr):st,Ke=to(be,"ADD_DATA_URI_TAGS")?fr(fl(Xe),be.ADD_DATA_URI_TAGS,rr):Xe,pe=to(be,"FORBID_CONTENTS")?fr({},be.FORBID_CONTENTS,rr):Fe,Q=to(be,"FORBID_TAGS")?fr({},be.FORBID_TAGS,rr):fl({}),z=to(be,"FORBID_ATTR")?fr({},be.FORBID_ATTR,rr):fl({}),lt=to(be,"USE_PROFILES")?be.USE_PROFILES:!1,Z=be.ALLOW_ARIA_ATTR!==!1,R=be.ALLOW_DATA_ATTR!==!1,le=be.ALLOW_UNKNOWN_PROTOCOLS||!1,ee=be.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_e=be.SAFE_FOR_TEMPLATES||!1,se=be.SAFE_FOR_XML!==!1,te=be.WHOLE_DOCUMENT||!1,Ae=be.RETURN_DOM||!1,ye=be.RETURN_DOM_FRAGMENT||!1,Le=be.RETURN_TRUSTED_TYPE||!1,Se=be.FORCE_BODY||!1,Re=be.SANITIZE_DOM!==!1,we=be.SANITIZE_NAMED_PROPS||!1,ze=be.KEEP_CONTENT!==!1,Ve=be.IN_PLACE||!1,V=be.ALLOWED_URI_REGEXP||GT,rt=be.NAMESPACE||Je,bt=be.MATHML_TEXT_INTEGRATION_POINTS||bt,vt=be.HTML_INTEGRATION_POINTS||vt,D=be.CUSTOM_ELEMENT_HANDLING||{},be.CUSTOM_ELEMENT_HANDLING&&Pt(be.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(D.tagNameCheck=be.CUSTOM_ELEMENT_HANDLING.tagNameCheck),be.CUSTOM_ELEMENT_HANDLING&&Pt(be.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(D.attributeNameCheck=be.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),be.CUSTOM_ELEMENT_HANDLING&&typeof be.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(D.allowCustomizedBuiltInElements=be.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(R=!1),ye&&(Ae=!0),lt&&(K=fr({},EB),L=[],lt.html===!0&&(fr(K,SB),fr(L,FB)),lt.svg===!0&&(fr(K,wv),fr(L,jv),fr(L,Nm)),lt.svgFilters===!0&&(fr(K,_v),fr(L,jv),fr(L,Nm)),lt.mathMl===!0&&(fr(K,Nv),fr(L,TB),fr(L,Nm))),be.ADD_TAGS&&(typeof be.ADD_TAGS=="function"?G.tagCheck=be.ADD_TAGS:(K===B&&(K=fl(K)),fr(K,be.ADD_TAGS,rr))),be.ADD_ATTR&&(typeof be.ADD_ATTR=="function"?G.attributeCheck=be.ADD_ATTR:(L===U&&(L=fl(L)),fr(L,be.ADD_ATTR,rr))),be.ADD_URI_SAFE_ATTR&&fr(tt,be.ADD_URI_SAFE_ATTR,rr),be.FORBID_CONTENTS&&(pe===Fe&&(pe=fl(pe)),fr(pe,be.FORBID_CONTENTS,rr)),ze&&(K["#text"]=!0),te&&fr(K,["html","head","body"]),K.table&&(fr(K,["tbody"]),delete Q.tbody),be.TRUSTED_TYPES_POLICY){if(typeof be.TRUSTED_TYPES_POLICY.createHTML!="function")throw qf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof be.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=be.TRUSTED_TYPES_POLICY,w=x.createHTML("")}else x===void 0&&(x=tee(A,s)),x!==null&&typeof w=="string"&&(w=x.createHTML(""));_s&&_s(be),dn=be}},ra=fr({},[...wv,..._v,...KZ]),Sn=fr({},[...Nv,...$Z]),ma=function(be){let Me=y(be);(!Me||!Me.tagName)&&(Me={namespaceURI:rt,tagName:"template"});const et=sg(be.tagName),dt=sg(Me.tagName);return xt[be.namespaceURI]?be.namespaceURI===Ee?Me.namespaceURI===Je?et==="svg":Me.namespaceURI===ke?et==="svg"&&(dt==="annotation-xml"||bt[dt]):!!ra[et]:be.namespaceURI===ke?Me.namespaceURI===Je?et==="math":Me.namespaceURI===Ee?et==="math"&&vt[dt]:!!Sn[et]:be.namespaceURI===Je?Me.namespaceURI===Ee&&!vt[dt]||Me.namespaceURI===ke&&!bt[dt]?!1:!Sn[et]&&(Nt[et]||!ra[et]):!!(Bt==="application/xhtml+xml"&&xt[be.namespaceURI]):!1},Ar=function(be){Mf(t.removed,{element:be});try{y(be).removeChild(be)}catch{v(be)}},Cr=function(be,Me){try{Mf(t.removed,{attribute:Me.getAttributeNode(be),from:Me})}catch{Mf(t.removed,{attribute:null,from:Me})}if(Me.removeAttribute(be),be==="is")if(Ae||ye)try{Ar(Me)}catch{}else try{Me.setAttribute(be,"")}catch{}},de=function(be){let Me=null,et=null;if(Se)be="<remove></remove>"+be;else{const Ct=bv(be,/^[\r\n\t ]+/);et=Ct&&Ct[0]}Bt==="application/xhtml+xml"&&rt===Je&&(be='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+be+"</body></html>");const dt=x?x.createHTML(be):be;if(rt===Je)try{Me=new f().parseFromString(dt,Bt)}catch{}if(!Me||!Me.documentElement){Me=N.createDocument(rt,"template",null);try{Me.documentElement.innerHTML=Ze?w:dt}catch{}}const it=Me.body||Me.documentElement;return be&&et&&it.insertBefore(r.createTextNode(et),it.childNodes[0]||null),rt===Je?j.call(Me,te?"html":"body")[0]:te?Me.documentElement:it},ne=function(be){return _.call(be.ownerDocument||be,be,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},oe=function(be){return be instanceof h&&(typeof be.nodeName!="string"||typeof be.textContent!="string"||typeof be.removeChild!="function"||!(be.attributes instanceof d)||typeof be.removeAttribute!="function"||typeof be.setAttribute!="function"||typeof be.namespaceURI!="string"||typeof be.insertBefore!="function"||typeof be.hasChildNodes!="function")},ie=function(be){return typeof l=="function"&&be instanceof l};function xe(Te,be,Me){_m(Te,et=>{et.call(t,be,Me,dn)})}const me=function(be){let Me=null;if(xe(S.beforeSanitizeElements,be,null),oe(be))return Ar(be),!0;const et=rr(be.nodeName);if(xe(S.uponSanitizeElement,be,{tagName:et,allowedTags:K}),se&&be.hasChildNodes()&&!ie(be.firstElementChild)&&hs(/<[/\w!]/g,be.innerHTML)&&hs(/<[/\w!]/g,be.textContent)||be.nodeType===$f.progressingInstruction||se&&be.nodeType===$f.comment&&hs(/<[/\w]/g,be.data))return Ar(be),!0;if(!(G.tagCheck instanceof Function&&G.tagCheck(et))&&(!K[et]||Q[et])){if(!Q[et]&&Qe(et)&&(D.tagNameCheck instanceof RegExp&&hs(D.tagNameCheck,et)||D.tagNameCheck instanceof Function&&D.tagNameCheck(et)))return!1;if(ze&&!pe[et]){const dt=y(be)||be.parentNode,it=g(be)||be.childNodes;if(it&&dt){const Ct=it.length;for(let Xt=Ct-1;Xt>=0;--Xt){const Vt=m(it[Xt],!0);Vt.__removalCount=(be.__removalCount||0)+1,dt.insertBefore(Vt,p(be))}}}return Ar(be),!0}return be instanceof c&&!ma(be)||(et==="noscript"||et==="noembed"||et==="noframes")&&hs(/<\/no(script|embed|frames)/i,be.innerHTML)?(Ar(be),!0):(_e&&be.nodeType===$f.text&&(Me=be.textContent,_m([F,I,O],dt=>{Me=Hf(Me,dt," ")}),be.textContent!==Me&&(Mf(t.removed,{element:be.cloneNode()}),be.textContent=Me)),xe(S.afterSanitizeElements,be,null),!1)},Ue=function(be,Me,et){if(Re&&(Me==="id"||Me==="name")&&(et in r||et in ta))return!1;if(!(R&&!z[Me]&&hs(M,Me))){if(!(Z&&hs(P,Me))){if(!(G.attributeCheck instanceof Function&&G.attributeCheck(Me,be))){if(!L[Me]||z[Me]){if(!(Qe(be)&&(D.tagNameCheck instanceof RegExp&&hs(D.tagNameCheck,be)||D.tagNameCheck instanceof Function&&D.tagNameCheck(be))&&(D.attributeNameCheck instanceof RegExp&&hs(D.attributeNameCheck,Me)||D.attributeNameCheck instanceof Function&&D.attributeNameCheck(Me,be))||Me==="is"&&D.allowCustomizedBuiltInElements&&(D.tagNameCheck instanceof RegExp&&hs(D.tagNameCheck,et)||D.tagNameCheck instanceof Function&&D.tagNameCheck(et))))return!1}else if(!tt[Me]){if(!hs(V,Hf(et,J,""))){if(!((Me==="src"||Me==="xlink:href"||Me==="href")&&be!=="script"&&QZ(et,"data:")===0&&Ke[be])){if(!(le&&!hs(X,Hf(et,J,"")))){if(et)return!1}}}}}}}return!0},Qe=function(be){return be!=="annotation-xml"&&bv(be,H)},qe=function(be){xe(S.beforeSanitizeAttributes,be,null);const{attributes:Me}=be;if(!Me||oe(be))return;const et={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:L,forceKeepAttr:void 0};let dt=Me.length;for(;dt--;){const it=Me[dt],{name:Ct,namespaceURI:Xt,value:Vt}=it,_r=rr(Ct),ja=Vt;let cr=Ct==="value"?ja:MZ(ja);if(et.attrName=_r,et.attrValue=cr,et.keepAttr=!0,et.forceKeepAttr=void 0,xe(S.uponSanitizeAttribute,be,et),cr=et.attrValue,we&&(_r==="id"||_r==="name")&&(Cr(Ct,be),cr=Pe+cr),se&&hs(/((--!?|])>)|<\/(style|title|textarea)/i,cr)){Cr(Ct,be);continue}if(_r==="attributename"&&bv(cr,"href")){Cr(Ct,be);continue}if(et.forceKeepAttr)continue;if(!et.keepAttr){Cr(Ct,be);continue}if(!ee&&hs(/\/>/i,cr)){Cr(Ct,be);continue}_e&&_m([F,I,O],Qr=>{cr=Hf(cr,Qr," ")});const Xr=rr(be.nodeName);if(!Ue(Xr,_r,cr)){Cr(Ct,be);continue}if(x&&typeof A=="object"&&typeof A.getAttributeType=="function"&&!Xt)switch(A.getAttributeType(Xr,_r)){case"TrustedHTML":{cr=x.createHTML(cr);break}case"TrustedScriptURL":{cr=x.createScriptURL(cr);break}}if(cr!==ja)try{Xt?be.setAttributeNS(Xt,Ct,cr):be.setAttribute(Ct,cr),oe(be)?Ar(be):kB(t.removed)}catch{Cr(Ct,be)}}xe(S.afterSanitizeAttributes,be,null)},Ge=function Te(be){let Me=null;const et=ne(be);for(xe(S.beforeSanitizeShadowDOM,be,null);Me=et.nextNode();)xe(S.uponSanitizeShadowNode,Me,null),me(Me),qe(Me),Me.content instanceof i&&Te(Me.content);xe(S.afterSanitizeShadowDOM,be,null)};return t.sanitize=function(Te){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me=null,et=null,dt=null,it=null;if(Ze=!Te,Ze&&(Te="<!-->"),typeof Te!="string"&&!ie(Te))if(typeof Te.toString=="function"){if(Te=Te.toString(),typeof Te!="string")throw qf("dirty is not a string, aborting")}else throw qf("toString is not a function");if(!t.isSupported)return Te;if(Ne||qn(be),t.removed=[],typeof Te=="string"&&(Ve=!1),Ve){if(Te.nodeName){const Vt=rr(Te.nodeName);if(!K[Vt]||Q[Vt])throw qf("root node is forbidden and cannot be sanitized in-place")}}else if(Te instanceof l)Me=de("<!---->"),et=Me.ownerDocument.importNode(Te,!0),et.nodeType===$f.element&&et.nodeName==="BODY"||et.nodeName==="HTML"?Me=et:Me.appendChild(et);else{if(!Ae&&!_e&&!te&&Te.indexOf("<")===-1)return x&&Le?x.createHTML(Te):Te;if(Me=de(Te),!Me)return Ae?null:Le?w:""}Me&&Se&&Ar(Me.firstChild);const Ct=ne(Ve?Te:Me);for(;dt=Ct.nextNode();)me(dt),qe(dt),dt.content instanceof i&&Ge(dt.content);if(Ve)return Te;if(Ae){if(ye)for(it=C.call(Me.ownerDocument);Me.firstChild;)it.appendChild(Me.firstChild);else it=Me;return(L.shadowroot||L.shadowrootmode)&&(it=E.call(n,it,!0)),it}let Xt=te?Me.outerHTML:Me.innerHTML;return te&&K["!doctype"]&&Me.ownerDocument&&Me.ownerDocument.doctype&&Me.ownerDocument.doctype.name&&hs(WT,Me.ownerDocument.doctype.name)&&(Xt="<!DOCTYPE "+Me.ownerDocument.doctype.name+`>
`+Xt),_e&&_m([F,I,O],Vt=>{Xt=Hf(Xt,Vt," ")}),x&&Le?x.createHTML(Xt):Xt},t.setConfig=function(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qn(Te),Ne=!0},t.clearConfig=function(){dn=null,Ne=!1},t.isValidAttribute=function(Te,be,Me){dn||qn({});const et=rr(Te),dt=rr(be);return Ue(et,dt,Me)},t.addHook=function(Te,be){typeof be=="function"&&Mf(S[Te],be)},t.removeHook=function(Te,be){if(be!==void 0){const Me=DZ(S[Te],be);return Me===-1?void 0:RZ(S[Te],Me,1)[0]}return kB(S[Te])},t.removeHooks=function(Te){S[Te]=[]},t.removeAllHooks=function(){S=LB()},t}var XT=zT();const ree=Object.freeze(Object.defineProperty({__proto__:null,default:XT},Symbol.toStringTag,{value:"Module"}));function YT({htmlContent:e,className:t=""}){const r=W.useRef(null),[n,s]=W.useState(500),[i,o]=W.useState({});return W.useEffect(()=>{var g;if(!r.current||!e)return;const l=r.current;let d=(y=>{const x=document.createElement("textarea");return x.innerHTML=y,x.value})(e);d=d.replace(/<blockquote[^>]*>([\s\S]*?)<\/blockquote>/gi,(y,x,w)=>{const N=Math.random().toString(36).substr(2,9);return`<div class="quoted-section" data-quote-id="${N}">
          <div class="quoted-toggle" onclick="toggleQuote('${N}')">
            <span class="toggle-icon">...</span>
          </div>
          <blockquote class="quoted-content" id="quote-${N}" style="display: none;">${x}</blockquote>
        </div>`});const A=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          
      <style>
        * {
          box-sizing: border-box;
        }
        body {
          font-family: Arial, sans-serif;
          font-size: 14px;
          line-height: 1.6;
          color: #202124;
          margin: 0;
          padding: 16px;
          background: white;
          overflow-x: hidden;
          word-wrap: break-word;
        }

        /* Table styling - Gmail style */
        table {
          border-collapse: collapse !important;
          width: auto !important;
          max-width: 100%;
          margin: 12px 0;
          font-size: 13px;
        }

        table, th, td {
          border: 1px solid #000 !important;
        }

        th, td {
          padding: 6px 10px !important;
          text-align: left;
          vertical-align: top;
          word-break: break-word;
        }

        th {
          font-weight: 700 !important;
        }

        /* Preserve inline styles and colors */
        th[bgcolor], td[bgcolor] {
          /* Browser will apply bgcolor attribute */
        }

        /* Common email table colors */
        [bgcolor="#FFFF00"], [bgcolor="yellow"], [style*="background:yellow"], [style*="background-color:yellow"] {
          background-color: #FFFF00 !important;
        }

        [bgcolor="#E6E6FA"], [bgcolor="lavender"], [style*="background:lavender"], [style*="background-color:lavender"] {
          background-color: #E6E6FA !important;
        }

        [style*="color:blue"], [style*="color:#0000FF"] {
          color: #0000FF !important;
        }

        [style*="color:darkblue"], [style*="color:#00008B"] {
          color: #00008B !important;
        }

        /* Typography */
        p {
          margin: 8px 0;
        }

        a {
          color: #1a73e8;
          text-decoration: none;
        }

        a:hover {
          text-decoration: underline;
        }

        strong, b {
          font-weight: 700;
        }

        em, i {
          font-style: italic;
        }

        /* Lists */
        ul, ol {
          margin: 8px 0;
          padding-left: 24px;
        }

        li {
          margin: 4px 0;
        }

        /* Blockquotes */
        blockquote {
          margin: 8px 0;
          padding-left: 16px;
          border-left: 4px solid #ccc;
          color: #666;
        }

        /* Quoted section styling */
        .quoted-section {
          margin: 12px 0;
        }

        .quoted-toggle {
          display: inline-block;
          color: #1a73e8;
          cursor: pointer;
          font-size: 13px;
          padding: 4px 8px;
          border-radius: 4px;
          user-select: none;
        }

        .quoted-toggle:hover {
          background-color: #f0f0f0;
        }

        .toggle-icon {
          display: inline-block;
          font-weight: bold;
        }

        .quoted-content {
          margin-top: 8px;
          padding-left: 16px;
          border-left: 4px solid #ccc;
          color: #666;
        }

        /* Headers */
        h1, h2, h3, h4, h5, h6 {
          margin: 12px 0 8px 0;
          font-weight: 700;
          line-height: 1.3;
        }

        /* Images */
        img {
          max-width: 100%;
          height: auto;
        }

        /* Horizontal rules */
        hr {
          border: none;
          border-top: 1px solid #dadce0;
          margin: 16px 0;
        }

        /* Prevent overflow */
        pre {
          white-space: pre-wrap;
          word-wrap: break-word;
          overflow-x: auto;
        }

        /* Center tag support */
        center {
          text-align: center;
        }
      </style>
    
          <script>
            function toggleQuote(id) {
              const content = document.getElementById('quote-' + id);
              const toggle = content.previousElementSibling.querySelector('.toggle-icon');

              if (content.style.display === 'none') {
                content.style.display = 'block';
                toggle.textContent = '';
              } else {
                content.style.display = 'none';
                toggle.textContent = '...';
              }
            }
          <\/script>
        </head>
        <body>
          ${XT.sanitize(d,{ALLOWED_TAGS:["html","head","body","meta","title","style","p","br","div","span","a","img","strong","em","u","b","i","s","strike","h1","h2","h3","h4","h5","h6","ul","ol","li","table","thead","tbody","tfoot","tr","th","td","font","center","blockquote","pre","code","hr","sup","sub"],ALLOWED_ATTR:["style","class","id","href","target","rel","src","alt","title","width","height","align","valign","border","cellpadding","cellspacing","bgcolor","color","face","size","data-quote-id","onclick"],ALLOW_DATA_ATTR:!0,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i})}
        </body>
      </html>
    `,b=new Blob([A],{type:"text/html; charset=UTF-8"}),m=URL.createObjectURL(b);if(l.src=m,!(l.contentDocument||((g=l.contentWindow)==null?void 0:g.document)))return;const p=()=>{var y;try{const x=l.contentDocument||((y=l.contentWindow)==null?void 0:y.document);if(!x)return;const w=()=>{const _=x.body,C=x.documentElement,j=Math.max((_==null?void 0:_.scrollHeight)||0,(_==null?void 0:_.offsetHeight)||0,(C==null?void 0:C.clientHeight)||0,(C==null?void 0:C.scrollHeight)||0,(C==null?void 0:C.offsetHeight)||0);s(Math.max(j+20,100))};w();const N=new ResizeObserver(w);x.body&&N.observe(x.body),setTimeout(w,150),l.__cleanup=()=>{N.disconnect(),URL.revokeObjectURL(m)}}catch(x){console.error("Error measuring iframe height:",x)}};return l.addEventListener("load",p),()=>{l.removeEventListener("load",p),l.__cleanup&&l.__cleanup(),URL.revokeObjectURL(m)}},[e]),!e||e.trim()===""?a.jsx("div",{className:`text-gray-500 italic p-4 ${t}`,children:"No email content available"}):a.jsx("iframe",{ref:r,title:"Email Content",className:`w-full border-0 ${t}`,style:{height:`${n}px`,minHeight:"100px",maxHeight:"800px"},sandbox:"allow-same-origin",loading:"lazy"})}function nee(){const{setCurrentPage:e}=Ho(),[t,r]=W.useState(null),[n,s]=W.useState(!0),[i,o]=W.useState(!1),[l,c]=W.useState([]),[u,d]=W.useState(null),[h,f]=W.useState("INBOX"),[A,b]=W.useState(""),[m,v]=W.useState(null),[p,g]=W.useState(null),[y,x]=W.useState(!1),[w,N]=W.useState(!1),[_,C]=W.useState("compose"),[j,E]=W.useState(null),[S,F]=W.useState(null),I=W.useRef(null);W.useEffect(()=>{O()},[]),W.useEffect(()=>{t&&X()},[t,h]),W.useEffect(()=>{const se=te=>{I.current&&!I.current.contains(te.target)&&F(null)};if(S)return document.addEventListener("mousedown",se),()=>document.removeEventListener("mousedown",se)},[S]);const O=async()=>{try{console.log("[GmailBrowserInbox] === LOADING GMAIL CONNECTION ===");const{data:{user:se},error:te}=await ae.auth.getUser();if(console.log("[GmailBrowserInbox] Auth user:",se==null?void 0:se.id),console.log("[GmailBrowserInbox] Auth error:",te),te||!se){console.error("[GmailBrowserInbox] Auth error:",te),v("Not authenticated"),s(!1);return}console.log("[GmailBrowserInbox] Querying gmail_connections for user:",se.id);const{data:Ne,error:Se}=await ae.from("gmail_connections").select("*").eq("user_id",se.id).eq("is_connected",!0).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(console.log("[GmailBrowserInbox] Query result - data:",Ne),console.log("[GmailBrowserInbox] Query result - error:",Se),Se&&Se.code!=="PGRST116")throw console.error("[GmailBrowserInbox] Database error loading connection:",Se),Se;if(!Ne){console.error("[GmailBrowserInbox] NO CONNECTION FOUND for user:",se.id),v("No Gmail account connected. Please connect your Gmail account in Settings."),s(!1);return}console.log("[GmailBrowserInbox] Connection loaded successfully:",Ne.email_address),r(Ne),v(null)}catch(se){console.error("[GmailBrowserInbox] Error loading Gmail connection:",se),v("Failed to load Gmail connection")}finally{s(!1)}},M=async se=>{if(new Date(se.access_token_expires_at)>new Date)return se.access_token;const Ne=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:"90568246766-durgkfgje103589m6cuk99sv8kim69ec.apps.googleusercontent.com",client_secret:"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",refresh_token:se.refresh_token,grant_type:"refresh_token"})});if(!Ne.ok)throw new Error("Failed to refresh token");const Se=await Ne.json(),Ae=Se.access_token,ye=new Date(Date.now()+Se.expires_in*1e3).toISOString();return await ae.from("gmail_connections").update({access_token:Ae,access_token_expires_at:ye}).eq("id",se.id),r({...se,access_token:Ae,access_token_expires_at:ye}),Ae},P=se=>{switch(se){case"INBOX":return"in:inbox";case"SENT":return"in:sent";case"STARRED":return"is:starred";case"TRASH":return"in:trash";case"DRAFT":return"in:drafts";case"ALL":return"in:anywhere";default:return"in:inbox"}},X=async se=>{if(t){o(!0),v(null);try{const te=await M(t),Ne=P(h);let Ae=`https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=50&q=${encodeURIComponent(Ne)}`;se&&(Ae+=`&pageToken=${se}`);const ye=await fetch(Ae,{headers:{Authorization:`Bearer ${te}`}});if(!ye.ok)throw new Error("Failed to fetch emails from Gmail");const Le=await ye.json(),Re=Le.messages||[];g(Le.nextPageToken||null);const we=Re.map(async Ve=>{const lt=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${Ve.id}?format=full`,{headers:{Authorization:`Bearer ${te}`}});if(!lt.ok)return null;const pe=await lt.json();return J(pe)}),ze=(await Promise.all(we)).filter(Ve=>Ve!==null);c(se?[...l,...ze]:ze)}catch(te){console.error("Error loading emails:",te),v("Failed to load emails from Gmail")}finally{o(!1)}}},J=se=>{var te,Ne,Se;try{const Ae=se.payload.headers,ye=H(Ae,"subject")||"(No Subject)",Le=H(Ae,"from")||"",Re=H(Ae,"to")||"",we=H(Ae,"cc")||"",Pe=((te=Le.match(/<(.+?)>/))==null?void 0:te[1])||Le,ze=Le.replace(/<.+?>/,"").trim()||Pe,Ve=new Date(parseInt(se.internalDate)),lt=((Ne=se.labelIds)==null?void 0:Ne.includes("UNREAD"))||!1,pe=((Se=se.labelIds)==null?void 0:Se.includes("STARRED"))||!1,{text:Fe,html:Ke,attachments:Xe}=K(se.payload);return{id:se.id,threadId:se.threadId,subject:ye,from:ze,fromEmail:Pe,to:Re,cc:we,snippet:se.snippet||"",body:Fe,htmlBody:Ke,date:Ve,isUnread:lt,isStarred:pe,labels:se.labelIds||[],attachments:Xe.length>0?Xe:void 0}}catch(Ae){return console.error("Error parsing email:",Ae),null}},H=(se,te)=>{const Ne=se.find(Se=>Se.name.toLowerCase()===te.toLowerCase());return(Ne==null?void 0:Ne.value)||""},V=se=>{const te=document.createElement("DIV");return te.innerHTML=se,te.textContent||te.innerText||""},K=se=>{var we;let te="",Ne="";const Se=[],Ae=Pe=>{try{const ze=Pe.replace(/-/g,"+").replace(/_/g,"/"),Ve=atob(ze),lt=new Uint8Array(Ve.length);for(let pe=0;pe<Ve.length;pe++)lt[pe]=Ve.charCodeAt(pe);return new TextDecoder("utf-8").decode(lt)}catch{try{return atob(Pe.replace(/-/g,"+").replace(/_/g,"/"))}catch{return Pe}}},ye=Pe=>{var ze,Ve,lt;for(const pe of Pe)pe.filename&&((ze=pe.body)!=null&&ze.attachmentId)&&Se.push({filename:pe.filename,mimeType:pe.mimeType,size:pe.body.size,attachmentId:pe.body.attachmentId}),pe.mimeType==="text/html"&&((Ve=pe.body)!=null&&Ve.data)?Ne=Ae(pe.body.data):pe.mimeType==="text/plain"&&((lt=pe.body)!=null&&lt.data)?te=Ae(pe.body.data):pe.parts&&ye(pe.parts)};if((we=se.body)!=null&&we.data){const Pe=Ae(se.body.data);se.mimeType==="text/html"?Ne=Pe:te=Pe}else se.parts&&ye(se.parts);const Le=te||(Ne?V(Ne):""),Re=Ne||te.replace(/\n/g,"<br>");return{text:Le,html:Re,attachments:Se}},B=async se=>{if(d(se),se.isUnread&&L(se.id),!se.body&&t){x(!0);try{const te=await M(t),Ne=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${se.id}?format=full`,{headers:{Authorization:`Bearer ${te}`}});if(Ne.ok){const Se=await Ne.json(),{text:Ae,html:ye,attachments:Le}=K(Se.payload),Re=Se.payload.headers,we=H(Re,"to")||"",Pe=H(Re,"cc")||"",ze={...se,body:Ae,htmlBody:ye,to:we,cc:Pe,attachments:Le.length>0?Le:void 0};d(ze),c(l.map(Ve=>Ve.id===se.id?ze:Ve))}}catch(te){console.error("Error loading email body:",te)}finally{x(!1)}}},L=async se=>{if(t)try{const te=await M(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${se}/modify`,{method:"POST",headers:{Authorization:`Bearer ${te}`,"Content-Type":"application/json"},body:JSON.stringify({removeLabelIds:["UNREAD"]})}),c(l.map(Ne=>Ne.id===se?{...Ne,isUnread:!1}:Ne)),(u==null?void 0:u.id)===se&&d({...u,isUnread:!1})}catch(te){console.error("Error marking as read:",te)}},U=async(se,te)=>{if(t)try{const Ne=await M(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${se}/modify`,{method:"POST",headers:{Authorization:`Bearer ${Ne}`,"Content-Type":"application/json"},body:JSON.stringify({addLabelIds:te?[]:["STARRED"],removeLabelIds:te?["STARRED"]:[]})}),c(l.map(Se=>Se.id===se?{...Se,isStarred:!te}:Se)),(u==null?void 0:u.id)===se&&d({...u,isStarred:!te})}catch(Ne){console.error("Error toggling star:",Ne)}},D=(se,te=!1)=>{C("reply"),E(se),N(!0),F(null)},Q=se=>{C("forward"),E(se),N(!0),F(null)},z=async se=>{if(t)try{const te=await M(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${se.id}/trash`,{method:"POST",headers:{Authorization:`Bearer ${te}`}}),c(l.filter(Ne=>Ne.id!==se.id)),(u==null?void 0:u.id)===se.id&&d(null),F(null)}catch(te){console.error("Error deleting email:",te),alert("Failed to delete email")}},G=async se=>{if(!t)throw new Error("No Gmail connection");const te=await M(t);let Ne="";if(se.attachments.length>0){const ye="----=_Part_"+Date.now(),Le=['Content-Type: multipart/mixed; boundary="'+ye+'"',"MIME-Version: 1.0",`To: ${se.to.join(", ")}`];se.cc.length>0&&Le.push(`Cc: ${se.cc.join(", ")}`),se.bcc.length>0&&Le.push(`Bcc: ${se.bcc.join(", ")}`),Le.push(`Subject: ${se.subject}`),Ne=Le.join(`\r
`)+`\r
\r
`,Ne+=`--${ye}\r
`,Ne+=`Content-Type: text/html; charset="UTF-8"\r
`,Ne+=`Content-Transfer-Encoding: 7bit\r
\r
`,Ne+=se.body+`\r
\r
`;for(const Re of se.attachments){const we=await Z(Re);Ne+=`--${ye}\r
`,Ne+=`Content-Type: ${Re.type}; name="${Re.name}"\r
`,Ne+=`Content-Transfer-Encoding: base64\r
`,Ne+=`Content-Disposition: attachment; filename="${Re.name}"\r
\r
`,Ne+=we+`\r
\r
`}Ne+=`--${ye}--`}else{const ye=['Content-Type: text/html; charset="UTF-8"',"MIME-Version: 1.0",`To: ${se.to.join(", ")}`];se.cc.length>0&&ye.push(`Cc: ${se.cc.join(", ")}`),se.bcc.length>0&&ye.push(`Bcc: ${se.bcc.join(", ")}`),ye.push(`Subject: ${se.subject}`),Ne=ye.join(`\r
`)+`\r
\r
`+se.body}const Se=btoa(unescape(encodeURIComponent(Ne))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");if(!(await fetch("https://gmail.googleapis.com/gmail/v1/users/me/messages/send",{method:"POST",headers:{Authorization:`Bearer ${te}`,"Content-Type":"application/json"},body:JSON.stringify({raw:Se})})).ok)throw new Error("Failed to send email")},Z=se=>new Promise((te,Ne)=>{const Se=new FileReader;Se.readAsDataURL(se),Se.onload=()=>{const Ae=Se.result.split(",")[1];te(Ae)},Se.onerror=Ae=>Ne(Ae)}),R=async(se,te)=>{if(t)try{const Ne=await M(t),Se=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${se.id}/attachments/${te.attachmentId}`,{headers:{Authorization:`Bearer ${Ne}`}});if(!Se.ok)throw new Error("Failed to download attachment");const ye=(await Se.json()).data.replace(/-/g,"+").replace(/_/g,"/"),Le=atob(ye),Re=new Uint8Array(Le.length);for(let Ve=0;Ve<Le.length;Ve++)Re[Ve]=Le.charCodeAt(Ve);const we=new Blob([Re],{type:te.mimeType}),Pe=window.URL.createObjectURL(we),ze=document.createElement("a");ze.href=Pe,ze.download=te.filename,document.body.appendChild(ze),ze.click(),document.body.removeChild(ze),window.URL.revokeObjectURL(Pe)}catch(Ne){console.error("Error downloading attachment:",Ne),alert("Failed to download attachment")}},le=async se=>{if(!se){alert("No email selected");return}F(null);try{const te={subject:se.subject||"No Subject",body:se.htmlBody||se.body||se.snippet||"",fromEmail:se.fromEmail||"",fromName:se.from||"",date:se.date?se.date.toISOString():new Date().toISOString()};sessionStorage.setItem("pendingEmailForInquiry",JSON.stringify(te)),e("command-center")}catch(te){console.error("Error preparing inquiry:",te),alert("Failed to prepare inquiry. Please try again.")}},ee=(se,te)=>{se.preventDefault(),F({x:se.clientX,y:se.clientY,email:te})},_e=se=>{const Ne=new Date().getTime()-se.getTime(),Se=Math.floor(Ne/(1e3*60*60*24));return Se===0?se.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):Se<7?se.toLocaleDateString("en-US",{weekday:"short"}):se.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(Mo,{className:"w-6 h-6 animate-spin text-blue-500"})}):m?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center max-w-md px-6",children:[a.jsx(ea,{className:"w-16 h-16 text-amber-500 mx-auto mb-4"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Gmail Not Connected"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:m}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left",children:[a.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"To connect Gmail:"}),a.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[a.jsx("li",{children:"Go to Settings page"}),a.jsx("li",{children:"Navigate to Gmail Settings section"}),a.jsx("li",{children:'Click "Connect Gmail Account"'}),a.jsx("li",{children:"Authorize access to your Gmail account"})]})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{onClick:()=>{s(!0),v(null),O()},className:"mt-4 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition",children:"Retry Connection"}),a.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition",children:"Refresh Page"})]})]})}):a.jsxs("div",{className:"flex h-[calc(100vh-16rem)] bg-white rounded-lg border border-gray-200 overflow-hidden",children:[a.jsxs("div",{className:"w-[10%] min-w-[140px] border-r border-gray-200 flex flex-col bg-gray-50",children:[a.jsx("div",{className:"p-3 border-b border-gray-200",children:a.jsx("h3",{className:"text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Folders"})}),a.jsxs("div",{className:"flex-1 overflow-y-auto py-1",children:[a.jsxs("button",{onClick:()=>f("INBOX"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="INBOX"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(jF,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Inbox"})]}),a.jsxs("button",{onClick:()=>f("STARRED"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="STARRED"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(Cy,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Starred"})]}),a.jsxs("button",{onClick:()=>f("SENT"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="SENT"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(Ri,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Sent"})]}),a.jsxs("button",{onClick:()=>f("DRAFT"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="DRAFT"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(ha,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Drafts"})]}),a.jsxs("button",{onClick:()=>f("ALL"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="ALL"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(yF,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"All Mail"})]}),a.jsxs("button",{onClick:()=>f("TRASH"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${h==="TRASH"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(By,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:"Trash"})]})]}),a.jsx("div",{className:"p-2 border-t border-gray-200",children:a.jsxs("button",{onClick:()=>X(),disabled:i,className:"w-full flex items-center justify-center gap-1.5 px-2 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition disabled:opacity-50",children:[a.jsx(go,{className:`w-3 h-3 ${i?"animate-spin":""}`}),"Refresh"]})})]}),a.jsxs("div",{className:"w-[30%] min-w-[320px] flex flex-col border-r border-gray-200 bg-white",children:[a.jsx("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:a.jsxs("div",{className:"relative",children:[a.jsx(ls,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),a.jsx("input",{type:"text",value:A,onChange:se=>b(se.target.value),placeholder:"Search emails...",className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-300 rounded bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:i&&l.length===0?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx(Mo,{className:"w-6 h-6 animate-spin text-blue-500"})}):l.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[a.jsx(ha,{className:"w-12 h-12 mb-4 text-gray-300"}),a.jsx("p",{className:"text-sm",children:"No emails found"})]}):a.jsxs("div",{children:[l.filter(se=>A===""||se.subject.toLowerCase().includes(A.toLowerCase())||se.from.toLowerCase().includes(A.toLowerCase())||se.snippet.toLowerCase().includes(A.toLowerCase())).map(se=>a.jsxs("div",{onClick:()=>B(se),onContextMenu:te=>ee(te,se),className:`flex items-start gap-2 px-3 py-2.5 border-b border-gray-100 cursor-pointer transition ${(u==null?void 0:u.id)===se.id?"bg-blue-50 border-l-2 border-l-blue-500":(se.isUnread,"bg-white hover:bg-gray-50")}`,children:[a.jsx("button",{onClick:te=>{te.stopPropagation(),U(se.id,se.isStarred)},className:"mt-0.5 flex-shrink-0",children:a.jsx(Cy,{className:`w-3.5 h-3.5 ${se.isStarred?"fill-yellow-400 text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2 mb-0.5",children:[a.jsx("p",{className:`text-xs truncate ${se.isUnread?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:se.from}),a.jsx("span",{className:"text-[10px] text-gray-500 whitespace-nowrap flex-shrink-0",children:_e(se.date)})]}),a.jsx("p",{className:`text-xs truncate mb-0.5 ${se.isUnread?"font-semibold text-gray-900":"text-gray-600"}`,children:se.subject}),a.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-1",children:se.snippet})]}),se.isUnread&&a.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 mt-1.5 flex-shrink-0"})]},se.id)),p&&a.jsx("div",{className:"p-4 text-center",children:a.jsx("button",{onClick:()=>X(p),disabled:i,className:"px-4 py-2 text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50",children:i?"Loading...":"Load More"})})]})})]}),a.jsx("div",{className:"flex-1 w-[60%] flex flex-col bg-white overflow-hidden",children:u?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3 leading-tight",children:u.subject}),a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",children:u.from.charAt(0).toUpperCase()}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:u.from}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:u.fromEmail})]})]}),a.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap",children:u.date.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 bg-gray-50",children:y?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx(Mo,{className:"w-6 h-6 animate-spin text-blue-500"})}):a.jsxs(a.Fragment,{children:[u.htmlBody?a.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:a.jsx(YT,{htmlContent:u.htmlBody})}):u.body?a.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:a.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:u.body})}):a.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:a.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:u.snippet})}),u.attachments&&u.attachments.length>0&&a.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mt-4",children:[a.jsxs("p",{className:"text-xs font-semibold text-gray-700 mb-2 uppercase",children:["Attachments (",u.attachments.length,")"]}),a.jsx("div",{className:"space-y-2",children:u.attachments.map((se,te)=>a.jsxs("button",{onClick:()=>R(u,se),className:"flex items-center gap-3 w-full p-3 bg-gray-50 hover:bg-gray-100 rounded-lg border border-gray-200 transition",children:[a.jsx(sr,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 text-left min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:se.filename}),a.jsxs("p",{className:"text-xs text-gray-500",children:[(se.size/1024).toFixed(1)," KB"]})]}),a.jsx(Sc,{className:"w-4 h-4 text-gray-400"})]},te))})]})]})}),a.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-white",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>D(u,!1),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700 transition",children:[a.jsx(U4,{className:"w-4 h-4"}),"Reply"]}),u.cc&&a.jsxs("button",{onClick:()=>D(u,!0),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition",children:[a.jsx(Hu,{className:"w-4 h-4"}),"Reply All"]}),a.jsxs("button",{onClick:()=>Q(u),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition",children:[a.jsx(T4,{className:"w-4 h-4"}),"Forward"]}),a.jsxs("button",{onClick:()=>le(u),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded hover:bg-blue-100 transition",children:[a.jsx(yn,{className:"w-4 h-4"}),"Process in Command Center"]}),a.jsxs("button",{onClick:()=>z(u),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded hover:bg-red-100 transition ml-auto",children:[a.jsx(By,{className:"w-4 h-4"}),"Delete"]})]})})]}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ha,{className:"w-20 h-20 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Select an email to view"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Choose a message from your inbox"})]})})}),S&&a.jsxs("div",{ref:I,className:"fixed bg-white rounded-lg shadow-xl border border-gray-200 py-1 z-50 min-w-[160px]",style:{top:S.y,left:S.x},children:[a.jsxs("button",{onClick:()=>D(S.email,!1),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[a.jsx(U4,{className:"w-4 h-4"}),"Reply"]}),S.email.cc&&a.jsxs("button",{onClick:()=>D(S.email,!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[a.jsx(Hu,{className:"w-4 h-4"}),"Reply All"]}),a.jsxs("button",{onClick:()=>Q(S.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[a.jsx(T4,{className:"w-4 h-4"}),"Forward"]}),a.jsxs("button",{onClick:()=>U(S.email.id,S.email.isStarred),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[a.jsx(Cy,{className:"w-4 h-4"}),S.email.isStarred?"Unstar":"Star"]}),a.jsxs("button",{onClick:()=>le(S.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2 border-t border-gray-100",children:[a.jsx(yn,{className:"w-4 h-4"}),"Process in Command Center"]}),a.jsxs("button",{onClick:()=>z(S.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-700 flex items-center gap-2 border-t border-gray-100",children:[a.jsx(By,{className:"w-4 h-4"}),"Delete"]})]}),a.jsx(LZ,{isOpen:w,onClose:()=>{N(!1),E(null),C("compose")},mode:_,replyTo:j?{id:j.id,subject:j.subject,from:j.from,fromEmail:j.fromEmail,body:j.body,htmlBody:j.htmlBody,date:j.date}:void 0,onSend:G})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var nx={};nx.version="0.18.5";var JT=1252,aee=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],v_={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},b_=function(e){aee.indexOf(e)!=-1&&(JT=v_[0]=e)};function see(){b_(1252)}var lo=function(e){b_(e)};function w_(){lo(1200),see()}function OB(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function iee(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ZT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var sh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?iee(e.slice(2)):t==254&&r==255?ZT(e.slice(2)):t==65279?e.slice(1):e},jm=function(t){return String.fromCharCode(t)},UB=function(t){return String.fromCharCode(t)},c0,yc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function u0(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,s=e.charCodeAt(u++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=yc.charAt(i)+yc.charAt(o)+yc.charAt(l)+yc.charAt(c);return t}function fi(e){var t="",r=0,n=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=yc.indexOf(e.charAt(u++)),o=yc.indexOf(e.charAt(u++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=yc.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=yc.indexOf(e.charAt(u++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var ur=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ul=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Uc(e){return ur?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function PB(e){return ur?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ai=function(t){return ur?Ul(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function r1(e){if(typeof ArrayBuffer>"u")return ai(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function $c(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function oee(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function __(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return __(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ba=ur?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ul(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function lee(e){for(var t=[],r=0,n=e.length+250,s=Uc(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Uc(65535),n=65530)}return t.push(s.slice(0,r)),ba(t)}var bs=/\u0000/g,ih=/[\u0001-\u0006]/g;function gA(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function co(e,t){var r=""+e;return r.length>=t?r:jn("0",t-r.length)+r}function N_(e,t){var r=""+e;return r.length>=t?r:jn(" ",t-r.length)+r}function ax(e,t){var r=""+e;return r.length>=t?r:r+jn(" ",t-r.length)}function cee(e,t){var r=""+Math.round(e);return r.length>=t?r:jn("0",t-r.length)+r}function uee(e,t){var r=""+e;return r.length>=t?r:jn("0",t-r.length)+r}var DB=Math.pow(2,32);function Id(e,t){if(e>DB||e<-DB)return cee(e,t);var r=Math.round(e);return uee(r,t)}function sx(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var RB=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Cv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dee(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var $t={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},QB={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Aee={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ix(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,o=1,l=0,c=1,u=0,d=0,h=Math.floor(s);u<t&&(h=Math.floor(s),l=h*o+i,d=h*u+c,!(s-h<5e-8));)s=1/(s-h),i=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=i):(d=u,l=o)),!r)return[0,n*l,d];var f=Math.floor(n*l/d);return[f,n*l-f*d,d]}function Bu(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=xee(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var eI=new Date(1899,11,31,0,0,0),fee=eI.getTime(),hee=new Date(1900,2,1,0,0,0);function tI(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=hee&&(r+=24*60*60*1e3),(r-(fee+(e.getTimezoneOffset()-eI.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function j_(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function pee(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function mee(e){var t=e<0?12:11,r=j_(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function gee(e){var t=j_(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function d0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=mee(e):t===10?r=e.toFixed(10).substr(0,12):r=gee(e),j_(pee(r.toUpperCase()))}function $u(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):d0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Hi(14,tI(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function xee(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function yee(e,t,r,n){var s="",i=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Cv[r.m-1][1];case 5:return Cv[r.m-1][0];default:return Cv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return RB[r.q][0];default:return RB[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?co(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=co(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?co(c,u):"";return d}function vc(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var rI=/%/g;function vee(e,t,r){var n=t.replace(rI,""),s=t.length-n.length;return _l(e,n,r*Math.pow(10,2*s))+jn("%",s)}function bee(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _l(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function nI(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+nI(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var aI=/# (\?+)( ?)\/( ?)(\d+)/;function wee(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),o=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?jn(" ",e[1].length+1+e[4].length):N_(o,e[1].length)+e[2]+"/"+e[3]+co(l,e[4].length))}function _ee(e,t,r){return r+(t===0?"":""+t)+jn(" ",e[1].length+2+e[4].length)}var sI=/^#*0*\.([0#]+)/,iI=/\).*[0#]/,oI=/\(###\) ###\\?-####/;function gs(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function MB(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function HB(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Nee(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function jee(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function wi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iI)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wi("n",n,r):"("+wi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bee(e,t,r);if(t.indexOf("%")!==-1)return vee(e,t,r);if(t.indexOf("E")!==-1)return nI(t,r);if(t.charCodeAt(0)===36)return"$"+wi(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Id(c,t.length);if(t.match(/^[#?]+$/))return s=Id(r,0),s==="0"&&(s=""),s.length>t.length?s:gs(t.substr(0,t.length-s.length))+s;if(i=t.match(aI))return wee(i,c,u);if(t.match(/^#+0+$/))return u+Id(c,t.length-t.indexOf("0"));if(i=t.match(sI))return s=MB(r,i[1].length).replace(/^([^\.]+)$/,"$1."+gs(i[1])).replace(/\.$/,"."+gs(i[1])).replace(/\.(\d*)$/,function(b,m){return"."+m+jn("0",gs(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+MB(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+vc(Id(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wi(e,t,-r):vc(""+(Math.floor(r)+Nee(r,i[1].length)))+"."+co(HB(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return wi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=gA(wi(e,t.replace(/[\\-]/g,""),r)),o=0,gA(gA(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<s.length?s.charAt(o++):b==="0"?"0":""}));if(t.match(oI))return s=wi(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ix(c,Math.pow(10,o)-1,!1),s=""+u,d=_l("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=ax(l[2],o),d.length<i[4].length&&(d=gs(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ix(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?N_(l[1],o)+i[2]+"/"+i[3]+ax(l[2],o):jn(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Id(r,0),t.length<=s.length?s:gs(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var h=t.indexOf(".")-o,f=t.length-s.length-h;return gs(t.substr(0,h)+s+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=HB(r,i[1].length),r<0?"-"+wi(e,t,-r):vc(jee(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?co(0,3-b.length):"")+b})+"."+co(o,i[1].length);switch(t){case"###,##0.00":return wi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var A=vc(Id(c,0));return A!=="0"?u+A:"";case"###,###.00":return wi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return wi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Cee(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _l(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Bee(e,t,r){var n=t.replace(rI,""),s=t.length-n.length;return _l(e,n,r*Math.pow(10,2*s))+jn("%",s)}function lI(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+lI(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Io(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iI)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Io("n",n,r):"("+Io("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Cee(e,t,r);if(t.indexOf("%")!==-1)return Bee(e,t,r);if(t.indexOf("E")!==-1)return lI(t,r);if(t.charCodeAt(0)===36)return"$"+Io(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+co(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:gs(t.substr(0,t.length-s.length))+s;if(i=t.match(aI))return _ee(i,c,u);if(t.match(/^#+0+$/))return u+co(c,t.length-t.indexOf("0"));if(i=t.match(sI))return s=(""+r).replace(/^([^\.]+)$/,"$1."+gs(i[1])).replace(/\.$/,"."+gs(i[1])),s=s.replace(/\.(\d*)$/,function(b,m){return"."+m+jn("0",gs(i[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+vc(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Io(e,t,-r):vc(""+r)+"."+jn("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Io(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=gA(Io(e,t.replace(/[\\-]/g,""),r)),o=0,gA(gA(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<s.length?s.charAt(o++):b==="0"?"0":""}));if(t.match(oI))return s=Io(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ix(c,Math.pow(10,o)-1,!1),s=""+u,d=_l("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=ax(l[2],o),d.length<i[4].length&&(d=gs(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ix(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?N_(l[1],o)+i[2]+"/"+i[3]+ax(l[2],o):jn(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:gs(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var h=t.indexOf(".")-o,f=t.length-s.length-h;return gs(t.substr(0,h)+s+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Io(e,t,-r):vc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?co(0,3-b.length):"")+b})+"."+co(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var A=vc(""+c);return A!=="0"?u+A:"";default:if(t.match(/\.[0#?]*$/))return Io(e,t.slice(0,t.lastIndexOf(".")),r)+gs(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _l(e,t,r){return(r|0)===r?Io(e,t,r):wi(e,t,r)}function kee(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var cI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zA(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":sx(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(cI))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function See(e,t,r,n){for(var s=[],i="",o=0,l="",c="t",u,d,h,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!sx(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(h=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++o;break;case"\\":var A=e.charAt(++o),b=A==="("||A===")"?A:"t";s[s.length]={t:b,v:A},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Bu(t,r,e.charAt(o+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Bu(t,r),u==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var m={t:l,v:l};if(u==null&&(u=Bu(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",o+=5,f="h"):(m.t="t",++o),u==null&&m.t==="T")return"";s[s.length]=m,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(cI)){if(u==null&&(u=Bu(t,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",zA(e)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var v=0,p=0,g;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=f,c="h",v<1&&(v=1);break;case"s":(g=s[o].v.match(/\.0+$/))&&(p=Math.max(p,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[o].v.match(/[Hh]/)&&(v=1),v<2&&s[o].v.match(/[Mm]/)&&(v=2),v<3&&s[o].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",x;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=yee(s[o].t.charCodeAt(0),s[o].v,u,p),s[o].t="t";break;case"n":case"?":for(x=o+1;s[x]!=null&&((l=s[x].t)==="?"||l==="D"||(l===" "||l==="t")&&s[x+1]!=null&&(s[x+1].t==="?"||s[x+1].t==="t"&&s[x+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[x].v==="/"||s[x].v===" "&&s[x+1]!=null&&s[x+1].t=="?"));)s[o].v+=s[x].v,s[x]={v:"",t:";"},++x;y+=s[o].v,o=x-1;break;case"G":s[o].t="t",s[o].v=$u(t,r);break}var w="",N,_;if(y.length>0){y.charCodeAt(0)==40?(N=t<0&&y.charCodeAt(0)===45?-t:t,_=_l("n",y,N)):(N=t<0&&n>1?-t:t,_=_l("n",y,N),N<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),x=_.length-1;var C=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){C=o;break}var j=s.length;if(C===s.length&&_.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(x>=s[o].v.length-1?(x-=s[o].v.length,s[o].v=_.substr(x+1,s[o].v.length)):x<0?s[o].v="":(s[o].v=_.substr(0,x+1),x=-1),s[o].t="t",j=o);x>=0&&j<s.length&&(s[j].v=_.substr(0,x+1)+s[j].v)}else if(C!==s.length&&_.indexOf("E")===-1){for(x=_.indexOf(".")-1,o=C;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")-1:s[o].v.length-1,w=s[o].v.substr(d+1);d>=0;--d)x>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(w=_.charAt(x--)+w);s[o].v=w,s[o].t="t",j=o}for(x>=0&&j<s.length&&(s[j].v=_.substr(0,x+1)+s[j].v),x=_.indexOf(".")+1,o=C;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==C)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")+1:0,w=s[o].v.substr(0,d);d<s[o].v.length;++d)x<_.length&&(w+=_.charAt(x++));s[o].v=w,s[o].t="t",j=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(N=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=_l(s[o].t,s[o].v,N),s[o].t="t");var E="";for(o=0;o!==s.length;++o)s[o]!=null&&(E+=s[o].v);return E}var qB=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function KB(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Eee(e,t){var r=kee(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(qB),l=r[1].match(qB);return KB(t,o)?[n,r[0]]:KB(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function Hi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:$t)[e],n==null&&(n=r.table&&r.table[QB[e]]||$t[QB[e]]),n==null&&(n=Aee[e]||"General");break}if(sx(n,0))return $u(t,r);t instanceof Date&&(t=tI(t,r.date1904));var s=Eee(n,t);if(sx(s[1]))return $u(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return See(s[1],t,r,s[0])}function Nl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if($t[r]==null){t<0&&(t=r);continue}if($t[r]==e){t=r;break}}t<0&&(t=391)}return $t[t]=e,t}function n1(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Nl(e[t],t)}function XA(){$t=dee()}var Fee={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},uI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Tee(e){var t=typeof e=="number"?$t[e]:e;return t=t.replace(uI,"(\\d+)"),new RegExp("^"+t+"$")}function Iee(e,t,r){var n=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(uI)||[]).forEach(function(h,f){var A=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=A;break;case"d":i=A;break;case"h":o=A;break;case"s":c=A;break;case"m":o>=0?l=A:s=A;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&s==-1&&i==-1?d:u+"T"+d}var Lee=function(){var e={};e.version="1.2.0";function t(){for(var _=0,C=new Array(256),j=0;j!=256;++j)_=j,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,C[j]=_;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(_){var C=0,j=0,E=0,S=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)S[E]=_[E];for(E=0;E!=256;++E)for(j=_[E],C=256+E;C<4096;C+=256)j=S[C]=j>>>8^_[j&255];var F=[];for(E=1;E!=16;++E)F[E-1]=typeof Int32Array<"u"?S.subarray(E*256,E*256+256):S.slice(E*256,E*256+256);return F}var s=n(r),i=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],h=s[6],f=s[7],A=s[8],b=s[9],m=s[10],v=s[11],p=s[12],g=s[13],y=s[14];function x(_,C){for(var j=C^-1,E=0,S=_.length;E<S;)j=j>>>8^r[(j^_.charCodeAt(E++))&255];return~j}function w(_,C){for(var j=C^-1,E=_.length-15,S=0;S<E;)j=y[_[S++]^j&255]^g[_[S++]^j>>8&255]^p[_[S++]^j>>16&255]^v[_[S++]^j>>>24]^m[_[S++]]^b[_[S++]]^A[_[S++]]^f[_[S++]]^h[_[S++]]^d[_[S++]]^u[_[S++]]^c[_[S++]]^l[_[S++]]^o[_[S++]]^i[_[S++]]^r[_[S++]];for(E+=15;S<E;)j=j>>>8^r[(j^_[S++])&255];return~j}function N(_,C){for(var j=C^-1,E=0,S=_.length,F=0,I=0;E<S;)F=_.charCodeAt(E++),F<128?j=j>>>8^r[(j^F)&255]:F<2048?(j=j>>>8^r[(j^(192|F>>6&31))&255],j=j>>>8^r[(j^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,I=_.charCodeAt(E++)&1023,j=j>>>8^r[(j^(240|F>>8&7))&255],j=j>>>8^r[(j^(128|F>>2&63))&255],j=j>>>8^r[(j^(128|I>>6&15|(F&3)<<4))&255],j=j>>>8^r[(j^(128|I&63))&255]):(j=j>>>8^r[(j^(224|F>>12&15))&255],j=j>>>8^r[(j^(128|F>>6&63))&255],j=j>>>8^r[(j^(128|F&63))&255]);return~j}return e.table=r,e.bstr=x,e.buf=w,e.str=N,e}(),Ht=function(){var t={};t.version="1.2.1";function r(de,ne){for(var oe=de.split("/"),ie=ne.split("/"),xe=0,me=0,Ue=Math.min(oe.length,ie.length);xe<Ue;++xe){if(me=oe[xe].length-ie[xe].length)return me;if(oe[xe]!=ie[xe])return oe[xe]<ie[xe]?-1:1}return oe.length-ie.length}function n(de){if(de.charAt(de.length-1)=="/")return de.slice(0,-1).indexOf("/")===-1?de:n(de.slice(0,-1));var ne=de.lastIndexOf("/");return ne===-1?de:de.slice(0,ne+1)}function s(de){if(de.charAt(de.length-1)=="/")return s(de.slice(0,-1));var ne=de.lastIndexOf("/");return ne===-1?de:de.slice(ne+1)}function i(de,ne){typeof ne=="string"&&(ne=new Date(ne));var oe=ne.getHours();oe=oe<<6|ne.getMinutes(),oe=oe<<5|ne.getSeconds()>>>1,de.write_shift(2,oe);var ie=ne.getFullYear()-1980;ie=ie<<4|ne.getMonth()+1,ie=ie<<5|ne.getDate(),de.write_shift(2,ie)}function o(de){var ne=de.read_shift(2)&65535,oe=de.read_shift(2)&65535,ie=new Date,xe=oe&31;oe>>>=5;var me=oe&15;oe>>>=4,ie.setMilliseconds(0),ie.setFullYear(oe+1980),ie.setMonth(me-1),ie.setDate(xe);var Ue=ne&31;ne>>>=5;var Qe=ne&63;return ne>>>=6,ie.setHours(ne),ie.setMinutes(Qe),ie.setSeconds(Ue<<1),ie}function l(de){Oa(de,0);for(var ne={},oe=0;de.l<=de.length-4;){var ie=de.read_shift(2),xe=de.read_shift(2),me=de.l+xe,Ue={};switch(ie){case 21589:oe=de.read_shift(1),oe&1&&(Ue.mtime=de.read_shift(4)),xe>5&&(oe&2&&(Ue.atime=de.read_shift(4)),oe&4&&(Ue.ctime=de.read_shift(4))),Ue.mtime&&(Ue.mt=new Date(Ue.mtime*1e3));break}de.l=me,ne[ie]=Ue}return ne}var c;function u(){return c||(c={})}function d(de,ne){if(de[0]==80&&de[1]==75)return bt(de,ne);if((de[0]|32)==109&&(de[1]|32)==105)return Pt(de,ne);if(de.length<512)throw new Error("CFB file size "+de.length+" < 512");var oe=3,ie=512,xe=0,me=0,Ue=0,Qe=0,qe=0,Ge=[],Te=de.slice(0,512);Oa(Te,0);var be=h(Te);switch(oe=be[0],oe){case 3:ie=512;break;case 4:ie=4096;break;case 0:if(be[1]==0)return bt(de,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+oe)}ie!==512&&(Te=de.slice(0,ie),Oa(Te,28));var Me=de.slice(0,ie);f(Te,oe);var et=Te.read_shift(4,"i");if(oe===3&&et!==0)throw new Error("# Directory Sectors: Expected 0 saw "+et);Te.l+=4,Ue=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Qe=Te.read_shift(4,"i"),xe=Te.read_shift(4,"i"),qe=Te.read_shift(4,"i"),me=Te.read_shift(4,"i");for(var dt=-1,it=0;it<109&&(dt=Te.read_shift(4,"i"),!(dt<0));++it)Ge[it]=dt;var Ct=A(de,ie);v(qe,me,Ct,ie,Ge);var Xt=g(Ct,Ue,Ge,ie);Xt[Ue].name="!Directory",xe>0&&Qe!==I&&(Xt[Qe].name="!MiniFAT"),Xt[Ge[0]].name="!FAT",Xt.fat_addrs=Ge,Xt.ssz=ie;var Vt={},_r=[],ja=[],cr=[];y(Ue,Xt,Ct,_r,xe,Vt,ja,Qe),b(ja,cr,_r),_r.shift();var Xr={FileIndex:ja,FullPaths:cr};return ne&&ne.raw&&(Xr.raw={header:Me,sectors:Ct}),Xr}function h(de){if(de[de.l]==80&&de[de.l+1]==75)return[0,0];de.chk(O,"Header Signature: "),de.l+=16;var ne=de.read_shift(2,"u");return[de.read_shift(2,"u"),ne]}function f(de,ne){var oe=9;switch(de.l+=2,oe=de.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+oe);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+oe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+oe)}de.chk("0600","Mini Sector Shift: "),de.chk("000000000000","Reserved: ")}function A(de,ne){for(var oe=Math.ceil(de.length/ne)-1,ie=[],xe=1;xe<oe;++xe)ie[xe-1]=de.slice(xe*ne,(xe+1)*ne);return ie[oe-1]=de.slice(oe*ne),ie}function b(de,ne,oe){for(var ie=0,xe=0,me=0,Ue=0,Qe=0,qe=oe.length,Ge=[],Te=[];ie<qe;++ie)Ge[ie]=Te[ie]=ie,ne[ie]=oe[ie];for(;Qe<Te.length;++Qe)ie=Te[Qe],xe=de[ie].L,me=de[ie].R,Ue=de[ie].C,Ge[ie]===ie&&(xe!==-1&&Ge[xe]!==xe&&(Ge[ie]=Ge[xe]),me!==-1&&Ge[me]!==me&&(Ge[ie]=Ge[me])),Ue!==-1&&(Ge[Ue]=ie),xe!==-1&&ie!=Ge[ie]&&(Ge[xe]=Ge[ie],Te.lastIndexOf(xe)<Qe&&Te.push(xe)),me!==-1&&ie!=Ge[ie]&&(Ge[me]=Ge[ie],Te.lastIndexOf(me)<Qe&&Te.push(me));for(ie=1;ie<qe;++ie)Ge[ie]===ie&&(me!==-1&&Ge[me]!==me?Ge[ie]=Ge[me]:xe!==-1&&Ge[xe]!==xe&&(Ge[ie]=Ge[xe]));for(ie=1;ie<qe;++ie)if(de[ie].type!==0){if(Qe=ie,Qe!=Ge[Qe])do Qe=Ge[Qe],ne[ie]=ne[Qe]+"/"+ne[ie];while(Qe!==0&&Ge[Qe]!==-1&&Qe!=Ge[Qe]);Ge[ie]=-1}for(ne[0]+="/",ie=1;ie<qe;++ie)de[ie].type!==2&&(ne[ie]+="/")}function m(de,ne,oe){for(var ie=de.start,xe=de.size,me=[],Ue=ie;oe&&xe>0&&Ue>=0;)me.push(ne.slice(Ue*F,Ue*F+F)),xe-=F,Ue=bu(oe,Ue*4);return me.length===0?nt(0):ba(me).slice(0,de.size)}function v(de,ne,oe,ie,xe){var me=I;if(de===I){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(de!==-1){var Ue=oe[de],Qe=(ie>>>2)-1;if(!Ue)return;for(var qe=0;qe<Qe&&(me=bu(Ue,qe*4))!==I;++qe)xe.push(me);v(bu(Ue,ie-4),ne-1,oe,ie,xe)}}function p(de,ne,oe,ie,xe){var me=[],Ue=[];xe||(xe=[]);var Qe=ie-1,qe=0,Ge=0;for(qe=ne;qe>=0;){xe[qe]=!0,me[me.length]=qe,Ue.push(de[qe]);var Te=oe[Math.floor(qe*4/ie)];if(Ge=qe*4&Qe,ie<4+Ge)throw new Error("FAT boundary crossed: "+qe+" 4 "+ie);if(!de[Te])break;qe=bu(de[Te],Ge)}return{nodes:me,data:rk([Ue])}}function g(de,ne,oe,ie){var xe=de.length,me=[],Ue=[],Qe=[],qe=[],Ge=ie-1,Te=0,be=0,Me=0,et=0;for(Te=0;Te<xe;++Te)if(Qe=[],Me=Te+ne,Me>=xe&&(Me-=xe),!Ue[Me]){qe=[];var dt=[];for(be=Me;be>=0;){dt[be]=!0,Ue[be]=!0,Qe[Qe.length]=be,qe.push(de[be]);var it=oe[Math.floor(be*4/ie)];if(et=be*4&Ge,ie<4+et)throw new Error("FAT boundary crossed: "+be+" 4 "+ie);if(!de[it]||(be=bu(de[it],et),dt[be]))break}me[Me]={nodes:Qe,data:rk([qe])}}return me}function y(de,ne,oe,ie,xe,me,Ue,Qe){for(var qe=0,Ge=ie.length?2:0,Te=ne[de].data,be=0,Me=0,et;be<Te.length;be+=128){var dt=Te.slice(be,be+128);Oa(dt,64),Me=dt.read_shift(2),et=T_(dt,0,Me-Ge),ie.push(et);var it={name:et,type:dt.read_shift(1),color:dt.read_shift(1),L:dt.read_shift(4,"i"),R:dt.read_shift(4,"i"),C:dt.read_shift(4,"i"),clsid:dt.read_shift(16),state:dt.read_shift(4,"i"),start:0,size:0},Ct=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);Ct!==0&&(it.ct=x(dt,dt.l-8));var Xt=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);Xt!==0&&(it.mt=x(dt,dt.l-8)),it.start=dt.read_shift(4,"i"),it.size=dt.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=I,it.name=""),it.type===5?(qe=it.start,xe>0&&qe!==I&&(ne[qe].name="!StreamData")):it.size>=4096?(it.storage="fat",ne[it.start]===void 0&&(ne[it.start]=p(oe,it.start,ne.fat_addrs,ne.ssz)),ne[it.start].name=it.name,it.content=ne[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:qe!==I&&it.start!==I&&ne[qe]&&(it.content=m(it,ne[qe].data,(ne[Qe]||{}).data))),it.content&&Oa(it.content,0),me[et]=it,Ue.push(it)}}function x(de,ne){return new Date((ti(de,ne+4)/1e7*Math.pow(2,32)+ti(de,ne)/1e7-11644473600)*1e3)}function w(de,ne){return u(),d(c.readFileSync(de),ne)}function N(de,ne){var oe=ne&&ne.type;switch(oe||ur&&Buffer.isBuffer(de)&&(oe="buffer"),oe||"base64"){case"file":return w(de,ne);case"base64":return d(ai(fi(de)),ne);case"binary":return d(ai(de),ne)}return d(de,ne)}function _(de,ne){var oe=ne||{},ie=oe.root||"Root Entry";if(de.FullPaths||(de.FullPaths=[]),de.FileIndex||(de.FileIndex=[]),de.FullPaths.length!==de.FileIndex.length)throw new Error("inconsistent CFB structure");de.FullPaths.length===0&&(de.FullPaths[0]=ie+"/",de.FileIndex[0]={name:ie,type:5}),oe.CLSID&&(de.FileIndex[0].clsid=oe.CLSID),C(de)}function C(de){var ne="Sh33tJ5";if(!Ht.find(de,"/"+ne)){var oe=nt(4);oe[0]=55,oe[1]=oe[3]=50,oe[2]=54,de.FileIndex.push({name:ne,type:2,content:oe,size:4,L:69,R:69,C:69}),de.FullPaths.push(de.FullPaths[0]+ne),j(de)}}function j(de,ne){_(de);for(var oe=!1,ie=!1,xe=de.FullPaths.length-1;xe>=0;--xe){var me=de.FileIndex[xe];switch(me.type){case 0:ie?oe=!0:(de.FileIndex.pop(),de.FullPaths.pop());break;case 1:case 2:case 5:ie=!0,isNaN(me.R*me.L*me.C)&&(oe=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(oe=!0);break;default:oe=!0;break}}if(!(!oe&&!ne)){var Ue=new Date(1987,1,19),Qe=0,qe=Object.create?Object.create(null):{},Ge=[];for(xe=0;xe<de.FullPaths.length;++xe)qe[de.FullPaths[xe]]=!0,de.FileIndex[xe].type!==0&&Ge.push([de.FullPaths[xe],de.FileIndex[xe]]);for(xe=0;xe<Ge.length;++xe){var Te=n(Ge[xe][0]);ie=qe[Te],ie||(Ge.push([Te,{name:s(Te).replace("/",""),type:1,clsid:P,ct:Ue,mt:Ue,content:null}]),qe[Te]=!0)}for(Ge.sort(function(et,dt){return r(et[0],dt[0])}),de.FullPaths=[],de.FileIndex=[],xe=0;xe<Ge.length;++xe)de.FullPaths[xe]=Ge[xe][0],de.FileIndex[xe]=Ge[xe][1];for(xe=0;xe<Ge.length;++xe){var be=de.FileIndex[xe],Me=de.FullPaths[xe];if(be.name=s(Me).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||P,xe===0)be.C=Ge.length>1?1:-1,be.size=0,be.type=5;else if(Me.slice(-1)=="/"){for(Qe=xe+1;Qe<Ge.length&&n(de.FullPaths[Qe])!=Me;++Qe);for(be.C=Qe>=Ge.length?-1:Qe,Qe=xe+1;Qe<Ge.length&&n(de.FullPaths[Qe])!=n(Me);++Qe);be.R=Qe>=Ge.length?-1:Qe,be.type=1}else n(de.FullPaths[xe+1]||"")==n(Me)&&(be.R=xe+1),be.type=2}}}function E(de,ne){var oe=ne||{};if(oe.fileType=="mad")return qn(de,oe);switch(j(de),oe.fileType){case"zip":return Nt(de,oe)}var ie=function(et){for(var dt=0,it=0,Ct=0;Ct<et.FileIndex.length;++Ct){var Xt=et.FileIndex[Ct];if(Xt.content){var Vt=Xt.content.length;Vt>0&&(Vt<4096?dt+=Vt+63>>6:it+=Vt+511>>9)}}for(var _r=et.FullPaths.length+3>>2,ja=dt+7>>3,cr=dt+127>>7,Xr=ja+it+_r+cr,Qr=Xr+127>>7,Ki=Qr<=109?0:Math.ceil((Qr-109)/127);Xr+Qr+Ki+127>>7>Qr;)Ki=++Qr<=109?0:Math.ceil((Qr-109)/127);var vn=[1,Ki,Qr,cr,_r,it,dt,0];return et.FileIndex[0].size=dt<<6,vn[7]=(et.FileIndex[0].start=vn[0]+vn[1]+vn[2]+vn[3]+vn[4]+vn[5])+(vn[6]+7>>3),vn}(de),xe=nt(ie[7]<<9),me=0,Ue=0;{for(me=0;me<8;++me)xe.write_shift(1,M[me]);for(me=0;me<8;++me)xe.write_shift(2,0);for(xe.write_shift(2,62),xe.write_shift(2,3),xe.write_shift(2,65534),xe.write_shift(2,9),xe.write_shift(2,6),me=0;me<3;++me)xe.write_shift(2,0);for(xe.write_shift(4,0),xe.write_shift(4,ie[2]),xe.write_shift(4,ie[0]+ie[1]+ie[2]+ie[3]-1),xe.write_shift(4,0),xe.write_shift(4,4096),xe.write_shift(4,ie[3]?ie[0]+ie[1]+ie[2]-1:I),xe.write_shift(4,ie[3]),xe.write_shift(-4,ie[1]?ie[0]-1:I),xe.write_shift(4,ie[1]),me=0;me<109;++me)xe.write_shift(-4,me<ie[2]?ie[1]+me:-1)}if(ie[1])for(Ue=0;Ue<ie[1];++Ue){for(;me<236+Ue*127;++me)xe.write_shift(-4,me<ie[2]?ie[1]+me:-1);xe.write_shift(-4,Ue===ie[1]-1?I:Ue+1)}var Qe=function(et){for(Ue+=et;me<Ue-1;++me)xe.write_shift(-4,me+1);et&&(++me,xe.write_shift(-4,I))};for(Ue=me=0,Ue+=ie[1];me<Ue;++me)xe.write_shift(-4,X.DIFSECT);for(Ue+=ie[2];me<Ue;++me)xe.write_shift(-4,X.FATSECT);Qe(ie[3]),Qe(ie[4]);for(var qe=0,Ge=0,Te=de.FileIndex[0];qe<de.FileIndex.length;++qe)Te=de.FileIndex[qe],Te.content&&(Ge=Te.content.length,!(Ge<4096)&&(Te.start=Ue,Qe(Ge+511>>9)));for(Qe(ie[6]+7>>3);xe.l&511;)xe.write_shift(-4,X.ENDOFCHAIN);for(Ue=me=0,qe=0;qe<de.FileIndex.length;++qe)Te=de.FileIndex[qe],Te.content&&(Ge=Te.content.length,!(!Ge||Ge>=4096)&&(Te.start=Ue,Qe(Ge+63>>6)));for(;xe.l&511;)xe.write_shift(-4,X.ENDOFCHAIN);for(me=0;me<ie[4]<<2;++me){var be=de.FullPaths[me];if(!be||be.length===0){for(qe=0;qe<17;++qe)xe.write_shift(4,0);for(qe=0;qe<3;++qe)xe.write_shift(4,-1);for(qe=0;qe<12;++qe)xe.write_shift(4,0);continue}Te=de.FileIndex[me],me===0&&(Te.start=Te.size?Te.start-1:I);var Me=me===0&&oe.root||Te.name;if(Ge=2*(Me.length+1),xe.write_shift(64,Me,"utf16le"),xe.write_shift(2,Ge),xe.write_shift(1,Te.type),xe.write_shift(1,Te.color),xe.write_shift(-4,Te.L),xe.write_shift(-4,Te.R),xe.write_shift(-4,Te.C),Te.clsid)xe.write_shift(16,Te.clsid,"hex");else for(qe=0;qe<4;++qe)xe.write_shift(4,0);xe.write_shift(4,Te.state||0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(4,Te.start),xe.write_shift(4,Te.size),xe.write_shift(4,0)}for(me=1;me<de.FileIndex.length;++me)if(Te=de.FileIndex[me],Te.size>=4096)if(xe.l=Te.start+1<<9,ur&&Buffer.isBuffer(Te.content))Te.content.copy(xe,xe.l,0,Te.size),xe.l+=Te.size+511&-512;else{for(qe=0;qe<Te.size;++qe)xe.write_shift(1,Te.content[qe]);for(;qe&511;++qe)xe.write_shift(1,0)}for(me=1;me<de.FileIndex.length;++me)if(Te=de.FileIndex[me],Te.size>0&&Te.size<4096)if(ur&&Buffer.isBuffer(Te.content))Te.content.copy(xe,xe.l,0,Te.size),xe.l+=Te.size+63&-64;else{for(qe=0;qe<Te.size;++qe)xe.write_shift(1,Te.content[qe]);for(;qe&63;++qe)xe.write_shift(1,0)}if(ur)xe.l=xe.length;else for(;xe.l<xe.length;)xe.write_shift(1,0);return xe}function S(de,ne){var oe=de.FullPaths.map(function(qe){return qe.toUpperCase()}),ie=oe.map(function(qe){var Ge=qe.split("/");return Ge[Ge.length-(qe.slice(-1)=="/"?2:1)]}),xe=!1;ne.charCodeAt(0)===47?(xe=!0,ne=oe[0].slice(0,-1)+ne):xe=ne.indexOf("/")!==-1;var me=ne.toUpperCase(),Ue=xe===!0?oe.indexOf(me):ie.indexOf(me);if(Ue!==-1)return de.FileIndex[Ue];var Qe=!me.match(ih);for(me=me.replace(bs,""),Qe&&(me=me.replace(ih,"!")),Ue=0;Ue<oe.length;++Ue)if((Qe?oe[Ue].replace(ih,"!"):oe[Ue]).replace(bs,"")==me||(Qe?ie[Ue].replace(ih,"!"):ie[Ue]).replace(bs,"")==me)return de.FileIndex[Ue];return null}var F=64,I=-2,O="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],P="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:O,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:P,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(de,ne,oe){u();var ie=E(de,oe);c.writeFileSync(ne,ie)}function H(de){for(var ne=new Array(de.length),oe=0;oe<de.length;++oe)ne[oe]=String.fromCharCode(de[oe]);return ne.join("")}function V(de,ne){var oe=E(de,ne);switch(ne&&ne.type||"buffer"){case"file":return u(),c.writeFileSync(ne.filename,oe),oe;case"binary":return typeof oe=="string"?oe:H(oe);case"base64":return u0(typeof oe=="string"?oe:H(oe));case"buffer":if(ur)return Buffer.isBuffer(oe)?oe:Ul(oe);case"array":return typeof oe=="string"?ai(oe):oe}return oe}var K;function B(de){try{var ne=de.InflateRaw,oe=new ne;if(oe._processChunk(new Uint8Array([3,0]),oe._finishFlushFlag),oe.bytesRead)K=de;else throw new Error("zlib does not expose bytesRead")}catch(ie){console.error("cannot use native zlib: "+(ie.message||ie))}}function L(de,ne){if(!K)return xt(de,ne);var oe=K.InflateRaw,ie=new oe,xe=ie._processChunk(de.slice(de.l),ie._finishFlushFlag);return de.l+=ie.bytesRead,xe}function U(de){return K?K.deflateRawSync(de):Xe(de)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function G(de){var ne=(de<<1|de<<11)&139536|(de<<5|de<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var Z=typeof Uint8Array<"u",R=Z?new Uint8Array(256):[],le=0;le<256;++le)R[le]=G(le);function ee(de,ne){var oe=R[de&255];return ne<=8?oe>>>8-ne:(oe=oe<<8|R[de>>8&255],ne<=16?oe>>>16-ne:(oe=oe<<8|R[de>>16&255],oe>>>24-ne))}function _e(de,ne){var oe=ne&7,ie=ne>>>3;return(de[ie]|(oe<=6?0:de[ie+1]<<8))>>>oe&3}function se(de,ne){var oe=ne&7,ie=ne>>>3;return(de[ie]|(oe<=5?0:de[ie+1]<<8))>>>oe&7}function te(de,ne){var oe=ne&7,ie=ne>>>3;return(de[ie]|(oe<=4?0:de[ie+1]<<8))>>>oe&15}function Ne(de,ne){var oe=ne&7,ie=ne>>>3;return(de[ie]|(oe<=3?0:de[ie+1]<<8))>>>oe&31}function Se(de,ne){var oe=ne&7,ie=ne>>>3;return(de[ie]|(oe<=1?0:de[ie+1]<<8))>>>oe&127}function Ae(de,ne,oe){var ie=ne&7,xe=ne>>>3,me=(1<<oe)-1,Ue=de[xe]>>>ie;return oe<8-ie||(Ue|=de[xe+1]<<8-ie,oe<16-ie)||(Ue|=de[xe+2]<<16-ie,oe<24-ie)||(Ue|=de[xe+3]<<24-ie),Ue&me}function ye(de,ne,oe){var ie=ne&7,xe=ne>>>3;return ie<=5?de[xe]|=(oe&7)<<ie:(de[xe]|=oe<<ie&255,de[xe+1]=(oe&7)>>8-ie),ne+3}function Le(de,ne,oe){var ie=ne&7,xe=ne>>>3;return oe=(oe&1)<<ie,de[xe]|=oe,ne+1}function Re(de,ne,oe){var ie=ne&7,xe=ne>>>3;return oe<<=ie,de[xe]|=oe&255,oe>>>=8,de[xe+1]=oe,ne+8}function we(de,ne,oe){var ie=ne&7,xe=ne>>>3;return oe<<=ie,de[xe]|=oe&255,oe>>>=8,de[xe+1]=oe&255,de[xe+2]=oe>>>8,ne+16}function Pe(de,ne){var oe=de.length,ie=2*oe>ne?2*oe:ne+5,xe=0;if(oe>=ne)return de;if(ur){var me=PB(ie);if(de.copy)de.copy(me);else for(;xe<de.length;++xe)me[xe]=de[xe];return me}else if(Z){var Ue=new Uint8Array(ie);if(Ue.set)Ue.set(de);else for(;xe<oe;++xe)Ue[xe]=de[xe];return Ue}return de.length=ie,de}function ze(de){for(var ne=new Array(de),oe=0;oe<de;++oe)ne[oe]=0;return ne}function Ve(de,ne,oe){var ie=1,xe=0,me=0,Ue=0,Qe=0,qe=de.length,Ge=Z?new Uint16Array(32):ze(32);for(me=0;me<32;++me)Ge[me]=0;for(me=qe;me<oe;++me)de[me]=0;qe=de.length;var Te=Z?new Uint16Array(qe):ze(qe);for(me=0;me<qe;++me)Ge[xe=de[me]]++,ie<xe&&(ie=xe),Te[me]=0;for(Ge[0]=0,me=1;me<=ie;++me)Ge[me+16]=Qe=Qe+Ge[me-1]<<1;for(me=0;me<qe;++me)Qe=de[me],Qe!=0&&(Te[me]=Ge[Qe+16]++);var be=0;for(me=0;me<qe;++me)if(be=de[me],be!=0)for(Qe=ee(Te[me],ie)>>ie-be,Ue=(1<<ie+4-be)-1;Ue>=0;--Ue)ne[Qe|Ue<<be]=be&15|me<<4;return ie}var lt=Z?new Uint16Array(512):ze(512),pe=Z?new Uint16Array(32):ze(32);if(!Z){for(var Fe=0;Fe<512;++Fe)lt[Fe]=0;for(Fe=0;Fe<32;++Fe)pe[Fe]=0}(function(){for(var de=[],ne=0;ne<32;ne++)de.push(5);Ve(de,pe,32);var oe=[];for(ne=0;ne<=143;ne++)oe.push(8);for(;ne<=255;ne++)oe.push(9);for(;ne<=279;ne++)oe.push(7);for(;ne<=287;ne++)oe.push(8);Ve(oe,lt,288)})();var Ke=function(){for(var ne=Z?new Uint8Array(32768):[],oe=0,ie=0;oe<z.length-1;++oe)for(;ie<z[oe+1];++ie)ne[ie]=oe;for(;ie<32768;++ie)ne[ie]=29;var xe=Z?new Uint8Array(259):[];for(oe=0,ie=0;oe<Q.length-1;++oe)for(;ie<Q[oe+1];++ie)xe[ie]=oe;function me(Qe,qe){for(var Ge=0;Ge<Qe.length;){var Te=Math.min(65535,Qe.length-Ge),be=Ge+Te==Qe.length;for(qe.write_shift(1,+be),qe.write_shift(2,Te),qe.write_shift(2,~Te&65535);Te-- >0;)qe[qe.l++]=Qe[Ge++]}return qe.l}function Ue(Qe,qe){for(var Ge=0,Te=0,be=Z?new Uint16Array(32768):[];Te<Qe.length;){var Me=Math.min(65535,Qe.length-Te);if(Me<10){for(Ge=ye(qe,Ge,+(Te+Me==Qe.length)),Ge&7&&(Ge+=8-(Ge&7)),qe.l=Ge/8|0,qe.write_shift(2,Me),qe.write_shift(2,~Me&65535);Me-- >0;)qe[qe.l++]=Qe[Te++];Ge=qe.l*8;continue}Ge=ye(qe,Ge,+(Te+Me==Qe.length)+2);for(var et=0;Me-- >0;){var dt=Qe[Te];et=(et<<5^dt)&32767;var it=-1,Ct=0;if((it=be[et])&&(it|=Te&-32768,it>Te&&(it-=32768),it<Te))for(;Qe[it+Ct]==Qe[Te+Ct]&&Ct<250;)++Ct;if(Ct>2){dt=xe[Ct],dt<=22?Ge=Re(qe,Ge,R[dt+1]>>1)-1:(Re(qe,Ge,3),Ge+=5,Re(qe,Ge,R[dt-23]>>5),Ge+=3);var Xt=dt<8?0:dt-4>>2;Xt>0&&(we(qe,Ge,Ct-Q[dt]),Ge+=Xt),dt=ne[Te-it],Ge=Re(qe,Ge,R[dt]>>3),Ge-=3;var Vt=dt<4?0:dt-2>>1;Vt>0&&(we(qe,Ge,Te-it-z[dt]),Ge+=Vt);for(var _r=0;_r<Ct;++_r)be[et]=Te&32767,et=(et<<5^Qe[Te])&32767,++Te;Me-=Ct-1}else dt<=143?dt=dt+48:Ge=Le(qe,Ge,1),Ge=Re(qe,Ge,R[dt]),be[et]=Te&32767,++Te}Ge=Re(qe,Ge,0)-1}return qe.l=(Ge+7)/8|0,qe.l}return function(qe,Ge){return qe.length<8?me(qe,Ge):Ue(qe,Ge)}}();function Xe(de){var ne=nt(50+Math.floor(de.length*1.1)),oe=Ke(de,ne);return ne.slice(0,oe)}var tt=Z?new Uint16Array(32768):ze(32768),st=Z?new Uint16Array(32768):ze(32768),ke=Z?new Uint16Array(128):ze(128),Ee=1,Je=1;function rt(de,ne){var oe=Ne(de,ne)+257;ne+=5;var ie=Ne(de,ne)+1;ne+=5;var xe=te(de,ne)+4;ne+=4;for(var me=0,Ue=Z?new Uint8Array(19):ze(19),Qe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],qe=1,Ge=Z?new Uint8Array(8):ze(8),Te=Z?new Uint8Array(8):ze(8),be=Ue.length,Me=0;Me<xe;++Me)Ue[D[Me]]=me=se(de,ne),qe<me&&(qe=me),Ge[me]++,ne+=3;var et=0;for(Ge[0]=0,Me=1;Me<=qe;++Me)Te[Me]=et=et+Ge[Me-1]<<1;for(Me=0;Me<be;++Me)(et=Ue[Me])!=0&&(Qe[Me]=Te[et]++);var dt=0;for(Me=0;Me<be;++Me)if(dt=Ue[Me],dt!=0){et=R[Qe[Me]]>>8-dt;for(var it=(1<<7-dt)-1;it>=0;--it)ke[et|it<<dt]=dt&7|Me<<3}var Ct=[];for(qe=1;Ct.length<oe+ie;)switch(et=ke[Se(de,ne)],ne+=et&7,et>>>=3){case 16:for(me=3+_e(de,ne),ne+=2,et=Ct[Ct.length-1];me-- >0;)Ct.push(et);break;case 17:for(me=3+se(de,ne),ne+=3;me-- >0;)Ct.push(0);break;case 18:for(me=11+Se(de,ne),ne+=7;me-- >0;)Ct.push(0);break;default:Ct.push(et),qe<et&&(qe=et);break}var Xt=Ct.slice(0,oe),Vt=Ct.slice(oe);for(Me=oe;Me<286;++Me)Xt[Me]=0;for(Me=ie;Me<30;++Me)Vt[Me]=0;return Ee=Ve(Xt,tt,286),Je=Ve(Vt,st,30),ne}function Ze(de,ne){if(de[0]==3&&!(de[1]&3))return[Uc(ne),2];for(var oe=0,ie=0,xe=PB(ne||1<<18),me=0,Ue=xe.length>>>0,Qe=0,qe=0;!(ie&1);){if(ie=se(de,oe),oe+=3,ie>>>1)ie>>1==1?(Qe=9,qe=5):(oe=rt(de,oe),Qe=Ee,qe=Je);else{oe&7&&(oe+=8-(oe&7));var Ge=de[oe>>>3]|de[(oe>>>3)+1]<<8;if(oe+=32,Ge>0)for(!ne&&Ue<me+Ge&&(xe=Pe(xe,me+Ge),Ue=xe.length);Ge-- >0;)xe[me++]=de[oe>>>3],oe+=8;continue}for(;;){!ne&&Ue<me+32767&&(xe=Pe(xe,me+32767),Ue=xe.length);var Te=Ae(de,oe,Qe),be=ie>>>1==1?lt[Te]:tt[Te];if(oe+=be&15,be>>>=4,!(be>>>8&255))xe[me++]=be;else{if(be==256)break;be-=257;var Me=be<8?0:be-4>>2;Me>5&&(Me=0);var et=me+Q[be];Me>0&&(et+=Ae(de,oe,Me),oe+=Me),Te=Ae(de,oe,qe),be=ie>>>1==1?pe[Te]:st[Te],oe+=be&15,be>>>=4;var dt=be<4?0:be-2>>1,it=z[be];for(dt>0&&(it+=Ae(de,oe,dt),oe+=dt),!ne&&Ue<et&&(xe=Pe(xe,et+100),Ue=xe.length);me<et;)xe[me]=xe[me-it],++me}}}return ne?[xe,oe+7>>>3]:[xe.slice(0,me),oe+7>>>3]}function xt(de,ne){var oe=de.slice(de.l||0),ie=Ze(oe,ne);return de.l+=ie[1],ie[0]}function mt(de,ne){if(de)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function bt(de,ne){var oe=de;Oa(oe,0);var ie=[],xe=[],me={FileIndex:ie,FullPaths:xe};_(me,{root:ne.root});for(var Ue=oe.length-4;(oe[Ue]!=80||oe[Ue+1]!=75||oe[Ue+2]!=5||oe[Ue+3]!=6)&&Ue>=0;)--Ue;oe.l=Ue+4,oe.l+=4;var Qe=oe.read_shift(2);oe.l+=6;var qe=oe.read_shift(4);for(oe.l=qe,Ue=0;Ue<Qe;++Ue){oe.l+=20;var Ge=oe.read_shift(4),Te=oe.read_shift(4),be=oe.read_shift(2),Me=oe.read_shift(2),et=oe.read_shift(2);oe.l+=8;var dt=oe.read_shift(4),it=l(oe.slice(oe.l+be,oe.l+be+Me));oe.l+=be+Me+et;var Ct=oe.l;oe.l=dt+4,vt(oe,Ge,Te,me,it),oe.l=Ct}return me}function vt(de,ne,oe,ie,xe){de.l+=2;var me=de.read_shift(2),Ue=de.read_shift(2),Qe=o(de);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var qe=de.read_shift(4),Ge=de.read_shift(4),Te=de.read_shift(4),be=de.read_shift(2),Me=de.read_shift(2),et="",dt=0;dt<be;++dt)et+=String.fromCharCode(de[de.l++]);if(Me){var it=l(de.slice(de.l,de.l+Me));(it[21589]||{}).mt&&(Qe=it[21589].mt),((xe||{})[21589]||{}).mt&&(Qe=xe[21589].mt)}de.l+=Me;var Ct=de.slice(de.l,de.l+Ge);switch(Ue){case 8:Ct=L(de,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ue)}var Xt=!1;me&8&&(qe=de.read_shift(4),qe==134695760&&(qe=de.read_shift(4),Xt=!0),Ge=de.read_shift(4),Te=de.read_shift(4)),Ge!=ne&&mt(Xt,"Bad compressed size: "+ne+" != "+Ge),Te!=oe&&mt(Xt,"Bad uncompressed size: "+oe+" != "+Te),Sn(ie,et,Ct,{unsafe:!0,mt:Qe})}function Nt(de,ne){var oe=ne||{},ie=[],xe=[],me=nt(1),Ue=oe.compression?8:0,Qe=0,qe=0,Ge=0,Te=0,be=0,Me=de.FullPaths[0],et=Me,dt=de.FileIndex[0],it=[],Ct=0;for(qe=1;qe<de.FullPaths.length;++qe)if(et=de.FullPaths[qe].slice(Me.length),dt=de.FileIndex[qe],!(!dt.size||!dt.content||et=="Sh33tJ5")){var Xt=Te,Vt=nt(et.length);for(Ge=0;Ge<et.length;++Ge)Vt.write_shift(1,et.charCodeAt(Ge)&127);Vt=Vt.slice(0,Vt.l),it[be]=Lee.buf(dt.content,0);var _r=dt.content;Ue==8&&(_r=U(_r)),me=nt(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,Qe),me.write_shift(2,Ue),dt.mt?i(me,dt.mt):me.write_shift(4,0),me.write_shift(-4,it[be]),me.write_shift(4,_r.length),me.write_shift(4,dt.content.length),me.write_shift(2,Vt.length),me.write_shift(2,0),Te+=me.length,ie.push(me),Te+=Vt.length,ie.push(Vt),Te+=_r.length,ie.push(_r),me=nt(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,Qe),me.write_shift(2,Ue),me.write_shift(4,0),me.write_shift(-4,it[be]),me.write_shift(4,_r.length),me.write_shift(4,dt.content.length),me.write_shift(2,Vt.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,Xt),Ct+=me.l,xe.push(me),Ct+=Vt.length,xe.push(Vt),++be}return me=nt(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,be),me.write_shift(2,be),me.write_shift(4,Ct),me.write_shift(4,Te),me.write_shift(2,0),ba([ba(ie),ba(xe),me])}var Bt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function tr(de,ne){if(de.ctype)return de.ctype;var oe=de.name||"",ie=oe.match(/\.([^\.]+)$/);return ie&&Bt[ie[1]]||ne&&(ie=(oe=ne).match(/[\.\\]([^\.\\])+$/),ie&&Bt[ie[1]])?Bt[ie[1]]:"application/octet-stream"}function Ma(de){for(var ne=u0(de),oe=[],ie=0;ie<ne.length;ie+=76)oe.push(ne.slice(ie,ie+76));return oe.join(`\r
`)+`\r
`}function rr(de){var ne=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ge){var Te=Ge.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var oe=[],ie=ne.split(`\r
`),xe=0;xe<ie.length;++xe){var me=ie[xe];if(me.length==0){oe.push("");continue}for(var Ue=0;Ue<me.length;){var Qe=76,qe=me.slice(Ue,Ue+Qe);qe.charAt(Qe-1)=="="?Qe--:qe.charAt(Qe-2)=="="?Qe-=2:qe.charAt(Qe-3)=="="&&(Qe-=3),qe=me.slice(Ue,Ue+Qe),Ue+=Qe,Ue<me.length&&(qe+="="),oe.push(qe)}}return oe.join(`\r
`)}function dn(de){for(var ne=[],oe=0;oe<de.length;++oe){for(var ie=de[oe];oe<=de.length&&ie.charAt(ie.length-1)=="=";)ie=ie.slice(0,ie.length-1)+de[++oe];ne.push(ie)}for(var xe=0;xe<ne.length;++xe)ne[xe]=ne[xe].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return ai(ne.join(`\r
`))}function ta(de,ne,oe){for(var ie="",xe="",me="",Ue,Qe=0;Qe<10;++Qe){var qe=ne[Qe];if(!qe||qe.match(/^\s*$/))break;var Ge=qe.match(/^(.*?):\s*([^\s].*)$/);if(Ge)switch(Ge[1].toLowerCase()){case"content-location":ie=Ge[2].trim();break;case"content-type":me=Ge[2].trim();break;case"content-transfer-encoding":xe=Ge[2].trim();break}}switch(++Qe,xe.toLowerCase()){case"base64":Ue=ai(fi(ne.slice(Qe).join("")));break;case"quoted-printable":Ue=dn(ne.slice(Qe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xe)}var Te=Sn(de,ie.slice(oe.length),Ue,{unsafe:!0});me&&(Te.ctype=me)}function Pt(de,ne){if(H(de.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var oe=ne&&ne.root||"",ie=(ur&&Buffer.isBuffer(de)?de.toString("binary"):H(de)).split(`\r
`),xe=0,me="";for(xe=0;xe<ie.length;++xe)if(me=ie[xe],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),oe||(oe=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,oe.length)!=oe))for(;oe.length>0&&(oe=oe.slice(0,oe.length-1),oe=oe.slice(0,oe.lastIndexOf("/")+1),me.slice(0,oe.length)!=oe););var Ue=(ie[1]||"").match(/boundary="(.*?)"/);if(!Ue)throw new Error("MAD cannot find boundary");var Qe="--"+(Ue[1]||""),qe=[],Ge=[],Te={FileIndex:qe,FullPaths:Ge};_(Te);var be,Me=0;for(xe=0;xe<ie.length;++xe){var et=ie[xe];et!==Qe&&et!==Qe+"--"||(Me++&&ta(Te,ie.slice(be,xe),oe),be=xe)}return Te}function qn(de,ne){var oe=ne||{},ie=oe.boundary||"SheetJS";ie="------="+ie;for(var xe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ie.slice(2)+'"',"","",""],me=de.FullPaths[0],Ue=me,Qe=de.FileIndex[0],qe=1;qe<de.FullPaths.length;++qe)if(Ue=de.FullPaths[qe].slice(me.length),Qe=de.FileIndex[qe],!(!Qe.size||!Qe.content||Ue=="Sh33tJ5")){Ue=Ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ct){return"_x"+Ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ct){return"_u"+Ct.charCodeAt(0).toString(16)+"_"});for(var Ge=Qe.content,Te=ur&&Buffer.isBuffer(Ge)?Ge.toString("binary"):H(Ge),be=0,Me=Math.min(1024,Te.length),et=0,dt=0;dt<=Me;++dt)(et=Te.charCodeAt(dt))>=32&&et<128&&++be;var it=be>=Me*4/5;xe.push(ie),xe.push("Content-Location: "+(oe.root||"file:///C:/SheetJS/")+Ue),xe.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),xe.push("Content-Type: "+tr(Qe,Ue)),xe.push(""),xe.push(it?rr(Te):Ma(Te))}return xe.push(ie+`--\r
`),xe.join(`\r
`)}function ra(de){var ne={};return _(ne,de),ne}function Sn(de,ne,oe,ie){var xe=ie&&ie.unsafe;xe||_(de);var me=!xe&&Ht.find(de,ne);if(!me){var Ue=de.FullPaths[0];ne.slice(0,Ue.length)==Ue?Ue=ne:(Ue.slice(-1)!="/"&&(Ue+="/"),Ue=(Ue+ne).replace("//","/")),me={name:s(ne),type:2},de.FileIndex.push(me),de.FullPaths.push(Ue),xe||Ht.utils.cfb_gc(de)}return me.content=oe,me.size=oe?oe.length:0,ie&&(ie.CLSID&&(me.clsid=ie.CLSID),ie.mt&&(me.mt=ie.mt),ie.ct&&(me.ct=ie.ct)),me}function ma(de,ne){_(de);var oe=Ht.find(de,ne);if(oe){for(var ie=0;ie<de.FileIndex.length;++ie)if(de.FileIndex[ie]==oe)return de.FileIndex.splice(ie,1),de.FullPaths.splice(ie,1),!0}return!1}function Ar(de,ne,oe){_(de);var ie=Ht.find(de,ne);if(ie){for(var xe=0;xe<de.FileIndex.length;++xe)if(de.FileIndex[xe]==ie)return de.FileIndex[xe].name=s(oe),de.FullPaths[xe]=oe,!0}return!1}function Cr(de){j(de,!0)}return t.find=S,t.read=N,t.parse=d,t.write=V,t.writeFile=J,t.utils={cfb_new:ra,cfb_add:Sn,cfb_del:ma,cfb_mov:Ar,cfb_gc:Cr,ReadShift:kh,CheckField:TI,prep_blob:Oa,bconcat:ba,use_zlib:B,_deflateRaw:Xe,_inflateRaw:xt,consts:X},t}();function Oee(e){return typeof e=="string"?r1(e):Array.isArray(e)?oee(e):e}function I0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=r1(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Do(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Oee(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=$c(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Uee(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function $B(e,t){for(var r=[],n=Bn(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function a1(e){for(var t=[],r=Bn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function s1(e){for(var t=[],r=Bn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Pee(e){for(var t=[],r=Bn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var ox=new Date(1899,11,30,0,0,0);function pa(e,t){var r=e.getTime(),n=ox.getTime()+(e.getTimezoneOffset()-ox.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var dI=new Date,Dee=ox.getTime()+(dI.getTimezoneOffset()-ox.getTimezoneOffset())*6e4,VB=dI.getTimezoneOffset();function i1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Dee),t.getTimezoneOffset()!==VB&&t.setTime(t.getTime()+(t.getTimezoneOffset()-VB)*6e4),t}function Ree(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var GB=new Date("2017-02-19T19:06:09.000Z"),AI=isNaN(GB.getFullYear())?new Date("2/19/17"):GB,Qee=AI.getFullYear()==2017;function an(e,t){var r=new Date(e);if(Qee)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(AI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Vu(e,t){if(ur&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Do(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Do(ZT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Do(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Do(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function sn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sn(e[r]));return t}function jn(e,t){for(var r="";r.length<t;)r+=e;return r}function ho(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Mee=["january","february","march","april","may","june","july","august","september","october","november","december"];function FA(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Mee.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Hee=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function fI(e){return e?e.content&&e.type?Vu(e.content,!0):e.data?sh(e.data):e.asNodeBuffer&&ur?sh(e.asNodeBuffer().toString("binary")):e.asBinary?sh(e.asBinary()):e._data&&e._data.getContent?sh(Vu(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function hI(e){if(!e)return null;if(e.data)return OB(e.data);if(e.asNodeBuffer&&ur)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?OB(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function qee(e){return e&&e.name.slice(-4)===".bin"?hI(e):fI(e)}function Ci(e,t){for(var r=e.FullPaths||Bn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function C_(e,t){var r=Ci(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Wn(e,t,r){if(!r)return qee(C_(e,t));if(!t)return null;try{return Wn(e,t)}catch{return null}}function si(e,t,r){if(!r)return fI(C_(e,t));if(!t)return null;try{return si(e,t)}catch{return null}}function Kee(e,t,r){return hI(C_(e,t))}function WB(e){for(var t=e.FullPaths||Bn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function lr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ur?n=Ul(r):n=lee(r),Ht.utils.cfb_add(e,t,n)}Ht.utils.cfb_add(e,t,r)}else e.file(t,r)}function B_(){return Ht.utils.cfb_new()}function pI(e,t){switch(t.type){case"base64":return Ht.read(e,{type:"base64"});case"binary":return Ht.read(e,{type:"binary"});case"buffer":case"array":return Ht.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function oh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Hn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$ee=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,zB=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Vee=/<[^>]*>/g,cs=Hn.match(zB)?zB:Vee,Gee=/<\w*:/,Wee=/<(\/?)\w+:/;function Wt(e,t,r){for(var n={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match($ee),l=0,c="",u=0,d="",h="",f=1;if(o)for(u=0;u!=o.length;++u){for(h=o[u],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(d=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(f=(s=h.charCodeAt(i+1))==34||s==39?1:0,c=h.slice(i+1+f,h.length-f),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var A=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[A]&&d.slice(l-3,l)=="ext")continue;n[A]=c,n[A.toLowerCase()]=c}}return n}function Vo(e){return e.replace(Wee,"<$1")}var mI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},k_=a1(mI),br=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return mI[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),S_=/[&<>'"]/g,zee=/[\u0000-\u0008\u000b-\u001f]/g;function Or(e){var t=e+"";return t.replace(S_,function(r){return k_[r]}).replace(zee,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function XB(e){return Or(e).replace(/ /g,"_x0020_")}var gI=/[\u0000-\u001f]/g;function E_(e){var t=e+"";return t.replace(S_,function(r){return k_[r]}).replace(/\n/g,"<br/>").replace(gI,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Xee(e){var t=e+"";return t.replace(S_,function(r){return k_[r]}).replace(gI,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var YB=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Yee(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function en(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bv(e){for(var t="",r=0,n=0,s=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function JB(e){var t=Uc(2*e.length),r,n,s=1,i=0,o=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function ZB(e){return Ul(e,"binary").toString("utf8")}var Cm="foo bar baz",Dr=ur&&(ZB(Cm)==Bv(Cm)&&ZB||JB(Cm)==Bv(Cm)&&JB)||Bv,Do=ur?function(e){return Ul(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},A0=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),xI=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Jee=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Zee=/<\/?(?:vt:)?variant>/g,ete=/<(?:vt:)([^>]*)>([\s\S]*)</;function ek(e,t){var r=Wt(e),n=e.match(Jee(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(Zee,"").match(ete);o&&s.push({v:Dr(o[2]),t:o[1]})}),s}var yI=/(^\s|\s$|\n)/;function Ua(e,t){return"<"+e+(t.match(yI)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function f0(e){return Bn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function wt(e,t,r){return"<"+e+(r!=null?f0(r):"")+(t!=null?(t.match(yI)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function qw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function tte(e,t){switch(typeof e){case"string":var r=wt("vt:lpwstr",Or(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return wt((e|0)==e?"vt:i4":"vt:r8",Or(String(e)));case"boolean":return wt("vt:bool",e?"true":"false")}if(e instanceof Date)return wt("vt:filetime",qw(e));throw new Error("Unable to serialize "+e)}function F_(e){if(ur&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Dr($c(__(e)));throw new Error("Bad input format: expected Buffer or string")}var h0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Aa={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},rd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ei={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function rte(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function nte(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=n?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var tk=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},rk=ur?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ul(t)})):tk(e)}:tk,nk=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(vl(e,s)));return n.join("").replace(bs,"")},T_=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(bs,""):nk(e,t,r)}:nk,ak=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},vI=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ak(e,t,r)}:ak,sk=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Hd(e,s)));return n.join("")},L0=ur?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):sk(t,r,n)}:sk,bI=function(e,t){var r=ti(e,t);return r>0?L0(e,t+4,t+4+r-1):""},wI=bI,_I=function(e,t){var r=ti(e,t);return r>0?L0(e,t+4,t+4+r-1):""},NI=_I,jI=function(e,t){var r=2*ti(e,t);return r>0?L0(e,t+4,t+4+r-1):""},CI=jI,BI=function(t,r){var n=ti(t,r);return n>0?T_(t,r+4,r+4+n):""},kI=BI,SI=function(e,t){var r=ti(e,t);return r>0?L0(e,t+4,t+4+r):""},EI=SI,FI=function(e,t){return rte(e,t)},lx=FI,I_=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ur&&(wI=function(t,r){if(!Buffer.isBuffer(t))return bI(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},NI=function(t,r){if(!Buffer.isBuffer(t))return _I(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},CI=function(t,r){if(!Buffer.isBuffer(t))return jI(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},kI=function(t,r){if(!Buffer.isBuffer(t))return BI(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},EI=function(t,r){if(!Buffer.isBuffer(t))return SI(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},lx=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):FI(t,r)},I_=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Hd=function(e,t){return e[t]},vl=function(e,t){return e[t+1]*256+e[t]},ate=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ti=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},bu=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ste=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kh(e,t){var r="",n,s,i=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,ur&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(vl(this,u)),u+=2;e*=2;break;case"utf8":r=L0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=T_(this,this.l,this.l+e);break;case"wstr":return kh.call(this,e,"dbcs");case"lpstr-ansi":r=wI(this,this.l),e=4+ti(this,this.l);break;case"lpstr-cp":r=NI(this,this.l),e=4+ti(this,this.l);break;case"lpwstr":r=CI(this,this.l),e=4+2*ti(this,this.l);break;case"lpp4":e=4+ti(this,this.l),r=kI(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ti(this,this.l),r=EI(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Hd(this,this.l+e++))!==0;)i.push(jm(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=vl(this,this.l+e))!==0;)i.push(jm(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Hd(this,u),this.l=u+1,l=kh.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(jm(vl(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Hd(this,u),this.l=u+1,l=kh.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(jm(Hd(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Hd(this,this.l),this.l++,n;case 2:return n=(t==="i"?ate:vl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?bu:ste)(this,this.l),this.l+=4,n):(s=ti(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=lx(this,this.l):s=lx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=vI(this,this.l,e);break}}return this.l+=e,r}var ite=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ote=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},lte=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function cte(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)lte(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,ite(this,t,this.l);break;case 8:if(n=8,r==="f"){nte(this,t,this.l);break}case 16:break;case-4:n=4,ote(this,t,this.l);break}return this.l+=n,this}function TI(e,t){var r=vI(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Oa(e,t){e.l=t,e.read_shift=kh,e.chk=TI,e.write_shift=cte}function os(e,t){e.l+=t}function nt(e){var t=Uc(e);return Oa(t,0),t}function Pl(e,t,r){if(e){var n,s,i;Oa(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=v0[l]||v0[65535];for(n=e.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=e.read_shift(1))&127)<<7*s;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,l))return}}}function Ds(){var e=[],t=ur?256:2048,r=function(u){var d=nt(u);return Oa(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},o=function(){return s(),ba(e)},l=function(u){s(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function At(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=v0[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&I_(r)&&e.push(r)}}function Sh(e,t,r){var n=sn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ik(e,t,r){var n=sn(e);return n.s=Sh(n.s,t.s,r),n.e=Sh(n.e,t.s,r),n}function Eh(e,t){if(e.cRel&&e.c<0)for(e=sn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=sn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Gt(e);return!e.cRel&&e.cRel!=null&&(r=Ate(r)),!e.rRel&&e.rRel!=null&&(r=ute(r)),r}function kv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+pn(e.s.c)+":"+(e.e.cRel?"":"$")+pn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Mn(e.s.r)+":"+(e.e.rRel?"":"$")+Mn(e.e.r):Eh(e.s,t.biff)+":"+Eh(e.e,t.biff)}function L_(e){return parseInt(dte(e),10)-1}function Mn(e){return""+(e+1)}function ute(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dte(e){return e.replace(/\$(\d+)$/,"$1")}function O_(e){for(var t=fte(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function pn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Ate(e){return e.replace(/^([A-Z])/,"$$$1")}function fte(e){return e.replace(/^\$([A-Z])/,"$1")}function hte(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Gt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Qs(e){var t=e.indexOf(":");return t==-1?{s:mn(e),e:mn(e)}:{s:mn(e.slice(0,t)),e:mn(e.slice(t+1))}}function ar(e,t){return typeof t>"u"||typeof t=="number"?ar(e.s,e.e):(typeof e!="string"&&(e=Gt(e)),typeof t!="string"&&(t=Gt(t)),e==t?e:e+":"+t)}function wr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function ok(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Hi(e.z,r?pa(t):t)}catch{}try{return e.w=Hi((e.XF||{}).numFmtId||(r?14:0),r?pa(t):t)}catch{return""+t}}function Il(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Dl[e.v]||e.v:t==null?ok(e,e.v):ok(e,t))}function Vc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function II(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?mn(n.origin):n.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=wr(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var A={v:t[h][f]},b=o+h,m=l+f;if(u.s.r>b&&(u.s.r=b),u.s.c>m&&(u.s.c=m),u.e.r<b&&(u.e.r=b),u.e.c<m&&(u.e.c=m),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))A=t[h][f];else if(Array.isArray(A.v)&&(A.f=t[h][f][1],A.v=A.v[0]),A.v===null)if(A.f)A.t="n";else if(n.nullError)A.t="e",A.v=0;else if(n.sheetStubs)A.t="z";else continue;else typeof A.v=="number"?A.t="n":typeof A.v=="boolean"?A.t="b":A.v instanceof Date?(A.z=n.dateNF||$t[14],n.cellDates?(A.t="d",A.w=Hi(A.z,pa(A.v))):(A.t="n",A.v=pa(A.v),A.w=Hi(A.z,A.v))):A.t="s";if(s)i[b]||(i[b]=[]),i[b][m]&&i[b][m].z&&(A.z=i[b][m].z),i[b][m]=A;else{var v=Gt({c:m,r:b});i[v]&&i[v].z&&(A.z=i[v].z),i[v]=A}}}return u.s.c<1e7&&(i["!ref"]=ar(u)),i}function YA(e,t){return II(null,e,t)}function pte(e){return e.read_shift(4,"i")}function po(e,t){return t||(t=nt(4)),t.write_shift(4,e),t}function ss(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wa(e,t){var r=!1;return t==null&&(r=!0,t=nt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function mte(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function gte(e,t){return t||(t=nt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function U_(e,t){var r=e.l,n=e.read_shift(1),s=ss(e),i=[],o={t:s,h:s};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(mte(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function xte(e,t){var r=!1;return t==null&&(r=!0,t=nt(15+4*e.t.length)),t.write_shift(1,0),wa(e.t,t),r?t.slice(0,t.l):t}var yte=U_;function vte(e,t){var r=!1;return t==null&&(r=!0,t=nt(23+4*e.t.length)),t.write_shift(1,1),wa(e.t,t),t.write_shift(4,1),gte({},t),r?t.slice(0,t.l):t}function qi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function nd(e,t){return t==null&&(t=nt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ad(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function sd(e,t){return t==null&&(t=nt(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var bte=ss,LI=wa;function P_(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function cx(e,t){var r=!1;return t==null&&(r=!0,t=nt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var wte=ss,Kw=P_,D_=cx;function R_(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?lx([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):bu(t,0)>>2;return r?s/100:s}function OI(e,t){t==null&&(t=nt(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function UI(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function _te(e,t){return t||(t=nt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var id=UI,JA=_te;function ns(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Gu(e,t){return(t||nt(8)).write_shift(8,e,"f")}function Nte(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Iu[s];u&&(t.rgb=m0(u));break;case 2:t.rgb=m0([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function ux(e,t){if(t||(t=nt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function jte(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Cte(e,t){t||(t=nt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function PI(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Bte(e){return PI(e,1)}function kte(e){return PI(e,2)}var Q_=2,Ss=3,Bm=11,lk=12,dx=19,km=64,Ste=65,Ete=71,Fte=4108,Tte=4126,xa=80,DI=81,Ite=[xa,DI],$w={1:{n:"CodePage",t:Q_},2:{n:"Category",t:xa},3:{n:"PresentationFormat",t:xa},4:{n:"ByteCount",t:Ss},5:{n:"LineCount",t:Ss},6:{n:"ParagraphCount",t:Ss},7:{n:"SlideCount",t:Ss},8:{n:"NoteCount",t:Ss},9:{n:"HiddenCount",t:Ss},10:{n:"MultimediaClipCount",t:Ss},11:{n:"ScaleCrop",t:Bm},12:{n:"HeadingPairs",t:Fte},13:{n:"TitlesOfParts",t:Tte},14:{n:"Manager",t:xa},15:{n:"Company",t:xa},16:{n:"LinksUpToDate",t:Bm},17:{n:"CharacterCount",t:Ss},19:{n:"SharedDoc",t:Bm},22:{n:"HyperlinksChanged",t:Bm},23:{n:"AppVersion",t:Ss,p:"version"},24:{n:"DigSig",t:Ste},26:{n:"ContentType",t:xa},27:{n:"ContentStatus",t:xa},28:{n:"Language",t:xa},29:{n:"Version",t:xa},255:{},2147483648:{n:"Locale",t:dx},2147483651:{n:"Behavior",t:dx},1919054434:{}},Vw={1:{n:"CodePage",t:Q_},2:{n:"Title",t:xa},3:{n:"Subject",t:xa},4:{n:"Author",t:xa},5:{n:"Keywords",t:xa},6:{n:"Comments",t:xa},7:{n:"Template",t:xa},8:{n:"LastAuthor",t:xa},9:{n:"RevNumber",t:xa},10:{n:"EditTime",t:km},11:{n:"LastPrinted",t:km},12:{n:"CreatedDate",t:km},13:{n:"ModifiedDate",t:km},14:{n:"PageCount",t:Ss},15:{n:"WordCount",t:Ss},16:{n:"CharCount",t:Ss},17:{n:"Thumbnail",t:Ete},18:{n:"Application",t:xa},19:{n:"DocSecurity",t:Ss},255:{},2147483648:{n:"Locale",t:dx},2147483651:{n:"Behavior",t:dx},1919054434:{}},ck={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Lte=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ote(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Ute=Ote([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Iu=sn(Ute),Dl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Gw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Sm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function M_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Pte(e){var t=M_();if(!e||!e.match)return t;var r={};if((e.match(cs)||[]).forEach(function(n){var s=Wt(n);switch(s[0].replace(Gee,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Gw[s.ContentType]]!==void 0&&t[Gw[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Aa.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function QI(e,t){var r=Pee(Gw),n=[],s;n[n.length]=Hn,n[n.length]=wt("Types",null,{xmlns:Aa.CT,"xmlns:xsd":Aa.xsd,"xmlns:xsi":Aa.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return wt("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=wt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Sm[c][t.bookType]||Sm[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=wt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Sm[c][t.bookType]||Sm[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=wt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var dr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function p0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Fh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(cs)||[]).forEach(function(s){var i=Wt(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:oh(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}function xA(e){var t=[Hn,wt("Relationships",null,{xmlns:Aa.RELS})];return Bn(e["!id"]).forEach(function(r){t[t.length]=wt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ir(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[dr.HLINK,dr.XPATH,dr.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Dte="application/vnd.oasis.opendocument.spreadsheet";function Rte(e,t){for(var r=F_(e),n,s;n=h0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Wt(n[0],!1),s.path=="/"&&s.type!==Dte)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Qte(e){var t=[Hn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function uk(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Mte(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Hte(e){var t=[Hn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(uk(e[r][0],e[r][1])),t.push(Mte("",e[r][0]));return t.push(uk("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function MI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+nx.version+"</meta:generator></office:meta></office:document-meta>"}var Ui=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],qte=function(){for(var e=new Array(Ui.length),t=0;t<Ui.length;++t){var r=Ui[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function HI(e){var t={};e=Dr(e);for(var r=0;r<Ui.length;++r){var n=Ui[r],s=e.match(qte[r]);s!=null&&s.length>0&&(t[n[1]]=br(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=an(t[n[1]]))}return t}function Sv(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Or(t),n[n.length]=r?wt(e,t,r):Ua(e,t))}function qI(e,t){var r=t||{},n=[Hn,wt("cp:coreProperties",null,{"xmlns:cp":Aa.CORE_PROPS,"xmlns:dc":Aa.dc,"xmlns:dcterms":Aa.dcterms,"xmlns:dcmitype":Aa.dcmitype,"xmlns:xsi":Aa.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Sv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:qw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Sv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:qw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Ui.length;++i){var o=Ui[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Sv(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Lu=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],KI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function $I(e,t,r,n){var s=[];if(typeof e=="string")s=ek(e,n);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(d){return{v:d}}));var o=typeof t=="string"?ek(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function Kte(e,t,r){var n={};return t||(t={}),e=Dr(e),Lu.forEach(function(s){var i=(e.match(A0(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=br(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&$I(n.HeadingPairs,n.TitlesOfParts,t,r),t}function VI(e){var t=[],r=wt;return e||(e={}),e.Application="SheetJS",t[t.length]=Hn,t[t.length]=wt("Properties",null,{xmlns:Aa.EXT_PROPS,"xmlns:vt":Aa.vt}),Lu.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Or(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Or(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var $te=/<[^>]+>[^<]*/g;function Vte(e,t){var r={},n="",s=e.match($te);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=Wt(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=br(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=br(d);break;case"bool":r[n]=en(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=an(d);break;case"cy":case"error":r[n]=br(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function GI(e){var t=[Hn,wt("Properties",null,{xmlns:Aa.CUST_PROPS,"xmlns:vt":Aa.vt})];if(!e)return t.join("");var r=1;return Bn(e).forEach(function(s){++r,t[t.length]=wt("property",tte(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Or(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ww={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ev;function Gte(e,t,r){Ev||(Ev=a1(Ww)),t=Ev[t]||t,e[t]=r}function Wte(e,t){var r=[];return Bn(Ww).map(function(n){for(var s=0;s<Ui.length;++s)if(Ui[s][1]==n)return Ui[s];for(s=0;s<Lu.length;++s)if(Lu[s][1]==n)return Lu[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ua(Ww[n[1]]||n[1],s))}}),wt("DocumentProperties",r.join(""),{xmlns:ei.o})}function zte(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Bn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Ui.length;++o)if(i==Ui[o][1])return;for(o=0;o<Lu.length;++o)if(i==Lu[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(wt(XB(i),l,{"dt:dt":c}))}}),t&&Bn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(wt(XB(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+ei.o+'">'+s.join("")+"</"+n+">"}function H_(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Xte(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=nt(8);return o.write_shift(4,n),o.write_shift(4,s),o}function WI(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function zI(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function XI(e,t,r){return t===31?zI(e):WI(e,t,r)}function zw(e,t,r){return XI(e,t,r===!1?0:4)}function Yte(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return XI(e,t,0)}function Jte(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(bs,""),e.l-s&2&&(e.l+=2)}return r}function Zte(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(bs,"");return r}function ere(e){var t=e.l,r=Ax(e,DI);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ax(e,Ss);return[r,n]}function tre(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(ere(e));return r}function dk(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(bs,"").replace(ih,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function YI(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function rre(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ax(e,t,r){var n=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==lk&&n!==t&&Ite.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===lk?n:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return WI(e,n,4).replace(bs,"");case 31:return zI(e);case 64:return H_(e);case 65:return YI(e);case 71:return rre(e);case 80:return zw(e,n,!i.raw).replace(bs,"");case 81:return Yte(e,n).replace(bs,"");case 4108:return tre(e);case 4126:case 4127:return n==4127?Jte(e):Zte(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Ak(e,t){var r=nt(4),n=nt(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=nt(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Xte(t);break;case 31:case 80:for(n=nt(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ba([r,n])}function fk(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,u={};for(o=0;o!=s;++o){var d=e.read_shift(4),h=e.read_shift(4);i[o]=[d,h+r]}i.sort(function(g,y){return g[1]-y[1]});var f={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var A=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,A=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],A=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],A=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(A=!1,e.l=i[o][1]),A)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var b=t[i[o][0]];if(f[b.n]=Ax(e,b.t,{raw:!0}),b.p==="version"&&(f[b.n]=String(f[b.n]>>16)+"."+("0000"+String(f[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(f[b.n]){case 0:f[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:lo(l=f[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[b.n])}}else if(i[o][0]===1){if(l=f.CodePage=Ax(e,Q_),lo(l),c!==-1){var m=e.l;e.l=i[c][1],u=dk(e,l),e.l=m}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}u=dk(e,l)}else{var v=u[i[o][0]],p;switch(e[e.l]){case 65:e.l+=4,p=YI(e);break;case 30:e.l+=4,p=zw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,p=zw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,p=e.read_shift(4,"i");break;case 19:e.l+=4,p=e.read_shift(4);break;case 5:e.l+=4,p=e.read_shift(8,"f");break;case 11:e.l+=4,p=On(e,4);break;case 64:e.l+=4,p=an(H_(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[v]=p}}return e.l=r+n,f}var JI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nre(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function hk(e,t,r){var n=nt(8),s=[],i=[],o=8,l=0,c=nt(8),u=nt(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),s.push(u),o+=8+c.length,!t){u=nt(8),u.write_shift(4,0),s.unshift(u);var d=[nt(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(c=nt(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ba(d),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(JI.indexOf(e[l][0])>-1||KI.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],A=0;if(t){A=+t[e[l][0]];var b=r[A];if(b.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}c=Ak(b.t,f)}else{var v=nre(f);v==-1&&(v=31,f=String(f)),c=Ak(v,f)}i.push(c),u=nt(8),u.write_shift(4,t?A:2+l),s.push(u),o+=8+c.length}var p=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,p),p+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),ba([n].concat(s).concat(i))}function pk(e,t,r){var n=e.content;if(!n)return{};Oa(n,0);var s,i,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Ht.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var h=fk(n,t),f={SystemIdentifier:u};for(var A in h)f[A]=h[A];if(f.FMTID=i,s===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var b;try{b=fk(n,null)}catch{}for(A in b)f[A]=b[A];return f.FMTID=[i,o],f}function mk(e,t,r,n,s,i){var o=nt(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ht.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=hk(e,r,n);if(l.push(c),s){var u=hk(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(u)}return ba(l)}function ac(e,t){return e.read_shift(t),null}function are(e,t){t||(t=nt(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function sre(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function On(e,t){return e.read_shift(t)===1}function xs(e,t){return t||(t=nt(2)),t.write_shift(2,+!!e),t}function zn(e){return e.read_shift(2,"u")}function Bi(e,t){return t||(t=nt(2)),t.write_shift(2,e),t}function ZI(e,t){return sre(e,t,zn)}function ire(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function e8(e,t,r){return r||(r=nt(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function O0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function ore(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*o),n&&(e.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function lre(e){var t=e.t||"",r=nt(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=nt(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return ba(s)}function Wu(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function U0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Wu(e,n,r)}function od(e,t,r){if(r.biff>5)return U0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function t8(e,t,r){return r||(r=nt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function cre(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ure(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(bs,"");return n&&(e.l+=24),s}function dre(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(bs,"");return r+o}function Are(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ure(e);case"0303000000000000c000000000000046":return dre(e);default:throw new Error("Unsupported Moniker "+r)}}function Em(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(bs,""):"";return r}function gk(e,t){t||(t=nt(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function fre(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var i,o,l,c,u="",d,h;s&16&&(i=Em(e,r-e.l)),s&128&&(o=Em(e,r-e.l)),(s&257)===257&&(l=Em(e,r-e.l)),(s&257)===1&&(c=Are(e,r-e.l)),s&8&&(u=Em(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(h=H_(e)),e.l=r;var f=o||l||c||"";f&&u&&(f+="#"+u),f||(f="#"+u),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var A={Target:f};return d&&(A.guid=d),h&&(A.time=h),i&&(A.Tooltip=i),A}function hre(e){var t=nt(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),gk(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&gk(s>-1?n.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function r8(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function n8(e,t){var r=r8(e);return r[3]=0,r}function Go(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function zu(e,t,r,n){return n||(n=nt(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function pre(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function mre(e,t,r){return t===0?"":od(e,t,r)}function gre(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,i,o]}function a8(e){var t=e.read_shift(2),r=R_(e);return[t,r]}function xre(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=O0(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,s}function o1(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function s8(e,t){return t||(t=nt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function i8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var yre=i8;function o8(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function vre(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function bre(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function za(e){e.l+=2,e.l+=e.read_shift(2)}var wre={0:za,4:za,5:za,6:za,7:bre,8:za,9:za,10:za,11:za,12:za,13:vre,14:za,15:za,16:za,17:za,18:za,19:za,20:za,21:o8};function _re(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(wre[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Fm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function q_(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=nt(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Nre(e,t){return t===0||e.read_shift(2),1200}function jre(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=od(e,0,r);return e.read_shift(t+n-e.l),s}function Cre(e,t){var r=!t||t.biff==8,n=nt(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Bre(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function kre(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=O0(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function Sre(e,t){var r=!t||t.biff>=8?2:1,n=nt(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Ere(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(ore(e));return i.Count=n,i.Unique=s,i}function Fre(e,t){var r=nt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=lre(e[s]);var i=ba([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function Tre(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Ire(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Lre(e){var t=pre(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Ore(e){return e.read_shift(2),e.read_shift(4)}function xk(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function Ure(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function Pre(){var e=nt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Dre(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Rre(e){var t=nt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Qre(){}function Mre(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=O0(e,0,r),n}function Hre(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=nt(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function qre(e){var t=Go(e);return t.isst=e.read_shift(4),t}function Kre(e,t,r,n){var s=nt(10);return zu(e,t,n,s),s.write_shift(4,r),s}function $re(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Go(e);r.biff==2&&e.l++;var i=U0(e,n-e.l,r);return s.val=i,s}function Vre(e,t,r,n,s){var i=!s||s.biff==8,o=nt(8+ +i+(1+i)*r.length);return zu(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function Gre(e,t,r){var n=e.read_shift(2),s=od(e,0,r);return[n,s]}function Wre(e,t,r,n){var s=r&&r.biff==5;n||(n=nt(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var zre=od;function yk(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c}}}function Xre(e,t){var r=t.biff==8||!t.biff?4:2,n=nt(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Yre(e){var t=e.read_shift(2),r=e.read_shift(2),n=a8(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Jre(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(a8(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function Zre(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function ene(e,t,r,n){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=Lte[l>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function tne(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=ene(e,t,n.fStyle,r),n}function vk(e,t,r,n){var s=r&&r.biff==5;n||(n=nt(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function rne(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function nne(e){var t=nt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function bk(e,t,r){var n=Go(e);(r.biff==2||t==9)&&++e.l;var s=ire(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function ane(e,t,r,n,s,i){var o=nt(8);return zu(e,t,n,o),e8(r,i,o),o}function sne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Go(e),s=ns(e);return n.val=s,n}function ine(e,t,r,n){var s=nt(14);return zu(e,t,n,s),Gu(r,s),s}var wk=mre;function one(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Wu(e,i),l=[];n>e.l;)l.push(U0(e));return[i,s,o,l]}function _k(e,t,r){var n=e.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=xre(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var lne=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Nk(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Wu(e,o,r);s&32&&(u=lne[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var h=n==e.l||l===0||!(d>0)?[]:_oe(e,d,r,l);return{chKey:i,Name:u,itab:c,rgce:h}}function l8(e,t,r){if(r.biff<8)return cne(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(gre(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function cne(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=O0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function une(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),i=Wu(e,n,r),o=Wu(e,s,r);return[i,o]}function dne(e,t,r){var n=i8(e);e.l++;var s=e.read_shift(1);return t-=8,[Noe(e,t,r),s,n]}function jk(e,t,r){var n=yre(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,boe(e,t,r)]}function Ane(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function fne(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=od(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,o,i]}}function hne(e,t,r){return fne(e,t,r)}function pne(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(o1(e));return r}function mne(e){var t=nt(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)s8(e[r],t);return t}function gne(e,t,r){if(r&&r.biff<8)return yne(e,t,r);var n=o8(e),s=_re(e,t-22,n[1]);return{cmo:n,ft:s}}var xne={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function yne(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((xne[n]||os)(e,t,r)),{cmo:[s,n,i],ft:o}}function vne(e,t,r){var n=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=cre(e,6,r);var l=e.read_shift(2);e.read_shift(2),zn(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],h=Wu(e,e.lens[u+1]-e.lens[u]-1);if(s+=h,s.length>=(d?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function bne(e,t){var r=o1(e);e.l+=16;var n=fre(e,t-24);return[r,n]}function wne(e){var t=nt(24),r=mn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return ba([t,hre(e[1])])}function _ne(e,t){e.read_shift(2);var r=o1(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(bs,""),[r,n]}function Nne(e){var t=e[1].Tooltip,r=nt(10+2*(t.length+1));r.write_shift(2,2048);var n=mn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function jne(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ck[r]||r,r=e.read_shift(2),t[1]=ck[r]||r,t}function Cne(e){return e||(e=nt(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Bne(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n8(e));return r}function kne(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(n8(e));return r}function Sne(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function c8(e,t,r){if(!r.cellStyles)return os(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Ene(e,t){var r=nt(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Fne(e,t){var r={};return t<32||(e.l+=16,r.header=ns(e),r.footer=ns(e),e.l+=2),r}function Tne(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Ine(e){for(var t=nt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Lne=Go,One=ZI,Une=U0;function Pne(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Dne(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Go(e);++e.l;var s=od(e,t-7,r);return n.t="str",n.val=s,n}function Rne(e){var t=Go(e);++e.l;var r=ns(e);return t.t="n",t.val=r,t}function Qne(e,t,r){var n=nt(15);return Q0(n,e,t),n.write_shift(8,r,"f"),n}function Mne(e){var t=Go(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Hne(e,t,r){var n=nt(9);return Q0(n,e,t),n.write_shift(2,r),n}function qne(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Kne(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function $ne(e,t,r){var n=e.l+t,s=Go(e),i=e.read_shift(2),o=Wu(e,i,r);return e.l=n,s.t="str",s.val=o,s}var Vne=[2,3,48,49,131,139,140,245],Xw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=a1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Uc(1);switch(c.type){case"base64":d=ai(fi(l));break;case"binary":d=ai(l);break;case"buffer":case"array":d=l;break}Oa(d,0);var h=d.read_shift(1),f=!!(h&136),A=!1,b=!1;switch(h){case 2:break;case 3:break;case 48:A=!0,f=!0;break;case 49:A=!0,f=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,v=521;h==2&&(m=d.read_shift(2)),d.l+=3,h!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(v=d.read_shift(2));var p=d.read_shift(2),g=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(g=e[d[d.l]]),d.l+=1,d.l+=2),b&&(d.l+=36);for(var y=[],x={},w=Math.min(d.length,h==2?521:v-10-(A?264:0)),N=b?32:11;d.l<w&&d[d.l]!=13;)switch(x={},x.name=c0.utils.decode(g,d.slice(d.l,d.l+N)).replace(/[\u0000\r\n].*$/g,""),d.l+=N,x.type=String.fromCharCode(d.read_shift(1)),h!=2&&!b&&(x.offset=d.read_shift(4)),x.len=d.read_shift(1),h==2&&(x.offset=d.read_shift(2)),x.dec=d.read_shift(1),x.name.length&&y.push(x),h!=2&&(d.l+=b?13:14),x.type){case"B":(!A||x.len!=8)&&c.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+x.name+":"+x.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+x.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var _=0,C=0;for(u[0]=[],C=0;C!=y.length;++C)u[0][C]=y[C].name;for(;m-- >0;){if(d[d.l]===42){d.l+=p;continue}for(++d.l,u[++_]=[],C=0,C=0;C!=y.length;++C){var j=d.slice(d.l,d.l+y[C].len);d.l+=y[C].len,Oa(j,0);var E=c0.utils.decode(g,j);switch(y[C].type){case"C":E.trim().length&&(u[_][C]=E.replace(/\s+$/,""));break;case"D":E.length===8?u[_][C]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):u[_][C]=E;break;case"F":u[_][C]=parseFloat(E.trim());break;case"+":case"I":u[_][C]=b?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":u[_][C]=!0;break;case"N":case"F":u[_][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[_][C]="##MEMO##"+(b?parseInt(E.trim(),10):j.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(u[_][C]=+E||0);break;case"@":u[_][C]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[_][C]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[_][C]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][C]=-j.read_shift(-8,"f");break;case"B":if(A&&y[C].len==8){u[_][C]=j.read_shift(8,"f");break}case"G":case"P":j.l+=y[C].len;break;case"0":if(y[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[C].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=YA(r(l,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(l,c){try{return Vc(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&lo(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ds(),h=gx(l,{header:1,raw:!0,cellDates:!0}),f=h[0],A=h.slice(1),b=l["!cols"]||[],m=0,v=0,p=0,g=1;for(m=0;m<f.length;++m){if(((b[m]||{}).DBF||{}).name){f[m]=b[m].DBF.name,++p;continue}if(f[m]!=null){if(++p,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(v=0;v<1024;++v)if(f.indexOf(f[m]+"_"+v)==-1){f[m]+="_"+v;break}}}}var y=wr(l["!ref"]),x=[],w=[],N=[];for(m=0;m<=y.e.c-y.s.c;++m){var _="",C="",j=0,E=[];for(v=0;v<A.length;++v)A[v][m]!=null&&E.push(A[v][m]);if(E.length==0||f[m]==null){x[m]="?";continue}for(v=0;v<E.length;++v){switch(typeof E[v]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=E[v]instanceof Date?"D":"C";break;default:C="C"}j=Math.max(j,String(E[v]).length),_=_&&_!=C?"C":C}j>250&&(j=250),C=((b[m]||{}).DBF||{}).type,C=="C"&&b[m].DBF.len>j&&(j=b[m].DBF.len),_=="B"&&C=="N"&&(_="N",N[m]=b[m].DBF.dec,j=b[m].DBF.len),w[m]=_=="C"||C=="N"?j:i[_]||0,g+=w[m],x[m]=_}var S=d.next(32);for(S.write_shift(4,318902576),S.write_shift(4,A.length),S.write_shift(2,296+32*p),S.write_shift(2,g),m=0;m<4;++m)S.write_shift(4,0);for(S.write_shift(4,0|(+t[JT]||3)<<8),m=0,v=0;m<f.length;++m)if(f[m]!=null){var F=d.next(32),I=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,I,"sbcs"),F.write_shift(1,x[m]=="?"?"C":x[m],"sbcs"),F.write_shift(4,v),F.write_shift(1,w[m]||i[x[m]]||0),F.write_shift(1,N[m]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),v+=w[m]||i[x[m]]||0}var O=d.next(264);for(O.write_shift(4,13),m=0;m<65;++m)O.write_shift(4,0);for(m=0;m<A.length;++m){var M=d.next(g);for(M.write_shift(1,0),v=0;v<f.length;++v)if(f[v]!=null)switch(x[v]){case"L":M.write_shift(1,A[m][v]==null?63:A[m][v]?84:70);break;case"B":M.write_shift(8,A[m][v]||0,"f");break;case"N":var P="0";for(typeof A[m][v]=="number"&&(P=A[m][v].toFixed(N[v]||0)),p=0;p<w[v]-P.length;++p)M.write_shift(1,32);M.write_shift(1,P,"sbcs");break;case"D":A[m][v]?(M.write_shift(4,("0000"+A[m][v].getFullYear()).slice(-4),"sbcs"),M.write_shift(2,("00"+(A[m][v].getMonth()+1)).slice(-2),"sbcs"),M.write_shift(2,("00"+A[m][v].getDate()).slice(-2),"sbcs")):M.write_shift(8,"00000000","sbcs");break;case"C":var X=String(A[m][v]!=null?A[m][v]:"").slice(0,w[v]);for(M.write_shift(1,X,"sbcs"),p=0;p<w[v]-X.length;++p)M.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),u8=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,A){var b=e[A];return typeof b=="number"?UB(b):b},n=function(f,A,b){var m=A.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return m==59?f:UB(m)};e["|"]=254;function s(f,A){switch(A.type){case"base64":return i(fi(f),A);case"binary":return i(f,A);case"buffer":return i(ur&&Buffer.isBuffer(f)?f.toString("binary"):$c(f),A);case"array":return i(Vu(f),A)}throw new Error("Unrecognized type "+A.type)}function i(f,A){var b=f.split(/[\n\r]+/),m=-1,v=-1,p=0,g=0,y=[],x=[],w=null,N={},_=[],C=[],j=[],E=0,S;for(+A.codepage>=0&&lo(+A.codepage);p!==b.length;++p){E=0;var F=b[p].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),I=F.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),O=I[0],M;if(F.length>0)switch(O){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":I[1].charAt(0)=="P"&&x.push(F.slice(3).replace(/;;/g,";"));break;case"C":var P=!1,X=!1,J=!1,H=!1,V=-1,K=-1;for(g=1;g<I.length;++g)switch(I[g].charAt(0)){case"A":break;case"X":v=parseInt(I[g].slice(1))-1,X=!0;break;case"Y":for(m=parseInt(I[g].slice(1))-1,X||(v=0),S=y.length;S<=m;++S)y[S]=[];break;case"K":M=I[g].slice(1),M.charAt(0)==='"'?M=M.slice(1,M.length-1):M==="TRUE"?M=!0:M==="FALSE"?M=!1:isNaN(ho(M))?isNaN(FA(M).getDate())||(M=an(M)):(M=ho(M),w!==null&&zA(w)&&(M=i1(M))),P=!0;break;case"E":H=!0;var B=yA(I[g].slice(1),{r:m,c:v});y[m][v]=[y[m][v],B];break;case"S":J=!0,y[m][v]=[y[m][v],"S5S"];break;case"G":break;case"R":V=parseInt(I[g].slice(1))-1;break;case"C":K=parseInt(I[g].slice(1))-1;break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+F)}if(P&&(y[m][v]&&y[m][v].length==2?y[m][v][0]=M:y[m][v]=M,w=null),J){if(H)throw new Error("SYLK shared formula cannot have own formula");var L=V>-1&&y[V][K];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");y[m][v][1]=k8(L[1],{r:m-V,c:v-K})}break;case"F":var U=0;for(g=1;g<I.length;++g)switch(I[g].charAt(0)){case"X":v=parseInt(I[g].slice(1))-1,++U;break;case"Y":for(m=parseInt(I[g].slice(1))-1,S=y.length;S<=m;++S)y[S]=[];break;case"M":E=parseInt(I[g].slice(1))/20;break;case"F":break;case"G":break;case"P":w=x[parseInt(I[g].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=I[g].slice(1).split(" "),S=parseInt(j[0],10);S<=parseInt(j[1],10);++S)E=parseInt(j[2],10),C[S-1]=E===0?{hidden:!0}:{wch:E},Pc(C[S-1]);break;case"C":v=parseInt(I[g].slice(1))-1,C[v]||(C[v]={});break;case"R":m=parseInt(I[g].slice(1))-1,_[m]||(_[m]={}),E>0?(_[m].hpt=E,_[m].hpx=IA(E)):E===0&&(_[m].hidden=!0);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+F)}U<1&&(w=null);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+F)}}return _.length>0&&(N["!rows"]=_),C.length>0&&(N["!cols"]=C),A&&A.sheetRows&&(y=y.slice(0,A.sheetRows)),[y,N]}function o(f,A){var b=s(f,A),m=b[0],v=b[1],p=YA(m,A);return Bn(v).forEach(function(g){p[g]=v[g]}),p}function l(f,A){return Vc(o(f,A),A)}function c(f,A,b,m){var v="C;Y"+(b+1)+";X"+(m+1)+";K";switch(f.t){case"n":v+=f.v||0,f.f&&!f.F&&(v+=";E"+z_(f.f,{r:b,c:m}));break;case"b":v+=f.v?"TRUE":"FALSE";break;case"e":v+=f.w||f.v;break;case"d":v+='"'+(f.w||f.v)+'"';break;case"s":v+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(f,A){A.forEach(function(b,m){var v="F;W"+(m+1)+" "+(m+1)+" ";b.hidden?v+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=g0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=x0(b.wpx)),typeof b.wch=="number"&&(v+=Math.round(b.wch))),v.charAt(v.length-1)!=" "&&f.push(v)})}function d(f,A){A.forEach(function(b,m){var v="F;";b.hidden?v+="M0;":b.hpt?v+="M"+20*b.hpt+";":b.hpx&&(v+="M"+20*y0(b.hpx)+";"),v.length>2&&f.push(v+"R"+(m+1))})}function h(f,A){var b=["ID;PWXL;N;E"],m=[],v=wr(f["!ref"]),p,g=Array.isArray(f),y=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),f["!cols"]&&u(b,f["!cols"]),f["!rows"]&&d(b,f["!rows"]),b.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var x=v.s.r;x<=v.e.r;++x)for(var w=v.s.c;w<=v.e.c;++w){var N=Gt({r:x,c:w});p=g?(f[x]||[])[w]:f[N],!(!p||p.v==null&&(!p.f||p.F))&&m.push(c(p,f,x,w))}return b.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),d8=function(){function e(i,o){switch(o.type){case"base64":return t(fi(i),o);case"binary":return t(i,o);case"buffer":return t(ur&&Buffer.isBuffer(i)?i.toString("binary"):$c(i),o);case"array":return t(Vu(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,u=-1,d=0,h=[];d!==l.length;++d){if(l[d].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var f=l[d].trim().split(","),A=f[0],b=f[1];++d;for(var m=l[d]||"";(m.match(/["]/g)||[]).length&1&&d<l.length-1;)m+=`
`+l[++d];switch(m=m.trim(),+A){case-1:if(m==="BOT"){h[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[c][u]=!0:m==="FALSE"?h[c][u]=!1:isNaN(ho(b))?isNaN(FA(b).getDate())?h[c][u]=b:h[c][u]=an(b):h[c][u]=ho(b),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(i,o){return YA(e(i,o),o)}function n(i,o){return Vc(r(i,o),o)}var s=function(){var i=function(c,u,d,h,f){c.push(u),c.push(d+","+h),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,u,d,h){c.push(u+","+d),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],d=wr(c["!ref"]),h,f=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var A=d.s.r;A<=d.e.r;++A){o(u,-1,0,"BOT");for(var b=d.s.c;b<=d.e.c;++b){var m=Gt({r:A,c:b});if(h=f?(c[A]||[])[b]:c[m],!h){o(u,1,0,"");continue}switch(h.t){case"n":var v=h.w;!v&&h.v!=null&&(v=h.v),v==null?h.f&&!h.F?o(u,1,0,"="+h.f):o(u,1,0,""):o(u,0,v,"V");break;case"b":o(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Hi(h.z||$t[14],pa(an(h.v)))),o(u,0,h.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var p=`\r
`,g=u.join(p);return g}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),A8=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var A=h.split(`
`),b=-1,m=-1,v=0,p=[];v!==A.length;++v){var g=A[v].trim().split(":");if(g[0]==="cell"){var y=mn(g[1]);if(p.length<=y.r)for(b=p.length;b<=y.r;++b)p[b]||(p[b]=[]);switch(b=y.r,m=y.c,g[2]){case"t":p[b][m]=e(g[3]);break;case"v":p[b][m]=+g[3];break;case"vtf":var x=g[g.length-1];case"vtc":switch(g[3]){case"nl":p[b][m]=!!+g[4];break;default:p[b][m]=+g[4];break}g[2]=="vtf"&&(p[b][m]=[p[b][m],x])}}}return f&&f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}function n(h,f){return YA(r(h,f),f)}function s(h,f){return Vc(n(h,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],A=[],b,m="",v=Qs(h["!ref"]),p=Array.isArray(h),g=v.s.r;g<=v.e.r;++g)for(var y=v.s.c;y<=v.e.c;++y)if(m=Gt({r:g,c:y}),b=p?(h[g]||[])[y]:h[m],!(!b||b.v==null||b.t==="z")){switch(A=["cell",m,"t"],b.t){case"s":case"str":A.push(t(b.v));break;case"n":b.f?(A[2]="vtf",A[3]="n",A[4]=b.v,A[5]=t(b.f)):(A[2]="v",A[3]=b.v);break;case"b":A[2]="vt"+(b.f?"f":"c"),A[3]="nl",A[4]=b.v?"1":"0",A[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var x=pa(an(b.v));A[2]="vtc",A[3]="nd",A[4]=""+x,A[5]=b.w||Hi(b.z||$t[14],x);break;case"e":continue}f.push(A.join(":"))}return f.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(h){return[i,o,l,o,u(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),TA=function(){function e(d,h,f,A,b){b.raw?h[f][A]=d:d===""||(d==="TRUE"?h[f][A]=!0:d==="FALSE"?h[f][A]=!1:isNaN(ho(d))?isNaN(FA(d).getDate())?h[f][A]=d:h[f][A]=an(d):h[f][A]=ho(d))}function t(d,h){var f=h||{},A=[];if(!d||d.length===0)return A;for(var b=d.split(/[\r\n]/),m=b.length-1;m>=0&&b[m].length===0;)--m;for(var v=10,p=0,g=0;g<=m;++g)p=b[g].indexOf(" "),p==-1?p=b[g].length:p++,v=Math.max(v,p);for(g=0;g<=m;++g){A[g]=[];var y=0;for(e(b[g].slice(0,v).trim(),A,g,y,f),y=1;y<=(b[g].length-v)/10+1;++y)e(b[g].slice(v+(y-1)*10,v+y*10).trim(),A,g,y,f)}return f.sheetRows&&(A=A.slice(0,f.sheetRows)),A}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},f=!1,A=0,b=0;A<d.length;++A)(b=d.charCodeAt(A))==34?f=!f:!f&&b in r&&(h[b]=(h[b]||0)+1);b=[];for(A in h)Object.prototype.hasOwnProperty.call(h,A)&&b.push([h[A],A]);if(!b.length){h=n;for(A in h)Object.prototype.hasOwnProperty.call(h,A)&&b.push([h[A],A])}return b.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[b.pop()[1]]||44}function i(d,h){var f=h||{},A="",b=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(A=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(A=d.charAt(4),d=d.slice(6)):A=s(d.slice(0,1024)):f&&f.FS?A=f.FS:A=s(d.slice(0,1024));var v=0,p=0,g=0,y=0,x=0,w=A.charCodeAt(0),N=!1,_=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=f.dateNF!=null?Tee(f.dateNF):null;function E(){var S=d.slice(y,x),F={};if(S.charAt(0)=='"'&&S.charAt(S.length-1)=='"'&&(S=S.slice(1,-1).replace(/""/g,'"')),S.length===0)F.t="z";else if(f.raw)F.t="s",F.v=S;else if(S.trim().length===0)F.t="s",F.v=S;else if(S.charCodeAt(0)==61)S.charCodeAt(1)==34&&S.charCodeAt(S.length-1)==34?(F.t="s",F.v=S.slice(2,-1).replace(/""/g,'"')):oie(S)?(F.t="n",F.f=S.slice(1)):(F.t="s",F.v=S);else if(S=="TRUE")F.t="b",F.v=!0;else if(S=="FALSE")F.t="b",F.v=!1;else if(!isNaN(g=ho(S)))F.t="n",f.cellText!==!1&&(F.w=S),F.v=g;else if(!isNaN(FA(S).getDate())||j&&S.match(j)){F.z=f.dateNF||$t[14];var I=0;j&&S.match(j)&&(S=Iee(S,f.dateNF,S.match(j)||[]),I=1),f.cellDates?(F.t="d",F.v=an(S,I)):(F.t="n",F.v=pa(an(S,I))),f.cellText!==!1&&(F.w=Hi(F.z,F.v instanceof Date?pa(F.v):F.v)),f.cellNF||delete F.z}else F.t="s",F.v=S;if(F.t=="z"||(f.dense?(b[v]||(b[v]=[]),b[v][p]=F):b[Gt({c:p,r:v})]=F),y=x+1,C=d.charCodeAt(y),m.e.c<p&&(m.e.c=p),m.e.r<v&&(m.e.r=v),_==w)++p;else if(p=0,++v,f.sheetRows&&f.sheetRows<=v)return!0}e:for(;x<d.length;++x)switch(_=d.charCodeAt(x)){case 34:C===34&&(N=!N);break;case w:case 10:case 13:if(!N&&E())break e;break}return x-y>0&&E(),b["!ref"]=ar(m),b}function o(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,h):YA(t(d,h),h)}function l(d,h){var f="",A=h.type=="string"?[0,0,0,0]:n5(d,h);switch(h.type){case"base64":f=fi(d);break;case"binary":f=d;break;case"buffer":h.codepage==65001?f=d.toString("utf8"):h.codepage&&typeof c0<"u"||(f=ur&&Buffer.isBuffer(d)?d.toString("binary"):$c(d));break;case"array":f=Vu(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+h.type)}return A[0]==239&&A[1]==187&&A[2]==191?f=Dr(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=Dr(f):h.type=="binary"&&typeof c0<"u",f.slice(0,19)=="socialcalc:version:"?A8.to_sheet(h.type=="string"?f:Dr(f),h):o(f,h)}function c(d,h){return Vc(l(d,h),h)}function u(d){for(var h=[],f=wr(d["!ref"]),A,b=Array.isArray(d),m=f.s.r;m<=f.e.r;++m){for(var v=[],p=f.s.c;p<=f.e.c;++p){var g=Gt({r:m,c:p});if(A=b?(d[m]||[])[p]:d[g],!A||A.v==null){v.push("          ");continue}for(var y=(A.w||(Il(A),A.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(p===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function Gne(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=u8.to_workbook(e,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return TA.to_workbook(e,t)}}var Ou=function(){function e(B,L,U){if(B){Oa(B,B.l||0);for(var D=U.Enum||V;B.l<B.length;){var Q=B.read_shift(2),z=D[Q]||D[65535],G=B.read_shift(2),Z=B.l+G,R=z.f&&z.f(B,G,U);if(B.l=Z,L(R,z,Q))return}}}function t(B,L){switch(L.type){case"base64":return r(ai(fi(B)),L);case"binary":return r(ai(B),L);case"buffer":case"array":return r(B,L)}throw"Unsupported type "+L.type}function r(B,L){if(!B)return B;var U=L||{},D=U.dense?[]:{},Q="Sheet1",z="",G=0,Z={},R=[],le=[],ee={s:{r:0,c:0},e:{r:0,c:0}},_e=U.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)U.Enum=V,e(B,function(Se,Ae,ye){switch(ye){case 0:U.vers=Se,Se>=4096&&(U.qpro=!0);break;case 6:ee=Se;break;case 204:Se&&(z=Se);break;case 222:z=Se;break;case 15:case 51:U.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:ye==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=U.dateNF||$t[14],U.cellDates&&(Se[1].t="d",Se[1].v=i1(Se[1].v))),U.qpro&&Se[3]>G&&(D["!ref"]=ar(ee),Z[Q]=D,R.push(Q),D=U.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},G=Se[3],Q=z||"Sheet"+(G+1),z="");var Le=U.dense?(D[Se[0].r]||[])[Se[0].c]:D[Gt(Se[0])];if(Le){Le.t=Se[1].t,Le.v=Se[1].v,Se[1].z!=null&&(Le.z=Se[1].z),Se[1].f!=null&&(Le.f=Se[1].f);break}U.dense?(D[Se[0].r]||(D[Se[0].r]=[]),D[Se[0].r][Se[0].c]=Se[1]):D[Gt(Se[0])]=Se[1];break}},U);else if(B[2]==26||B[2]==14)U.Enum=K,B[2]==14&&(U.qpro=!0,B.l=0),e(B,function(Se,Ae,ye){switch(ye){case 204:Q=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>G&&(D["!ref"]=ar(ee),Z[Q]=D,R.push(Q),D=U.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},G=Se[3],Q="Sheet"+(G+1)),_e>0&&Se[0].r>=_e)break;U.dense?(D[Se[0].r]||(D[Se[0].r]=[]),D[Se[0].r][Se[0].c]=Se[1]):D[Gt(Se[0])]=Se[1],ee.e.c<Se[0].c&&(ee.e.c=Se[0].c),ee.e.r<Se[0].r&&(ee.e.r=Se[0].r);break;case 27:Se[14e3]&&(le[Se[14e3][0]]=Se[14e3][1]);break;case 1537:le[Se[0]]=Se[1],Se[0]==G&&(Q=Se[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(D["!ref"]=ar(ee),Z[z||Q]=D,R.push(z||Q),!le.length)return{SheetNames:R,Sheets:Z};for(var se={},te=[],Ne=0;Ne<le.length;++Ne)Z[R[Ne]]?(te.push(le[Ne]||R[Ne]),se[le[Ne]]=Z[le[Ne]]||Z[R[Ne]]):(te.push(le[Ne]),se[le[Ne]]={"!ref":"A1"});return{SheetNames:te,Sheets:se}}function n(B,L){var U=L||{};if(+U.codepage>=0&&lo(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Ds(),Q=wr(B["!ref"]),z=Array.isArray(B),G=[];_t(D,0,i(1030)),_t(D,6,c(Q));for(var Z=Math.min(Q.e.r,8191),R=Q.s.r;R<=Z;++R)for(var le=Mn(R),ee=Q.s.c;ee<=Q.e.c;++ee){R===Q.s.r&&(G[ee]=pn(ee));var _e=G[ee]+le,se=z?(B[R]||[])[ee]:B[_e];if(!(!se||se.t=="z"))if(se.t=="n")(se.v|0)==se.v&&se.v>=-32768&&se.v<=32767?_t(D,13,A(R,ee,se.v)):_t(D,14,m(R,ee,se.v));else{var te=Il(se);_t(D,15,h(R,ee,te.slice(0,239)))}}return _t(D,1),D.end()}function s(B,L){var U=L||{};if(+U.codepage>=0&&lo(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Ds();_t(D,0,o(B));for(var Q=0,z=0;Q<B.SheetNames.length;++Q)(B.Sheets[B.SheetNames[Q]]||{})["!ref"]&&_t(D,27,H(B.SheetNames[Q],z++));var G=0;for(Q=0;Q<B.SheetNames.length;++Q){var Z=B.Sheets[B.SheetNames[Q]];if(!(!Z||!Z["!ref"])){for(var R=wr(Z["!ref"]),le=Array.isArray(Z),ee=[],_e=Math.min(R.e.r,8191),se=R.s.r;se<=_e;++se)for(var te=Mn(se),Ne=R.s.c;Ne<=R.e.c;++Ne){se===R.s.r&&(ee[Ne]=pn(Ne));var Se=ee[Ne]+te,Ae=le?(Z[se]||[])[Ne]:Z[Se];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")_t(D,23,E(se,Ne,G,Ae.v));else{var ye=Il(Ae);_t(D,22,_(se,Ne,G,ye.slice(0,239)))}}++G}}return _t(D,1),D.end()}function i(B){var L=nt(2);return L.write_shift(2,B),L}function o(B){var L=nt(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var U=0,D=0,Q=0,z=0;z<B.SheetNames.length;++z){var G=B.SheetNames[z],Z=B.Sheets[G];if(!(!Z||!Z["!ref"])){++Q;var R=Qs(Z["!ref"]);U<R.e.r&&(U=R.e.r),D<R.e.c&&(D=R.e.c)}}return U>8191&&(U=8191),L.write_shift(2,U),L.write_shift(1,Q),L.write_shift(1,D),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function l(B,L,U){var D={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&U.qpro?(D.s.c=B.read_shift(1),B.l++,D.s.r=B.read_shift(2),D.e.c=B.read_shift(1),B.l++,D.e.r=B.read_shift(2),D):(D.s.c=B.read_shift(2),D.s.r=B.read_shift(2),L==12&&U.qpro&&(B.l+=2),D.e.c=B.read_shift(2),D.e.r=B.read_shift(2),L==12&&U.qpro&&(B.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function c(B){var L=nt(8);return L.write_shift(2,B.s.c),L.write_shift(2,B.s.r),L.write_shift(2,B.e.c),L.write_shift(2,B.e.r),L}function u(B,L,U){var D=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(D[0].c=B.read_shift(1),D[3]=B.read_shift(1),D[0].r=B.read_shift(2),B.l+=2):(D[2]=B.read_shift(1),D[0].c=B.read_shift(2),D[0].r=B.read_shift(2)),D}function d(B,L,U){var D=B.l+L,Q=u(B,L,U);if(Q[1].t="s",U.vers==20768){B.l++;var z=B.read_shift(1);return Q[1].v=B.read_shift(z,"utf8"),Q}return U.qpro&&B.l++,Q[1].v=B.read_shift(D-B.l,"cstr"),Q}function h(B,L,U){var D=nt(7+U.length);D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,B),D.write_shift(1,39);for(var Q=0;Q<D.length;++Q){var z=U.charCodeAt(Q);D.write_shift(1,z>=128?95:z)}return D.write_shift(1,0),D}function f(B,L,U){var D=u(B,L,U);return D[1].v=B.read_shift(2,"i"),D}function A(B,L,U){var D=nt(7);return D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,B),D.write_shift(2,U,"i"),D}function b(B,L,U){var D=u(B,L,U);return D[1].v=B.read_shift(8,"f"),D}function m(B,L,U){var D=nt(13);return D.write_shift(1,255),D.write_shift(2,L),D.write_shift(2,B),D.write_shift(8,U,"f"),D}function v(B,L,U){var D=B.l+L,Q=u(B,L,U);if(Q[1].v=B.read_shift(8,"f"),U.qpro)B.l=D;else{var z=B.read_shift(2);x(B.slice(B.l,B.l+z),Q),B.l+=z}return Q}function p(B,L,U){var D=L&32768;return L&=-32769,L=(D?B:0)+(L>=8192?L-16384:L),(D?"":"$")+(U?pn(L):Mn(L))}var g={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function x(B,L){Oa(B,0);for(var U=[],D=0,Q="",z="",G="",Z="";B.l<B.length;){var R=B[B.l++];switch(R){case 0:U.push(B.read_shift(8,"f"));break;case 1:z=p(L[0].c,B.read_shift(2),!0),Q=p(L[0].r,B.read_shift(2),!1),U.push(z+Q);break;case 2:{var le=p(L[0].c,B.read_shift(2),!0),ee=p(L[0].r,B.read_shift(2),!1);z=p(L[0].c,B.read_shift(2),!0),Q=p(L[0].r,B.read_shift(2),!1),U.push(le+ee+":"+z+Q)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(B.read_shift(2));break;case 6:{for(var _e="";R=B[B.l++];)_e+=String.fromCharCode(R);U.push('"'+_e.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:Z=U.pop(),G=U.pop(),U.push(["AND","OR"][R-20]+"("+G+","+Z+")");break;default:if(R<32&&y[R])Z=U.pop(),G=U.pop(),U.push(G+y[R]+Z);else if(g[R]){if(D=g[R][1],D==69&&(D=B[B.l++]),D>U.length){console.error("WK1 bad formula parse 0x"+R.toString(16)+":|"+U.join("|")+"|");return}var se=U.slice(-D);U.length-=D,U.push(g[R][0]+"("+se.join(",")+")")}else return R<=7?console.error("WK1 invalid opcode "+R.toString(16)):R<=24?console.error("WK1 unsupported op "+R.toString(16)):R<=30?console.error("WK1 invalid opcode "+R.toString(16)):R<=115?console.error("WK1 unsupported function opcode "+R.toString(16)):console.error("WK1 unrecognized opcode "+R.toString(16))}}U.length==1?L[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function w(B){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=B.read_shift(2),L[3]=B[B.l++],L[0].c=B[B.l++],L}function N(B,L){var U=w(B);return U[1].t="s",U[1].v=B.read_shift(L-4,"cstr"),U}function _(B,L,U,D){var Q=nt(6+D.length);Q.write_shift(2,B),Q.write_shift(1,U),Q.write_shift(1,L),Q.write_shift(1,39);for(var z=0;z<D.length;++z){var G=D.charCodeAt(z);Q.write_shift(1,G>=128?95:G)}return Q.write_shift(1,0),Q}function C(B,L){var U=w(B);U[1].v=B.read_shift(2);var D=U[1].v>>1;if(U[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return U[1].v=D,U}function j(B,L){var U=w(B),D=B.read_shift(4),Q=B.read_shift(4),z=B.read_shift(2);if(z==65535)return D===0&&Q===3221225472?(U[1].t="e",U[1].v=15):D===0&&Q===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var G=z&32768;return z=(z&32767)-16446,U[1].v=(1-G*2)*(Q*Math.pow(2,z+32)+D*Math.pow(2,z)),U}function E(B,L,U,D){var Q=nt(14);if(Q.write_shift(2,B),Q.write_shift(1,U),Q.write_shift(1,L),D==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var z=0,G=0,Z=0,R=0;return D<0&&(z=1,D=-D),G=Math.log2(D)|0,D/=Math.pow(2,G-31),R=D>>>0,R&2147483648||(D/=2,++G,R=D>>>0),D-=R,R|=2147483648,R>>>=0,D*=Math.pow(2,32),Z=D>>>0,Q.write_shift(4,Z),Q.write_shift(4,R),G+=16383+(z?32768:0),Q.write_shift(2,G),Q}function S(B,L){var U=j(B);return B.l+=L-14,U}function F(B,L){var U=w(B),D=B.read_shift(4);return U[1].v=D>>6,U}function I(B,L){var U=w(B),D=B.read_shift(8,"f");return U[1].v=D,U}function O(B,L){var U=I(B);return B.l+=L-10,U}function M(B,L){return B[B.l+L-1]==0?B.read_shift(L,"cstr"):""}function P(B,L){var U=B[B.l++];U>L-1&&(U=L-1);for(var D="";D.length<U;)D+=String.fromCharCode(B[B.l++]);return D}function X(B,L,U){if(!(!U.qpro||L<21)){var D=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var Q=B.read_shift(L-21,"cstr");return[D,Q]}}function J(B,L){for(var U={},D=B.l+L;B.l<D;){var Q=B.read_shift(2);if(Q==14e3){for(U[Q]=[0,""],U[Q][0]=B.read_shift(2);B[B.l];)U[Q][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return U}function H(B,L){var U=nt(5+B.length);U.write_shift(2,14e3),U.write_shift(2,L);for(var D=0;D<B.length;++D){var Q=B.charCodeAt(D);U[U.l++]=Q>127?95:Q}return U[U.l++]=0,U}var V={0:{n:"BOF",f:zn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:M},222:{n:"SHEETNAMELP",f:P},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:S},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:I},40:{n:"FORMULA28",f:O},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:M},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function Wne(e){var t={},r=e.match(cs),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Wt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=v_[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var zne=function(){var e=A0("t"),t=A0("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:br(o[1])},c=i.match(t);return c&&(l.s=Wne(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),Xne=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),Yne=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Jne=/<(?:\w+:)?r>/,Zne=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function K_(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=br(Dr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Dr(e),r&&(n.h=E_(n.t))):e.match(Jne)&&(n.r=Dr(e),n.t=br(Dr((e.replace(Zne,"").match(Yne)||[]).join("").replace(cs,""))),r&&(n.h=Xne(zne(n.r)))),n):{t:""}}var eae=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tae=/<(?:\w+:)?(?:si|sstItem)>/g,rae=/<\/(?:\w+:)?(?:si|sstItem)>/;function nae(e,t){var r=[],n="";if(!e)return r;var s=e.match(eae);if(s){n=s[2].replace(tae,"").split(rae);for(var i=0;i!=n.length;++i){var o=K_(n[i].trim(),t);o!=null&&(r[r.length]=o)}s=Wt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var aae=/^\s|\s$|[\t\n\r]/;function f8(e,t){if(!t.bookSST)return"";var r=[Hn];r[r.length]=wt("sst",null,{xmlns:rd[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(aae)&&(i+=' xml:space="preserve"'),i+=">"+Or(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function sae(e){return[e.read_shift(4),e.read_shift(4)]}function iae(e,t){var r=[],n=!1;return Pl(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function oae(e,t){return t||(t=nt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var lae=xte;function cae(e){var t=Ds();At(t,159,oae(e));for(var r=0;r<e.length;++r)At(t,19,lae(e[r]));return At(t,160),t.end()}function h8(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function jl(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function uae(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=jl(e,4),t.U=jl(e,4),t.W=jl(e,4),t}function dae(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Aae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(dae(e));return t}function fae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function hae(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=jl(e,4),t.U=jl(e,4),t.W=jl(e,4),t}function pae(e){var t=hae(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function p8(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function m8(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function mae(e){var t=jl(e);switch(t.Minor){case 2:return[t.Minor,gae(e)];case 3:return[t.Minor,xae()];case 4:return[t.Minor,yae(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function gae(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=p8(e,r),s=m8(e,e.length-e.l);return{t:"Std",h:n,v:s}}function xae(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yae(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(cs,function(i){var o=Wt(i);switch(Vo(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function vae(e,t){var r={},n=r.EncryptionVersionInfo=jl(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=p8(e,s),t-=s,r.EncryptionVerifier=m8(e,t),r}function bae(e){var t={},r=t.EncryptionVersionInfo=jl(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function $_(e){var t=0,r,n=h8(e),s=n.length+1,i,o,l,c,u;for(r=Uc(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var g8=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],h=0;h!=7;++h)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=h8(o),c=i(l),u=l.length,d=Uc(16),h=0;h!=16;++h)d[h]=0;var f,A,b;for((u&1)===1&&(f=c>>8,d[u]=s(e[0],f),--u,f=c&255,A=l[l.length-1],d[u]=s(A,f));u>0;)--u,f=c>>8,d[u]=s(l[u],f),--u,f=c&255,d[u]=s(l[u],f);for(u=15,b=15-l.length;b>0;)f=c>>8,d[u]=s(e[b],f),--u,--b,f=c&255,d[u]=s(l[u],f),--u,--b;return d}}(),wae=function(e,t,r,n,s){s||(s=t),n||(n=g8(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},_ae=function(e){var t=0,r=g8(e);return function(n){var s=wae("",n,t,r);return t=s[1],s[0]}};function Nae(e,t,r,n){var s={key:zn(e),verificationBytes:zn(e)};return r.password&&(s.verifier=$_(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=_ae(r.password)),s}function jae(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=bae(e):n.Data=vae(e,t),n}function Cae(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?jae(e,t-2,n):Nae(e,r.biff>=8?t:t-2,r,n),n}var x8=function(){function e(s,i){switch(i.type){case"base64":return t(fi(s),i);case"binary":return t(s,i);case"buffer":return t(ur&&Buffer.isBuffer(s)?s.toString("binary"):$c(s),i);case"array":return t(Vu(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(l)&&(l[h]=[]);for(var f=/\\\w+\b/g,A=0,b,m=-1;b=f.exec(d);){switch(b[0]){case"\\cell":var v=d.slice(A,f.lastIndex-b[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var p={v,t:"s"};Array.isArray(l)?l[h][m]=p:l[Gt({r:h,c:m})]=p}break}A=f.lastIndex}m>u.e.c&&(u.e.c=m)}),l["!ref"]=ar(u),l}function r(s,i){return Vc(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=wr(s["!ref"]),l,c=Array.isArray(s),u=o.s.r;u<=o.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var h=Gt({r:u,c:d});l=c?(s[u]||[])[d]:s[h],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Il(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Bae(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function m0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function kae(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),i=Math.min(t,r,n),o=s-i;if(o===0)return[0,0,t];var l=0,c=0,u=s+i;switch(c=o/(u>1?2-u:u),s){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function Sae(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function fx(e,t){if(t===0)return e;var r=kae(Bae(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),m0(Sae(r))}var y8=6,Eae=15,Fae=1,rs=y8;function g0(e){return Math.floor((e+Math.round(128/rs)/256)*rs)}function x0(e){return Math.floor((e-5)/rs*100+.5)/100}function hx(e){return Math.round((e*rs+5)/rs*256)/256}function Fv(e){return hx(x0(g0(e)))}function V_(e){var t=Math.abs(e-Fv(e)),r=rs;if(t>.005)for(rs=Fae;rs<Eae;++rs)Math.abs(e-Fv(e))<=t&&(t=Math.abs(e-Fv(e)),r=rs);rs=r}function Pc(e){e.width?(e.wpx=g0(e.width),e.wch=x0(e.wpx),e.MDW=rs):e.wpx?(e.wch=x0(e.wpx),e.width=hx(e.wch),e.MDW=rs):typeof e.wch=="number"&&(e.width=hx(e.wch),e.wpx=g0(e.width),e.MDW=rs),e.customWidth&&delete e.customWidth}var Tae=96,v8=Tae;function y0(e){return e*96/v8}function IA(e){return e*v8/96}var Iae={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Lae(e,t,r,n){t.Borders=[];var s={},i=!1;(e[0].match(cs)||[]).forEach(function(o){var l=Wt(o);switch(Vo(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=en(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=en(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function Oae(e,t,r,n){t.Fills=[];var s={},i=!1;(e[0].match(cs)||[]).forEach(function(o){var l=Wt(o);switch(Vo(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function Uae(e,t,r,n){t.Fonts=[];var s={},i=!1;(e[0].match(cs)||[]).forEach(function(o){var l=Wt(o);switch(Vo(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Dr(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?en(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?en(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?en(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?en(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?en(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?en(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?en(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=v_[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=en(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Iu[s.color.index];s.color.index==81&&(c=Iu[1]),c||(c=Iu[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=fx(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Pae(e,t,r){t.NumberFmt=[];for(var n=Bn($t),s=0;s<n.length;++s)t.NumberFmt[n[s]]=$t[n[s]];var i=e[0].match(cs);if(i)for(s=0;s<i.length;++s){var o=Wt(i[s]);switch(Vo(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=br(Dr(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Nl(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Dae(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=wt("numFmt",null,{numFmtId:n,formatCode:Or(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=wt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Tm=["numFmtId","fillId","fontId","borderId","xfId"],Im=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Rae(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(cs)||[]).forEach(function(i){var o=Wt(i),l=0;switch(Vo(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Tm.length;++l)n[Tm[l]]&&(n[Tm[l]]=parseInt(n[Tm[l]],10));for(l=0;l<Im.length;++l)n[Im[l]]&&(n[Im[l]]=en(n[Im[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=en(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Qae(e){var t=[];return t[t.length]=wt("cellXfs",null),e.forEach(function(r){t[t.length]=wt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=wt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Mae=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=l.match(t))&&Pae(h,d,u),(h=l.match(s))&&Uae(h,d,c,u),(h=l.match(n))&&Oae(h,d,c,u),(h=l.match(i))&&Lae(h,d,c,u),(h=l.match(r))&&Rae(h,d,u),d}}();function b8(e,t){var r=[Hn,wt("styleSheet",null,{xmlns:rd[0],"xmlns:vt":Aa.vt})],n;return e.SSF&&(n=Dae(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Qae(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Hae(e,t){var r=e.read_shift(2),n=ss(e);return[r,n]}function qae(e,t,r){r||(r=nt(6+4*t.length)),r.write_shift(2,e),wa(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Kae(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=jte(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Nte(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ss(e),n}function $ae(e,t){t||(t=nt(25+4*32)),t.write_shift(2,e.sz*20),Cte(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ux(e.color,t);var n=0;return n=2,t.write_shift(1,n),wa(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Vae=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Tv,Gae=os;function Ck(e,t){t||(t=nt(4*3+8*7+16*1)),Tv||(Tv=a1(Vae));var r=Tv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(ux({auto:1},t),ux({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Wae(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function w8(e,t,r){r||(r=nt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Vf(e,t){return t||(t=nt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var zae=os;function Xae(e,t){return t||(t=nt(51)),t.write_shift(1,0),Vf(null,t),Vf(null,t),Vf(null,t),Vf(null,t),Vf(null,t),t.length>t.l?t.slice(0,t.l):t}function Yae(e,t){return t||(t=nt(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),cx(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Jae(e,t,r){var n=nt(2052);return n.write_shift(4,e),cx(t,n),cx(r,n),n.length>n.l?n.slice(0,n.l):n}function Zae(e,t,r){var n={};n.NumberFmt=[];for(var s in $t)n.NumberFmt[s]=$t[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Pl(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Nl(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=fx(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function ese(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(At(e,615,po(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&At(e,44,qae(s,t[s]))}),At(e,616))}}function tse(e){var t=1;At(e,611,po(t)),At(e,43,$ae({sz:12,color:{theme:1},name:"Calibri",family:2})),At(e,612)}function rse(e){var t=2;At(e,603,po(t)),At(e,45,Ck({patternType:"none"})),At(e,45,Ck({patternType:"gray125"})),At(e,604)}function nse(e){var t=1;At(e,613,po(t)),At(e,46,Xae()),At(e,614)}function ase(e){var t=1;At(e,626,po(t)),At(e,47,w8({numFmtId:0},65535)),At(e,627)}function sse(e,t){At(e,617,po(t.length)),t.forEach(function(r){At(e,47,w8(r,0))}),At(e,618)}function ise(e){var t=1;At(e,619,po(t)),At(e,48,Yae({xfId:0,name:"Normal"})),At(e,620)}function ose(e){var t=0;At(e,505,po(t)),At(e,506)}function lse(e){var t=0;At(e,508,Jae(t,"TableStyleMedium9","PivotStyleMedium4")),At(e,509)}function cse(e,t){var r=Ds();return At(r,278),ese(r,e.SSF),tse(r),rse(r),nse(r),ase(r),sse(r,t.cellXfs),ise(r),ose(r),lse(r),At(r,279),r.end()}var use=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dse(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(cs)||[]).forEach(function(s){var i=Wt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[use.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Ase(){}function fse(){}var hse=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pse=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mse=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function gse(e,t,r){t.themeElements={};var n;[["clrScheme",hse,dse],["fontScheme",pse,Ase],["fmtScheme",mse,fse]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var xse=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function _8(e,t){(!e||e.length===0)&&(e=G_());var r,n={};if(!(r=e.match(xse)))throw new Error("themeElements not found in theme");return gse(r[0],n,t),n.raw=e,n}function G_(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Hn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yse(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=pI(i,{type:"array"})}catch{return}var l=si(o,"theme/theme/theme1.xml",!0);if(l)return _8(l,r)}}function vse(e){return e.read_shift(4)}function bse(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=wse(e,4);break;case 2:t.xclrValue=r8(e);break;case 3:t.xclrValue=vse(e);break;case 4:e.l+=4;break}return e.l+=8,t}function wse(e,t){return os(e,t)}function _se(e,t){return os(e,t)}function Nse(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=bse(e);break;case 6:n[1]=_se(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function jse(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(Nse(e,r-e.l));return{ixfe:n,ext:i}}function Cse(e,t){t.forEach(function(r){switch(r[0]){}})}function Bse(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ss(e)}}function kse(e){var t=nt(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),wa(e.name,t),t.slice(0,t.l)}function Sse(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Ese(e){var t=nt(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Fse(e,t){var r=nt(8+2*t.length);return r.write_shift(4,e),wa(t,r),r.slice(0,r.l)}function Tse(e){return e.l+=4,e.read_shift(4)!=0}function Ise(e,t){var r=nt(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Lse(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return Pl(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){l==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):l==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!u.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Ose(){var e=Ds();return At(e,332),At(e,334,po(1)),At(e,335,kse({name:"XLDAPR",version:12e4,flags:3496657072})),At(e,336),At(e,339,Fse(1,"XLDAPR")),At(e,52),At(e,35,po(514)),At(e,4096,po(0)),At(e,4097,Bi(1)),At(e,36),At(e,53),At(e,340),At(e,337,Ise(1)),At(e,51,Ese([[1,0]])),At(e,338),At(e,333),e.end()}function Use(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,i=2,o;return e.replace(cs,function(l){var c=Wt(l);switch(Vo(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function N8(){var e=[Hn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Pse(e){var t=[];if(!e)return t;var r=1;return(e.match(cs)||[]).forEach(function(n){var s=Wt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Dse(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Gt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Rse(e,t,r){var n=[];return Pl(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Qse(e,t,r,n){if(!e)return e;var s=n||{},i=!1;Pl(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function Mse(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var nA=1024;function j8(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[wt("xml",null,{"xmlns:v":ei.v,"xmlns:o":ei.o,"xmlns:x":ei.x,"xmlns:mv":ei.mv}).replace(/\/>/,">"),wt("o:shapelayout",wt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),wt("v:shapetype",[wt("v:stroke",null,{joinstyle:"miter"}),wt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];nA<e*1e3;)nA+=1e3;return t.forEach(function(i){var o=mn(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?wt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=wt("v:fill",c,l),d={on:"t",obscured:"t"};++nA,s=s.concat(["<v:shape"+f0({id:"_x0000_s"+nA,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,wt("v:shadow",null,d),wt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ua("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ua("x:AutoFill","False"),Ua("x:Row",String(o.r)),Ua("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Bk(e,t,r,n){var s=Array.isArray(e),i;t.forEach(function(o){var l=mn(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=wr(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=ar(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}i.c.push(d)})}function Hse(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Wt(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=mn(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&K_(h[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),n.push(u)}}}}),n}function C8(e){var t=[Hn,wt("comments",null,{xmlns:rd[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=Or(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Or(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Ua("t",Or(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Ua("t",Or(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function qse(e,t){var r=[],n=!1,s={},i=0;return e.replace(cs,function(l,c){var u=Wt(l);switch(Vo(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function Kse(e,t,r){var n=[Hn,wt("ThreadedComments",null,{xmlns:Aa.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(wt("threadedComment",Ua("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function $se(e,t){var r=[],n=!1;return e.replace(cs,function(i){var o=Wt(i);switch(Vo(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function Vse(e){var t=[Hn,wt("personList",null,{xmlns:Aa.TCMNT,"xmlns:x":rd[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(wt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Gse(e){var t={};t.iauthor=e.read_shift(4);var r=id(e);return t.rfx=r.s,t.ref=Gt(r.s),e.l+=16,t}function Wse(e,t){return t==null&&(t=nt(36)),t.write_shift(4,e[1].iauthor),JA(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var zse=ss;function Xse(e){return wa(e.slice(0,54))}function Yse(e,t){var r=[],n=[],s={},i=!1;return Pl(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function Jse(e){var t=Ds(),r=[];return At(t,628),At(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),At(t,632,Xse(s.a)))})}),At(t,631),At(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:mn(n[0]),e:mn(n[0])};At(t,635,Wse([i,s])),s.t&&s.t.length>0&&At(t,637,vte(s)),At(t,636),delete s.iauthor})}),At(t,634),At(t,629),t.end()}var Zse="application/vnd.ms-office.vbaProject";function eie(e){var t=Ht.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ht.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Ht.write(t)}function tie(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ht.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var B8=["xlsb","xlsm","xlam","biff8","xla"];function rie(){return{"!type":"dialog"}}function nie(){return{"!type":"dialog"}}function aie(){return{"!type":"macro"}}function sie(){return{"!type":"macro"}}var yA=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,s+(l?"":"$")+pn(d)+(c?"":"$")+Mn(u)}return function(s,i){return t=i,s.replace(e,r)}}(),W_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,z_=function(){return function(t,r){return t.replace(W_,function(n,s,i,o,l,c){var u=O_(o)-(i?0:r.c),d=L_(c)-(l?0:r.r),h=d==0?"":l?d+1:"["+d+"]",f=u==0?"":i?u+1:"["+u+"]";return s+"R"+h+"C"+f})}}();function k8(e,t){return e.replace(W_,function(r,n,s,i,o,l){return n+(s=="$"?s+i:pn(O_(i)+t.c))+(o=="$"?o+l:Mn(L_(l)+t.r))})}function iie(e,t,r){var n=Qs(t),s=n.s,i=mn(r),o={r:i.r-s.r,c:i.c-s.c};return k8(e,o)}function oie(e){return e.length!=1}function kk(e){return e.replace(/_xlfn\./g,"")}function Gn(e){e.l+=1}function Dc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function S8(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return E8(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),o=Dc(e),l=Dc(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function E8(e){var t=Dc(e),r=Dc(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function lie(e,t,r){if(r.biff<8)return E8(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Dc(e),o=Dc(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function F8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return cie(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Dc(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function cie(e){var t=Dc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function uie(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function die(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Aie(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function Aie(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function fie(e,t,r){var n=(e[e.l++]&96)>>5,s=S8(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function hie(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=S8(e,i,r);return[n,s,o]}function pie(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function mie(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function gie(e,t,r){var n=(e[e.l++]&96)>>5,s=lie(e,t-1,r);return[n,s]}function xie(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Sk(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function yie(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function vie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function bie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function wie(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function _ie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function T8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Nie(e){return e.read_shift(2),T8(e)}function jie(e){return e.read_shift(2),T8(e)}function Cie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=F8(e,0,r);return[n,s]}function Bie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=die(e,0,r);return[n,s]}function kie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=F8(e,0,r);return[n,s,i]}function Sie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Toe[s],O8[s],n]}function Eie(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Fie(e);return[s,(i[0]===0?O8:Foe)[i[1]]]}function Fie(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Tie(e,t,r){e.l+=r&&r.biff==2?3:4}function Iie(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Lie(e){return e.l++,Dl[e.read_shift(1)]}function Oie(e){return e.l++,e.read_shift(2)}function Uie(e){return e.l++,e.read_shift(1)!==0}function Pie(e){return e.l++,ns(e)}function Die(e,t,r){return e.l++,O0(e,t-1,r)}function Rie(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=On(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Dl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ns(e);break;case 2:r[1]=od(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Qie(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?id:o1)(e));return s}function Mie(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=Rie(e,r.biff);return o}function Hie(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function qie(e,t,r){if(r.biff==5)return Kie(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function Kie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function $ie(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Vie(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Gie(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Wie(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var zie=os,Xie=os,Yie=os;function P0(e,t,r){return e.l+=2,[uie(e)]}function X_(e){return e.l+=6,[]}var Jie=P0,Zie=X_,eoe=X_,toe=P0;function I8(e){return e.l+=2,[zn(e),e.read_shift(2)&1]}var roe=P0,noe=I8,aoe=X_,soe=P0,ioe=P0,ooe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function loe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=ooe[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:i}}function coe(e){return e.l+=2,[e.read_shift(4)]}function uoe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function doe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Aoe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function foe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hoe(e){return e.l+=4,[0,0]}var Ek={1:{n:"PtgExp",f:Iie},2:{n:"PtgTbl",f:Yie},3:{n:"PtgAdd",f:Gn},4:{n:"PtgSub",f:Gn},5:{n:"PtgMul",f:Gn},6:{n:"PtgDiv",f:Gn},7:{n:"PtgPower",f:Gn},8:{n:"PtgConcat",f:Gn},9:{n:"PtgLt",f:Gn},10:{n:"PtgLe",f:Gn},11:{n:"PtgEq",f:Gn},12:{n:"PtgGe",f:Gn},13:{n:"PtgGt",f:Gn},14:{n:"PtgNe",f:Gn},15:{n:"PtgIsect",f:Gn},16:{n:"PtgUnion",f:Gn},17:{n:"PtgRange",f:Gn},18:{n:"PtgUplus",f:Gn},19:{n:"PtgUminus",f:Gn},20:{n:"PtgPercent",f:Gn},21:{n:"PtgParen",f:Gn},22:{n:"PtgMissArg",f:Gn},23:{n:"PtgStr",f:Die},26:{n:"PtgSheet",f:uoe},27:{n:"PtgEndSheet",f:doe},28:{n:"PtgErr",f:Lie},29:{n:"PtgBool",f:Uie},30:{n:"PtgInt",f:Oie},31:{n:"PtgNum",f:Pie},32:{n:"PtgArray",f:xie},33:{n:"PtgFunc",f:Sie},34:{n:"PtgFuncVar",f:Eie},35:{n:"PtgName",f:Hie},36:{n:"PtgRef",f:Cie},37:{n:"PtgArea",f:fie},38:{n:"PtgMemArea",f:$ie},39:{n:"PtgMemErr",f:zie},40:{n:"PtgMemNoMem",f:Xie},41:{n:"PtgMemFunc",f:Vie},42:{n:"PtgRefErr",f:Gie},43:{n:"PtgAreaErr",f:pie},44:{n:"PtgRefN",f:Bie},45:{n:"PtgAreaN",f:gie},46:{n:"PtgMemAreaN",f:Aoe},47:{n:"PtgMemNoMemN",f:foe},57:{n:"PtgNameX",f:qie},58:{n:"PtgRef3d",f:kie},59:{n:"PtgArea3d",f:hie},60:{n:"PtgRefErr3d",f:Wie},61:{n:"PtgAreaErr3d",f:mie},255:{}},poe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},moe={1:{n:"PtgElfLel",f:I8},2:{n:"PtgElfRw",f:soe},3:{n:"PtgElfCol",f:Jie},6:{n:"PtgElfRwV",f:ioe},7:{n:"PtgElfColV",f:toe},10:{n:"PtgElfRadical",f:roe},11:{n:"PtgElfRadicalS",f:aoe},13:{n:"PtgElfColS",f:Zie},15:{n:"PtgElfColSV",f:eoe},16:{n:"PtgElfRadicalLel",f:noe},25:{n:"PtgList",f:loe},29:{n:"PtgSxName",f:coe},255:{}},goe={0:{n:"PtgAttrNoop",f:hoe},1:{n:"PtgAttrSemi",f:_ie},2:{n:"PtgAttrIf",f:bie},4:{n:"PtgAttrChoose",f:yie},8:{n:"PtgAttrGoto",f:vie},16:{n:"PtgAttrSum",f:Tie},32:{n:"PtgAttrBaxcel",f:Sk},33:{n:"PtgAttrBaxcel",f:Sk},64:{n:"PtgAttrSpace",f:Nie},65:{n:"PtgAttrSpaceSemi",f:jie},128:{n:"PtgAttrIfError",f:wie},255:{}};function D0(e,t,r,n){if(n.biff<8)return os(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Mie(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Qie(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(os(e,t)),i}function R0(e,t,r){for(var n=e.l+t,s,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Ek[i]||Ek[poe[i]],(i===24||i===25)&&(s=(i===24?moe:goe)[e[e.l+1]]),!s||!s.f?os(e,t):o.push([s.n,s.f(e,t,r)]);return o}function xoe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var yoe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function voe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function L8(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Fk(e,t,r){var n=L8(e,t,r);return n=="#REF"?n:voe(n,r)}function es(e,t,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,h=0,f=0,A,b="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",p=0,g=e[0].length;p<g;++p){var y=e[0][p];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=jn(" ",e[0][m][1][1]);break;case 1:v=jn("\r",e[0][m][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+v,m=-1}l.push(u+yoe[y[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Sh(y[1][1],o,s),l.push(Eh(d,i));break;case"PtgRefN":d=r?Sh(y[1][1],r,s):y[1][1],l.push(Eh(d,i));break;case"PtgRef3d":h=y[1][1],d=Sh(y[1][2],o,s),b=Fk(n,h,s),l.push(b+"!"+Eh(d,i));break;case"PtgFunc":case"PtgFuncVar":var x=y[1][0],w=y[1][1];x||(x=0),x&=127;var N=x==0?[]:l.slice(-x);l.length-=x,w==="User"&&(w=N.shift()),l.push(w+"("+N.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":A=ik(y[1][1],r?{s:r}:o,s),l.push(kv(A,s));break;case"PtgArea":A=ik(y[1][1],o,s),l.push(kv(A,s));break;case"PtgArea3d":h=y[1][1],A=y[1][2],b=Fk(n,h,s),l.push(b+"!"+kv(A,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var _=(n.names||[])[f-1]||(n[0]||[])[f],C=_?_.Name:"SH33TJSNAME"+String(f);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),l.push(C);break;case"PtgNameX":var j=y[1][1];f=y[1][2];var E;if(s.biff<=5)j<0&&(j=-j),n[j]&&(E=n[j][f]);else{var S="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][f]&&n[j][f].itab>0&&(S=n.SheetNames[n[j][f].itab-1]+"!"):S=n.SheetNames[f-1]+"!"),n[j]&&n[j][f])S+=n[j][f].Name;else if(n[0]&&n[0][f])S+=n[0][f].Name;else{var F=(L8(n,j,s)||"").split(";;");F[f-1]?S=F[f-1]:S+="SH33TJSERRX"}l.push(S);break}E||(E={Name:"SH33TJSERRY"}),l.push(E.Name);break;case"PtgParen":var I="(",O=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:I=jn(" ",e[0][m][1][1])+I;break;case 3:I=jn("\r",e[0][m][1][1])+I;break;case 4:O=jn(" ",e[0][m][1][1])+O;break;case 5:O=jn("\r",e[0][m][1][1])+O;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}l.push(I+l.pop()+O);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var M={c:r.c,r:r.r};if(n.sharedf[Gt(d)]){var P=n.sharedf[Gt(d)];l.push(es(P,o,M,n,s))}else{var X=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(es(u[1],o,M,n,s)),X=!0;break}X||l.push(y[1])}break;case"PtgArray":l.push("{"+xoe(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=p;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&J.indexOf(e[0][p][0])==-1){y=e[0][m];var H=!0;switch(y[1][0]){case 4:H=!1;case 0:v=jn(" ",y[1][1]);break;case 5:H=!1;case 1:v=jn("\r",y[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((H?v:"")+l.pop()+(H?"":v)),m=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function boe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],os(e,t-2)];var l=R0(e,o,r);return t!==o+s&&(i=D0(e,t-o-s,l,r)),e.l=n,[l,i]}function woe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],os(e,t-2)];var l=R0(e,o,r);return t!==o+s&&(i=D0(e,t-o-s,l,r)),e.l=n,[l,i]}function _oe(e,t,r,n){var s=e.l+t,i=R0(e,n,r),o;return s!==e.l&&(o=D0(e,s-e.l,i,r)),[i,o]}function Noe(e,t,r){var n=e.l+t,s,i=e.read_shift(2),o=R0(e,i,r);return i==65535?[[],os(e,t-2)]:(t!==i+2&&(s=D0(e,n-i-2,o,r)),[o,s])}function joe(e){var t;if(vl(e,e.l+6)!==65535)return[ns(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Coe(e){if(e==null){var t=nt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Gu(e);return Gu(0)}function Iv(e,t,r){var n=e.l+t,s=Go(e);r.biff==2&&++e.l;var i=joe(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=woe(e,n-e.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function Boe(e,t,r,n,s){var i=zu(t,r,s),o=Coe(e.v),l=nt(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=nt(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=ba([i,o,l,u]);return h}function l1(e,t,r){var n=e.read_shift(4),s=R0(e,n,r),i=e.read_shift(4),o=i>0?D0(e,i,s,r):null;return[s,o]}var koe=l1,c1=l1,Soe=l1,Eoe=l1,Foe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},O8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Toe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Tk(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Ioe(e){var t="of:="+e.replace(W_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Lv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Loe(e){return e.replace(/\./,"!")}var Th={},vA={},Ih=typeof Map<"u";function Y_(e,t,r){var n=0,s=e.length;if(r){if(Ih?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Ih?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Ih?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function u1(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(rs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=x0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=hx(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Uu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Gc(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Nl(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function U8(e,t,r,n,s,i){try{n.cellNF&&(e.z=$t[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=an(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if($t[t]==null&&Nl(Fee[t]||"General",t),e.t==="e")e.w=e.w||Dl[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d0(e.v);else if(e.t==="d"){var o=pa(e.v);(o|0)===o?e.w=o.toString(10):e.w=d0(o)}else{if(e.v===void 0)return"";e.w=$u(e.v,vA)}else e.t==="d"?e.w=Hi(t,pa(e.v),vA):e.w=Hi(t,e.v,vA)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fx(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fx(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function Ooe(e,t,r){if(e&&e["!ref"]){var n=wr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Uoe(e,t){var r=wr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ar(r))}var Poe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Doe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Roe=/<(?:\w:)?hyperlink [^>]*>/mg,Qoe=/"(\w*:\w*)"/,Moe=/<(?:\w:)?col\b[^>]*[\/]?>/g,Hoe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,qoe=/<(?:\w:)?pageMargins[^>]*\/>/g,P8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Koe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$oe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Voe(e,t,r,n,s,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=e.match(Doe);h?(u=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):u=d=e;var f=u.match(P8);f?J_(f[0],l,s,r):(f=u.match(Koe))&&Woe(f[0],f[1]||"",l,s,r);var A=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(A>0){var b=u.slice(A,A+50).match(Qoe);b&&Uoe(l,b[1])}var m=u.match($oe);m&&m[1]&&ole(m[1],s);var v=[];if(t.cellStyles){var p=u.match(Moe);p&&rle(v,p)}h&&ule(h[1],l,t,c,i,o);var g=d.match(Hoe);g&&(l["!autofilter"]=ale(g[0]));var y=[],x=d.match(Poe);if(x)for(A=0;A!=x.length;++A)y[A]=wr(x[A].slice(x[A].indexOf('"')+1));var w=d.match(Roe);w&&Zoe(l,w,n);var N=d.match(qoe);if(N&&(l["!margins"]=ele(Wt(N[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=ar(c)),t.sheetRows>0&&l["!ref"]){var _=wr(l["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ar(_))}return v.length>0&&(l["!cols"]=v),y.length>0&&(l["!merges"]=y),l}function Goe(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ar(e[r])+'"/>';return t+"</mergeCells>"}function J_(e,t,r,n){var s=Wt(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=br(Dr(s.codeName)))}function Woe(e,t,r,n,s){J_(e.slice(0,e.indexOf(">")),r,n,s)}function zoe(e,t,r,n,s){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=Do(Or(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+wt("outlinePr",null,u)}!i&&!l||(s[s.length]=wt("sheetPr",l,o))}var Xoe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Yoe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Joe(e){var t={sheet:1};return Xoe.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Yoe.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=$_(e.password).toString(16).toUpperCase()),wt("sheetProtection",null,t)}function Zoe(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var i=Wt(Dr(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+br(i.location))):(i.Target="#"+br(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=wr(i.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Gt({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function ele(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function tle(e){return Uu(e),wt("pageMargins",null,e)}function rle(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Wt(t[n],!0);s.hidden&&(s.hidden=en(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,V_(s.width)),Pc(s);i<=o;)e[i++]=sn(s)}}function nle(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=wt("col",null,u1(s,n)));return r[r.length]="</cols>",r.join("")}function ale(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function sle(e,t,r,n){var s=typeof e.ref=="string"?e.ref:ar(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Qs(s);o.s.r==o.e.r&&(o.e.r=Qs(t["!ref"]).e.r,s=ar(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),wt("autoFilter",null,{ref:s})}var ile=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ole(e,t){t.Views||(t.Views=[{}]),(e.match(ile)||[]).forEach(function(r,n){var s=Wt(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),en(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function lle(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),wt("sheetViews",wt("sheetView",null,s),{})}function cle(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Dl[e.v];break;case"d":n&&n.cellDates?s=an(e.v,-1).toISOString():(e=sn(e),e.t="n",s=""+(e.v=pa(an(e.v)))),typeof e.z>"u"&&(e.z=$t[14]);break;default:s=e.v;break}var l=Ua("v",Or(s)),c={r:t},u=Gc(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Ua("v",""+Y_(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=wt("f",Or(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),wt("c",l,c)}var ule=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=A0("v"),o=A0("f");return function(c,u,d,h,f,A){for(var b=0,m="",v=[],p=[],g=0,y=0,x=0,w="",N,_,C=0,j=0,E,S,F=0,I=0,O=Array.isArray(A.CellXf),M,P=[],X=[],J=Array.isArray(u),H=[],V={},K=!1,B=!!d.sheetStubs,L=c.split(t),U=0,D=L.length;U!=D;++U){m=L[U].trim();var Q=m.length;if(Q!==0){var z=0;e:for(b=0;b<Q;++b)switch(m[b]){case">":if(m[b-1]!="/"){++b;break e}if(d&&d.cellStyles){if(_=Wt(m.slice(z,b),!0),C=_.r!=null?parseInt(_.r,10):C+1,j=-1,d.sheetRows&&d.sheetRows<C)continue;V={},K=!1,_.ht&&(K=!0,V.hpt=parseFloat(_.ht),V.hpx=IA(V.hpt)),_.hidden=="1"&&(K=!0,V.hidden=!0),_.outlineLevel!=null&&(K=!0,V.level=+_.outlineLevel),K&&(H[C-1]=V)}break;case"<":z=b;break}if(z>=b)break;if(_=Wt(m.slice(z,b),!0),C=_.r!=null?parseInt(_.r,10):C+1,j=-1,!(d.sheetRows&&d.sheetRows<C)){h.s.r>C-1&&(h.s.r=C-1),h.e.r<C-1&&(h.e.r=C-1),d&&d.cellStyles&&(V={},K=!1,_.ht&&(K=!0,V.hpt=parseFloat(_.ht),V.hpx=IA(V.hpt)),_.hidden=="1"&&(K=!0,V.hidden=!0),_.outlineLevel!=null&&(K=!0,V.level=+_.outlineLevel),K&&(H[C-1]=V)),v=m.slice(b).split(e);for(var G=0;G!=v.length&&v[G].trim().charAt(0)=="<";++G);for(v=v.slice(G),b=0;b!=v.length;++b)if(m=v[b].trim(),m.length!==0){if(p=m.match(r),g=b,y=0,x=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,p!=null&&p.length===2){for(g=0,w=p[1],y=0;y!=w.length&&!((x=w.charCodeAt(y)-64)<1||x>26);++y)g=26*g+x;--g,j=g}else++j;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,_=Wt(m.slice(0,y),!0),_.r||(_.r=Gt({r:C-1,c:j})),w=m.slice(y),N={t:""},(p=w.match(i))!=null&&p[1]!==""&&(N.v=br(p[1])),d.cellFormula){if((p=w.match(o))!=null&&p[1]!==""){if(N.f=br(Dr(p[1])).replace(/\r\n/g,`
`),d.xlfn||(N.f=kk(N.f)),p[0].indexOf('t="array"')>-1)N.F=(w.match(s)||[])[1],N.F.indexOf(":")>-1&&P.push([wr(N.F),N.F]);else if(p[0].indexOf('t="shared"')>-1){S=Wt(p[0]);var Z=br(Dr(p[1]));d.xlfn||(Z=kk(Z)),X[parseInt(S.si,10)]=[S,Z,_.r]}}else(p=w.match(/<f[^>]*\/>/))&&(S=Wt(p[0]),X[S.si]&&(N.f=iie(X[S.si][1],X[S.si][2],_.r)));var R=mn(_.r);for(y=0;y<P.length;++y)R.r>=P[y][0].s.r&&R.r<=P[y][0].e.r&&R.c>=P[y][0].s.c&&R.c<=P[y][0].e.c&&(N.F=P[y][1])}if(_.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(B)N.t="z";else continue;else N.t=_.t||"n";switch(h.s.c>j&&(h.s.c=j),h.e.c<j&&(h.e.c=j),N.t){case"n":if(N.v==""||N.v==null){if(!B)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!B)continue;N.t="z"}else E=Th[parseInt(N.v,10)],N.v=E.t,N.r=E.r,d.cellHTML&&(N.h=E.h);break;case"str":N.t="s",N.v=N.v!=null?Dr(N.v):"",d.cellHTML&&(N.h=E_(N.v));break;case"inlineStr":p=w.match(n),N.t="s",p!=null&&(E=K_(p[1]))?(N.v=E.t,d.cellHTML&&(N.h=E.h)):N.v="";break;case"b":N.v=en(N.v);break;case"d":d.cellDates?N.v=an(N.v,1):(N.v=pa(an(N.v,1)),N.t="n");break;case"e":(!d||d.cellText!==!1)&&(N.w=N.v),N.v=RI[N.v];break}if(F=I=0,M=null,O&&_.s!==void 0&&(M=A.CellXf[_.s],M!=null&&(M.numFmtId!=null&&(F=M.numFmtId),d.cellStyles&&M.fillId!=null&&(I=M.fillId))),U8(N,F,I,d,f,A),d.cellDates&&O&&N.t=="n"&&zA($t[F])&&(N.t="d",N.v=i1(N.v)),_.cm&&d.xlmeta){var le=(d.xlmeta.Cell||[])[+_.cm-1];le&&le.type=="XLDAPR"&&(N.D=!0)}if(J){var ee=mn(_.r);u[ee.r]||(u[ee.r]=[]),u[ee.r][ee.c]=N}else u[_.r]=N}}}}H.length>0&&(u["!rows"]=H)}}();function dle(e,t,r,n){var s=[],i=[],o=wr(e["!ref"]),l="",c,u="",d=[],h=0,f=0,A=e["!rows"],b=Array.isArray(e),m={r:u},v,p=-1;for(f=o.s.c;f<=o.e.c;++f)d[f]=pn(f);for(h=o.s.r;h<=o.e.r;++h){for(i=[],u=Mn(h),f=o.s.c;f<=o.e.c;++f){c=d[f]+u;var g=b?(e[h]||[])[f]:e[c];g!==void 0&&(l=cle(g,c,e,t))!=null&&i.push(l)}(i.length>0||A&&A[h])&&(m={r:u},A&&A[h]&&(v=A[h],v.hidden&&(m.hidden=1),p=-1,v.hpx?p=y0(v.hpx):v.hpt&&(p=v.hpt),p>-1&&(m.ht=p,m.customHeight=1),v.level&&(m.outlineLevel=v.level)),s[s.length]=wt("row",i.join(""),m))}if(A)for(;h<A.length;++h)A&&A[h]&&(m={r:h+1},v=A[h],v.hidden&&(m.hidden=1),p=-1,v.hpx?p=y0(v.hpx):v.hpt&&(p=v.hpt),p>-1&&(m.ht=p,m.customHeight=1),v.level&&(m.outlineLevel=v.level),s[s.length]=wt("row","",m));return s.join("")}function D8(e,t,r,n){var s=[Hn,wt("worksheet",null,{xmlns:rd[0],"xmlns:r":Aa.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=wr(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=ar(d)}n||(n={}),c["!comments"]=[];var h=[];zoe(c,r,e,t,s),s[s.length]=wt("dimension",null,{ref:u}),s[s.length]=lle(c,t,e,r),t.sheetFormat&&(s[s.length]=wt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=nle(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=dle(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=Joe(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=sle(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Goe(c["!merges"]));var f=-1,A,b=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(A={ref:m[0]},m[1].Target.charAt(0)!="#"&&(b=Ir(n,-1,Or(m[1].Target).replace(/#.*$/,""),dr.HLINK),A["r:id"]="rId"+b),(f=m[1].Target.indexOf("#"))>-1&&(A.location=Or(m[1].Target.slice(f+1))),m[1].Tooltip&&(A.tooltip=Or(m[1].Tooltip)),s[s.length]=wt("hyperlink",null,A))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=tle(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ua("ignoredErrors",wt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(b=Ir(n,-1,"../drawings/drawing"+(e+1)+".xml",dr.DRAW),s[s.length]=wt("drawing",null,{"r:id":"rId"+b}),c["!drawing"]=h),c["!comments"].length>0&&(b=Ir(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",dr.VML),s[s.length]=wt("legacyDrawing",null,{"r:id":"rId"+b}),c["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Ale(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function fle(e,t,r){var n=nt(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=y0(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,f=-1,A=d<<10;A<d+1<<10;++A){u.c=A;var b=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Gt(u)];b&&(h<0&&(h=A),f=A)}h<0||(++l,n.write_shift(4,h),n.write_shift(4,f))}var m=n.l;return n.l=c,n.write_shift(4,l),n.l=m,n.length>n.l?n.slice(0,n.l):n}function hle(e,t,r,n){var s=fle(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&At(e,0,s)}var ple=id,mle=JA;function gle(){}function xle(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=bte(e),r}function yle(e,t,r){r==null&&(r=nt(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return ux({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),LI(e,r),r.slice(0,r.l)}function vle(e){var t=qi(e);return[t]}function ble(e,t,r){return r==null&&(r=nt(8)),nd(t,r)}function wle(e){var t=ad(e);return[t]}function _le(e,t,r){return r==null&&(r=nt(4)),sd(t,r)}function Nle(e){var t=qi(e),r=e.read_shift(1);return[t,r,"b"]}function jle(e,t,r){return r==null&&(r=nt(9)),nd(t,r),r.write_shift(1,e.v?1:0),r}function Cle(e){var t=ad(e),r=e.read_shift(1);return[t,r,"b"]}function Ble(e,t,r){return r==null&&(r=nt(5)),sd(t,r),r.write_shift(1,e.v?1:0),r}function kle(e){var t=qi(e),r=e.read_shift(1);return[t,r,"e"]}function Sle(e,t,r){return r==null&&(r=nt(9)),nd(t,r),r.write_shift(1,e.v),r}function Ele(e){var t=ad(e),r=e.read_shift(1);return[t,r,"e"]}function Fle(e,t,r){return r==null&&(r=nt(8)),sd(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Tle(e){var t=qi(e),r=e.read_shift(4);return[t,r,"s"]}function Ile(e,t,r){return r==null&&(r=nt(12)),nd(t,r),r.write_shift(4,t.v),r}function Lle(e){var t=ad(e),r=e.read_shift(4);return[t,r,"s"]}function Ole(e,t,r){return r==null&&(r=nt(8)),sd(t,r),r.write_shift(4,t.v),r}function Ule(e){var t=qi(e),r=ns(e);return[t,r,"n"]}function Ple(e,t,r){return r==null&&(r=nt(16)),nd(t,r),Gu(e.v,r),r}function R8(e){var t=ad(e),r=ns(e);return[t,r,"n"]}function Dle(e,t,r){return r==null&&(r=nt(12)),sd(t,r),Gu(e.v,r),r}function Rle(e){var t=qi(e),r=R_(e);return[t,r,"n"]}function Qle(e,t,r){return r==null&&(r=nt(12)),nd(t,r),OI(e.v,r),r}function Mle(e){var t=ad(e),r=R_(e);return[t,r,"n"]}function Hle(e,t,r){return r==null&&(r=nt(8)),sd(t,r),OI(e.v,r),r}function qle(e){var t=qi(e),r=U_(e);return[t,r,"is"]}function Kle(e){var t=qi(e),r=ss(e);return[t,r,"str"]}function $le(e,t,r){return r==null&&(r=nt(12+4*e.v.length)),nd(t,r),wa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Vle(e){var t=ad(e),r=ss(e);return[t,r,"str"]}function Gle(e,t,r){return r==null&&(r=nt(8+4*e.v.length)),sd(t,r),wa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Wle(e,t,r){var n=e.l+t,s=qi(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=c1(e,n-e.l,r);o[3]=es(l,null,s,r.supbooks,r)}else e.l=n;return o}function zle(e,t,r){var n=e.l+t,s=qi(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=c1(e,n-e.l,r);o[3]=es(l,null,s,r.supbooks,r)}else e.l=n;return o}function Xle(e,t,r){var n=e.l+t,s=qi(e);s.r=r["!row"];var i=ns(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=c1(e,n-e.l,r);o[3]=es(l,null,s,r.supbooks,r)}else e.l=n;return o}function Yle(e,t,r){var n=e.l+t,s=qi(e);s.r=r["!row"];var i=ss(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=c1(e,n-e.l,r);o[3]=es(l,null,s,r.supbooks,r)}else e.l=n;return o}var Jle=id,Zle=JA;function ece(e,t){return t==null&&(t=nt(4)),t.write_shift(4,e),t}function tce(e,t){var r=e.l+t,n=id(e),s=P_(e),i=ss(e),o=ss(e),l=ss(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function rce(e,t){var r=nt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));JA({s:mn(e[0]),e:mn(e[0])},r),D_("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return wa(s||"",r),wa(e[1].Tooltip||"",r),wa("",r),r.slice(0,r.l)}function nce(){}function ace(e,t,r){var n=e.l+t,s=UI(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=koe(e,n-e.l,r);o[1]=l}else e.l=n;return o}function sce(e,t,r){var n=e.l+t,s=id(e),i=[s];if(r.cellFormula){var o=Eoe(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function ice(e,t,r){r==null&&(r=nt(18));var n=u1(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Q8=["left","right","top","bottom","header","footer"];function oce(e){var t={};return Q8.forEach(function(r){t[r]=ns(e)}),t}function lce(e,t){return t==null&&(t=nt(6*8)),Uu(e),Q8.forEach(function(r){Gu(e[r],t)}),t}function cce(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function uce(e,t,r){r==null&&(r=nt(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function dce(e){var t=nt(24);return t.write_shift(4,4),t.write_shift(4,1),JA(e,t),t}function Ace(e,t){return t==null&&(t=nt(16*4+2)),t.write_shift(2,e.password?$_(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function fce(){}function hce(){}function pce(e,t,r,n,s,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,A,b,m,v,p,g,y,x,w,N=[];l.biff=12,l["!row"]=0;var _=0,C=!1,j=[],E={},S=l.supbooks||s.supbooks||[[]];if(S.sharedf=E,S.arrayf=j,S.SheetNames=s.SheetNames||s.Sheets.map(function(J){return J.name}),!l.supbooks&&(l.supbooks=S,s.Names))for(var F=0;F<s.Names.length;++F)S[0][F+1]=s.Names[F];var I=[],O=[],M=!1;v0[16]={n:"BrtShortReal",f:R8};var P;if(Pl(e,function(H,V,K){if(!f)switch(K){case 148:u=H;break;case 0:A=H,l.sheetRows&&l.sheetRows<=A.r&&(f=!0),x=Mn(v=A.r),l["!row"]=A.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=IA(H.hpt)),O[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:H[2]},H[2]){case"n":b.v=H[1];break;case"s":y=Th[H[1]],b.v=y.t,b.r=y.r;break;case"b":b.v=!!H[1];break;case"e":b.v=H[1],l.cellText!==!1&&(b.w=Dl[b.v]);break;case"str":b.t="s",b.v=H[1];break;case"is":b.t="s",b.v=H[1].t;break}if((m=o.CellXf[H[0].iStyleRef])&&U8(b,m.numFmtId,null,l,i,o),p=H[0].c==-1?p+1:H[0].c,l.dense?(c[v]||(c[v]=[]),c[v][p]=b):c[pn(p)+x]=b,l.cellFormula){for(C=!1,_=0;_<j.length;++_){var B=j[_];A.r>=B[0].s.r&&A.r<=B[0].e.r&&p>=B[0].s.c&&p<=B[0].e.c&&(b.F=ar(B[0]),C=!0)}!C&&H.length>3&&(b.f=H[3])}if(d.s.r>A.r&&(d.s.r=A.r),d.s.c>p&&(d.s.c=p),d.e.r<A.r&&(d.e.r=A.r),d.e.c<p&&(d.e.c=p),l.cellDates&&m&&b.t=="n"&&zA($t[m.numFmtId])){var L=Bu(b.v);L&&(b.t="d",b.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}P&&(P.type=="XLDAPR"&&(b.D=!0),P=void 0);break;case 1:case 12:if(!l.sheetStubs||h)break;b={t:"z",v:void 0},p=H[0].c==-1?p+1:H[0].c,l.dense?(c[v]||(c[v]=[]),c[v][p]=b):c[pn(p)+x]=b,d.s.r>A.r&&(d.s.r=A.r),d.s.c>p&&(d.s.c=p),d.e.r<A.r&&(d.e.r=A.r),d.e.c<p&&(d.e.c=p),P&&(P.type=="XLDAPR"&&(b.D=!0),P=void 0);break;case 176:N.push(H);break;case 49:P=((l.xlmeta||{}).Cell||[])[H-1];break;case 494:var U=n["!id"][H.relId];for(U?(H.Target=U.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=U):H.relId==""&&(H.Target="#"+H.loc),v=H.rfx.s.r;v<=H.rfx.e.r;++v)for(p=H.rfx.s.c;p<=H.rfx.e.c;++p)l.dense?(c[v]||(c[v]=[]),c[v][p]||(c[v][p]={t:"z",v:void 0}),c[v][p].l=H):(g=Gt({c:p,r:v}),c[g]||(c[g]={t:"z",v:void 0}),c[g].l=H);break;case 426:if(!l.cellFormula)break;j.push(H),w=l.dense?c[v][p]:c[pn(p)+x],w.f=es(H[1],d,{r:A.r,c:p},S,l),w.F=ar(H[0]);break;case 427:if(!l.cellFormula)break;E[Gt(H[0].s)]=H[1],w=l.dense?c[v][p]:c[pn(p)+x],w.f=es(H[1],d,{r:A.r,c:p},S,l);break;case 60:if(!l.cellStyles)break;for(;H.e>=H.s;)I[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},M||(M=!0,V_(H.w/256)),Pc(I[H.e+1]);break;case 161:c["!autofilter"]={ref:ar(H)};break;case 476:c["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(c["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!V.T){if(!h||l.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=ar(u||d)),l.sheetRows&&c["!ref"]){var X=wr(c["!ref"]);l.sheetRows<=+X.e.r&&(X.e.r=l.sheetRows-1,X.e.r>d.e.r&&(X.e.r=d.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>d.e.c&&(X.e.c=d.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ar(X))}return N.length>0&&(c["!merges"]=N),I.length>0&&(c["!cols"]=I),O.length>0&&(c["!rows"]=O),c}function mce(e,t,r,n,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=sn(t),t.z=t.z||$t[14],t.v=pa(an(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Gc(s.cellXfs,t,s),t.l&&i["!links"].push([Gt(c),t.l]),t.c&&i["!comments"].push([Gt(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=Y_(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?At(e,18,Ole(t,c)):At(e,7,Ile(t,c))):(c.t="str",o?At(e,17,Gle(t,c)):At(e,6,$le(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?At(e,13,Hle(t,c)):At(e,2,Qle(t,c)):o?At(e,16,Dle(t,c)):At(e,5,Ple(t,c)),!0;case"b":return c.t="b",o?At(e,15,Ble(t,c)):At(e,4,jle(t,c)),!0;case"e":return c.t="e",o?At(e,14,Fle(t,c)):At(e,3,Sle(t,c)),!0}return o?At(e,12,_le(t,c)):At(e,1,ble(t,c)),!0}function gce(e,t,r,n){var s=wr(t["!ref"]||"A1"),i,o="",l=[];At(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){o=Mn(d),hle(e,t,s,d);var h=!1;if(d<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(l[f]=pn(f)),i=l[f]+o;var A=c?(t[d]||[])[f]:t[i];if(!A){h=!1;continue}h=mce(e,A,d,f,n,t,h)}}At(e,146)}function xce(e,t){!t||!t["!merges"]||(At(e,177,ece(t["!merges"].length)),t["!merges"].forEach(function(r){At(e,176,Zle(r))}),At(e,178))}function yce(e,t){!t||!t["!cols"]||(At(e,390),t["!cols"].forEach(function(r,n){r&&At(e,60,ice(n,r))}),At(e,391))}function vce(e,t){!t||!t["!ref"]||(At(e,648),At(e,649,dce(wr(t["!ref"]))),At(e,650))}function bce(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Ir(r,-1,n[1].Target.replace(/#.*$/,""),dr.HLINK);At(e,494,rce(n,s))}}),delete t["!links"]}function wce(e,t,r,n){if(t["!comments"].length>0){var s=Ir(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",dr.VML);At(e,551,D_("rId"+s)),t["!legacy"]=s}}function _ce(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:ar(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Qs(i);l.s.r==l.e.r&&(l.e.r=Qs(t["!ref"]).e.r,i=ar(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),At(e,161,JA(wr(i))),At(e,162)}}function Nce(e,t,r){At(e,133),At(e,137,uce(t,r)),At(e,138),At(e,134)}function jce(e,t){t["!protect"]&&At(e,535,Ace(t["!protect"]))}function Cce(e,t,r,n){var s=Ds(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=wr(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],At(s,129),(r.vbaraw||o["!outline"])&&At(s,147,yle(l,o["!outline"])),At(s,148,mle(c)),Nce(s,o,r.Workbook),yce(s,o),gce(s,o,e,t),jce(s,o),_ce(s,o,r,e),xce(s,o),bce(s,o,n),o["!margins"]&&At(s,476,lce(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&vce(s,o),wce(s,o,e,n),At(s,130),s.end()}function Bce(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=br((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,s,n]}function kce(e,t,r,n,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=Bce(h);d.s.r=d.s.c=0,d.e.c=l,u=pn(l),f[0].forEach(function(A,b){o[u+Mn(b)]={t:"n",v:A,z:f[1]},c=b}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=ar(d)),o}function Sce(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(P8);return l&&J_(l[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Ece(e,t){e.l+=10;var r=ss(e);return{name:r}}function Fce(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Pl(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Z_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Tce=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ice=[],Lce=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ik(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var i=t[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=en(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Lk(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=en(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function M8(e){Lk(e.WBProps,Z_),Lk(e.CalcPr,Lce),Ik(e.WBView,Tce),Ik(e.Sheets,Ice),vA.date1904=en(e.WBProps.date1904)}function Oce(e){return!e.Workbook||!e.Workbook.WBProps?"false":en(e.Workbook.WBProps.date1904)?"true":"false"}var Uce="][*?/\\".split("");function H8(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Uce.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Pce(e,t,r){e.forEach(function(n,s){H8(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[s]&&t[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Dce(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Pce(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Ooe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Rce=/<\w+:workbook/;function Qce(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(e.replace(cs,function(c,u){var d=Wt(c);switch(Vo(d[0])){case"<?xml":break;case"<workbook":c.match(Rce)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Z_.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=en(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Dr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=br(Dr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Dr(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),en(d.hidden||"0")&&(i.Hidden=!0),o=u+c.length;break;case"</definedName>":i.Ref=br(Dr(e.slice(o,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),rd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return M8(r),r}function q8(e){var t=[Hn];t[t.length]=wt("workbook",null,{xmlns:rd[0],"xmlns:r":Aa.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Z_.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=wt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Or(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=wt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=wt("definedName",Or(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Mce(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Kw(e),r.name=ss(e),r}function Hce(e,t){return t||(t=nt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),D_(e.strRelID,t),wa(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function qce(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ss(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Kce(e,t){t||(t=nt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),LI(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function $ce(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Vce(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=wte(e),o=Soe(e,0,r),l=P_(e);e.l=n;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Gce(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],v0[16]={n:"BrtFRTArchID$",f:$ce},Pl(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=es(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),M8(r),r.Names=i,r.supbooks=o,r}function Wce(e,t){At(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};At(e,156,Hce(s))}At(e,144)}function zce(e,t){t||(t=nt(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return wa("SheetJS",t),wa(nx.version,t),wa(nx.version,t),wa("7262",t),t.length>t.l?t.slice(0,t.l):t}function Xce(e,t){t||(t=nt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Yce(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(At(e,135),At(e,158,Xce(s)),At(e,136))}}function Jce(e,t){var r=Ds();return At(r,131),At(r,128,zce()),At(r,153,Kce(e.Workbook&&e.Workbook.WBProps||null)),Yce(r,e),Wce(r,e),At(r,132),r.end()}function Zce(e,t,r){return t.slice(-4)===".bin"?Gce(e,r):Qce(e,r)}function eue(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?pce(e,n,r,s,i,o,l):Voe(e,n,r,s,i,o,l)}function tue(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?Fce(e,n,r,s,i):Sce(e,n,r,s,i)}function rue(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?aie():sie()}function nue(e,t,r,n,s,i,o,l){return t.slice(-4)===".bin"?rie():nie()}function aue(e,t,r,n){return t.slice(-4)===".bin"?Zae(e,r,n):Mae(e,r,n)}function sue(e,t,r){return _8(e,r)}function iue(e,t,r){return t.slice(-4)===".bin"?iae(e,r):nae(e,r)}function oue(e,t,r){return t.slice(-4)===".bin"?Yse(e,r):Hse(e,r)}function lue(e,t,r){return t.slice(-4)===".bin"?Rse(e):Pse(e)}function cue(e,t,r,n){return r.slice(-4)===".bin"?Qse(e,t,r,n):void 0}function uue(e,t,r){return t.slice(-4)===".bin"?Lse(e,t,r):Use(e,t,r)}function due(e,t,r){return(t.slice(-4)===".bin"?Jce:q8)(e)}function Aue(e,t,r,n,s){return(t.slice(-4)===".bin"?Cce:D8)(e,r,n,s)}function fue(e,t,r){return(t.slice(-4)===".bin"?cse:b8)(e,r)}function hue(e,t,r){return(t.slice(-4)===".bin"?cae:f8)(e,r)}function pue(e,t,r){return(t.slice(-4)===".bin"?Jse:C8)(e)}function mue(e){return(e.slice(-4)===".bin"?Ose:N8)()}var K8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,$8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ji(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(K8),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match($8),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function gue(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(K8),s,i,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match($8),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Lh;function xue(e,t){var r=Lh[e]||br(e);return r==="General"?$u(t):Hi(r,t)}function yue(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=en(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=an(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[br(t)]=s}function vue(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Dl[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d0(e.v):e.w=$u(e.v):e.w=xue(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Lh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&zA(n)){var s=Bu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function bue(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Iae[n.Pattern]||n.Pattern)}e[t.ID]=t}function wue(e,t,r,n,s,i,o,l,c,u){var d="General",h=n.StyleID,f={};u=u||{};var A=[],b=0;for(h===void 0&&l&&(h=l.StyleID),h===void 0&&o&&(h=o.StyleID);i[h]!==void 0&&(i[h].nf&&(d=i[h].nf),i[h].Interior&&A.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=en(e);break;case"String":n.t="s",n.r=YB(br(e)),n.v=e.indexOf("<")>-1?br(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(an(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=br(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RI[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=YB(t||e));break}if(vue(n,d,u),u.cellFormula!==!1)if(n.Formula){var m=br(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=yA(m,s),delete n.Formula,n.ArrayRange=="RC"?n.F=yA("RC:RC",s):n.ArrayRange&&(n.F=yA(n.ArrayRange,s),c.push([wr(n.F),n.F]))}else for(b=0;b<c.length;++b)s.r>=c[b][0].s.r&&s.r<=c[b][0].e.r&&s.c>=c[b][0].s.c&&s.c<=c[b][0].e.c&&(n.F=c[b][1]);u.cellStyles&&(A.forEach(function(v){!f.patternType&&v.patternType&&(f.patternType=v.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function _ue(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ov(e,t){var r=t||{};XA();var n=sh(F_(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Dr(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=sn(r);return o.type="string",TA.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ae){s.indexOf("<"+Ae)>=0&&(i=!0)}),i)return lde(n,r);Lh={"General Number":"General","General Date":$t[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$t[15],"Short Date":$t[14],"Long Time":$t[19],"Medium Time":$t[18],"Short Time":$t[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$t[2],Standard:$t[4],Percent:$t[10],Scientific:$t[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},h=[],f=r.dense?[]:{},A="",b={},m={},v=Ji('<Data ss:Type="String">'),p=0,g=0,y=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},N={},_="",C=0,j=[],E={},S={},F=0,I=[],O=[],M={},P=[],X,J=!1,H=[],V=[],K={},B=0,L=0,U={Sheets:[],WBProps:{date1904:!1}},D={};h0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";l=h0.exec(n);)switch(l[3]=(Q=l[3]).toLowerCase()){case"data":if(Q=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?wue(n.slice(p,l.index),_,v,c[c.length-1][0]=="comment"?M:b,{c:g,r:y},w,P[g],m,H,r):(_="",v=Ji(l[0]),p=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(O.length>0&&(b.c=O),(!r.sheetRows||r.sheetRows>y)&&b.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][g]=b):f[pn(g)+Mn(y)]=b),b.HRef&&(b.l={Target:br(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(B=g+(parseInt(b.MergeAcross,10)|0),L=y+(parseInt(b.MergeDown,10)|0),j.push({s:{c:g,r:y},e:{c:B,r:L}})),!r.sheetStubs)b.MergeAcross?g=B+1:++g;else if(b.MergeAcross||b.MergeDown){for(var z=g;z<=B;++z)for(var G=y;G<=L;++G)(z>g||G>y)&&(r.dense?(f[G]||(f[G]=[]),f[G][z]={t:"z"}):f[pn(z)+Mn(G)]={t:"z"});g=B+1}else++g;else b=gue(l[0]),b.Index&&(g=+b.Index-1),g<x.s.c&&(x.s.c=g),g>x.e.c&&(x.e.c=g),l[0].slice(-2)==="/>"&&++g,O=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<x.s.r&&(x.s.r=y),y>x.e.r&&(x.e.r=y),l[0].slice(-2)==="/>"&&(m=Ji(l[0]),m.Index&&(y=+m.Index-1)),g=0,++y):(m=Ji(l[0]),m.Index&&(y=+m.Index-1),K={},(m.AutoFitHeight=="0"||m.Height)&&(K.hpx=parseInt(m.Height,10),K.hpt=y0(K.hpx),V[y]=K),m.Hidden=="1"&&(K.hidden=!0,V[y]=K));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));h.push(A),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(f["!ref"]=ar(x),r.sheetRows&&r.sheetRows<=x.e.r&&(f["!fullref"]=f["!ref"],x.e.r=r.sheetRows-1,f["!ref"]=ar(x))),j.length&&(f["!merges"]=j),P.length>0&&(f["!cols"]=P),V.length>0&&(f["!rows"]=V),d[A]=f}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=g=0,c.push([l[3],!1]),u=Ji(l[0]),A=br(u.Name),f=r.dense?[]:{},j=[],H=[],V=[],D={name:A,Hidden:0},U.Sheets.push(D);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),P=[],J=!1}break;case"style":l[1]==="/"?bue(w,N,r):N=Ji(l[0]);break;case"numberformat":N.nf=br(Ji(l[0]).Format||"General"),Lh[N.nf]&&(N.nf=Lh[N.nf]);for(var Z=0;Z!=392&&$t[Z]!=N.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if($t[Z]==null){Nl(N.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(X=Ji(l[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!J&&X.wpx>10){J=!0,rs=y8;for(var R=0;R<P.length;++R)P[R]&&Pc(P[R])}J&&Pc(X),P[X.Index-1||P.length]=X;for(var le=0;le<+X.Span;++le)P[P.length]=sn(X);break;case"namedrange":if(l[1]==="/")break;U.Names||(U.Names=[]);var ee=Wt(l[0]),_e={Name:ee.Name,Ref:yA(ee.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(_e.Sheet=U.Sheets.length-1),U.Names.push(_e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=n.slice(C,l.index):C=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Ji(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?Gte(E,Q,n.slice(F,l.index)):F=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));_ue(M),O.push(M)}else c.push([l[3],!1]),u=Ji(l[0]),M={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var se=Ji(l[0]);f["!autofilter"]={ref:yA(se.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Rk(n,r);var te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(F,l.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else F=l.index+l[0].length;break;case"header":f["!margins"]||Uu(f["!margins"]={},"xlml"),isNaN(+Wt(l[0]).Margin)||(f["!margins"].header=+Wt(l[0]).Margin);break;case"footer":f["!margins"]||Uu(f["!margins"]={},"xlml"),isNaN(+Wt(l[0]).Margin)||(f["!margins"].footer=+Wt(l[0]).Margin);break;case"pagemargins":var Ne=Wt(l[0]);f["!margins"]||Uu(f["!margins"]={},"xlml"),isNaN(+Ne.Top)||(f["!margins"].top=+Ne.Top),isNaN(+Ne.Left)||(f["!margins"].left=+Ne.Left),isNaN(+Ne.Right)||(f["!margins"].right=+Ne.Right),isNaN(+Ne.Bottom)||(f["!margins"].bottom=+Ne.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:te=!1}break;case"smarttags":break;default:te=!1;break}if(te||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?yue(S,Q,I,n.slice(F,l.index)):(I=l,F=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Se={};return!r.bookSheets&&!r.bookProps&&(Se.Sheets=d),Se.SheetNames=h,Se.Workbook=U,Se.SSF=sn($t),Se.Props=E,Se.Custprops=S,Se}function Yw(e,t){switch(t5(t=t||{}),t.type||"base64"){case"base64":return Ov(fi(e),t);case"binary":case"buffer":case"file":return Ov(e,t);case"array":return Ov($c(e),t)}}function Nue(e,t){var r=[];return e.Props&&r.push(Wte(e.Props,t)),e.Custprops&&r.push(zte(e.Props,e.Custprops)),r.join("")}function jue(){return""}function Cue(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(wt("NumberFormat",null,{"ss:Format":Or($t[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(wt("Style",i.join(""),o))}),wt("Styles",r.join(""))}function V8(e){return wt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+z_(e.Ref,{r:0,c:0})})}function Bue(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(V8(s)))}return wt("Names",r.join(""))}function kue(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(V8(l)))}return i.join("")}function Sue(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(wt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(wt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(wt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(wt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ua("ProtectContents","True")),e["!protect"].objects&&s.push(Ua("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ua("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ua("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ua("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":wt("WorksheetOptions",s.join(""),{xmlns:ei.x})}function Eue(e){return e.map(function(t){var r=Yee(t.t||""),n=wt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return wt("Comment",n,{"ss:Author":t.a})}).join("")}function Fue(e,t,r,n,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Or(z_(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=mn(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Or(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Or(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Dl[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||$t[14]);break;case"s":h="String",f=Xee(e.v||"");break}var A=Gc(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+A),l["ss:Index"]=o.c+1;var b=e.v!=null?f:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+b+"</Data>";return(e.c||[]).length>0&&(m+=Eue(e.c)),wt("Cell",m,l)}function Tue(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=IA(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Iue(e,t,r,n){if(!e["!ref"])return"";var s=wr(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(v,p){Pc(v);var g=!!v.width,y=u1(p,v),x={"ss:Index":p+1};g&&(x["ss:Width"]=g0(y.width)),v.hidden&&(x["ss:Hidden"]="1"),l.push(wt("Column",null,x))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[Tue(u,(e["!rows"]||[])[u])],h=s.s.c;h<=s.e.c;++h){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>h)&&!(i[o].s.r>u)&&!(i[o].e.c<h)&&!(i[o].e.r<u)){(i[o].s.c!=h||i[o].s.r!=u)&&(f=!0);break}if(!f){var A={r:u,c:h},b=Gt(A),m=c?(e[u]||[])[h]:e[b];d.push(Fue(m,b,e,t,r,n,A))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Lue(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?kue(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?Iue(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Sue(i,t,e,r)),n.join("")}function Oue(e,t){t||(t={}),e.SSF||(e.SSF=sn($t)),e.SSF&&(XA(),n1(e.SSF),t.revssf=s1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Gc(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Nue(e,t)),r.push(jue()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(wt("Worksheet",Lue(n,t,e),{"ss:Name":Or(e.SheetNames[n])}));return r[2]=Cue(e,t),r[3]=Bue(e),Hn+wt("Workbook",r.join(""),{xmlns:ei.ss,"xmlns:o":ei.o,"xmlns:x":ei.x,"xmlns:ss":ei.ss,"xmlns:dt":ei.dt,"xmlns:html":ei.html})}function Uue(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Bte(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=kte(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Pue=[60,1084,2066,2165,2175];function Due(e,t,r,n,s){var i=n,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=vl(r,r.l),u=Jw[c],d=0;u!=null&&Pue.indexOf(c)>-1;)i=vl(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+i),o.push(l),r.l+=4+i,u=Jw[c=vl(r,r.l)];var h=ba(o);Oa(h,0);var f=0;h.lens=[];for(var A=0;A<o.length;++A)h.lens.push(f),f+=o[A].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function Fo(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=$t[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Dl[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d0(e.v):e.w=$u(e.v):e.w=Hi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&zA($t[n]||String(n))){var s=Bu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Lm(e,t,r){return{v:e,ixfe:t,t:r}}function Rue(e,t){var r={opts:{}},n={},s=t.dense?[]:{},i={},o={},l=null,c=[],u="",d={},h,f="",A,b,m,v,p={},g=[],y,x,w=[],N=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},j=function(Xe){return Xe<8?Iu[Xe]:Xe<64&&N[Xe-8]||Iu[Xe]},E=function(Xe,tt,st){var ke=tt.XF.data;if(!(!ke||!ke.patternType||!st||!st.cellStyles)){tt.s={},tt.s.patternType=ke.patternType;var Ee;(Ee=m0(j(ke.icvFore)))&&(tt.s.fgColor={rgb:Ee}),(Ee=m0(j(ke.icvBack)))&&(tt.s.bgColor={rgb:Ee})}},S=function(Xe,tt,st){if(!(K>1)&&!(st.sheetRows&&Xe.r>=st.sheetRows)){if(st.cellStyles&&tt.XF&&tt.XF.data&&E(Xe,tt,st),delete tt.ixfe,delete tt.XF,h=Xe,f=Gt(Xe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<o.s.r&&(o.s.r=Xe.r),Xe.c<o.s.c&&(o.s.c=Xe.c),Xe.r+1>o.e.r&&(o.e.r=Xe.r+1),Xe.c+1>o.e.c&&(o.e.c=Xe.c+1),st.cellFormula&&tt.f){for(var ke=0;ke<g.length;++ke)if(!(g[ke][0].s.c>Xe.c||g[ke][0].s.r>Xe.r)&&!(g[ke][0].e.c<Xe.c||g[ke][0].e.r<Xe.r)){tt.F=ar(g[ke][0]),(g[ke][0].s.c!=Xe.c||g[ke][0].s.r!=Xe.r)&&delete tt.f,tt.f&&(tt.f=""+es(g[ke][1],o,Xe,H,F));break}}st.dense?(s[Xe.r]||(s[Xe.r]=[]),s[Xe.r][Xe.c]=tt):s[f]=tt}},F={enc:!1,sbcch:0,snames:[],sharedf:p,arrayf:g,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var I,O=[],M=[],P=[],X=[],J=!1,H=[];H.SheetNames=F.snames,H.sharedf=F.sharedf,H.arrayf=F.arrayf,H.names=[],H.XTI=[];var V=0,K=0,B=0,L=[],U=[],D;F.codepage=1200,lo(1200);for(var Q=!1;e.l<e.length-1;){var z=e.l,G=e.read_shift(2);if(G===0&&V===10)break;var Z=e.l===e.length?0:e.read_shift(2),R=Jw[G];if(R&&R.f){if(t.bookSheets&&V===133&&G!==133)break;if(V=G,R.r===2||R.r==12){var le=e.read_shift(2);if(Z-=2,!F.enc&&le!==G&&((le&255)<<8|le>>8)!==G)throw new Error("rt mismatch: "+le+"!="+G);R.r==12&&(e.l+=10,Z-=10)}var ee={};if(G===10?ee=R.f(e,Z,F):ee=Due(G,R,e,Z,F),K==0&&[9,521,1033,2057].indexOf(V)===-1)continue;switch(G){case 34:r.opts.Date1904=_.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=ee,!t.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=ee;break;case 66:var _e=Number(ee);switch(_e){case 21010:_e=1200;break;case 32768:_e=1e4;break;case 32769:_e=1252;break}lo(F.codepage=_e),Q=!0;break;case 317:F.rrtabid=ee;break;case 25:F.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:F.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(s["!type"]="dialog"),ee.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ee.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:w.push(ee);break;case 430:H.push([ee]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(ee);break;case 24:case 536:D={Name:ee.Name,Ref:es(ee.rgce,o,null,H,F)},ee.itab>0&&(D.Sheet=ee.itab-1),H.names.push(D),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(U[ee.itab-1]={ref:ar(ee.rgce[0][0][1][2])});break;case 22:F.ExternCount=ee;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(ee),H.XTI=H.XTI.concat(ee);break;case 2196:if(F.biff<8)break;D!=null&&(D.Comment=ee[1]);break;case 18:s["!protect"]=ee;break;case 19:ee!==0&&F.WTF&&console.error("Password verifier: "+ee);break;case 133:i[ee.pos]=ee,F.snames.push(ee.name);break;case 10:{if(--K)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=ar(o),t.sheetRows&&t.sheetRows<=o.e.r){var se=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ar(o),o.e.r=se}o.e.r++,o.e.c++}O.length>0&&(s["!merges"]=O),M.length>0&&(s["!objects"]=M),P.length>0&&(s["!cols"]=P),X.length>0&&(s["!rows"]=X),_.Sheets.push(C)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[G]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),F.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(F.biff=5,Q=!0,lo(F.codepage=28591)),F.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(F.biff=2),K++)break;if(s=t.dense?[]:{},F.biff<8&&!Q&&(Q=!0,lo(F.codepage=t.codepage||1252)),F.biff<5||ee.BIFFVer==0&&ee.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-Z,name:u};i[te.pos]=te,F.snames.push(u)}else u=(i[z]||{name:""}).name;ee.dt==32&&(s["!type"]="chart"),ee.dt==64&&(s["!type"]="macro"),O=[],M=[],F.arrayf=g=[],P=[],X=[],J=!1,C={Hidden:(i[z]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[ee.r]||[])[ee.c]:s[Gt({c:ee.c,r:ee.r})])&&++ee.c,y={ixfe:ee.ixfe,XF:w[ee.ixfe]||{},v:ee.val,t:"n"},B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:ee.c,r:ee.r},y,t);break;case 5:case 517:y={ixfe:ee.ixfe,XF:w[ee.ixfe],v:ee.val,t:ee.t},B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:ee.c,r:ee.r},y,t);break;case 638:y={ixfe:ee.ixfe,XF:w[ee.ixfe],v:ee.rknum,t:"n"},B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:ee.c,r:ee.r},y,t);break;case 189:for(var Ne=ee.c;Ne<=ee.C;++Ne){var Se=ee.rkrec[Ne-ee.c][0];y={ixfe:Se,XF:w[Se],v:ee.rkrec[Ne-ee.c][1],t:"n"},B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:Ne,r:ee.r},y,t)}break;case 6:case 518:case 1030:{if(ee.val=="String"){l=ee;break}if(y=Lm(ee.val,ee.cell.ixfe,ee.tt),y.XF=w[y.ixfe],t.cellFormula){var Ae=ee.formula;if(Ae&&Ae[0]&&Ae[0][0]&&Ae[0][0][0]=="PtgExp"){var ye=Ae[0][0][1][0],Le=Ae[0][0][1][1],Re=Gt({r:ye,c:Le});p[Re]?y.f=""+es(ee.formula,o,ee.cell,H,F):y.F=((t.dense?(s[ye]||[])[Le]:s[Re])||{}).F}else y.f=""+es(ee.formula,o,ee.cell,H,F)}B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S(ee.cell,y,t),l=ee}break;case 7:case 519:if(l)l.val=ee,y=Lm(ee,l.cell.ixfe,"s"),y.XF=w[y.ixfe],t.cellFormula&&(y.f=""+es(l.formula,o,l.cell,H,F)),B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{g.push(ee);var we=Gt(ee[0].s);if(A=t.dense?(s[ee[0].s.r]||[])[ee[0].s.c]:s[we],t.cellFormula&&A){if(!l||!we||!A)break;A.f=""+es(ee[1],o,ee[0],H,F),A.F=ar(ee[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!l)break;p[Gt(l.cell)]=ee[0],A=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Gt(l.cell)],(A||{}).f=""+es(ee[0],o,h,H,F)}}break;case 253:y=Lm(c[ee.isst].t,ee.ixfe,"s"),c[ee.isst].h&&(y.h=c[ee.isst].h),y.XF=w[y.ixfe],B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:ee.c,r:ee.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:ee.ixfe,XF:w[ee.ixfe],t:"z"},B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:ee.c,r:ee.r},y,t));break;case 190:if(t.sheetStubs)for(var Pe=ee.c;Pe<=ee.C;++Pe){var ze=ee.ixfe[Pe-ee.c];y={ixfe:ze,XF:w[ze],t:"z"},B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:Pe,r:ee.r},y,t)}break;case 214:case 516:case 4:y=Lm(ee.val,ee.ixfe,"s"),y.XF=w[y.ixfe],B>0&&(y.z=L[y.ixfe>>8&63]),Fo(y,t,r.opts.Date1904),S({c:ee.c,r:ee.r},y,t);break;case 0:case 512:K===1&&(o=ee);break;case 252:c=ee;break;case 1054:if(F.biff==4){L[B++]=ee[1];for(var Ve=0;Ve<B+163&&$t[Ve]!=ee[1];++Ve);Ve>=163&&Nl(ee[1],B+163)}else Nl(ee[1],ee[0]);break;case 30:{L[B++]=ee;for(var lt=0;lt<B+163&&$t[lt]!=ee;++lt);lt>=163&&Nl(ee,B+163)}break;case 229:O=O.concat(ee);break;case 93:M[ee.cmo[0]]=F.lastobj=ee;break;case 438:F.lastobj.TxO=ee;break;case 127:F.lastobj.ImData=ee;break;case 440:for(v=ee[0].s.r;v<=ee[0].e.r;++v)for(m=ee[0].s.c;m<=ee[0].e.c;++m)A=t.dense?(s[v]||[])[m]:s[Gt({c:m,r:v})],A&&(A.l=ee[1]);break;case 2048:for(v=ee[0].s.r;v<=ee[0].e.r;++v)for(m=ee[0].s.c;m<=ee[0].e.c;++m)A=t.dense?(s[v]||[])[m]:s[Gt({c:m,r:v})],A&&A.l&&(A.l.Tooltip=ee[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;A=t.dense?(s[ee[0].r]||[])[ee[0].c]:s[Gt(ee[0])];var pe=M[ee[2]];A||(t.dense?(s[ee[0].r]||(s[ee[0].r]=[]),A=s[ee[0].r][ee[0].c]={t:"z"}):A=s[Gt(ee[0])]={t:"z"},o.e.r=Math.max(o.e.r,ee[0].r),o.s.r=Math.min(o.s.r,ee[0].r),o.e.c=Math.max(o.e.c,ee[0].c),o.s.c=Math.min(o.s.c,ee[0].c)),A.c||(A.c=[]),b={a:ee[1],t:pe.TxO.t},A.c.push(b)}break;case 2173:Cse(w[ee.ixfe],ee.ext);break;case 125:{if(!F.cellStyles)break;for(;ee.e>=ee.s;)P[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},J||(J=!0,V_(ee.w/256)),Pc(P[ee.e+1])}break;case 520:{var Fe={};ee.level!=null&&(X[ee.r]=Fe,Fe.level=ee.level),ee.hidden&&(X[ee.r]=Fe,Fe.hidden=!0),ee.hpt&&(X[ee.r]=Fe,Fe.hpt=ee.hpt,Fe.hpx=IA(ee.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Uu(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[G]]=ee;break;case 161:s["!margins"]||Uu(s["!margins"]={}),s["!margins"].header=ee.header,s["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(_.Views[0].RTL=!0);break;case 146:N=ee;break;case 2198:I=ee;break;case 140:x=ee;break;case 442:u?C.CodeName=ee||C.name:_.WBProps.CodeName=ee||"ThisWorkbook";break}}else R||console.error("Missing Info for XLS Record 0x"+G.toString(16)),e.l+=Z}return r.SheetNames=Bn(i).sort(function(Ke,Xe){return Number(Ke)-Number(Xe)}).map(function(Ke){return i[Ke].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&U.forEach(function(Ke,Xe){r.Sheets[r.SheetNames[Xe]]["!autofilter"]=Ke}),r.Strings=c,r.SSF=sn($t),F.enc&&(r.Encryption=F.enc),I&&(r.Themes=I),r.Metadata={},x!==void 0&&(r.Metadata.Country=x),H.names.length>0&&(_.Names=H.names),r.Workbook=_,r}var Oh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Que(e,t,r){var n=Ht.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=pk(n,$w,Oh.DSI);for(var i in s)t[i]=s[i]}catch(u){if(r.WTF)throw u}var o=Ht.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=pk(o,Vw,Oh.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&($I(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Mue(e,t){var r=[],n=[],s=[],i=0,o,l=$B($w,"n"),c=$B(Vw,"n");if(e.Props)for(o=Bn(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Bn(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],e.Custprops[o[i]]]);var u=[];for(i=0;i<s.length;++i)JI.indexOf(s[i][0])>-1||KI.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);n.length&&Ht.utils.cfb_add(t,"/SummaryInformation",mk(n,Oh.SI,c,Vw)),(r.length||u.length)&&Ht.utils.cfb_add(t,"/DocumentSummaryInformation",mk(r,Oh.DSI,l,$w,u.length?u:null,Oh.UDI))}function G8(e,t){t||(t={}),t5(t),w_(),t.codepage&&b_(t.codepage);var r,n;if(e.FullPaths){if(Ht.find(e,"/encryption"))throw new Error("File is password-protected");r=Ht.find(e,"!CompObj"),n=Ht.find(e,"/Workbook")||Ht.find(e,"/Book")}else{switch(t.type){case"base64":e=ai(fi(e));break;case"binary":e=ai(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Oa(e,0),n={content:e}}var s,i;if(r&&Uue(r),t.bookProps&&!t.bookSheets)s={};else{var o=ur?"buffer":"array";if(n&&n.content)s=Rue(n.content,t);else if((i=Ht.find(e,"PerfectOffice_MAIN"))&&i.content)s=Ou.to_workbook(i.content,(t.type=o,t));else if((i=Ht.find(e,"NativeContent_MAIN"))&&i.content)s=Ou.to_workbook(i.content,(t.type=o,t));else throw(i=Ht.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ht.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=eie(e))}var l={};return e.FullPaths&&Que(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function Hue(e,t){var r=t||{},n=Ht.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ht.utils.cfb_add(n,s,W8(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Mue(e,n),r.biff==8&&e.vbaraw&&tie(n,Ht.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var v0={0:{f:Ale},1:{f:vle},2:{f:Rle},3:{f:kle},4:{f:Nle},5:{f:Ule},6:{f:Kle},7:{f:Tle},8:{f:Yle},9:{f:Xle},10:{f:Wle},11:{f:zle},12:{f:wle},13:{f:Mle},14:{f:Ele},15:{f:Cle},16:{f:R8},17:{f:Vle},18:{f:Lle},19:{f:U_},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Vce},40:{},42:{},43:{f:Kae},44:{f:Hae},45:{f:Gae},46:{f:zae},47:{f:Wae},48:{},49:{f:pte},50:{},51:{f:Sse},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:c8},62:{f:qle},63:{f:Dse},64:{f:fce},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:os,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cce},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xle},148:{f:ple,p:16},151:{f:nce},152:{},153:{f:qce},154:{},155:{},156:{f:Mce},157:{},158:{},159:{T:1,f:sae},160:{T:-1},161:{T:1,f:id},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Jle},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bse},336:{T:-1},337:{f:Tse,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:l8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ace},427:{f:sce},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oce},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gle},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tce},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zse},633:{T:1},634:{T:-1},635:{T:1,f:Gse},636:{T:-1},637:{f:yte},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Ece},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hce},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Jw={6:{f:Iv},10:{f:ac},12:{f:zn},13:{f:zn},14:{f:On},15:{f:On},16:{f:ns},17:{f:On},18:{f:On},19:{f:zn},20:{f:wk},21:{f:wk},23:{f:l8},24:{f:Nk},25:{f:On},26:{},27:{},28:{f:hne},29:{},34:{f:On},35:{f:_k},38:{f:ns},39:{f:ns},40:{f:ns},41:{f:ns},42:{f:On},43:{f:On},47:{f:Cae},49:{f:Mre},51:{f:zn},60:{},61:{f:Ure},64:{f:On},65:{f:Qre},66:{f:zn},77:{},80:{},81:{},82:{},85:{f:zn},89:{},90:{},91:{},92:{f:jre},93:{f:gne},94:{},95:{f:On},96:{},97:{},99:{f:On},125:{f:c8},128:{f:rne},129:{f:Bre},130:{f:zn},131:{f:On},132:{f:On},133:{f:kre},134:{},140:{f:jne},141:{f:zn},144:{},146:{f:kne},151:{},152:{},153:{},154:{},155:{},156:{f:zn},157:{},158:{},160:{f:One},161:{f:Fne},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Jre},190:{f:Zre},193:{f:ac},197:{},198:{},199:{},200:{},201:{},202:{f:On},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:zn},220:{},221:{f:On},222:{},224:{f:tne},225:{f:Nre},226:{f:ac},227:{},229:{f:pne},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Ere},253:{f:qre},255:{f:Tre},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ZI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:On},353:{f:ac},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:one},431:{f:On},432:{},433:{},434:{},437:{},438:{f:vne},439:{f:On},440:{f:bne},441:{},442:{f:U0},443:{},444:{f:zn},445:{},446:{},448:{f:ac},449:{f:Ore,r:2},450:{f:ac},512:{f:yk},513:{f:Lne},515:{f:sne},516:{f:$re},517:{f:bk},519:{f:Une},520:{f:Ire},523:{},545:{f:jk},549:{f:xk},566:{},574:{f:Dre},638:{f:Yre},659:{},1048:{},1054:{f:Gre},1084:{},1212:{f:dne},2048:{f:_ne},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Fm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ac},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Sne,r:12},2173:{f:jse,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:On,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:une,r:12},2197:{},2198:{f:yse,r:12},2199:{},2200:{},2201:{},2202:{f:Ane,r:12},2203:{f:ac},2204:{},2205:{},2206:{},2207:{},2211:{f:Lre},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:zn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Tne},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Bne},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:yk},1:{},2:{f:Mne},3:{f:Rne},4:{f:Dne},5:{f:bk},7:{f:qne},8:{},9:{f:Fm},11:{},22:{f:zn},30:{f:zre},31:{},32:{},33:{f:jk},36:{},37:{f:xk},50:{f:Kne},62:{},52:{},67:{},68:{f:zn},69:{},86:{},126:{},127:{f:Pne},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:$ne},223:{},234:{},354:{},421:{},518:{f:Iv},521:{f:Fm},536:{f:Nk},547:{f:_k},561:{},579:{},1030:{f:Iv},1033:{f:Fm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _t(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&I_(r)&&e.push(r)}}function que(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return _t(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Q0(e,t,r){return e||(e=nt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Kue(e,t,r,n){var s=nt(9);return Q0(s,e,t),e8(r,n||"b",s),s}function $ue(e,t,r){var n=nt(8+2*r.length);return Q0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Vue(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?pa(an(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?_t(e,2,Hne(r,n,s)):_t(e,3,Qne(r,n,s));return;case"b":case"e":_t(e,5,Kue(r,n,t.v,t.t));return;case"s":case"str":_t(e,4,$ue(r,n,(t.v||"").slice(0,255)));return}_t(e,1,Q0(null,r,n))}function Gue(e,t,r,n){var s=Array.isArray(t),i=wr(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=ar(i)}for(var u=i.s.r;u<=i.e.r;++u){l=Mn(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=pn(d)),o=c[d]+l;var h=s?(t[u]||[])[d]:t[o];h&&Vue(e,h,u,d)}}}function Wue(e,t){for(var r=t||{},n=Ds(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _t(n,r.biff==4?1033:r.biff==3?521:9,q_(e,16,r)),Gue(n,e.Sheets[e.SheetNames[s]],s,r),_t(n,10),n.end()}function zue(e,t,r){_t(e,49,Hre({sz:12,name:"Arial"},r))}function Xue(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&_t(e,1054,Wre(s,t[s],r))})}function Yue(e,t){var r=nt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_t(e,2151,r),r=nt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),s8(wr(t["!ref"]||"A1"),r),r.write_shift(4,4),_t(e,2152,r)}function Jue(e,t){for(var r=0;r<16;++r)_t(e,224,vk({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){_t(e,224,vk(n,0,t))})}function Zue(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];_t(e,440,wne(n)),n[1].Tooltip&&_t(e,2048,Nne(n))}delete t["!links"]}function ede(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&_t(e,125,Ene(u1(s,n),s))})}}function tde(e,t,r,n,s){var i=16+Gc(s.cellXfs,t,s);if(t.v==null&&!t.bf){_t(e,513,zu(r,n,i));return}if(t.bf)_t(e,6,Boe(t,r,n,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?pa(an(t.v)):t.v;_t(e,515,ine(r,n,o,i));break;case"b":case"e":_t(e,517,ane(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=Y_(s.Strings,t.v,s.revStrings);_t(e,253,Kre(r,n,l,i))}else _t(e,516,Vre(r,n,(t.v||"").slice(0,255),i,s));break;default:_t(e,513,zu(r,n,i))}}function rde(e,t,r){var n=Ds(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,h="",f=[],A=wr(i["!ref"]||"A1"),b=u?65536:16384;if(A.e.c>255||A.e.r>=b){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");A.e.c=Math.min(A.e.c,255),A.e.r=Math.min(A.e.c,b-1)}_t(n,2057,q_(r,16,t)),_t(n,13,Bi(1)),_t(n,12,Bi(100)),_t(n,15,xs(!0)),_t(n,17,xs(!1)),_t(n,16,Gu(.001)),_t(n,95,xs(!0)),_t(n,42,xs(!1)),_t(n,43,xs(!1)),_t(n,130,Bi(1)),_t(n,128,nne()),_t(n,131,xs(!1)),_t(n,132,xs(!1)),u&&ede(n,i["!cols"]),_t(n,512,Xre(A,t)),u&&(i["!links"]=[]);for(var m=A.s.r;m<=A.e.r;++m){h=Mn(m);for(var v=A.s.c;v<=A.e.c;++v){m===A.s.r&&(f[v]=pn(v)),d=f[v]+h;var p=c?(i[m]||[])[v]:i[d];p&&(tde(n,p,m,v,t),u&&p.l&&i["!links"].push([d,p.l]))}}var g=l.CodeName||l.name||s;return u&&_t(n,574,Rre((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&_t(n,229,mne(i["!merges"])),u&&Zue(n,i),_t(n,442,t8(g)),u&&Yue(n,i),_t(n,10),n.end()}function nde(e,t,r){var n=Ds(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(_t(n,2057,q_(e,5,r)),r.bookType=="xla"&&_t(n,135),_t(n,225,l?Bi(1200):null),_t(n,193,are(2)),c&&_t(n,191),c&&_t(n,192),_t(n,226),_t(n,92,Cre("SheetJS",r)),_t(n,66,Bi(l?1200:1252)),l&&_t(n,353,Bi(0)),l&&_t(n,448),_t(n,317,Ine(e.SheetNames.length)),l&&e.vbaraw&&_t(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";_t(n,442,t8(u))}_t(n,156,Bi(17)),_t(n,25,xs(!1)),_t(n,18,xs(!1)),_t(n,19,Bi(0)),l&&_t(n,431,xs(!1)),l&&_t(n,444,Bi(0)),_t(n,61,Pre()),_t(n,64,xs(!1)),_t(n,141,Bi(0)),_t(n,34,xs(Oce(e)=="true")),_t(n,14,xs(!0)),l&&_t(n,439,xs(!1)),_t(n,218,Bi(0)),zue(n,e,r),Xue(n,e.SSF,r),Jue(n,r),l&&_t(n,352,xs(!1));var d=n.end(),h=Ds();l&&_t(h,140,Cne()),l&&r.Strings&&que(h,252,Fre(r.Strings)),_t(h,10);var f=h.end(),A=Ds(),b=0,m=0;for(m=0;m<e.SheetNames.length;++m)b+=(l?12:11)+(l?2:1)*e.SheetNames[m].length;var v=d.length+b+f.length;for(m=0;m<e.SheetNames.length;++m){var p=i[m]||{};_t(A,133,Sre({pos:v,hs:p.Hidden||0,dt:0,name:e.SheetNames[m]},r)),v+=t[m].length}var g=A.end();if(b!=g.length)throw new Error("BS8 "+b+" != "+g.length);var y=[];return d.length&&y.push(d),g.length&&y.push(g),f.length&&y.push(f),ba(y)}function ade(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=sn($t)),e&&e.SSF&&(XA(),n1(e.SSF),r.revssf=s1(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,r5(r),r.cellXfs=[],Gc(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=rde(s,r,e);return n.unshift(nde(e,n,r)),ba(n)}function W8(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Qs(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return ade(e,t);case 4:case 3:case 2:return Wue(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Ok(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=Hee(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,f=0,A={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(o=0;o<c.length;++o){var m=c[o].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var p=m.split(/<\/t[dh]>/i);for(l=0;l<p.length;++l){var g=p[l].trim();if(g.match(/<t[dh]/i)){for(var y=g,x=0;y.charAt(0)=="<"&&(x=y.indexOf(">"))>-1;)y=y.slice(x+1);for(var w=0;w<b.length;++w){var N=b[w];N.s.c==d&&N.s.r<u&&u<=N.e.r&&(d=N.e.c+1,w=-1)}var _=Wt(g.slice(0,g.indexOf(">")));f=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||f>1)&&b.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+f-1}});var C=_.t||_["data-t"]||"";if(!y.length){d+=f;continue}if(y=xI(y),A.s.r>u&&(A.s.r=u),A.e.r<u&&(A.e.r=u),A.s.c>d&&(A.s.c=d),A.e.c<d&&(A.e.c=d),!y.length){d+=f;continue}var j={t:"s",v:y};r.raw||!y.trim().length||C=="s"||(y==="TRUE"?j={t:"b",v:!0}:y==="FALSE"?j={t:"b",v:!1}:isNaN(ho(y))?isNaN(FA(y).getDate())||(j={t:"d",v:an(y)},r.cellDates||(j={t:"n",v:pa(j.v)}),j.z=r.dateNF||$t[14]):j={t:"n",v:ho(y)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=j):n[Gt({r:u,c:d})]=j,d+=f}}}}return n["!ref"]=ar(A),b.length&&(n["!merges"]=b),n}function sde(e,t,r,n){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>o)&&!(s[u].e.r<r||s[u].e.c<o)){if(s[u].s.r<r||s[u].s.c<o){l=-1;break}l=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(l<0)){var d=Gt({r,c:o}),h=n.dense?(e[r]||[])[o]:e[d],f=h&&h.v!=null&&(h.h||E_(h.w||(Il(h),h.w)||""))||"",A={};l>1&&(A.rowspan=l),c>1&&(A.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(A["data-t"]=h&&h.t||"z",h.v!=null&&(A["data-v"]=h.v),h.z!=null&&(A["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),A.id=(n.id||"sjs")+"-"+d,i.push(wt("td",f,A))}}var b="<tr>";return b+i.join("")+"</tr>"}var ide='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ode="</body></html>";function lde(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Vc(Ok(r[0],t),t);var n=s5();return r.forEach(function(s,i){i5(n,Ok(s,t),"Sheet"+(i+1))}),n}function cde(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function z8(e,t){var r=t||{},n=r.header!=null?r.header:ide,s=r.footer!=null?r.footer:ode,i=[n],o=Qs(e["!ref"]);r.dense=Array.isArray(e),i.push(cde(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(sde(e,o,l,r));return i.push("</table>"+s),i.join("")}function X8(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?mn(n.origin):n.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var d=Qs(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],f=0,A=e["!rows"]||(e["!rows"]=[]),b=0,m=0,v=0,p=0,g=0,y=0;for(e["!cols"]||(e["!cols"]=[]);b<l.length&&m<c;++b){var x=l[b];if(Uk(x)){if(n.display)continue;A[m]={hidden:!0}}var w=x.children;for(v=p=0;v<w.length;++v){var N=w[v];if(!(n.display&&Uk(N))){var _=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):xI(N.innerHTML),C=N.getAttribute("data-z")||N.getAttribute("z");for(f=0;f<h.length;++f){var j=h[f];j.s.c==p+i&&j.s.r<m+s&&m+s<=j.e.r&&(p=j.e.c+1-i,f=-1)}y=+N.getAttribute("colspan")||1,((g=+N.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:m+s,c:p+i},e:{r:m+s+(g||1)-1,c:p+i+(y||1)-1}});var E={t:"s",v:_},S=N.getAttribute("data-t")||N.getAttribute("t")||"";_!=null&&(_.length==0?E.t=S||"z":n.raw||_.trim().length==0||S=="s"||(_==="TRUE"?E={t:"b",v:!0}:_==="FALSE"?E={t:"b",v:!1}:isNaN(ho(_))?isNaN(FA(_).getDate())||(E={t:"d",v:an(_)},n.cellDates||(E={t:"n",v:pa(E.v)}),E.z=n.dateNF||$t[14]):E={t:"n",v:ho(_)})),E.z===void 0&&C!=null&&(E.z=C);var F="",I=N.getElementsByTagName("A");if(I&&I.length)for(var O=0;O<I.length&&!(I[O].hasAttribute("href")&&(F=I[O].getAttribute("href"),F.charAt(0)!="#"));++O);F&&F.charAt(0)!="#"&&(E.l={Target:F}),n.dense?(e[m+s]||(e[m+s]=[]),e[m+s][p+i]=E):e[Gt({c:p+i,r:m+s})]=E,u.e.c<p+i&&(u.e.c=p+i),p+=y}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=ar(u),m>=c&&(e["!fullref"]=ar((u.e.r=l.length-b+m-1+s,u))),e}function Y8(e,t){var r=t||{},n=r.dense?[]:{};return X8(n,e,t)}function ude(e,t){return Vc(Y8(e,t),t)}function Uk(e){var t="",r=dde(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function dde(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ade(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=br(t.replace(/<[^>]*>/g,""));return[r]}var Pk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function J8(e,t){var r=t||{},n=F_(e),s=[],i,o,l={name:""},c="",u=0,d,h,f={},A=[],b=r.dense?[]:{},m,v,p={value:""},g="",y=0,x=[],w=-1,N=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,j={},E=[],S={},F=0,I=0,O=[],M=1,P=1,X=[],J={Names:[]},H={},V=["",""],K=[],B={},L="",U=0,D=!1,Q=!1,z=0;for(h0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=h0.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?b["!ref"]=ar(_):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(b["!fullref"]=b["!ref"],_.e.r=r.sheetRows-1,b["!ref"]=ar(_)),E.length&&(b["!merges"]=E),O.length&&(b["!rows"]=O),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),A.push(d.name),f[d.name]=b,Q=!1):m[0].charAt(m[0].length-2)!=="/"&&(d=Wt(m[0],!1),w=N=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,b=r.dense?[]:{},E=[],O=[],Q=!0);break;case"table-row-group":m[1]==="/"?--C:++C;break;case"table-row":case"":if(m[1]==="/"){w+=M,M=1;break}if(h=Wt(m[0],!1),h.?w=h.-1:w==-1&&(w=0),M=+h["number-rows-repeated"]||1,M<10)for(z=0;z<M;++z)C>0&&(O[w+z]={level:C});N=-1;break;case"covered-table-cell":m[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(b[w]||(b[w]=[]),b[w][N]={t:"z"}):b[Gt({r:w,c:N})]={t:"z"}),g="",x=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++N,p=Wt(m[0],!1),P=parseInt(p["number-columns-repeated"]||"1",10),v={t:"z",v:null},p.formula&&r.cellFormula!=!1&&(v.f=Tk(br(p.formula))),(p.||p["value-type"])=="string"&&(v.t="s",v.v=br(p["string-value"]||""),r.dense?(b[w]||(b[w]=[]),b[w][N]=v):b[Gt({r:w,c:N})]=v),N+=P-1;else if(m[1]!=="/"){++N,g="",y=0,x=[],P=1;var G=M?w+M-1:w;if(N>_.e.c&&(_.e.c=N),N<_.s.c&&(_.s.c=N),w<_.s.r&&(_.s.r=w),G>_.e.r&&(_.e.r=G),p=Wt(m[0],!1),K=[],B={},v={t:p.||p["value-type"],v:null},r.cellFormula)if(p.formula&&(p.formula=br(p.formula)),p["number-matrix-columns-spanned"]&&p["number-matrix-rows-spanned"]&&(F=parseInt(p["number-matrix-rows-spanned"],10)||0,I=parseInt(p["number-matrix-columns-spanned"],10)||0,S={s:{r:w,c:N},e:{r:w+F-1,c:N+I-1}},v.F=ar(S),X.push([S,v.F])),p.formula)v.f=Tk(p.formula);else for(z=0;z<X.length;++z)w>=X[z][0].s.r&&w<=X[z][0].e.r&&N>=X[z][0].s.c&&N<=X[z][0].e.c&&(v.F=X[z][1]);switch((p["number-columns-spanned"]||p["number-rows-spanned"])&&(F=parseInt(p["number-rows-spanned"],10)||0,I=parseInt(p["number-columns-spanned"],10)||0,S={s:{r:w,c:N},e:{r:w+F-1,c:N+I-1}},E.push(S)),p["number-columns-repeated"]&&(P=parseInt(p["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=en(p["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(p.value);break;case"percentage":v.t="n",v.v=parseFloat(p.value);break;case"currency":v.t="n",v.v=parseFloat(p.value);break;case"date":v.t="d",v.v=an(p["date-value"]),r.cellDates||(v.t="n",v.v=pa(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=Ree(p["time-value"])/86400,r.cellDates&&(v.t="d",v.v=i1(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(p.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",p["string-value"]!=null&&(g=br(p["string-value"]),x=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(D=!1,v.t==="s"&&(v.v=g||"",x.length&&(v.R=x),D=y==0),H.Target&&(v.l=H),K.length>0&&(v.c=K,K=[]),g&&r.cellText!==!1&&(v.w=g),D&&(v.t="z",delete v.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var Z=0;Z<M;++Z){if(P=parseInt(p["number-columns-repeated"]||"1",10),r.dense)for(b[w+Z]||(b[w+Z]=[]),b[w+Z][N]=Z==0?v:sn(v);--P>0;)b[w+Z][N+P]=sn(v);else for(b[Gt({r:w+Z,c:N})]=v;--P>0;)b[Gt({r:w+Z,c:N+P})]=sn(v);_.e.c<=N&&(_.e.c=N)}P=parseInt(p["number-columns-repeated"]||"1",10),N+=P-1,P=0,v={},g="",x=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i;B.t=g,x.length&&(B.R=x),B.a=L,K.push(B)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);L="",U=0,g="",y=0,x=[];break;case"creator":m[1]==="/"?L=n.slice(U,m.index):U=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);g="",y=0,x=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(j[l.name]=c,(i=s.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(c="",l=Wt(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Wt(m[0],!1),c+=Pk[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Wt(m[0],!1),c+=Pk[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":o=Wt(m[0],!1),V=Lv(o["cell-range-address"]);var R={Name:o.name,Ref:V[0]+"!"+V[1]};Q&&(R.Sheet=A.length),J.Names.push(R);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!p||!p["string-value"])){var le=Ade(n.slice(y,m.index));g=(g.length>0?g+`
`:"")+le[0]}else Wt(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{V=Lv(Wt(m[0])["target-range-address"]),f[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(H=Wt(m[0],!1),!H.href)break;H.Target=br(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(V=Lv(H.Target.slice(1)),H.Target="#"+V[0]+"!"+V[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var ee={Sheets:f,SheetNames:A,Workbook:J};return r.bookSheets&&delete ee.Sheets,ee}function Dk(e,t){t=t||{},Ci(e,"META-INF/manifest.xml")&&Rte(Wn(e,"META-INF/manifest.xml"),t);var r=si(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=J8(Dr(r),t);return Ci(e,"meta.xml")&&(n.Props=HI(Wn(e,"meta.xml"))),n}function Rk(e,t){return J8(e,t)}var fde=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+f0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Hn+t}}(),Qk=function(){var e=function(i){return Or(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Or(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,h=Qs(i["!ref"]||"A1"),f=i["!merges"]||[],A=0,b=Array.isArray(i);if(i["!cols"])for(d=0;d<=h.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",v=i["!rows"]||[];for(u=0;u<h.s.r;++u)m=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=h.e.r;++u){for(m=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),d=0;d<h.s.c;++d)c.push(t);for(;d<=h.e.c;++d){var p=!1,g={},y="";for(A=0;A!=f.length;++A)if(!(f[A].s.c>d)&&!(f[A].s.r>u)&&!(f[A].e.c<d)&&!(f[A].e.r<u)){(f[A].s.c!=d||f[A].s.r!=u)&&(p=!0),g["table:number-columns-spanned"]=f[A].e.c-f[A].s.c+1,g["table:number-rows-spanned"]=f[A].e.r-f[A].s.r+1;break}if(p){c.push(r);continue}var x=Gt({r:u,c:d}),w=b?(i[u]||[])[d]:i[x];if(w&&w.f&&(g["table:formula"]=Or(Ioe(w.f)),w.F&&w.F.slice(0,x.length)==x)){var N=Qs(w.F);g["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,g["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!w){c.push(t);continue}switch(w.t){case"b":y=w.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=w.v?"true":"false";break;case"n":y=w.w||String(w.v||0),g["office:value-type"]="float",g["office:value"]=w.v||0;break;case"s":case"str":y=w.v==null?"":w.v,g["office:value-type"]="string";break;case"d":y=w.w||an(w.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=an(w.v).toISOString(),g["table:style-name"]="ce1";break;default:c.push(t);continue}var _=e(y);if(w.l&&w.l.Target){var C=w.l.Target;C=C.charAt(0)=="#"?"#"+Loe(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),_=wt("text:a",_,{"xlink:href":C.replace(/&/g,"&amp;")})}c.push("          "+wt("table:table-cell",wt("text:p",_,{}),g)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Pc(h),h.ods=l;var f=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var h=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Hn],u=f0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=f0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(MI().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)c.push(n(o.Sheets[o.SheetNames[h]],o,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Z8(e,t){if(t.bookType=="fods")return Qk(e,t);var r=B_(),n="",s=[],i=[];return n="mimetype",lr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",lr(r,n,Qk(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",lr(r,n,fde(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",lr(r,n,Hn+MI()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",lr(r,n,Hte(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",lr(r,n,Qte(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Dr($c(e))}function hde(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ai(Do(e))}function pde(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Rc(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Mk(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function mde(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function gde(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function b0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Tr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Cn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Nr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=b0(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=b0(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var u={data:l,type:i};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Ta(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Tr(n*8+s.type)),s.type==2&&t.push(Tr(s.data.length)),t.push(s.data))})}),Rc(t)}function e5(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function _i(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=b0(e,n),i=Nr(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Cn(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Nr(l.data),u=Cn(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(o.merge=Cn(i[3][0].data)>>>0>0),r.push(o)}return r}function Ld(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Tr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Tr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Tr(o.data.length)}],n[2].push({data:Ta(o.meta),type:2})});var i=Ta(n);t.push(Tr(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),Rc(t)}function xde(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=b0(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Rc(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Rc(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ni(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(xde(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Rc(t)}function Od(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Tr(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return Rc(t)}function yde(e,t,r,n){var s=Xu(e),i=s.getUint32(4,!0),o=(n>1?12:8)+Mk(i&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=Mk(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(u=s.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function vde(e,t,r){var n=Xu(e),s=n.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=mde(e,i),i+=16),s&2&&(u=n.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function Uv(e,t){var r=new Uint8Array(32),n=Xu(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,gde(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Pv(e,t){var r=new Uint8Array(32),n=Xu(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function bde(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return yde(e,t,r,e[0]);case 5:return vde(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ja(e){var t=Nr(e);return b0(t[1][0].data)}function Hk(e,t){var r=Nr(t.data),n=Cn(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=Nr(o.data),c=Cn(l[1][0].data)>>>0;switch(n){case 1:i[c]=Zw(l[3][0].data);break;case 8:{var u=e[Ja(l[9][0].data)][0],d=Nr(u.data),h=e[Ja(d[1][0].data)][0],f=Cn(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var A=Nr(h.data);i[c]=A[3].map(function(b){return Zw(b.data)}).join("")}break}}),i}function wde(e,t){var r,n,s,i,o,l,c,u,d,h,f,A,b,m,v=Nr(e),p=Cn(v[1][0].data)>>>0,g=Cn(v[2][0].data)>>>0,y=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&Cn(v[8][0].data)>0||!1,x,w;if((i=(s=v[7])==null?void 0:s[0])!=null&&i.data&&t!=0)x=(l=(o=v[7])==null?void 0:o[0])==null?void 0:l.data,w=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(d=v[4])==null?void 0:d[0])!=null&&h.data&&t!=1)x=(A=(f=v[4])==null?void 0:f[0])==null?void 0:A.data,w=(m=(b=v[3])==null?void 0:b[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=y?4:1,_=Xu(x),C=[],j=0;j<x.length/2;++j){var E=_.getUint16(j*2,!0);E<65535&&C.push([j,E])}if(C.length!=g)throw"Expected ".concat(g," cells, found ").concat(C.length);var S=[];for(j=0;j<C.length-1;++j)S[C[j][0]]=w.subarray(C[j][1]*N,C[j+1][1]*N);return C.length>=1&&(S[C[C.length-1][0]]=w.subarray(C[C.length-1][1]*N)),{R:p,cells:S}}function _de(e,t){var r,n=Nr(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Cn(n[7][0].data)>>>0>0?1:0:-1,i=e5(n[5],function(o){return wde(o,s)});return{nrows:Cn(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function Nde(e,t,r){var n,s=Nr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Cn(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Cn(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=ar(i);var o=Nr(s[4][0].data),l=Hk(e,e[Ja(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?Hk(e,e[Ja(o[17][0].data)][0]):[],u=Nr(o[3][0].data),d=0;u[1].forEach(function(h){var f=Nr(h.data),A=e[Ja(f[2][0].data)][0],b=Cn(A.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var m=_de(e,A);m.data.forEach(function(v,p){v.forEach(function(g,y){var x=Gt({r:d+p,c:y}),w=bde(g,l,c);w&&(r[x]=w)})}),d+=m.nrows})}function jde(e,t){var r=Nr(t.data),n={"!ref":"A1"},s=e[Ja(r[2][0].data)],i=Cn(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Nde(e,s[0],n),n}function Cde(e,t){var r,n=Nr(t.data),s={name:(r=n[1])!=null&&r[0]?Zw(n[1][0].data):"",sheets:[]},i=e5(n[2],Ja);return i.forEach(function(o){e[o].forEach(function(l){var c=Cn(l.meta[1][0].data);c==6e3&&s.sheets.push(jde(e,l))})}),s}function Bde(e,t){var r=s5(),n=Nr(t.data),s=e5(n[1],Ja);if(s.forEach(function(i){e[i].forEach(function(o){var l=Cn(o.meta[1][0].data);if(l==2){var c=Cde(e,o);c.sheets.forEach(function(u,d){i5(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Dv(e){var t,r,n,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Ni(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var d;try{d=_i(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){i[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Cn(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(u){var d=Cn(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Bde(i,l)}function kde(e,t,r){var n,s,i,o;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Cn(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=Xu(e[7][0].data),d=0,h=[],f=Xu(e[4][0].data),A=0,b=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}u.setUint16(m*2,d,!0),f.setUint16(m*2,A,!0);var v,p;switch(typeof t[m]){case"string":v=Uv({t:"s",v:t[m]},r),p=Pv({t:"s",v:t[m]},r);break;case"number":v=Uv({t:"n",v:t[m]},r),p=Pv({t:"n",v:t[m]},r);break;case"boolean":v=Uv({t:"b",v:t[m]},r),p=Pv({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}h.push(v),d+=v.length,b.push(p),A+=p.length,++c}for(e[2][0].data=Tr(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return e[6][0].data=Rc(h),e[3][0].data=Rc(b),c}function Sde(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Qs(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ar(n)));var i=gx(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(L){return L.forEach(function(U){typeof U=="string"&&o.push(U)})});var l={},c=[],u=Ht.read(t.numbers,{type:"base64"});u.FileIndex.map(function(L,U){return[L,u.FullPaths[U]]}).forEach(function(L){var U=L[0],D=L[1];if(U.type==2&&U.name.match(/\.iwa/)){var Q=U.content,z=Ni(Q),G=_i(z);G.forEach(function(Z){c.push(Z.id),l[Z.id]={deps:[],location:D,type:Cn(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(L,U){return L-U});var d=c.filter(function(L){return L>1}).map(function(L){return[L,Tr(L)]});u.FileIndex.map(function(L,U){return[L,u.FullPaths[U]]}).forEach(function(L){var U=L[0];if(L[1],!!U.name.match(/\.iwa/)){var D=_i(Ni(U.content));D.forEach(function(Q){Q.messages.forEach(function(z){d.forEach(function(G){Q.messages.some(function(Z){return Cn(Z.meta[1][0].data)!=11006&&pde(Z.data,G[1])})&&l[G[0]].deps.push(Q.id)})})})}});for(var h=Ht.find(u,l[1].location),f=_i(Ni(h.content)),A,b=0;b<f.length;++b){var m=f[b];m.id==1&&(A=m)}var v=Ja(Nr(A.messages[0].data)[1][0].data);for(h=Ht.find(u,l[v].location),f=_i(Ni(h.content)),b=0;b<f.length;++b)m=f[b],m.id==v&&(A=m);for(v=Ja(Nr(A.messages[0].data)[2][0].data),h=Ht.find(u,l[v].location),f=_i(Ni(h.content)),b=0;b<f.length;++b)m=f[b],m.id==v&&(A=m);for(v=Ja(Nr(A.messages[0].data)[2][0].data),h=Ht.find(u,l[v].location),f=_i(Ni(h.content)),b=0;b<f.length;++b)m=f[b],m.id==v&&(A=m);var p=Nr(A.messages[0].data);{p[6][0].data=Tr(n.e.r+1),p[7][0].data=Tr(n.e.c+1);var g=Ja(p[46][0].data),y=Ht.find(u,l[g].location),x=_i(Ni(y.content));{for(var w=0;w<x.length&&x[w].id!=g;++w);if(x[w].id!=g)throw"Bad ColumnRowUIDMapArchive";var N=Nr(x[w].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var _=0;_<=n.e.c;++_){var C=[];C[1]=C[2]=[{type:0,data:Tr(_+420690)}],N[1].push({type:2,data:Ta(C)}),N[2].push({type:0,data:Tr(_)}),N[3].push({type:0,data:Tr(_)})}N[4]=[],N[5]=[],N[6]=[];for(var j=0;j<=n.e.r;++j)C=[],C[1]=C[2]=[{type:0,data:Tr(j+726270)}],N[4].push({type:2,data:Ta(C)}),N[5].push({type:0,data:Tr(j)}),N[6].push({type:0,data:Tr(j)});x[w].messages[0].data=Ta(N)}y.content=Od(Ld(x)),y.size=y.content.length,delete p[46];var E=Nr(p[4][0].data);{E[7][0].data=Tr(n.e.r+1);var S=Nr(E[1][0].data),F=Ja(S[2][0].data);y=Ht.find(u,l[F].location),x=_i(Ni(y.content));{if(x[0].id!=F)throw"Bad HeaderStorageBucket";var I=Nr(x[0].messages[0].data);for(j=0;j<i.length;++j){var O=Nr(I[2][0].data);O[1][0].data=Tr(j),O[4][0].data=Tr(i[j].length),I[2][j]={type:I[2][0].type,data:Ta(O)}}x[0].messages[0].data=Ta(I)}y.content=Od(Ld(x)),y.size=y.content.length;var M=Ja(E[2][0].data);y=Ht.find(u,l[M].location),x=_i(Ni(y.content));{if(x[0].id!=M)throw"Bad HeaderStorageBucket";for(I=Nr(x[0].messages[0].data),_=0;_<=n.e.c;++_)O=Nr(I[2][0].data),O[1][0].data=Tr(_),O[4][0].data=Tr(n.e.r+1),I[2][_]={type:I[2][0].type,data:Ta(O)};x[0].messages[0].data=Ta(I)}y.content=Od(Ld(x)),y.size=y.content.length;var P=Ja(E[4][0].data);(function(){for(var L=Ht.find(u,l[P].location),U=_i(Ni(L.content)),D,Q=0;Q<U.length;++Q){var z=U[Q];z.id==P&&(D=z)}var G=Nr(D.messages[0].data);{G[3]=[];var Z=[];o.forEach(function(ee,_e){Z[1]=[{type:0,data:Tr(_e)}],Z[2]=[{type:0,data:Tr(1)}],Z[3]=[{type:2,data:hde(ee)}],G[3].push({type:2,data:Ta(Z)})})}D.messages[0].data=Ta(G);var R=Ld(U),le=Od(R);L.content=le,L.size=L.content.length})();var X=Nr(E[3][0].data);{var J=X[1][0];delete X[2];var H=Nr(J.data);{var V=Ja(H[2][0].data);(function(){for(var L=Ht.find(u,l[V].location),U=_i(Ni(L.content)),D,Q=0;Q<U.length;++Q){var z=U[Q];z.id==V&&(D=z)}var G=Nr(D.messages[0].data);{delete G[6],delete X[7];var Z=new Uint8Array(G[5][0].data);G[5]=[];for(var R=0,le=0;le<=n.e.r;++le){var ee=Nr(Z);R+=kde(ee,i[le],o),ee[1][0].data=Tr(le),G[5].push({data:Ta(ee),type:2})}G[1]=[{type:0,data:Tr(n.e.c+1)}],G[2]=[{type:0,data:Tr(n.e.r+1)}],G[3]=[{type:0,data:Tr(R)}],G[4]=[{type:0,data:Tr(n.e.r+1)}]}D.messages[0].data=Ta(G);var _e=Ld(U),se=Od(_e);L.content=se,L.size=L.content.length})()}J.data=Ta(H)}E[3][0].data=Ta(X)}p[4][0].data=Ta(E)}A.messages[0].data=Ta(p);var K=Ld(f),B=Od(K);return h.content=B,h.size=h.content.length,u}function eL(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function t5(e){eL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function r5(e){eL([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Ede(e){return dr.WS.indexOf(e)>-1?"sheet":e==dr.CS?"chart":e==dr.DS?"dialog":e==dr.MS?"macro":e&&e.length?e:"sheet"}function Fde(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Ede(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Tde(e,t,r,n,s,i,o,l,c,u,d,h){try{i[n]=Fh(si(e,r,!0),t);var f=Wn(e,t),A;switch(l){case"sheet":A=eue(f,t,s,c,i[n],u,d,h);break;case"chart":if(A=tue(f,t,s,c,i[n],u,d,h),!A||!A["!drawel"])break;var b=oh(A["!drawel"].Target,t),m=p0(b),v=Mse(si(e,b,!0),Fh(si(e,m,!0),b)),p=oh(v,b),g=p0(p);A=kce(si(e,p,!0),p,c,Fh(si(e,g,!0),p),u,A);break;case"macro":A=rue(f,t,s,c,i[n],u,d,h);break;case"dialog":A=nue(f,t,s,c,i[n],u,d,h);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=A;var y=[];i&&i[n]&&Bn(i[n]).forEach(function(x){var w="";if(i[n][x].Type==dr.CMNT){w=oh(i[n][x].Target,t);var N=oue(Wn(e,w,!0),w,c);if(!N||!N.length)return;Bk(A,N,!1)}i[n][x].Type==dr.TCMNT&&(w=oh(i[n][x].Target,t),y=y.concat(qse(Wn(e,w,!0),c)))}),y&&y.length&&Bk(A,y,!0,c.people||[])}catch(x){if(c.WTF)throw x}}function bi(e){return e.charAt(0)=="/"?e.slice(1):e}function Ide(e,t){if(XA(),t=t||{},t5(t),Ci(e,"META-INF/manifest.xml")||Ci(e,"objectdata.xml"))return Dk(e,t);if(Ci(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Dv<"u"){if(e.FileIndex)return Dv(e);var r=Ht.utils.cfb_new();return WB(e).forEach(function(O){lr(r,O,Kee(e,O))}),Dv(r)}throw new Error("Unsupported NUMBERS file")}if(!Ci(e,"[Content_Types].xml"))throw Ci(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ci(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=WB(e),s=Pte(si(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Wn(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Wn(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Th=[],s.sst)try{Th=iue(Wn(e,bi(s.sst)),s.sst,t)}catch(O){if(t.WTF)throw O}t.cellStyles&&s.themes.length&&(c=sue(si(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=aue(Wn(e,bi(s.style)),s.style,c,t))}s.links.map(function(O){try{var M=Fh(si(e,p0(bi(O))),O);return cue(Wn(e,bi(O)),M,O,t)}catch{}});var d=Zce(Wn(e,bi(s.workbooks[0])),s.workbooks[0],t),h={},f="";s.coreprops.length&&(f=Wn(e,bi(s.coreprops[0]),!0),f&&(h=HI(f)),s.extprops.length!==0&&(f=Wn(e,bi(s.extprops[0]),!0),f&&Kte(f,h,t)));var A={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(f=si(e,bi(s.custprops[0]),!0),f&&(A=Vte(f,t)));var b={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(M){return M.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),t.bookProps&&(b.Props=h,b.Custprops=A),t.bookSheets&&typeof o<"u"&&(b.SheetNames=o),t.bookSheets?b.SheetNames:t.bookProps))return b;o={};var m={};t.bookDeps&&s.calcchain&&(m=lue(Wn(e,bi(s.calcchain)),s.calcchain));var v=0,p={},g,y;{var x=d.Sheets;h.Worksheets=x.length,h.SheetNames=[];for(var w=0;w!=x.length;++w)h.SheetNames[w]=x[w].name}var N=i?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),C=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Ci(e,C)||(C="xl/_rels/workbook."+N+".rels");var j=Fh(si(e,C,!0),C.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=uue(Wn(e,bi(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=$se(Wn(e,bi(s.people[0])),t)),j&&(j=Fde(j,d.Sheets));var E=Wn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=h.Worksheets;++v){var S="sheet";if(j&&j[v]?(g="xl/"+j[v][1].replace(/[\/]?xl\//,""),Ci(e,g)||(g=j[v][1]),Ci(e,g)||(g=C.replace(/_rels\/.*$/,"")+j[v][1]),S=j[v][2]):(g="xl/worksheets/sheet"+(v+1-E)+"."+N,g=g.replace(/sheet0\./,"sheet.")),y=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(h.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,I=0;I!=t.sheets.length;++I)typeof t.sheets[I]=="number"&&t.sheets[I]==v&&(F=1),typeof t.sheets[I]=="string"&&t.sheets[I].toLowerCase()==h.SheetNames[v].toLowerCase()&&(F=1);if(!F)continue e}}Tde(e,g,y,h.SheetNames[v],v,p,o,S,t,d,c,u)}return b={Directory:s,Workbook:d,Props:h,Custprops:A,Deps:m,Sheets:o,SheetNames:h.SheetNames,Strings:Th,Styles:u,Themes:c,SSF:sn($t)},t&&t.bookFiles&&(e.files?(b.keys=n,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(O,M){O=O.replace(/^Root Entry[\/]/,""),b.keys.push(O),b.files[O]=e.FileIndex[M]}))),t&&t.bookVBA&&(s.vba.length>0?b.vbaraw=Wn(e,bi(s.vba[0]),!0):s.defaults&&s.defaults.bin===Zse&&(b.vbaraw=Wn(e,"xl/vbaProject.bin",!0))),b}function Lde(e,t){var r=t||{},n="Workbook",s=Ht.find(e,n);try{if(n="/!DataSpaces/Version",s=Ht.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(uae(s.content),n="/!DataSpaces/DataSpaceMap",s=Ht.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Aae(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ht.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=fae(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ht.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);pae(s.content)}catch{}if(n="/EncryptionInfo",s=Ht.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=mae(s.content);if(n="/EncryptedPackage",s=Ht.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Ode(e,t){return t.bookType=="ods"?Z8(e,t):t.bookType=="numbers"?Sde(e,t):t.bookType=="xlsb"?Ude(e,t):Pde(e,t)}function Ude(e,t){nA=1024,e&&!e.SSF&&(e.SSF=sn($t)),e&&e.SSF&&(XA(),n1(e.SSF),t.revssf=s1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ih?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=B8.indexOf(t.bookType)>-1,s=M_();r5(t=t||{});var i=B_(),o="",l=0;if(t.cellXfs=[],Gc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",lr(i,o,qI(e.Props,t)),s.coreprops.push(o),Ir(t.rels,2,o,dr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,lr(i,o,VI(e.Props)),s.extprops.push(o),Ir(t.rels,3,o,dr.EXT_PROPS),e.Custprops!==e.Props&&Bn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",lr(i,o,GI(e.Custprops)),s.custprops.push(o),Ir(t.rels,4,o,dr.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,lr(i,o,Aue(l-1,o,t,e,d)),s.sheets.push(o),Ir(t.wbrels,-1,"worksheets/sheet"+l+"."+r,dr.WS[0])}if(h){var A=h["!comments"],b=!1,m="";A&&A.length>0&&(m="xl/comments"+l+"."+r,lr(i,m,pue(A,m)),s.comments.push(m),Ir(d,-1,"../comments"+l+"."+r,dr.CMNT),b=!0),h["!legacy"]&&b&&lr(i,"xl/drawings/vmlDrawing"+l+".vml",j8(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&lr(i,p0(o),xA(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,lr(i,o,hue(t.Strings,o,t)),s.strs.push(o),Ir(t.wbrels,-1,"sharedStrings."+r,dr.SST)),o="xl/workbook."+r,lr(i,o,due(e,o)),s.workbooks.push(o),Ir(t.rels,1,o,dr.WB),o="xl/theme/theme1.xml",lr(i,o,G_(e.Themes,t)),s.themes.push(o),Ir(t.wbrels,-1,"theme/theme1.xml",dr.THEME),o="xl/styles."+r,lr(i,o,fue(e,o,t)),s.styles.push(o),Ir(t.wbrels,-1,"styles."+r,dr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",lr(i,o,e.vbaraw),s.vba.push(o),Ir(t.wbrels,-1,"vbaProject.bin",dr.VBA)),o="xl/metadata."+r,lr(i,o,mue(o)),s.metadata.push(o),Ir(t.wbrels,-1,"metadata."+r,dr.XLMETA),lr(i,"[Content_Types].xml",QI(s,t)),lr(i,"_rels/.rels",xA(t.rels)),lr(i,"xl/_rels/workbook."+r+".rels",xA(t.wbrels)),delete t.revssf,delete t.ssf,i}function Pde(e,t){nA=1024,e&&!e.SSF&&(e.SSF=sn($t)),e&&e.SSF&&(XA(),n1(e.SSF),t.revssf=s1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ih?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=B8.indexOf(t.bookType)>-1,s=M_();r5(t=t||{});var i=B_(),o="",l=0;if(t.cellXfs=[],Gc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",lr(i,o,qI(e.Props,t)),s.coreprops.push(o),Ir(t.rels,2,o,dr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,lr(i,o,VI(e.Props)),s.extprops.push(o),Ir(t.rels,3,o,dr.EXT_PROPS),e.Custprops!==e.Props&&Bn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",lr(i,o,GI(e.Custprops)),s.custprops.push(o),Ir(t.rels,4,o,dr.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],A=(f||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,lr(i,o,D8(l-1,t,e,h)),s.sheets.push(o),Ir(t.wbrels,-1,"worksheets/sheet"+l+"."+r,dr.WS[0])}if(f){var b=f["!comments"],m=!1,v="";if(b&&b.length>0){var p=!1;b.forEach(function(g){g[1].forEach(function(y){y.T==!0&&(p=!0)})}),p&&(v="xl/threadedComments/threadedComment"+l+"."+r,lr(i,v,Kse(b,d,t)),s.threadedcomments.push(v),Ir(h,-1,"../threadedComments/threadedComment"+l+"."+r,dr.TCMNT)),v="xl/comments"+l+"."+r,lr(i,v,C8(b)),s.comments.push(v),Ir(h,-1,"../comments"+l+"."+r,dr.CMNT),m=!0}f["!legacy"]&&m&&lr(i,"xl/drawings/vmlDrawing"+l+".vml",j8(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&lr(i,p0(o),xA(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,lr(i,o,f8(t.Strings,t)),s.strs.push(o),Ir(t.wbrels,-1,"sharedStrings."+r,dr.SST)),o="xl/workbook."+r,lr(i,o,q8(e)),s.workbooks.push(o),Ir(t.rels,1,o,dr.WB),o="xl/theme/theme1.xml",lr(i,o,G_(e.Themes,t)),s.themes.push(o),Ir(t.wbrels,-1,"theme/theme1.xml",dr.THEME),o="xl/styles."+r,lr(i,o,b8(e,t)),s.styles.push(o),Ir(t.wbrels,-1,"styles."+r,dr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",lr(i,o,e.vbaraw),s.vba.push(o),Ir(t.wbrels,-1,"vbaProject.bin",dr.VBA)),o="xl/metadata."+r,lr(i,o,N8()),s.metadata.push(o),Ir(t.wbrels,-1,"metadata."+r,dr.XLMETA),d.length>1&&(o="xl/persons/person.xml",lr(i,o,Vse(d)),s.people.push(o),Ir(t.wbrels,-1,"persons/person.xml",dr.PEOPLE)),lr(i,"[Content_Types].xml",QI(s,t)),lr(i,"_rels/.rels",xA(t.rels)),lr(i,"xl/_rels/workbook."+r+".rels",xA(t.wbrels)),delete t.revssf,delete t.ssf,i}function n5(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=fi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Dde(e,t){return Ht.find(e,"EncryptedPackage")?Lde(e,t):G8(e,t)}function Rde(e,t){var r,n=e,s=t||{};return s.type||(s.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r=pI(n,s),Ide(r,s)}function tL(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Yw(e.slice(r),t);default:break e}return TA.to_workbook(e,t)}function Qde(e,t){var r="",n=n5(e,t);switch(t.type){case"base64":r=fi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Vu(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Dr(r)),t.type="binary",tL(r,t)}function Mde(e,t){var r=e;return t.type=="base64"&&(r=fi(r)),r=c0.utils.decode(1200,r.slice(2),"str"),t.type="binary",tL(r,t)}function Hde(e){return e.match(/[^\x00-\x7F]/)?Do(e):e}function Rv(e,t,r,n){return n?(r.type="string",TA.to_workbook(e,r)):TA.to_workbook(t,r)}function px(e,t){w_();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return px(new Uint8Array(e),(r=sn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vA={},r.dateNF&&(vA.dateNF=r.dateNF),r.type||(r.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ur?"buffer":"binary",n=Uee(e),typeof Uint8Array<"u"&&!ur&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Hde(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=sn(r),r.type="array",px(__(n),r)}switch((s=n5(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Dde(Ht.read(n,r),r);break;case 9:if(s[1]<=8)return G8(n,r);break;case 60:return Yw(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Gne(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return d8.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Rde(n,r):Rv(e,n,r,i);case 239:return s[3]===60?Yw(n,r):Rv(e,n,r,i);case 255:if(s[1]===254)return Mde(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Ou.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Ou.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Xw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return x8.to_workbook(n,r);break;case 10:case 13:case 32:return Qde(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Vne.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Xw.to_workbook(n,r):Rv(e,n,r,i)}function rL(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return I0(t.file,Ht.write(e,{type:ur?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ht.write(e,t)}function qde(e,t){var r=sn(t||{}),n=Ode(e,r);return Kde(n,r)}function Kde(e,t){var r={},n=ur?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ht.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(r1(s))}return t.password&&typeof encrypt_agile<"u"?rL(encrypt_agile(s,t.password),t):t.type==="file"?I0(t.file,s):t.type=="string"?Dr(s):s}function $de(e,t){var r=t||{},n=Hue(e,r);return rL(n,r)}function Lo(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return u0(Do(n));case"binary":return Do(n);case"string":return e;case"file":return I0(t.file,n,"utf8");case"buffer":return ur?Ul(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Lo(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Vde(e,t){switch(t.type){case"base64":return u0(e);case"binary":return e;case"string":return e;case"file":return I0(t.file,e,"binary");case"buffer":return ur?Ul(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Om(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?u0(r):t.type=="string"?Dr(r):r;case"file":return I0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function nL(e,t){w_(),Dce(e);var r=sn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=nL(e,r);return r.type="array",r1(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Lo(Oue(e,r),r);case"slk":case"sylk":return Lo(u8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Lo(z8(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Vde(aL(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Lo(a5(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Lo(d8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Om(Xw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Lo(TA.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Lo(x8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Lo(A8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Lo(Z8(e,r),r);case"wk1":return Om(Ou.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Om(Ou.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Om(W8(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),$de(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return qde(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Gde(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function mx(e,t,r){var n={};return n.type="file",n.file=t,Gde(n),nL(e,n)}function Wde(e,t,r,n,s,i,o,l){var c=Mn(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||e[r])for(var A=t.s.c;A<=t.e.c;++A){var b=o?e[r][A]:e[n[A]+c];if(b===void 0||b.t===void 0){if(u===void 0)continue;i[A]!=null&&(f[i[A]]=u);continue}var m=b.v;switch(b.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(i[A]!=null){if(m==null)if(b.t=="e"&&m===null)f[i[A]]=null;else if(u!==void 0)f[i[A]]=u;else if(d&&m===null)f[i[A]]=null;else continue;else f[i[A]]=d&&(b.t!=="n"||b.t==="n"&&l.rawNumbers!==!1)?m:Il(b,m,l);m!=null&&(h=!1)}}return{row:f,isempty:h}}function gx(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=wr(d);break;case"number":c=wr(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var h=Mn(c.s.r),f=[],A=[],b=0,m=0,v=Array.isArray(e),p=c.s.r,g=0,y={};v&&!e[p]&&(e[p]=[]);var x=u.skipHidden&&e["!cols"]||[],w=u.skipHidden&&e["!rows"]||[];for(g=c.s.c;g<=c.e.c;++g)if(!(x[g]||{}).hidden)switch(f[g]=pn(g),r=v?e[p][g]:e[f[g]+h],n){case 1:i[g]=g-c.s.c;break;case 2:i[g]=f[g];break;case 3:i[g]=u.header[g-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Il(r,null,u),m=y[o]||0,!m)y[o]=1;else{do l=o+"_"+m++;while(y[l]);y[o]=m,y[l]=1}i[g]=l}for(p=c.s.r+s;p<=c.e.r;++p)if(!(w[p]||{}).hidden){var N=Wde(e,c,p,f,n,i,v,u);(N.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(A[b++]=N.row)}return A.length=b,A}var qk=/"/g;function zde(e,t,r,n,s,i,o,l){for(var c=!0,u=[],d="",h=Mn(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var A=l.dense?(e[r]||[])[f]:e[n[f]+h];if(A==null)d="";else if(A.v!=null){c=!1,d=""+(l.rawNumbers&&A.t=="n"?A.v:Il(A,null,l));for(var b=0,m=0;b!==d.length;++b)if((m=d.charCodeAt(b))===s||m===i||m===34||l.forceQuotes){d='"'+d.replace(qk,'""')+'"';break}d=="ID"&&(d='"ID"')}else A.f!=null&&!A.F?(c=!1,d="="+A.f,d.indexOf(",")>=0&&(d='"'+d.replace(qk,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function a5(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=wr(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",h=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],A=n.skipHidden&&e["!rows"]||[],b=s.s.c;b<=s.e.c;++b)(f[b]||{}).hidden||(h[b]=pn(b));for(var m=0,v=s.s.r;v<=s.e.r;++v)(A[v]||{}).hidden||(d=zde(e,s,v,h,o,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((m++?l:"")+d)));return delete n.dense,r.join("")}function aL(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=a5(e,t);return r}function Xde(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=wr(e["!ref"]),i="",o=[],l,c=[],u=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=pn(l);for(var d=s.s.r;d<=s.e.r;++d)for(i=Mn(d),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function sL(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?mn(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var h=wr(i["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(o=h.e.r+1,d.e.r=o+t.length-1+s)}else o==-1&&(o=0,d.e.r=t.length-1+s);var f=n.header||[],A=0;t.forEach(function(m,v){Bn(m).forEach(function(p){(A=f.indexOf(p))==-1&&(f[A=f.length]=p);var g=m[p],y="z",x="",w=Gt({c:l+A,r:o+v+s});u=w0(i,w),g&&typeof g=="object"&&!(g instanceof Date)?i[w]=g:(typeof g=="number"?y="n":typeof g=="boolean"?y="b":typeof g=="string"?y="s":g instanceof Date?(y="d",n.cellDates||(y="n",g=pa(g)),x=n.dateNF||$t[14]):g===null&&n.nullError&&(y="e",g=0),u?(u.t=y,u.v=g,delete u.w,delete u.R,x&&(u.z=x)):i[w]=u={t:y,v:g},x&&(u.z=x))})}),d.e.c=Math.max(d.e.c,l+f.length-1);var b=Mn(o);if(s)for(A=0;A<f.length;++A)i[pn(A+l)+b]={t:"s",v:f[A]};return i["!ref"]=ar(d),i}function Yde(e,t){return sL(null,e,t)}function w0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=mn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?w0(e,Gt(t)):w0(e,Gt({r:t,c:r||0}))}function Jde(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function s5(){return{SheetNames:[],Sheets:{}}}function i5(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(H8(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Zde(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Jde(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function eAe(e,t){return e.z=t,e}function iL(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function tAe(e,t,r){return iL(e,"#"+t,r)}function rAe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nAe(e,t,r,n){for(var s=typeof t!="string"?t:wr(t),i=typeof t=="string"?t:ar(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=w0(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Ya={encode_col:pn,encode_row:Mn,encode_cell:Gt,encode_range:ar,decode_col:O_,decode_row:L_,split_cell:hte,decode_cell:mn,decode_range:Qs,format_cell:Il,sheet_add_aoa:II,sheet_add_json:sL,sheet_add_dom:X8,aoa_to_sheet:YA,json_to_sheet:Yde,table_to_sheet:Y8,table_to_book:ude,sheet_to_csv:a5,sheet_to_txt:aL,sheet_to_json:gx,sheet_to_html:z8,sheet_to_formulae:Xde,sheet_to_row_object_array:gx,sheet_get_cell:w0,book_new:s5,book_append_sheet:i5,book_set_sheet_visibility:Zde,cell_set_number_format:eAe,cell_set_hyperlink:iL,cell_set_internal_link:tAe,cell_add_comment:rAe,sheet_set_array_formula:nAe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function aAe({isOpen:e,onClose:t,inquiry:r,replyTo:n}){const[s,i]=W.useState(r.contact_email||""),[o,l]=W.useState(""),[c,u]=W.useState(""),[d,h]=W.useState(!1),[f,A]=W.useState(!1),[b,m]=W.useState(n!=null&&n.subject?n.subject.startsWith("Re:")?n.subject:`Re: ${n.subject}`:`Re: ${r.product_name} - Inquiry ${r.inquiry_number}`),[v,p]=W.useState(""),[g,y]=W.useState([]),[x,w]=W.useState(!1),[N,_]=W.useState([]),[C,j]=W.useState(!1),[E,S]=W.useState(""),F=W.useRef(null);W.useEffect(()=>{if(I(),O(),n){const V=`
        <br><br>
        <div style="border-left: 3px solid #ccc; padding-left: 15px; margin-left: 10px; color: #666;">
          <p><strong>On ${new Date().toLocaleDateString()}, ${n.from_email} wrote:</strong></p>
          ${n.body}
        </div>
      `;p(V)}},[n]);const I=async()=>{try{const{data:V,error:K}=await ae.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(K)throw K;_(V||[])}catch(V){console.error("Error loading templates:",V)}},O=async()=>{try{const{data:{user:V}}=await ae.auth.getUser();if(V){const{data:K}=await ae.from("user_profiles").select("full_name").eq("id",V.id).single();S((K==null?void 0:K.full_name)||"")}}catch(V){console.error("Error loading user name:",V)}},M=V=>{const K={"{{contact_person}}":r.contact_person||"","{{company_name}}":r.company_name,"{{product_name}}":r.product_name,"{{specification}}":r.specification||"-","{{quantity}}":r.quantity,"{{supplier_name}}":r.supplier_name||"-","{{supplier_country}}":r.supplier_country||"-","{{inquiry_number}}":r.inquiry_number,"{{user_name}}":E};let B=V.subject,L=V.body;Object.entries(K).forEach(([U,D])=>{const Q=new RegExp(U.replace(/[{}]/g,"\\$&"),"g");B=B.replace(Q,D),L=L.replace(Q,D)}),m(B),p(L),j(!1),ae.from("crm_email_templates").update({use_count:V.use_count+1,last_used:new Date().toISOString()}).eq("id",V.id).then(()=>{})},P=V=>{const K=V.target.files;if(!K)return;const B=[];for(let L=0;L<K.length;L++){const U=K[L];if(U.size>25*1024*1024){alert(`File ${U.name} is too large. Maximum size is 25MB.`);continue}B.push({file:U,name:U.name,size:U.size})}y(L=>[...L,...B])},X=V=>{y(K=>K.filter((B,L)=>L!==V))},J=V=>V<1024?V+" B":V<1024*1024?(V/1024).toFixed(1)+" KB":(V/(1024*1024)).toFixed(1)+" MB",H=async()=>{if(!s||!b||!v){alert("Please fill in all required fields");return}w(!0);try{const{data:{user:V}}=await ae.auth.getUser();if(!V)throw new Error("Not authenticated");const K=[];for(const D of g){const Q=`${Date.now()}_${D.name}`,z=`email-attachments/${V.id}/${Q}`,{error:G}=await ae.storage.from("crm-documents").upload(z,D.file);G||K.push(z)}const B={inquiry_id:r.id,email_type:"sent",from_email:V.email,to_email:[s,...o?o.split(",").map(D=>D.trim()):[]],cc_email:o?o.split(",").map(D=>D.trim()):null,bcc_email:c?c.split(",").map(D=>D.trim()):null,subject:b,body:v,attachments:K.length>0?K:null,sent_date:new Date().toISOString(),created_by:V.id,reply_to_id:(n==null?void 0:n.email_id)||null},{error:L}=await ae.from("crm_email_activities").insert([B]);if(L)throw L;const U={};b.toLowerCase().includes("price")||b.toLowerCase().includes("quote")?(U.price_quoted=!0,U.price_quoted_date=new Date().toISOString().split("T")[0],U.status="price_quoted"):(b.toLowerCase().includes("coa")||b.toLowerCase().includes("msds"))&&(U.coa_sent=!0,U.coa_sent_date=new Date().toISOString().split("T")[0]),Object.keys(U).length>0&&await ae.from("crm_inquiries").update(U).eq("id",r.id),alert("Email sent successfully!"),t()}catch(V){console.error("Error sending email:",V),alert("Failed to send email. Please try again.")}finally{w(!1)}};return e?a.jsx(qt,{isOpen:e,onClose:t,title:"",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between border-b pb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(ha,{className:"w-5 h-5"}),n?"Reply to Email":"New Message"]}),a.jsxs("button",{onClick:()=>j(!C),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded transition",children:[a.jsx(dA,{className:"w-4 h-4"}),"Templates",a.jsx(Fi,{className:"w-3 h-3"})]})]}),C&&a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Choose a template:"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:N.map(V=>a.jsxs("button",{onClick:()=>M(V),className:"px-3 py-2 text-left text-sm bg-white hover:bg-blue-50 border border-gray-200 rounded transition",children:[a.jsx("div",{className:"font-medium text-gray-900",children:V.template_name}),a.jsx("div",{className:"text-xs text-gray-500",children:V.category})]},V.id))})]}),a.jsx("div",{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"To:"}),a.jsx("input",{type:"email",value:s,onChange:V=>i(V.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"recipient@example.com",required:!0}),a.jsx("button",{onClick:()=>h(!d),className:"text-sm text-blue-600 hover:text-blue-700",children:"Cc"}),a.jsx("button",{onClick:()=>A(!f),className:"text-sm text-blue-600 hover:text-blue-700",children:"Bcc"})]})}),d&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Cc:"}),a.jsx("input",{type:"text",value:o,onChange:V=>l(V.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"cc@example.com (comma separated)"})]}),f&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Bcc:"}),a.jsx("input",{type:"text",value:c,onChange:V=>u(V.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"bcc@example.com (comma separated)"})]}),a.jsx("div",{children:a.jsx("input",{type:"text",value:b,onChange:V=>m(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Subject",required:!0})}),a.jsx("div",{children:a.jsx("textarea",{value:v.replace(/<[^>]*>/g,""),onChange:V=>p(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Compose your email..."})}),g.length>0&&a.jsx("div",{className:"space-y-2",children:g.map((V,K)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fo,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:V.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",J(V.size),")"]})]}),a.jsx("button",{onClick:()=>X(K),className:"text-red-600 hover:text-red-700",children:a.jsx(Kr,{className:"w-4 h-4"})})]},K))}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[a.jsxs("div",{children:[a.jsx("input",{ref:F,type:"file",multiple:!0,onChange:P,className:"hidden"}),a.jsxs("button",{onClick:()=>{var V;return(V=F.current)==null?void 0:V.click()},className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",children:[a.jsx(fo,{className:"w-4 h-4"}),"Attach Files"]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{onClick:H,disabled:x||!s||!b||!v,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:x?a.jsxs(a.Fragment,{children:[a.jsx(Mo,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ri,{className:"w-4 h-4"}),"Send"]})})]})]}),a.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t",children:[a.jsx("strong",{children:"Inquiry:"})," ",r.inquiry_number," | ",r.company_name," | ",r.product_name]})]})}):null}function oL({isOpen:e,onClose:t,onSuccess:r,initialData:n}){const{user:s}=jr(),[i,o]=W.useState(!1),[l,c]=W.useState([]),[u,d]=W.useState([]),[h,f]=W.useState([]),[A,b]=W.useState([]),m=W.useRef(null),[v,p]=W.useState(""),[g,y]=W.useState(""),[x,w]=W.useState(""),[N,_]=W.useState(""),[C,j]=W.useState("medium"),[E,S]=W.useState([]),[F,I]=W.useState(""),[O,M]=W.useState(""),[P,X]=W.useState(""),[J,H]=W.useState([]),[V,K]=W.useState(""),[B,L]=W.useState([]),[U,D]=W.useState(""),[Q,z]=W.useState(!1);W.useEffect(()=>{if(e){G(),Z(),R(),le(),n&&(I(n.inquiry_id||""),M(n.customer_id||""),X(n.product_id||""));const Ae=new Date;Ae.setDate(Ae.getDate()+1),w(Ae.toISOString().split("T")[0]),_("17:00")}},[e,n]);const G=async()=>{try{const{data:Ae,error:ye}=await ae.from("user_profiles").select("id, full_name, email, role").eq("is_active",!0).order("full_name");if(ye)throw ye;c(Ae||[])}catch(Ae){console.error("Error loading users:",Ae)}},Z=async()=>{try{const{data:Ae,error:ye}=await ae.from("crm_inquiries").select("id, inquiry_number, company_name, product_name").order("created_at",{ascending:!1}).limit(100);if(ye)throw ye;d((Ae||[]).map(Le=>({id:Le.id,label:`${Le.inquiry_number} - ${Le.company_name} (${Le.product_name})`})))}catch(Ae){console.error("Error loading inquiries:",Ae)}},R=async()=>{try{const{data:Ae,error:ye}=await ae.from("customers").select("id, company_name, contact_person").eq("is_active",!0).order("company_name");if(ye)throw ye;f((Ae||[]).map(Le=>({id:Le.id,label:`${Le.company_name}${Le.contact_person?` (${Le.contact_person})`:""}`})))}catch(Ae){console.error("Error loading customers:",Ae)}},le=async()=>{try{const{data:Ae,error:ye}=await ae.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(ye)throw ye;b((Ae||[]).map(Le=>({id:Le.id,label:`${Le.product_name}${Le.product_code?` (${Le.product_code})`:""}`})))}catch(Ae){console.error("Error loading products:",Ae)}},ee=Ae=>{E.includes(Ae)?S(E.filter(ye=>ye!==Ae)):S([...E,Ae])},_e=()=>{V.trim()&&!J.includes(V.trim())&&(H([...J,V.trim()]),K(""))},se=Ae=>{H(J.filter(ye=>ye!==Ae))},te=async Ae=>{const ye=[];for(const Le of B){const Re=`${Date.now()}_${Le.name}`,we=`tasks/${Ae}/${Re}`,{error:Pe}=await ae.storage.from("task-attachments").upload(we,Le);Pe?console.error("Error uploading file:",Pe):ye.push(we)}return ye},Ne=async Ae=>{if(Ae.preventDefault(),!v.trim()){alert("Please enter a task title");return}if(!x||!N){alert("Please set a deadline");return}if(E.length===0){alert("Please assign at least one user");return}try{o(!0);const ye=`${x}T${N}:00`,Le={title:v.trim(),description:g.trim()||null,deadline:ye,priority:C,created_by:s==null?void 0:s.id,assigned_users:E,inquiry_id:F||null,customer_id:O||null,product_id:P||null,tags:J},{data:Re,error:we}=await ae.from("tasks").insert([Le]).select().single();if(we)throw we;if(B.length>0&&Re){const Ve=await te(Re.id),{error:lt}=await ae.from("tasks").update({attachment_urls:Ve}).eq("id",Re.id);if(lt)throw lt}const Pe=E.map(Ve=>({task_id:Re.id,assigned_user_id:Ve,assigned_by:s==null?void 0:s.id})),{error:ze}=await ae.from("task_assignments").insert(Pe);if(ze)throw ze;r()}catch(ye){console.error("Error creating task:",ye),alert("Failed to create task. Please try again.")}finally{o(!1)}},Se=l.filter(Ae=>Ae.full_name.toLowerCase().includes(U.toLowerCase())||Ae.email.toLowerCase().includes(U.toLowerCase()));return a.jsx(qt,{isOpen:e,onClose:t,title:"Create New Task",size:"lg",children:a.jsxs("form",{onSubmit:Ne,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Task Title ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:v,onChange:Ae=>p(Ae.target.value),placeholder:"e.g., Send quotation to customer",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:g,onChange:Ae=>y(Ae.target.value),placeholder:"Add detailed instructions or notes...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Date ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",value:x,onChange:Ae=>w(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Time ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"time",value:N,onChange:Ae=>_(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Priority ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:C,onChange:Ae=>j(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"low",children:"Low"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"high",children:"High"}),a.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Assign To ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:U,onChange:Ae=>D(Ae.target.value),onFocus:()=>z(!0),placeholder:"Search users...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx(ls,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),Q&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:Se.map(Ae=>a.jsxs("button",{type:"button",onClick:()=>ee(Ae.id),className:`w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center justify-between ${E.includes(Ae.id)?"bg-blue-50":""}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:Ae.full_name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[Ae.email,"  ",Ae.role]})]}),E.includes(Ae.id)&&a.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},Ae.id))})]}),E.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:E.map(Ae=>{const ye=l.find(Le=>Le.id===Ae);return a.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:[ye==null?void 0:ye.full_name,a.jsx("button",{type:"button",onClick:()=>ee(Ae),className:"text-blue-600 hover:text-blue-800",children:a.jsx(Kr,{className:"w-4 h-4"})})]},Ae)})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Inquiry"}),a.jsxs("select",{value:F,onChange:Ae=>I(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"None"}),u.map(Ae=>a.jsx("option",{value:Ae.id,children:Ae.label},Ae.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Customer"}),a.jsxs("select",{value:O,onChange:Ae=>M(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"None"}),h.map(Ae=>a.jsx("option",{value:Ae.id,children:Ae.label},Ae.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Product"}),a.jsxs("select",{value:P,onChange:Ae=>X(Ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"None"}),A.map(Ae=>a.jsx("option",{value:Ae.id,children:Ae.label},Ae.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:V,onChange:Ae=>K(Ae.target.value),onKeyPress:Ae=>Ae.key==="Enter"&&(Ae.preventDefault(),_e()),placeholder:"Add tag and press Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsx("button",{type:"button",onClick:_e,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:"Add"})]}),J.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:J.map(Ae=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:[a.jsx(Dg,{className:"w-3 h-3"}),Ae,a.jsx("button",{type:"button",onClick:()=>se(Ae),className:"text-gray-500 hover:text-red-600",children:a.jsx(Kr,{className:"w-3 h-3"})})]},Ae))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attachments"}),a.jsx("input",{ref:m,type:"file",multiple:!0,onChange:Ae=>{Ae.target.files&&L(Array.from(Ae.target.files))},className:"hidden"}),a.jsxs("button",{type:"button",onClick:()=>{var Ae;return(Ae=m.current)==null?void 0:Ae.click()},className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[a.jsx(fo,{className:"w-4 h-4"}),"Choose Files"]}),B.length>0&&a.jsx("div",{className:"mt-2 space-y-2",children:B.map((Ae,ye)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sr,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:Ae.name}),a.jsxs("span",{className:"text-xs text-gray-500",children:["(",(Ae.size/1024).toFixed(1)," KB)"]})]}),a.jsx("button",{type:"button",onClick:()=>L(Le=>Le.filter((Re,we)=>we!==ye)),className:"text-red-600 hover:text-red-700",children:a.jsx(Kr,{className:"w-4 h-4"})})]},ye))})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:t,disabled:i,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:i||!v.trim()||E.length===0,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:i?a.jsxs(a.Fragment,{children:[a.jsx(Mo,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):"Create Task"})]})]})})}function sAe({inquiry:e,compact:t=!1,onMarkSent:r}){const n=[{type:"price",letter:"P",required:e.price_required??!0,sent:e.price_sent_at,label:"Price"},{type:"coa",letter:"C",required:e.coa_required??!0,sent:e.coa_sent_at,label:"COA"},{type:"sample",letter:"S",required:e.sample_required,sent:e.sample_sent_at,label:"Sample"},{type:"agency_letter",letter:"A",required:e.agency_letter_required,sent:e.agency_letter_sent_at,label:"Agency Letter"},{type:"others",letter:"O",required:e.others_required,sent:e.others_sent_at,label:"Others"}];return n.some(i=>i.required)?a.jsx("div",{className:"flex flex-wrap gap-1.5",children:n.filter(i=>i.required).map(i=>a.jsx("button",{onClick:()=>r==null?void 0:r(i.type),disabled:!r,className:`
            inline-flex items-center justify-center
            w-6 h-6 rounded text-xs font-bold
            transition-colors duration-150
            ${i.sent?"bg-green-100 text-green-700 hover:bg-green-200 cursor-pointer":"bg-red-100 text-red-700 hover:bg-red-200 cursor-pointer"}
            ${r?"":"cursor-default"}
          `,title:`${i.label}${i.sent?" - Sent (Click to unmark)":" - Pending (Click to mark as sent)"}`,children:i.letter},i.type))}):a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-500",children:[a.jsx(iAe,{className:"w-3 h-3"}),!t&&"Nothing required"]})}function iAe({className:e}){return a.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}const Kk={new:{label:"New",color:"bg-gray-100 text-gray-700 border-gray-300",icon:vF},in_progress:{label:"In Progress",color:"bg-blue-100 text-blue-700 border-blue-300",icon:ui},follow_up:{label:"Follow Up",color:"bg-purple-100 text-purple-700 border-purple-300",icon:Ra},won:{label:"Won",color:"bg-green-100 text-green-700 border-green-300",icon:yn},lost:{label:"Lost",color:"bg-red-100 text-red-700 border-red-300",icon:un},on_hold:{label:"On Hold",color:"bg-yellow-100 text-yellow-700 border-yellow-300",icon:bR}};function lL({status:e,compact:t=!1}){const r=Kk[e]||Kk.new,n=r.icon;return a.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium border ${r.color}`,children:[a.jsx(n,{className:"w-3 h-3"}),!t&&r.label]})}const Um=[{value:"new",label:"New"},{value:"in_progress",label:"In Progress"},{value:"follow_up",label:"Follow Up"},{value:"won",label:"Won"},{value:"lost",label:"Lost"},{value:"on_hold",label:"On Hold"}];function oAe({isOpen:e,onClose:t,inquiryId:r,inquiryNumber:n,onSuccess:s}){const[i,o]=W.useState(""),[l,c]=W.useState(""),[u,d]=W.useState(""),[h,f]=W.useState(!1),A=async v=>{if(v.preventDefault(),i.trim().length<10){alert("Please provide a detailed reason (at least 10 characters)");return}f(!0);try{const p={pipeline_status:"lost",lost_reason:i.trim(),lost_at:new Date().toISOString()};l.trim()&&(p.competitor_name=l.trim()),u.trim()&&(p.competitor_price=parseFloat(u));const{error:g}=await ae.from("crm_inquiries").update(p).eq("id",r);if(g)throw g;s(),t(),b()}catch(p){console.error("Error marking inquiry as lost:",p),alert("Failed to mark inquiry as lost. Please try again.")}finally{f(!1)}},b=()=>{o(""),c(""),d("")},m=()=>{h||(t(),b())};return a.jsx(qt,{isOpen:e,onClose:m,title:`Mark Inquiry #${n} as Lost`,children:a.jsxs("form",{onSubmit:A,className:"space-y-4",children:[a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[a.jsx(un,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-red-800",children:[a.jsx("p",{className:"font-medium",children:"You are about to mark this inquiry as lost."}),a.jsx("p",{className:"mt-1 text-red-700",children:"This will move it to the Archive. Please provide details below."})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Lost Reason ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("textarea",{value:i,onChange:v=>o(v.target.value),placeholder:"e.g., Competitor offered lower price, Customer chose local supplier, Budget constraints...",rows:4,required:!0,minLength:10,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 characters. Be specific to help improve future quotes."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Name ",a.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),a.jsx("input",{type:"text",value:l,onChange:v=>c(v.target.value),placeholder:"e.g., ABC Trading Co.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Price (USD) ",a.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),a.jsx("input",{type:"number",step:"0.01",value:u,onChange:v=>d(v.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:m,disabled:h,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:h||i.trim().length<10,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(un,{className:"w-4 h-4"}),"Mark as Lost"]})})]})]})})}function lAe({inquiries:e,onRefresh:t,canManage:r,onAddInquiry:n}){const{profile:s}=jr(),[i,o]=W.useState(new Set),[l,c]=W.useState([]),[u,d]=W.useState(null),[h,f]=W.useState(e),[A,b]=W.useState({column:"inquiry_date",direction:"desc"}),[m,v]=W.useState(null),[p,g]=W.useState(""),[y,x]=W.useState(!1),[w,N]=W.useState(null),[_,C]=W.useState(!1),[j,E]=W.useState(""),[S,F]=W.useState(!1),[I,O]=W.useState(""),[M,P]=W.useState(""),[X,J]=W.useState(!1),[H,V]=W.useState(!1),[K,B]=W.useState(!1),[L,U]=W.useState(null),[D,Q]=W.useState(!1),[z,G]=W.useState(null),[Z,R]=W.useState(""),[le,ee]=W.useState(!1),[_e,se]=W.useState({price_required:!1,coa_required:!1,sample_required:!1,agency_letter_required:!1,others_required:!1}),[te,Ne]=W.useState(new Set),[Se,Ae]=W.useState(new Map),ye=W.useRef(null),[Le,Re]=W.useState({checkbox:50,inquiry_number:120,inquiry_date:120,product_name:200,specification:200,quantity:100,supplier_name:150,company_name:180,mail_subject:200,aceerp_no:120,status:130,pipeline_status:130,our_side:130,purchase_price:100,offered_price:100,delivery_date:120,priority:100,remarks:200}),[we,Pe]=W.useState(null),ze=[{value:"urgent",label:"Urgent",icon:a.jsx(_F,{className:"w-3 h-3 text-red-600"})},{value:"high",label:"High",icon:a.jsx(zb,{className:"w-3 h-3 text-orange-600"})},{value:"medium",label:"Medium",icon:a.jsx(Ug,{className:"w-3 h-3 text-gray-400"})},{value:"low",label:"Low",icon:a.jsx(Ug,{className:"w-3 h-3 text-gray-300"})}];W.useEffect(()=>{pe()},[e,l,A]),W.useEffect(()=>{function ne(oe){ye.current&&!ye.current.contains(oe.target)&&d(null)}return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[]),W.useEffect(()=>{const ne=ie=>{if(!we)return;const xe=ie.clientX-we.startX,me=Math.max(50,we.startWidth+xe);Re(Ue=>({...Ue,[we.column]:me}))},oe=()=>{Pe(null)};if(we)return document.addEventListener("mousemove",ne),document.addEventListener("mouseup",oe),()=>{document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",oe)}},[we]);const Ve=(ne,oe)=>{oe.preventDefault(),oe.stopPropagation(),Pe({column:ne,startX:oe.clientX,startWidth:Le[ne]||150})},lt=({column:ne,label:oe,sortable:ie=!0,className:xe=""})=>a.jsxs("th",{style:{width:Le[ne],minWidth:Le[ne]},className:`relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 ${ie?"cursor-pointer hover:bg-gray-100 select-none":""} ${xe}`,onClick:ie?()=>Fe(ne):void 0,children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"truncate",children:oe}),ie&&Ke(ne)]}),a.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400 group",onMouseDown:me=>Ve(ne,me),onClick:me=>me.stopPropagation(),children:a.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-transparent group-hover:bg-blue-400"})})]}),pe=()=>{let ne=[...e];l.forEach(oe=>{oe.values.length>0&&(ne=ne.filter(ie=>{const xe=ie[oe.column];return oe.values.includes(String(xe||""))}))}),A.column&&A.direction&&ne.sort((oe,ie)=>{const xe=oe[A.column],me=ie[A.column];if(xe==null&&me==null)return 0;if(xe==null)return A.direction==="asc"?1:-1;if(me==null)return A.direction==="asc"?-1:1;const Ue=String(xe).toLowerCase(),Qe=String(me).toLowerCase();return A.direction==="asc"?Ue>Qe?1:Ue<Qe?-1:0:Ue<Qe?1:Ue>Qe?-1:0}),f(ne)},Fe=ne=>{let oe="asc";A.column===ne&&(A.direction==="asc"?oe="desc":A.direction==="desc"&&(oe=null)),b({column:ne,direction:oe})},Ke=ne=>A.column!==ne?a.jsx(B4,{className:"w-3 h-3 text-gray-400"}):A.direction==="asc"?a.jsx(zb,{className:"w-3 h-3 text-blue-600"}):A.direction==="desc"?a.jsx(Z7,{className:"w-3 h-3 text-blue-600"}):a.jsx(B4,{className:"w-3 h-3 text-gray-400"}),Xe=()=>{V(!0);try{const ne=h.map(me=>{var Ue,Qe;return{"No.":me.inquiry_number,Date:new Date(me.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:me.product_name,Specification:me.specification||"-",Qty:me.quantity,Supplier:me.supplier_name||"-",Country:me.supplier_country||"-",Company:me.company_name,"Mail Subject":me.mail_subject||"-","ACE ERP#":me.aceerp_no||"-",Pipeline:((Ue=Um.find(qe=>qe.value===me.pipeline_status))==null?void 0:Ue.label)||"-","Price Needed":me.price_required?"Yes":"No","COA Needed":me.coa_required?"Yes":"No","Sample Needed":me.sample_required?"Yes":"No","Agency Letter Needed":me.agency_letter_required?"Yes":"No","Others Needed":me.others_required?"Yes":"No","Price Sent":me.price_sent_at?"Yes":"No","COA Sent":me.coa_sent_at?"Yes":"No","Sample Sent":me.sample_sent_at?"Yes":"No","Agency Letter Sent":me.agency_letter_sent_at?"Yes":"No","Purchase Price":me.purchase_price?`${me.purchase_price} ${me.purchase_price_currency||"USD"}`:"-","Offered Price":me.offered_price?`${me.offered_price} ${me.offered_price_currency||"USD"}`:"-","Delivery Date":me.delivery_date?new Date(me.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":me.delivery_terms||"-",Priority:((Qe=ze.find(qe=>qe.value===me.priority))==null?void 0:Qe.label)||me.priority,Remarks:me.remarks||"-"}}),oe=Ya.json_to_sheet(ne);oe["!cols"]=[{wch:15},{wch:12},{wch:30},{wch:20},{wch:10},{wch:20},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:13},{wch:12},{wch:15},{wch:20},{wch:12},{wch:11},{wch:13},{wch:19},{wch:18},{wch:18},{wch:15},{wch:18},{wch:10},{wch:30}];const ie=Ya.book_new();Ya.book_append_sheet(ie,oe,"CRM Inquiries");const xe=`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.xlsx`;mx(ie,xe),alert(`Exported ${ne.length} inquiries to ${xe}`)}catch(ne){console.error("Export error:",ne),alert("Failed to export data. Please try again.")}finally{V(!1)}},tt=()=>{V(!0);try{const ne=h.map(Qe=>{var qe,Ge;return{"No.":Qe.inquiry_number,Date:new Date(Qe.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:Qe.product_name,Specification:Qe.specification||"-",Qty:Qe.quantity,Supplier:Qe.supplier_name||"-",Country:Qe.supplier_country||"-",Company:Qe.company_name,"Mail Subject":Qe.mail_subject||"-","ACE ERP#":Qe.aceerp_no||"-",Pipeline:((qe=Um.find(Te=>Te.value===Qe.pipeline_status))==null?void 0:qe.label)||"-","Price Needed":Qe.price_required?"Yes":"No","COA Needed":Qe.coa_required?"Yes":"No","Sample Needed":Qe.sample_required?"Yes":"No","Agency Letter Needed":Qe.agency_letter_required?"Yes":"No","Others Needed":Qe.others_required?"Yes":"No","Price Sent":Qe.price_sent_at?"Yes":"No","COA Sent":Qe.coa_sent_at?"Yes":"No","Sample Sent":Qe.sample_sent_at?"Yes":"No","Agency Letter Sent":Qe.agency_letter_sent_at?"Yes":"No","Purchase Price":Qe.purchase_price?`${Qe.purchase_price} ${Qe.purchase_price_currency||"USD"}`:"-","Offered Price":Qe.offered_price?`${Qe.offered_price} ${Qe.offered_price_currency||"USD"}`:"-","Delivery Date":Qe.delivery_date?new Date(Qe.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":Qe.delivery_terms||"-",Priority:((Ge=ze.find(Te=>Te.value===Qe.priority))==null?void 0:Ge.label)||Qe.priority,Remarks:Qe.remarks||"-"}}),oe=Ya.json_to_sheet(ne),ie=Ya.sheet_to_csv(oe),xe=new Blob([ie],{type:"text/csv;charset=utf-8;"}),me=document.createElement("a"),Ue=URL.createObjectURL(xe);me.setAttribute("href",Ue),me.setAttribute("download",`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.csv`),me.style.visibility="hidden",document.body.appendChild(me),me.click(),document.body.removeChild(me),alert(`Exported ${ne.length} inquiries to CSV. You can import this file to Google Sheets.`)}catch(ne){console.error("Export error:",ne),alert("Failed to export data. Please try again.")}finally{V(!1)}},st=()=>{const ne=[{Date:"02-12-2024",Product:"Example Product Name",Specification:"BP / USP / EP",Qty:"500 KG",Supplier:"Manufacturer Name",Country:"Japan",Company:"Customer Company Name","Mail Subject":"Inquiry for Product","ACE ERP#":"ACE-123","Price Needed":"Yes","COA Needed":"Yes","Sample Needed":"No","Agency Letter Needed":"No","Others Needed":"No","Purchase Price":"100","Purchase Price Currency":"USD","Offered Price":"150","Offered Price Currency":"USD","Delivery Date":"2025-12-31","Delivery Terms":"FOB Shanghai",Priority:"Medium",Remarks:"Additional notes"}],oe=Ya.json_to_sheet(ne),ie=Ya.book_new();Ya.book_append_sheet(ie,oe,"Import Template"),mx(ie,"CRM-Import-Template.xlsx"),alert("Template downloaded! Fill in your data and use the Import button to upload.")},ke=ne=>{var xe;const oe=(xe=ne.target.files)==null?void 0:xe[0];if(!oe)return;const ie=new FileReader;ie.onload=async me=>{var Ue;try{const Qe=new Uint8Array((Ue=me.target)==null?void 0:Ue.result),qe=px(Qe,{type:"array"}),Ge=qe.Sheets[qe.SheetNames[0]],Te=Ya.sheet_to_json(Ge);if(Te.length===0){alert("No data found in the file");return}const{data:{user:be}}=await ae.auth.getUser();if(!be)throw new Error("Not authenticated");const Me=it=>{if(!it)return new Date().toISOString().split("T")[0];if(typeof it=="number"){const cr=new Date(1899,11,30),Xr=new Date(cr.getTime()+it*864e5),Qr=Xr.getFullYear(),Ki=(Xr.getMonth()+1).toString().padStart(2,"0"),vn=Xr.getDate().toString().padStart(2,"0");return`${Qr}-${Ki}-${vn}`}const Ct=it.toString().trim(),Xt=Ct.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(Xt){let[,cr,Xr,Qr]=Xt;return`${parseInt(Qr)<30?`20${Qr}`:`19${Qr}`}-${Xr.padStart(2,"0")}-${cr.padStart(2,"0")}`}const Vt=Ct.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(Vt){const[,cr,Xr,Qr]=Vt;return`${Qr}-${Xr.padStart(2,"0")}-${cr.padStart(2,"0")}`}const _r=Ct.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(_r){const[,cr,Xr,Qr]=_r;return`${Qr}-${Xr.padStart(2,"0")}-${cr.padStart(2,"0")}`}const ja=Ct.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(ja){const[,cr,Xr,Qr]=ja;return`${cr}-${Xr.padStart(2,"0")}-${Qr.padStart(2,"0")}`}return new Date().toISOString().split("T")[0]},et=Te.map(it=>({product_name:it.Product||"",specification:it.Specification||null,quantity:it.Qty||"",supplier_name:it.Supplier||null,supplier_country:it.Country||null,company_name:it.Company||"",mail_subject:it["Mail Subject"]||null,aceerp_no:it["ACE ERP#"]||null,price_required:(it["Price Needed"]||"").toLowerCase()==="yes",coa_required:(it["COA Needed"]||"").toLowerCase()==="yes",sample_required:(it["Sample Needed"]||"").toLowerCase()==="yes",agency_letter_required:(it["Agency Letter Needed"]||"").toLowerCase()==="yes",others_required:(it["Others Needed"]||"").toLowerCase()==="yes",purchase_price:it["Purchase Price"]?parseFloat(it["Purchase Price"]):null,purchase_price_currency:it["Purchase Price Currency"]||"USD",offered_price:it["Offered Price"]?parseFloat(it["Offered Price"]):null,offered_price_currency:it["Offered Price Currency"]||"USD",delivery_date:it["Delivery Date"]||null,delivery_terms:it["Delivery Terms"]||null,priority:(it.Priority||"medium").toLowerCase(),remarks:it.Remarks||null,inquiry_date:Me(it.Date),pipeline_status:"new",status:"new",inquiry_source:"other",assigned_to:be.id,created_by:be.id})),{error:dt}=await ae.from("crm_inquiries").insert(et);if(dt)throw dt;alert(`Successfully imported ${et.length} inquiries!`),t(),ne.target.value=""}catch(Qe){console.error("Import error:",Qe),alert("Failed to import data. Please check the file format and try again."),ne.target.value=""}},ie.readAsArrayBuffer(oe)},Ee=(ne,oe)=>{c(ie=>{const xe=ie.find(me=>me.column===ne);if(xe){const me=xe.values.includes(oe)?xe.values.filter(Ue=>Ue!==oe):[...xe.values,oe];return me.length===0?ie.filter(Ue=>Ue.column!==ne):ie.map(Ue=>Ue.column===ne?{...Ue,values:me}:Ue)}return[...ie,{column:ne,values:[oe]}]})},Je=ne=>{c(oe=>oe.filter(ie=>ie.column!==ne))},rt=ne=>{const oe=e.map(ie=>ie[ne]);return[...new Set(oe)].filter(Boolean).sort()},Ze=ne=>l.some(oe=>oe.column===ne&&oe.values.length>0),xt=ne=>{o(oe=>{const ie=new Set(oe);return ie.has(ne)?ie.delete(ne):ie.add(ne),ie})},mt=()=>{i.size===h.length?o(new Set):o(new Set(h.map(ne=>ne.id)))},bt=async ne=>{const oe=new Set(te);if(oe.has(ne))oe.delete(ne);else if(oe.add(ne),!Se.has(ne))try{const{data:ie,error:xe}=await ae.from("crm_inquiry_items").select("*").eq("parent_inquiry_id",ne).order("inquiry_number",{ascending:!0});if(xe)throw xe;const me=new Map(Se);me.set(ne,ie||[]),Ae(me)}catch(ie){console.error("Error fetching inquiry items:",ie)}Ne(oe)},vt=(ne,oe)=>{r&&(v({id:ne.id,field:oe}),g(String(ne[oe]||"")))},Nt=async()=>{if(m)try{const{error:ne}=await ae.from("crm_inquiries").update({[m.field]:p||null}).eq("id",m.id);if(ne)throw ne;v(null),t()}catch(ne){console.error("Error updating field:",ne),alert("Failed to update. Please try again.")}},Bt=async(ne,oe)=>{try{const{error:ie}=await ae.from("crm_inquiries").update({priority:oe}).eq("id",ne.id);if(ie)throw ie;t()}catch(ie){console.error("Error updating priority:",ie)}},tr=async(ne,oe)=>{if(oe==="lost"){U(ne),B(!0);return}try{const{error:ie}=await ae.from("crm_inquiries").update({pipeline_status:oe}).eq("id",ne.id);if(ie)throw ie;t()}catch(ie){console.error("Error updating pipeline status:",ie)}},Ma=async(ne,oe)=>{var me;const ie=`${oe}_sent_at`;if(ne[ie]){if(!confirm(`Are you sure you want to unmark ${oe.toUpperCase()} as sent?`))return;try{const Ue={[ie]:null},{error:Qe}=await ae.from("crm_inquiries").update(Ue).eq("id",ne.id);if(Qe)throw Qe;t(),alert(`${oe.toUpperCase()} unmarked!`)}catch(Ue){console.error("Error unmarking requirement:",Ue),alert("Failed to unmark. Please try again.")}return}if(oe==="price"){G(ne),R(((me=ne.offered_price)==null?void 0:me.toString())||""),Q(!0);return}try{const{error:Ue}=await ae.rpc("mark_requirement_sent",{inquiry_id:ne.id,requirement_type:oe});if(Ue)throw Ue;t(),alert(`${oe.toUpperCase()} marked as sent!`)}catch(Ue){console.error("Error marking requirement as sent:",Ue),alert("Failed to mark as sent. Please try again.")}},rr=async()=>{if(!z)return;const ne=Z.trim()?parseFloat(Z):null;try{const{error:oe}=await ae.from("crm_inquiries").update({offered_price:ne}).eq("id",z.id);if(oe)throw oe;const{error:ie}=await ae.rpc("mark_requirement_sent",{inquiry_id:z.id,requirement_type:"price"});if(ie)throw ie;Q(!1),G(null),R(""),t(),alert("Price marked as sent with offered price updated!")}catch(oe){console.error("Error saving offered price and marking sent:",oe),alert("Failed to save. Please try again.")}},dn=()=>{const ne=h.find(oe=>i.has(oe.id));ne&&(N(ne),x(!0))},ta=async()=>{const ne=h.find(oe=>i.has(oe.id));ne&&(N(ne),x(!0))},Pt=()=>{C(!0)},qn=async()=>{const ne=h.find(oe=>i.has(oe.id));if(ne)try{const{data:{user:oe}}=await ae.auth.getUser();if(!oe)throw new Error("Not authenticated");await ae.from("crm_activities").insert({inquiry_id:ne.id,activity_type:"call",description:j,activity_date:new Date().toISOString().split("T")[0],is_completed:!0,created_by:oe.id}),C(!1),E(""),alert("Call logged successfully!"),t()}catch(oe){console.error("Error logging call:",oe),alert("Failed to log call. Please try again.")}},ra=async()=>{if(i.size===0)return;const ne=i.size;if(confirm(`Are you sure you want to delete ${ne} selected ${ne===1?"inquiry":"inquiries"}? This action cannot be undone.`))try{const oe=Array.from(i),{error:ie}=await ae.from("crm_inquiries").delete().in("id",oe);if(ie)throw ie;o(new Set),alert(`Successfully deleted ${ne} ${ne===1?"inquiry":"inquiries"}`),t()}catch(oe){console.error("Error deleting inquiries:",oe),alert("Failed to delete inquiries. Please try again.")}},Sn=()=>{F(!0)},ma=async()=>{const ne=h.find(oe=>i.has(oe.id));if(ne)try{const{data:{user:oe}}=await ae.auth.getUser();if(!oe)throw new Error("Not authenticated");await ae.from("crm_activities").insert({inquiry_id:ne.id,activity_type:"follow_up",description:M,activity_date:new Date().toISOString().split("T")[0],follow_up_date:I,is_completed:!1,created_by:oe.id}),F(!1),O(""),P(""),alert("Follow-up scheduled successfully!"),t()}catch(oe){console.error("Error scheduling follow-up:",oe),alert("Failed to schedule follow-up. Please try again.")}},Ar=()=>{const ne=h.find(oe=>i.has(oe.id));ne&&(se({price_required:ne.price_required??!1,coa_required:ne.coa_required??!1,sample_required:ne.sample_required??!1,agency_letter_required:ne.agency_letter_required??!1,others_required:ne.others_required??!1}),ee(!0))},Cr=async()=>{const ne=h.find(oe=>i.has(oe.id));if(ne)try{const{error:oe}=await ae.from("crm_inquiries").update(_e).eq("id",ne.id);if(oe)throw oe;ee(!1),alert("Customer requirements updated successfully!"),t()}catch(oe){console.error("Error updating requirements:",oe),alert("Failed to update requirements. Please try again.")}},de=h.find(ne=>i.has(ne.id));return a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:Xe,disabled:H||h.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to Excel (.xlsx)",children:[a.jsx(F4,{className:"w-3.5 h-3.5"}),H?"Exporting...":"Export Excel"]}),a.jsxs("button",{onClick:tt,disabled:H||h.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to CSV for Google Sheets",children:[a.jsx(Ai,{className:"w-3.5 h-3.5"}),H?"Exporting...":"Export CSV"]}),r&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),a.jsxs("button",{onClick:st,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",title:"Download Excel template for bulk import",children:[a.jsx(Ai,{className:"w-3.5 h-3.5"}),"Download Template"]}),a.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[a.jsx(F4,{className:"w-3.5 h-3.5"}),"Import Excel",a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ke,className:"hidden"})]}),n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),a.jsxs("button",{onClick:n,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[a.jsx(Rr,{className:"w-3.5 h-3.5"}),"Add Inquiry"]})]})]}),a.jsxs("div",{className:"text-sm text-gray-600 ml-2",children:[h.length," ",h.length===1?"inquiry":"inquiries",l.length>0&&" (filtered)",A.direction&&" (sorted)"]})]})}),i.size>0&&r&&de&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{className:"text-sm font-medium text-blue-900",children:["Selected: ",a.jsx("span",{className:"font-bold",children:de.inquiry_number})," - ",de.product_name]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:dn,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[a.jsx(Ri,{className:"w-3.5 h-3.5"}),"Send Price"]}),a.jsxs("button",{onClick:ta,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-green-700 bg-green-50 border border-green-200 rounded-md hover:bg-green-100 transition",children:[a.jsx(sr,{className:"w-3.5 h-3.5"}),"Send COA/MSDS"]}),a.jsxs("button",{onClick:Pt,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[a.jsx(Fl,{className:"w-3.5 h-3.5"}),"Log Call"]}),a.jsxs("button",{onClick:Sn,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[a.jsx(Na,{className:"w-3.5 h-3.5"}),"Schedule Follow-up"]}),a.jsxs("button",{onClick:()=>J(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[a.jsx(n0,{className:"w-3.5 h-3.5"}),"Create Task"]}),a.jsxs("button",{onClick:Ar,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-700 bg-purple-50 border border-purple-200 rounded-md hover:bg-purple-100 transition",title:"Edit Customer Requirements",children:[a.jsx(n0,{className:"w-3.5 h-3.5"}),"Edit Requirements"]}),a.jsxs("button",{onClick:ra,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",title:"Delete Selected",children:[a.jsx(Kr,{className:"w-3.5 h-3.5"}),"Delete"]}),a.jsx("button",{onClick:()=>o(new Set),className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition",title:"Deselect",children:a.jsx(Kr,{className:"w-3.5 h-3.5"})})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden border border-gray-200",children:a.jsx("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 280px)"},children:a.jsxs("table",{className:"w-full text-sm border-collapse",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{className:"border-b border-gray-300",children:[a.jsx("th",{className:"px-3 py-2 border-r border-gray-300",children:a.jsx("input",{type:"checkbox",checked:i.size===h.length&&h.length>0,onChange:mt,className:"rounded border-gray-300"})}),a.jsx(lt,{column:"inquiry_number",label:"No.",className:"whitespace-nowrap"}),a.jsx(lt,{column:"inquiry_date",label:"Date",className:"whitespace-nowrap"}),a.jsx(lt,{column:"product_name",label:"Product"}),a.jsx(lt,{column:"specification",label:"Specification"}),a.jsx(lt,{column:"quantity",label:"Qty"}),a.jsx(lt,{column:"supplier_name",label:"Supplier"}),a.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[150px] relative",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Company"}),a.jsx("button",{onClick:()=>d(u==="company_name"?null:"company_name"),className:`p-0.5 rounded hover:bg-gray-200 ${Ze("company_name")?"text-blue-600":""}`,children:a.jsx(Fi,{className:"w-4 h-4"})})]}),u==="company_name"&&a.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-64",children:[a.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-medium",children:"Filter Company"}),Ze("company_name")&&a.jsx("button",{onClick:()=>Je("company_name"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),a.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:rt("company_name").map(ne=>{var ie;const oe=(ie=l.find(xe=>xe.column==="company_name"))==null?void 0:ie.values.includes(String(ne));return a.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:oe,onChange:()=>Ee("company_name",String(ne)),className:"rounded border-gray-300"}),a.jsx("span",{className:"text-sm",children:String(ne)})]},String(ne))})})]})]}),a.jsx(lt,{column:"mail_subject",label:"Mail Subject"}),a.jsx(lt,{column:"aceerp_no",label:"ACE ERP#"}),a.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative min-w-[130px]",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Pipeline"}),a.jsx("button",{onClick:()=>d(u==="pipeline_status"?null:"pipeline_status"),className:`p-0.5 rounded hover:bg-gray-200 ${Ze("pipeline_status")?"text-blue-600":""}`,children:a.jsx(Fi,{className:"w-4 h-4"})})]}),u==="pipeline_status"&&a.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[a.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-medium",children:"Filter Pipeline"}),Ze("pipeline_status")&&a.jsx("button",{onClick:()=>Je("pipeline_status"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),a.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Um.map(ne=>{var ie;const oe=(ie=l.find(xe=>xe.column==="pipeline_status"))==null?void 0:ie.values.includes(ne.value);return a.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:oe,onChange:()=>Ee("pipeline_status",ne.value),className:"rounded border-gray-300"}),a.jsx("span",{className:"text-sm",children:ne.label})]},ne.value)})})]})]}),a.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[120px] relative",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Our Side"}),a.jsx("button",{onClick:()=>d(u==="our_side"?null:"our_side"),className:`p-0.5 rounded hover:bg-gray-200 ${Ze("our_side")?"text-blue-600":""}`,children:a.jsx(Fi,{className:"w-4 h-4"})})]}),u==="our_side"&&a.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[a.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-medium",children:"Filter Our Side"}),Ze("our_side")&&a.jsx("button",{onClick:()=>Je("our_side"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),a.jsxs("div",{className:"p-2 space-y-1",children:[a.jsxs("button",{onClick:()=>{const ne=e.filter(oe=>(oe.price_required??!0)&&!oe.price_sent_at);f(ne),d(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[a.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"P"}),a.jsx("span",{children:"Price Pending"})]}),a.jsxs("button",{onClick:()=>{const ne=e.filter(oe=>(oe.coa_required??!0)&&!oe.coa_sent_at);f(ne),d(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[a.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"C"}),a.jsx("span",{children:"COA Pending"})]}),a.jsxs("button",{onClick:()=>{const ne=e.filter(oe=>(oe.price_required??!0)&&oe.price_sent_at);f(ne),d(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[a.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"P"}),a.jsx("span",{children:"Price Sent"})]}),a.jsxs("button",{onClick:()=>{const ne=e.filter(oe=>(oe.coa_required??!0)&&oe.coa_sent_at);f(ne),d(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[a.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"C"}),a.jsx("span",{children:"COA Sent"})]})]})]})]}),(s==null?void 0:s.role)==="admin"&&a.jsxs("th",{style:{width:Le.purchase_price,minWidth:Le.purchase_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[a.jsx("span",{children:"P.Price"}),a.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ne=>Ve("purchase_price",ne)})]}),a.jsxs("th",{style:{width:Le.offered_price,minWidth:Le.offered_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[a.jsx("span",{children:"O.Price"}),a.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ne=>Ve("offered_price",ne)})]}),a.jsxs("th",{style:{width:Le.delivery_date,minWidth:Le.delivery_date},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[a.jsx("span",{children:"Delivery"}),a.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ne=>Ve("delivery_date",ne)})]}),a.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Priority"}),a.jsx("button",{onClick:()=>d(u==="priority"?null:"priority"),className:`p-0.5 rounded hover:bg-gray-200 ${Ze("priority")?"text-blue-600":""}`,children:a.jsx(Fi,{className:"w-4 h-4"})})]}),u==="priority"&&a.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-48",children:[a.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-medium",children:"Filter Priority"}),Ze("priority")&&a.jsx("button",{onClick:()=>Je("priority"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),a.jsx("div",{className:"p-2",children:ze.map(ne=>{var ie;const oe=(ie=l.find(xe=>xe.column==="priority"))==null?void 0:ie.values.includes(ne.value);return a.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:oe,onChange:()=>Ee("priority",ne.value),className:"rounded border-gray-300"}),ne.icon,a.jsx("span",{className:"text-sm",children:ne.label})]},ne.value)})})]})]}),a.jsx(lt,{column:"remarks",label:"Remarks"})]})}),a.jsx("tbody",{children:h.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:18,className:"px-3 py-8 text-center text-gray-500",children:"No inquiries found"})}):h.map(ne=>{var oe;return a.jsxs(fO.Fragment,{children:[a.jsxs("tr",{className:`border-b border-gray-200 hover:bg-blue-50 transition ${i.has(ne.id)?"bg-blue-100":""}`,children:[a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:a.jsx("input",{type:"checkbox",checked:i.has(ne.id),onChange:()=>xt(ne.id),className:"rounded border-gray-300"})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 font-medium text-blue-600",children:a.jsxs("div",{className:"flex items-center gap-1",children:[ne.has_items&&a.jsx("button",{onClick:()=>bt(ne.id),className:"hover:bg-blue-100 rounded p-0.5 transition",title:te.has(ne.id)?"Collapse products":"Expand products",children:te.has(ne.id)?a.jsx(Fi,{className:"w-4 h-4"}):a.jsx(Sc,{className:"w-4 h-4"})}),ne.is_multi_product&&a.jsx(BF,{className:"w-3.5 h-3.5 text-blue-500",title:"Multi-product inquiry"}),a.jsx("span",{children:ne.inquiry_number})]})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 whitespace-nowrap",children:new Date(ne.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="product_name"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):a.jsx("div",{onDoubleClick:()=>vt(ne,"product_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ne.product_name})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 text-xs",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="specification"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):a.jsx("div",{onDoubleClick:()=>vt(ne,"specification"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ne.specification||"-"})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="quantity"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):a.jsx("div",{onDoubleClick:()=>vt(ne,"quantity"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ne.quantity})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="supplier_name"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):a.jsxs("div",{onDoubleClick:()=>vt(ne,"supplier_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:[a.jsx("div",{children:ne.supplier_name||"-"}),ne.supplier_country&&a.jsx("div",{className:"text-xs text-gray-500",children:ne.supplier_country})]})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:a.jsx("div",{className:"font-medium",children:ne.company_name})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="mail_subject"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):a.jsx("div",{onDoubleClick:()=>vt(ne,"mail_subject"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",title:ne.mail_subject||"",children:ne.mail_subject?a.jsx("div",{className:"line-clamp-2",children:ne.mail_subject}):a.jsx("span",{className:"text-gray-400",children:"-"})})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="aceerp_no"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):a.jsx("div",{onDoubleClick:()=>r&&vt(ne,"aceerp_no"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded":"px-2 py-1",children:ne.aceerp_no||(r?a.jsx("span",{className:"text-gray-400 text-xs",children:"Click to add"}):"-")})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:a.jsx("select",{value:ne.pipeline_status||"new",onChange:ie=>tr(ne,ie.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer bg-white",children:Um.map(ie=>a.jsx("option",{value:ie.value,children:ie.label},ie.value))})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:a.jsx("div",{className:"flex items-center justify-center",children:a.jsx(sAe,{inquiry:ne,onMarkSent:r?ie=>Ma(ne,ie):void 0})})}),(s==null?void 0:s.role)==="admin"&&a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="purchase_price"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):a.jsx("div",{onDoubleClick:()=>vt(ne,"purchase_price"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",children:ne.purchase_price?`$${ne.purchase_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:a.jsx("span",{className:"text-gray-400",children:"Click to add"})})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="offered_price"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):a.jsx("div",{onDoubleClick:()=>r&&vt(ne,"offered_price"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs":"px-2 py-1 text-xs",children:ne.offered_price?`$${ne.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:r?a.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="delivery_date"?a.jsx("input",{type:"date",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):a.jsx("div",{onDoubleClick:()=>r&&vt(ne,"delivery_date"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs whitespace-nowrap":"px-2 py-1 text-xs whitespace-nowrap",children:ne.delivery_date?new Date(ne.delivery_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):r?a.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:a.jsx("select",{value:ne.priority,onChange:ie=>Bt(ne,ie.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer",children:ze.map(ie=>a.jsx("option",{value:ie.value,children:ie.label},ie.value))})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(m==null?void 0:m.id)===ne.id&&(m==null?void 0:m.field)==="remarks"?a.jsx("input",{type:"text",value:p,onChange:ie=>g(ie.target.value),onBlur:Nt,onKeyDown:ie=>{ie.key==="Enter"&&Nt(),ie.key==="Escape"&&v(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):a.jsx("div",{onDoubleClick:()=>vt(ne,"remarks"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-gray-600",children:ne.remarks||"-"})})]}),ne.has_items&&te.has(ne.id)&&((oe=Se.get(ne.id))==null?void 0:oe.map(ie=>a.jsxs("tr",{className:"bg-blue-50 border-b border-blue-100",children:[a.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm text-blue-700 pl-8",children:ie.inquiry_number}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm",children:ie.product_name}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-600",children:ie.specification||"-"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm",children:ie.quantity}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:a.jsx(lL,{status:ie.pipeline_stage})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-center",children:ie.document_sent?a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(Xb,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{className:"text-xs text-gray-500",children:ie.document_sent_at?new Date(ie.document_sent_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}):""})]}):a.jsx(un,{className:"w-4 h-4 text-gray-400 mx-auto"})}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-600",children:ie.notes||"-"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),a.jsx("td",{className:"px-3 py-2 border-r border-gray-200"})]},ie.id)))]},ne.id)})})]})})}),y&&w&&a.jsx(aAe,{isOpen:y,onClose:()=>{x(!1),N(null),t()},inquiry:w}),a.jsx(qt,{isOpen:_,onClose:()=>{C(!1),E("")},title:"Log Phone Call",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Call Notes *"}),a.jsx("textarea",{value:j,onChange:ne=>E(ne.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What was discussed during the call?",required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>{C(!1),E("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:qn,disabled:!j.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:"Save Call Log"})]})]})}),a.jsx(qt,{isOpen:S,onClose:()=>{F(!1),O(""),P("")},title:"Schedule Follow-up",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date *"}),a.jsx("input",{type:"date",value:I,onChange:ne=>O(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:M,onChange:ne=>P(ne.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What needs to be followed up?"})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>{F(!1),O(""),P("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:ma,disabled:!I,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50",children:"Schedule Follow-up"})]})]})}),X&&de&&a.jsx(oL,{isOpen:X,onClose:()=>J(!1),onSuccess:()=>{J(!1),t()},initialData:{inquiry_id:de.id}}),L&&a.jsx(oAe,{isOpen:K,onClose:()=>{B(!1),U(null)},inquiryId:L.id,inquiryNumber:L.inquiry_number,onSuccess:()=>{t(),U(null)}}),a.jsx(qt,{isOpen:D,onClose:()=>{Q(!1),G(null),R("")},title:"Enter Offered Price",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Inquiry: ",(z==null?void 0:z.inquiry_number)||"-"]}),a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Product: ",(z==null?void 0:z.product_name)||"-"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Offered Price (O.Price) *"}),a.jsx("input",{type:"number",value:Z,onChange:ne=>R(ne.target.value),placeholder:"Enter offered price",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the price you offered to the customer"})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>{Q(!1),G(null),R("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{onClick:rr,className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Save & Mark Price as Sent"})]})]})}),a.jsx(qt,{isOpen:le,onClose:()=>ee(!1),title:"Edit Customer Requirements",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Check what the customer has requested:"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:_e.price_required,onChange:ne=>se({..._e,price_required:ne.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Price"})]}),a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:_e.coa_required,onChange:ne=>se({..._e,coa_required:ne.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"COA"})]}),a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:_e.sample_required,onChange:ne=>se({..._e,sample_required:ne.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sample"})]}),a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:_e.agency_letter_required,onChange:ne=>se({..._e,agency_letter_required:ne.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Agency Letter"})]}),a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:_e.others_required,onChange:ne=>se({..._e,others_required:ne.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Others"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:[a.jsx("button",{onClick:()=>ee(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{onClick:Cr,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition",children:"Save Requirements"})]})]})})]})}function cAe({onReminderCreated:e}){const[t,r]=W.useState([]),[n,s]=W.useState(new Date),[i,o]=W.useState(null),[l,c]=W.useState("month"),[u,d]=W.useState(!0),[h,f]=W.useState(!1),[A,b]=W.useState(null);W.useEffect(()=>{m()},[n,l]);const m=async()=>{try{let I=ae.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `);if(l==="month"){const P=new Date(n.getFullYear(),n.getMonth(),1),X=new Date(n.getFullYear(),n.getMonth()+1,0);I=I.gte("due_date",P.toISOString()).lte("due_date",X.toISOString())}const{data:O,error:M}=await I.order("due_date",{ascending:!0});if(M)throw M;r(O||[])}catch(I){console.error("Error loading reminders:",I)}finally{d(!1)}},v=async I=>{try{const{error:O}=await ae.from("crm_reminders").update({is_completed:!I.is_completed,completed_at:I.is_completed?null:new Date().toISOString()}).eq("id",I.id);if(O)throw O;m()}catch(O){console.error("Error updating reminder:",O)}},p=async(I,O)=>{try{const M=new Date(I.due_date);M.setDate(M.getDate()+O);const{error:P}=await ae.from("crm_reminders").update({due_date:M.toISOString()}).eq("id",I.id);if(P)throw P;m(),f(!1)}catch(M){console.error("Error snoozing reminder:",M)}},g=I=>new Date(I.getFullYear(),I.getMonth()+1,0).getDate(),y=I=>new Date(I.getFullYear(),I.getMonth(),1).getDay(),x=I=>t.filter(O=>{const M=new Date(O.due_date);return M.getDate()===I.getDate()&&M.getMonth()===I.getMonth()&&M.getFullYear()===I.getFullYear()}),w=()=>{const I=new Date;return I.setHours(0,0,0,0),t.filter(O=>{const M=new Date(O.due_date);return M.setHours(0,0,0,0),M.getTime()===I.getTime()&&!O.is_completed})},N=()=>{const I=new Date;return I.setHours(0,0,0,0),t.filter(O=>{const M=new Date(O.due_date);return M.setHours(0,0,0,0),M<I&&!O.is_completed})},_=()=>{const I=new Date;I.setHours(0,0,0,0);const O=new Date(I);return O.setDate(O.getDate()+7),t.filter(M=>{const P=new Date(M.due_date);return P.setHours(0,0,0,0),P>I&&P<=O&&!M.is_completed})},C=()=>{s(new Date(n.getFullYear(),n.getMonth()-1))},j=()=>{s(new Date(n.getFullYear(),n.getMonth()+1))},E={follow_up:"bg-blue-100 text-blue-800 border-blue-200",send_coa:"bg-orange-100 text-orange-800 border-orange-200",send_sample:"bg-green-100 text-green-800 border-green-200",send_price:"bg-purple-100 text-purple-800 border-purple-200",custom:"bg-gray-100 text-gray-800 border-gray-200"},S=()=>{const I=g(n),O=y(n),M=[];for(let P=0;P<O;P++)M.push(a.jsx("div",{className:"min-h-24 p-2 bg-gray-50"},`empty-${P}`));for(let P=1;P<=I;P++){const X=new Date(n.getFullYear(),n.getMonth(),P),J=x(X),H=X.toDateString()===new Date().toDateString();M.push(a.jsxs("div",{className:`min-h-24 p-2 border border-gray-200 ${H?"bg-blue-50":"bg-white"} hover:bg-gray-50 transition cursor-pointer`,onClick:()=>{o(X),J.length>0&&(b(J[0]),f(!0))},children:[a.jsx("div",{className:`text-sm font-medium mb-1 ${H?"text-blue-600":"text-gray-900"}`,children:P}),a.jsxs("div",{className:"space-y-1",children:[J.slice(0,3).map(V=>a.jsx("div",{className:`text-xs p-1 rounded border ${E[V.reminder_type]} truncate ${V.is_completed?"opacity-50 line-through":""}`,title:V.title,children:V.title},V.id)),J.length>3&&a.jsxs("div",{className:"text-xs text-gray-500 font-medium",children:["+",J.length-3," more"]})]})]},P))}return M},F=()=>{const I=N(),O=w(),M=_();return a.jsxs("div",{className:"space-y-6",children:[I.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold text-red-600 mb-2 flex items-center gap-2",children:[a.jsx(ea,{className:"w-4 h-4"}),"Overdue (",I.length,")"]}),a.jsx("div",{className:"space-y-2",children:I.map(P=>a.jsx(Qv,{reminder:P,onToggleComplete:v,onViewDetails:()=>{b(P),f(!0)}},P.id))})]}),O.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold text-blue-600 mb-2 flex items-center gap-2",children:[a.jsx(Ra,{className:"w-4 h-4"}),"Today (",O.length,")"]}),a.jsx("div",{className:"space-y-2",children:O.map(P=>a.jsx(Qv,{reminder:P,onToggleComplete:v,onViewDetails:()=>{b(P),f(!0)}},P.id))})]}),M.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Upcoming (Next 7 days)"}),a.jsx("div",{className:"space-y-2",children:M.map(P=>a.jsx(Qv,{reminder:P,onToggleComplete:v,onViewDetails:()=>{b(P),f(!0)}},P.id))})]}),I.length===0&&O.length===0&&M.length===0&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Ra,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.length===0?a.jsx("p",{children:"No reminders found. Create one using the quick actions!"}):a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"No upcoming reminders in the next 7 days"}),a.jsxs("p",{className:"text-sm mt-1",children:["You have ",t.length," reminder",t.length===1?"":"s"," total (all past or completed)"]})]})]})]})};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Na,{className:"w-5 h-5 text-blue-600"}),"Reminders & Tasks"]}),a.jsxs("div",{className:"flex gap-1 bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>c("month"),className:`px-3 py-1 rounded text-sm ${l==="month"?"bg-white shadow":"text-gray-600"}`,children:"Month"}),a.jsx("button",{onClick:()=>c("list"),className:`px-3 py-1 rounded text-sm ${l==="list"?"bg-white shadow":"text-gray-600"}`,children:"List"})]})]}),l==="month"&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:a.jsx(iR,{className:"w-5 h-5"})}),a.jsx("span",{className:"font-semibold min-w-40 text-center",children:n.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),a.jsx("button",{onClick:j,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:a.jsx(Sc,{className:"w-5 h-5"})})]})]}),u?a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l==="month"?a.jsxs("div",{className:"space-y-2",children:[t.length===0&&a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800",children:[a.jsxs("p",{className:"font-medium",children:["No reminders for ",n.toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),a.jsx("p",{className:"text-xs mt-1",children:'Use the arrows above to navigate to other months, or switch to "List" view to see all reminders.'})]}),t.length>0&&a.jsxs("div",{className:"text-sm text-gray-600 px-2",children:[t.length," reminder",t.length===1?"":"s"," in ",n.toLocaleDateString("en-US",{month:"long"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(I=>a.jsx("div",{className:"p-2 text-center text-sm font-semibold text-gray-700 bg-gray-50",children:I},I))}),a.jsx("div",{className:"grid grid-cols-7",children:S()})]})]}):a.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:F()}),a.jsx(qt,{isOpen:h,onClose:()=>{f(!1),b(null)},title:"Reminder Details",children:A&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:`p-3 rounded-lg border ${E[A.reminder_type]}`,children:[a.jsx("p",{className:"font-semibold",children:A.title}),a.jsxs("p",{className:"text-sm mt-1",children:["Due: ",new Date(A.due_date).toLocaleDateString()]})]}),A.description&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:A.description})]}),A.crm_inquiries&&a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Related Inquiry"}),a.jsxs("div",{className:"mt-2 bg-gray-50 p-3 rounded-lg",children:[a.jsxs("p",{className:"text-sm font-medium",children:["#",A.crm_inquiries.inquiry_number]}),a.jsx("p",{className:"text-sm text-gray-600",children:A.crm_inquiries.company_name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:A.crm_inquiries.product_name})]})]}),a.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>p(A,1),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 1 day"}),a.jsx("button",{onClick:()=>p(A,3),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 3 days"})]}),a.jsxs("button",{onClick:()=>{v(A),f(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[a.jsx(yn,{className:"w-4 h-4"}),A.is_completed?"Mark Incomplete":"Mark Complete"]})]})]})})]})}function Qv({reminder:e,onToggleComplete:t,onViewDetails:r}){const n={follow_up:"border-blue-200",send_coa:"border-orange-200",send_sample:"border-green-200",send_price:"border-purple-200",custom:"border-gray-200"},s=new Date(e.due_date)<new Date&&!e.is_completed;return a.jsx("div",{className:`p-3 border-l-4 ${n[e.reminder_type]} bg-white rounded-lg shadow-sm hover:shadow-md transition ${e.is_completed?"opacity-60":""}`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1 cursor-pointer",onClick:r,children:[a.jsx("p",{className:`font-medium ${e.is_completed?"line-through":""}`,children:e.title}),e.crm_inquiries&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["#",e.crm_inquiries.inquiry_number," - ",e.crm_inquiries.company_name]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:`text-xs ${s?"text-red-600 font-medium":"text-gray-500"}`,children:new Date(e.due_date).toLocaleDateString()}),s&&a.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-0.5 rounded-full",children:"Overdue"})]})]}),a.jsx("button",{onClick:()=>t(e),className:`p-1 rounded ${e.is_completed?"text-green-600":"text-gray-400 hover:text-green-600"}`,children:a.jsx(yn,{className:"w-5 h-5"})})]})})}function uAe({canManage:e,onInquiryClick:t}){const[r,n]=W.useState([]),[s,i]=W.useState([]),[o,l]=W.useState(!0),[c,u]=W.useState(null),[d,h]=W.useState(null);W.useEffect(()=>{f(),A()},[]);const f=async()=>{try{u(null);const{data:w,error:N}=await ae.from("crm_pipeline_stages").select("*").eq("is_active",!0).order("stage_order",{ascending:!0});if(N)throw console.error("Database error loading stages:",N),new Error(N.message||"Failed to load pipeline stages");i(w||[])}catch(w){const N=w instanceof Error?w.message:"Failed to load pipeline stages";console.error("Error loading stages:",w),u(N),i([])}},A=async()=>{try{u(null);const{data:w,error:N}=await ae.from("crm_inquiries").select("*").order("created_at",{ascending:!1});if(N)throw console.error("Database error loading inquiries:",N),new Error(N.message||"Failed to load inquiries");n(w||[])}catch(w){const N=w instanceof Error?w.message:"Failed to load inquiries";console.error("Error loading inquiries:",w),u(N),n([])}finally{l(!1)}},b={"New Inquiry":"new","Price Quoted":"price_quoted","COA Pending":"coa_pending","Sample Sent":"sample_sent",Negotiation:"negotiation","PO Received":"po_received",Won:"won",Lost:"lost"},m=w=>{const N=b[w];return r.filter(_=>_.status===N)},v=w=>{e&&h(w)},p=w=>{w.preventDefault()},g=async w=>{if(!d||!e)return;const N=b[w];if(d.status===N){h(null);return}try{const{error:_}=await ae.from("crm_inquiries").update({status:N}).eq("id",d.id);if(_)throw _;A()}catch(_){console.error("Error updating inquiry status:",_),alert("Failed to update inquiry status")}finally{h(null)}},y=w=>{const N=new Date(w.created_at),C=Math.abs(new Date().getTime()-N.getTime());return Math.ceil(C/(1e3*60*60*24))},x={urgent:"border-l-4 border-red-500",high:"border-l-4 border-orange-500",medium:"border-l-4 border-yellow-500",low:"border-l-4 border-gray-400"};return o?a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c?a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"text-red-600 mt-0.5",children:a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-red-900",children:"Error Loading Pipeline"}),a.jsx("p",{className:"text-sm text-red-700 mt-1",children:c}),a.jsx("button",{onClick:()=>{f(),A()},className:"mt-3 text-sm font-medium text-red-700 hover:text-red-800 underline",children:"Try Again"})]})]})})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Pipeline View"}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",r.length," inquiries"]})]}),a.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:s.map(w=>{const N=m(w.stage_name),_=N.reduce((C,j)=>C+(j.estimated_value||0),0);return a.jsxs("div",{className:"flex-shrink-0 w-80 bg-gray-50 rounded-lg",onDragOver:p,onDrop:()=>g(w.stage_name),children:[a.jsxs("div",{className:"p-4 rounded-t-lg",style:{backgroundColor:w.color+"20"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:w.stage_name}),a.jsx("span",{className:"text-sm font-medium text-gray-600",children:N.length})]}),_>0&&a.jsxs("div",{className:"text-xs text-gray-600",children:["Value: Rp ",_.toLocaleString("id-ID")]})]}),a.jsx("div",{className:"p-2 space-y-2 max-h-[600px] overflow-y-auto",children:N.length===0?a.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No inquiries"}):N.map(C=>a.jsxs("div",{draggable:e,onDragStart:()=>v(C),onClick:()=>t&&t(C),className:`bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition cursor-pointer ${x[C.priority]||""} ${e?"cursor-move":""}`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("span",{className:"text-xs font-semibold text-blue-600",children:["#",C.inquiry_number]}),a.jsxs("span",{className:"text-xs text-gray-500",children:[y(C),"d"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(nR,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:C.company_name})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ps,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:C.product_name})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[a.jsx("span",{children:C.quantity}),a.jsx("span",{children:new Date(C.inquiry_date).toLocaleDateString("en-GB")})]}),C.priority==="urgent"&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[a.jsx(ea,{className:"w-3 h-3"}),a.jsx("span",{className:"font-medium",children:"URGENT"})]}),C.estimated_value&&C.estimated_value>0&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 font-medium",children:[a.jsx(El,{className:"w-3 h-3"}),a.jsxs("span",{children:["Rp ",C.estimated_value.toLocaleString("id-ID")]})]})]})]},C.id))})]},w.id)})}),!e&&a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[a.jsx(ea,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-yellow-800",children:"You have view-only access to the pipeline. Contact admin to manage inquiries."})]})]})}function dAe({inquiry:e,onClose:t,onSent:r}){const[n,s]=W.useState([]),[i,o]=W.useState(null),[l,c]=W.useState(""),[u,d]=W.useState(""),[h,f]=W.useState(""),[A,b]=W.useState(!1),[m,v]=W.useState(!1);W.useEffect(()=>{p(),e&&c(e.contact_email||"")},[e]);const p=async()=>{try{const{data:x,error:w}=await ae.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(w)throw w;s(x||[])}catch(x){console.error("Error loading templates:",x)}},g=x=>{let w=x.subject,N=x.body;e&&(w=w.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number),N=N.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"Sir/Madam").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number)),d(w),f(N),o(x),v(!1)},y=async()=>{if(!l||!u||!h){alert("Please fill in all required fields");return}b(!0);try{const{data:{user:x}}=await ae.auth.getUser();if(!x)throw new Error("Not authenticated");const w=l.split(";").map(C=>C.trim()).filter(C=>C.length>0),N={inquiry_id:(e==null?void 0:e.id)||null,contact_id:null,email_type:"sent",from_email:x.email,to_email:w,subject:u,body:h,template_id:(i==null?void 0:i.id)||null,sent_date:new Date().toISOString(),created_by:x.id},{error:_}=await ae.from("crm_email_activities").insert([N]);if(_)throw _;i&&await ae.from("crm_email_templates").update({use_count:i.use_count+1,last_used:new Date().toISOString()}).eq("id",i.id),alert("Email logged successfully! Note: Actual email sending requires SMTP configuration."),r&&r(),t&&t()}catch(x){console.error("Error sending email:",x),alert("Failed to send email. Please try again.")}finally{b(!1)}};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(ha,{className:"w-5 h-5 text-blue-600"}),"Compose Email"]}),a.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:[a.jsx(sr,{className:"w-4 h-4"}),"Use Template"]})]}),e&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[a.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Inquiry #",e.inquiry_number," - ",e.company_name]}),a.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[e.product_name," - ",e.quantity]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To *"}),a.jsx("input",{type:"text",value:l,onChange:x=>c(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"recipient@example.com; recipient2@example.com",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l.includes(";")?`Sending to ${l.split(";").filter(x=>x.trim()).length} email addresses`:"Separate multiple emails with semicolon (;)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),a.jsx("input",{type:"text",value:u,onChange:x=>d(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),a.jsx("textarea",{value:h,onChange:x=>f(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:12,placeholder:"Type your message here...",required:!0})]}),a.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:!0,children:[a.jsx(fo,{className:"w-4 h-4"}),"Attach Files (Coming Soon)"]})}),a.jsxs("div",{className:"flex gap-2",children:[t&&a.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{onClick:y,disabled:A||!l||!u||!h,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:A?a.jsxs(a.Fragment,{children:[a.jsx(Mo,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ri,{className:"w-4 h-4"}),"Send Email"]})})]})]}),a.jsx(qt,{isOpen:m,onClose:()=>v(!1),title:"Email Templates",children:a.jsx("div",{className:"space-y-2",children:n.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(sr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),a.jsx("p",{children:"No templates available"}),a.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):n.map(x=>a.jsxs("div",{onClick:()=>g(x),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:[a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:x.template_name}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:x.subject}),x.category&&a.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:x.category})]})}),x.variables&&x.variables.length>0&&a.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:a.jsxs("p",{className:"text-xs text-gray-500",children:["Variables: ",x.variables.join(", ")]})})]},x.id))})})]})}function AAe({selectedCustomers:e,onClose:t,onComplete:r}){var I;const[n,s]=W.useState([]),[i,o]=W.useState(null),[l,c]=W.useState(""),[u,d]=W.useState(""),[h,f]=W.useState(30),[A,b]=W.useState(!1),[m,v]=W.useState(!1),[p,g]=W.useState([]),[y,x]=W.useState(0);W.useEffect(()=>{N(),w()},[]);const w=()=>{const O=e.map(M=>({customerId:M.id,companyName:M.company_name,email:M.email,status:"pending"}));g(O)},N=async()=>{try{const{data:O,error:M}=await ae.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(M)throw M;s(O||[])}catch(O){console.error("Error loading templates:",O)}},_=O=>{c(O.subject),d(O.body),o(O),v(!1)},C=(O,M)=>O.replace(/\{\{company_name\}\}/g,M.company_name).replace(/\{\{contact_person\}\}/g,M.contact_person||"Sir/Madam"),j=async()=>{if(!l||!u){alert("Please fill in subject and message");return}if(h<10){alert("Please set interval to at least 10 seconds to avoid blocking");return}b(!0),x(0);try{const{data:{user:O}}=await ae.auth.getUser();if(!O)throw new Error("Not authenticated");const{data:M}=await ae.from("gmail_connections").select("*").eq("user_id",O.id).eq("is_connected",!0).maybeSingle();if(!M){alert("Gmail not connected. Please connect Gmail in Settings first."),b(!1);return}for(let X=0;X<e.length;X++){const J=e[X];x(X),g(H=>H.map((V,K)=>K===X?{...V,status:"sending"}:V));try{const H=J.email.split(";").map(Q=>Q.trim()).filter(Q=>Q.length>0),V=C(l,J),K=C(u,J),U=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/send-bulk-email",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY"},body:JSON.stringify({userId:O.id,toEmails:H,subject:V,body:K,contactId:J.id})});if(!U.ok)throw new Error("Failed to send email");const D=await U.json();if(D.success){const Q={contact_id:J.id,email_type:"sent",from_email:O.email,to_email:H,subject:V,body:K,template_id:(i==null?void 0:i.id)||null,sent_date:new Date().toISOString(),created_by:O.id};await ae.from("crm_email_activities").insert([Q]),g(z=>z.map((G,Z)=>Z===X?{...G,status:"success"}:G))}else throw new Error(D.error||"Unknown error");X<e.length-1&&await new Promise(Q=>setTimeout(Q,h*1e3))}catch(H){console.error(`Error sending to ${J.company_name}:`,H),g(V=>V.map((K,B)=>B===X?{...K,status:"error",error:H.message}:K))}}i&&await ae.from("crm_email_templates").update({use_count:i.use_count+e.length,last_used:new Date().toISOString()}).eq("id",i.id);const P=p.filter(X=>X.status==="success").length;alert(`Bulk email completed!
${P} of ${e.length} emails sent successfully.`),r()}catch(O){console.error("Error in bulk email:",O),alert("Failed to complete bulk email. Please check the results.")}finally{b(!1)}},E=p.filter(O=>O.status==="success").length,S=p.filter(O=>O.status==="error").length,F=p.filter(O=>O.status==="pending").length;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(ha,{className:"w-5 h-5 text-blue-600"}),"Bulk Email to Customers"]}),a.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Sending to ",e.length," customers"]})]}),a.jsxs("button",{onClick:()=>v(!0),disabled:A,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50",children:[a.jsx(sr,{className:"w-4 h-4"}),"Use Template"]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[a.jsx(ea,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium",children:"Important: Email Throttling"}),a.jsxs("p",{className:"mt-1",children:["Emails will be sent with ",h,"s intervals to prevent your email account from being blocked. Total time: ~",Math.ceil(e.length*h/60)," minutes"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interval Between Emails (seconds)"}),a.jsx("input",{type:"number",min:"10",max:"300",value:h,onChange:O=>f(Math.max(10,parseInt(O.target.value)||10)),disabled:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 seconds recommended. Higher values are safer for large batches."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),a.jsx("input",{type:"text",value:l,onChange:O=>c(O.target.value),disabled:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",placeholder:"Email subject (use {{company_name}} and {{contact_person}} for personalization)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),a.jsx("textarea",{value:u,onChange:O=>d(O.target.value),disabled:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",rows:10,placeholder:"Type your message here... (use {{company_name}} and {{contact_person}} for personalization)"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables: ","{{company_name}}",", ","{{contact_person}}"]})]}),A&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-blue-900",children:["Sending email ",y+1," of ",e.length]}),a.jsxs("p",{className:"text-sm text-blue-700",children:["Current: ",(I=e[y])==null?void 0:I.company_name]})]})]}),a.jsxs("div",{className:"flex gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-1 text-green-700",children:[a.jsx(yn,{className:"w-4 h-4"}),"Success: ",E]}),a.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[a.jsx(un,{className:"w-4 h-4"}),"Failed: ",S]}),a.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[a.jsx(Ra,{className:"w-4 h-4"}),"Pending: ",F]})]})]}),p.some(O=>O.status!=="pending")&&a.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b",children:a.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Send Results"})}),a.jsx("div",{className:"max-h-64 overflow-y-auto",children:p.map((O,M)=>a.jsxs("div",{className:`px-4 py-2 border-b last:border-b-0 flex items-center justify-between ${O.status==="success"?"bg-green-50":O.status==="error"?"bg-red-50":O.status==="sending"?"bg-blue-50":""}`,children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:O.companyName}),a.jsx("p",{className:"text-xs text-gray-600",children:O.email}),O.error&&a.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.error})]}),a.jsxs("div",{children:[O.status==="success"&&a.jsx(yn,{className:"w-5 h-5 text-green-600"}),O.status==="error"&&a.jsx(un,{className:"w-5 h-5 text-red-600"}),O.status==="sending"&&a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),O.status==="pending"&&a.jsx(Ra,{className:"w-5 h-5 text-gray-400"})]})]},M))})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{onClick:t,disabled:A,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:A?"Sending...":"Cancel"}),a.jsxs("button",{onClick:j,disabled:A||!l||!u,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(Ri,{className:"w-4 h-4"}),A?"Sending...":"Start Bulk Send"]})]}),a.jsx(qt,{isOpen:m,onClose:()=>v(!1),title:"Email Templates",children:a.jsx("div",{className:"space-y-2",children:n.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(sr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),a.jsx("p",{children:"No templates available"}),a.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):n.map(O=>a.jsx("div",{onClick:()=>_(O),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-900",children:O.template_name}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:O.subject}),O.category&&a.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:O.category})]})})},O.id))})})]})}function fAe(){const[e,t]=W.useState([]),[r,n]=W.useState([]),[s,i]=W.useState(!0),[o,l]=W.useState(null),[c,u]=W.useState(""),[d,h]=W.useState(new Set),[f,A]=W.useState(!1),[b,m]=W.useState(""),[v,p]=W.useState(""),[g,y]=W.useState(""),[x,w]=W.useState({created_at:110,company_name:200,contact_person:150,designation:120,email:180,mobile:130,landline:130,phone:130,country:120,city:120,address:200,website:150,customer_type:120,notes:200}),[N,_]=W.useState(null),C=W.useRef(null);W.useEffect(()=>{j()},[]),W.useEffect(()=>{if(N){const z=Z=>{const R=Z.clientX-N.startX,le=Math.max(80,N.startWidth+R);w(ee=>({...ee,[N.column]:le}))},G=()=>{_(null)};return document.addEventListener("mousemove",z),document.addEventListener("mouseup",G),()=>{document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",G)}}},[N]);const j=async()=>{try{const{data:z,error:G}=await ae.from("crm_contacts").select("*").order("company_name");if(G)throw G;t(z||[]),n(z||[])}catch(z){console.error("Error loading customers:",z)}finally{i(!1)}};W.useEffect(()=>{let z=[...e];if(b){const G=b.toLowerCase();z=z.filter(Z=>{var R,le,ee,_e;return((R=Z.company_name)==null?void 0:R.toLowerCase().includes(G))||((le=Z.contact_person)==null?void 0:le.toLowerCase().includes(G))||((ee=Z.email)==null?void 0:ee.toLowerCase().includes(G))||((_e=Z.city)==null?void 0:_e.toLowerCase().includes(G))})}v&&(z=z.filter(G=>G.city===v)),g&&(z=z.filter(G=>G.customer_type===g)),n(z)},[b,v,g,e]);const E=Array.from(new Set(e.map(z=>z.city).filter(Boolean))).sort(),S=Array.from(new Set(e.map(z=>z.customer_type).filter(Boolean))).sort(),F=(z,G)=>{l({rowId:z.id,field:G}),u(z[G]||"")},I=async()=>{if(o)try{const{error:z}=await ae.from("crm_contacts").update({[o.field]:c||null}).eq("id",o.rowId);if(z)throw z;t(G=>G.map(Z=>Z.id===o.rowId?{...Z,[o.field]:c||null}:Z))}catch(z){console.error("Error updating customer:",z),alert("Failed to update customer")}finally{l(null),u("")}},O=z=>{z.key==="Enter"?(z.preventDefault(),I()):z.key==="Escape"&&(l(null),u(""))},M=async()=>{try{const{data:{user:z}}=await ae.auth.getUser();if(!z)throw new Error("Not authenticated");const{data:G,error:Z}=await ae.from("crm_contacts").insert({company_name:"New Customer",is_active:!0,created_by:z.id}).select().single();if(Z)throw Z;t(R=>[G,...R])}catch(z){console.error("Error adding customer:",z),alert("Failed to add customer")}},P=async()=>{if(d.size!==0&&confirm(`Delete ${d.size} customer(s)?`))try{const{error:z}=await ae.from("crm_contacts").delete().in("id",Array.from(d));if(z)throw z;t(G=>G.filter(Z=>!d.has(Z.id))),h(new Set)}catch(z){console.error("Error deleting customers:",z),alert("Failed to delete customers")}},X=z=>{h(G=>{const Z=new Set(G);return Z.has(z)?Z.delete(z):Z.add(z),Z})},J=()=>{d.size===r.length?h(new Set):h(new Set(r.map(z=>z.id)))},H=z=>{const G=new Date(z),Z=G.getDate().toString().padStart(2,"0"),R=(G.getMonth()+1).toString().padStart(2,"0"),le=G.getFullYear();return`${Z}-${R}-${le}`},V=()=>{const z=["Date","Company Name","Contact Person","Designation","Email","Mobile","Landline","Phone","Country","City","Address","Website","Customer Type","Notes"],G=e.map(_e=>[H(_e.created_at),_e.company_name,_e.contact_person||"",_e.designation||"",_e.email||"",_e.mobile||"",_e.landline||"",_e.phone||"",_e.country||"",_e.city||"",_e.address||"",_e.website||"",_e.customer_type||"",_e.notes||""]),Z=[z,...G].map(_e=>_e.map(se=>`"${se}"`).join(",")).join(`
`),R=new Blob([Z],{type:"text/csv"}),le=URL.createObjectURL(R),ee=document.createElement("a");ee.href=le,ee.download=`customers_${new Date().toISOString().split("T")[0]}.csv`,ee.click()},K=async z=>{var Z;const G=(Z=z.target.files)==null?void 0:Z[0];if(G){try{const{data:{user:R}}=await ae.auth.getUser();if(!R)throw new Error("Not authenticated");const ee=(await G.text()).split(`
`).filter(Ee=>Ee.trim());if(ee.length<2){alert("CSV file is empty or invalid");return}const _e=ee[0].split(",").map(Ee=>Ee.replace(/"/g,"").trim()),se=ee.slice(1),te=_e.findIndex(Ee=>Ee.toLowerCase()==="date"),Ne=_e.findIndex(Ee=>Ee.toLowerCase()==="company name"),Se=_e.findIndex(Ee=>Ee.toLowerCase()==="contact person"),Ae=_e.findIndex(Ee=>Ee.toLowerCase()==="designation"),ye=_e.findIndex(Ee=>Ee.toLowerCase()==="email"),Le=_e.findIndex(Ee=>Ee.toLowerCase()==="mobile"),Re=_e.findIndex(Ee=>Ee.toLowerCase()==="landline"),we=_e.findIndex(Ee=>Ee.toLowerCase()==="phone"),Pe=_e.findIndex(Ee=>Ee.toLowerCase()==="country"),ze=_e.findIndex(Ee=>Ee.toLowerCase()==="city"),Ve=_e.findIndex(Ee=>Ee.toLowerCase()==="address"),lt=_e.findIndex(Ee=>Ee.toLowerCase()==="website"),pe=_e.findIndex(Ee=>Ee.toLowerCase()==="customer type"),Fe=_e.findIndex(Ee=>Ee.toLowerCase()==="notes");if(Ne===-1){alert('CSV must have a "Company Name" column');return}const Ke=Ee=>{const Je=[];let rt="",Ze=!1;for(let xt=0;xt<Ee.length;xt++){const mt=Ee[xt];mt==='"'?Ze=!Ze:mt===","&&!Ze?(Je.push(rt.trim()),rt=""):rt+=mt}return Je.push(rt.trim()),Je},Xe=Ee=>{if(!Ee)return new Date().toISOString();const Je=[/^(\d{1,2})-(\d{1,2})-(\d{4})$/,/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,/^(\d{4})-(\d{1,2})-(\d{1,2})$/];for(const rt of Je){const Ze=Ee.match(rt);if(Ze){let xt,mt,bt;return rt.toString().includes("\\d{4}$")?[,xt,mt,bt]=Ze:[,bt,mt,xt]=Ze,new Date(`${bt}-${mt.padStart(2,"0")}-${xt.padStart(2,"0")}`).toISOString()}}return new Date().toISOString()},tt=se.map(Ee=>{var xt,mt,bt,vt,Nt,Bt,tr,Ma,rr,dn,ta,Pt,qn,ra;const Je=Ke(Ee),rt=(xt=Je[Ne])==null?void 0:xt.replace(/"/g,"").trim();if(!rt)return null;const Ze=te!==-1?Xe((mt=Je[te])==null?void 0:mt.replace(/"/g,"").trim()):new Date().toISOString();return{company_name:rt,contact_person:Se!==-1&&((bt=Je[Se])==null?void 0:bt.replace(/"/g,"").trim())||null,designation:Ae!==-1&&((vt=Je[Ae])==null?void 0:vt.replace(/"/g,"").trim())||null,email:ye!==-1&&((Nt=Je[ye])==null?void 0:Nt.replace(/"/g,"").trim())||null,mobile:Le!==-1&&((Bt=Je[Le])==null?void 0:Bt.replace(/"/g,"").trim())||null,landline:Re!==-1&&((tr=Je[Re])==null?void 0:tr.replace(/"/g,"").trim())||null,phone:we!==-1&&((Ma=Je[we])==null?void 0:Ma.replace(/"/g,"").trim())||null,country:Pe!==-1&&((rr=Je[Pe])==null?void 0:rr.replace(/"/g,"").trim())||null,city:ze!==-1&&((dn=Je[ze])==null?void 0:dn.replace(/"/g,"").trim())||null,address:Ve!==-1&&((ta=Je[Ve])==null?void 0:ta.replace(/"/g,"").trim())||null,website:lt!==-1&&((Pt=Je[lt])==null?void 0:Pt.replace(/"/g,"").trim())||null,customer_type:pe!==-1&&((qn=Je[pe])==null?void 0:qn.replace(/"/g,"").trim())||null,notes:Fe!==-1&&((ra=Je[Fe])==null?void 0:ra.replace(/"/g,"").trim())||null,is_active:!0,created_by:R.id,created_at:Ze}}).filter(Boolean);if(tt.length===0){alert("No valid customer data found in CSV");return}const{data:st,error:ke}=await ae.from("crm_contacts").insert(tt).select();if(ke)throw ke;alert(`Successfully imported ${tt.length} customer(s)`),j()}catch(R){console.error("Error importing CSV:",R),alert("Failed to import CSV. Please check the file format.")}z.target.value=""}},B=z=>{const G=new Date(z),Z=G.getDate().toString().padStart(2,"0"),R=(G.getMonth()+1).toString().padStart(2,"0"),le=G.getFullYear();return`${Z}-${R}-${le}`},L=(z,G)=>{const Z=(o==null?void 0:o.rowId)===z.id&&(o==null?void 0:o.field)===G,R=z[G];return G==="created_at"?a.jsx("div",{className:"px-2 py-1 h-full flex items-center",children:a.jsx("span",{className:"truncate text-xs",children:B(z.created_at)})}):Z?a.jsx("input",{type:"text",value:c,onChange:le=>u(le.target.value),onBlur:I,onKeyDown:O,autoFocus:!0,className:"w-full h-full px-2 py-1 border-2 border-blue-500 focus:outline-none bg-white"}):a.jsx("div",{onDoubleClick:()=>F(z,G),className:"px-2 py-1 cursor-cell hover:bg-gray-50 h-full flex items-center",title:"Double-click to edit",children:G==="is_active"?a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${R?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:R?"Active":"Inactive"}):a.jsx("span",{className:"truncate",children:(R==null?void 0:R.toString())||"-"})})},U=(z,G)=>{z.preventDefault(),_({column:G,startX:z.clientX,startWidth:x[G]})},D=()=>{if(Array.from(d).map(G=>e.find(Z=>Z.id===G)).filter(G=>!!G&&!!G.email).length===0){alert("Please select customers with email addresses");return}A(!0)},Q=()=>Array.from(d).map(z=>e.find(G=>G.id===z)).filter(z=>!!z&&!!z.email).map(z=>({id:z.id,company_name:z.company_name,email:z.email,contact_person:z.contact_person}));return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading customers..."}):a.jsxs("div",{className:"flex flex-col h-full bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex flex-col gap-3 px-4 py-3 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:M,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[a.jsx(Rr,{className:"w-3.5 h-3.5"}),"Add Customer"]}),d.size>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:D,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-green-600 border border-green-700 rounded-md hover:bg-green-700 transition",children:[a.jsx(Ri,{className:"w-3.5 h-3.5"}),"Send Email (",d.size,")"]}),a.jsxs("button",{onClick:P,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",children:[a.jsx(nn,{className:"w-3.5 h-3.5"}),"Delete (",d.size,")"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[a.jsx(SA,{className:"w-3.5 h-3.5"}),"Import CSV",a.jsx("input",{type:"file",accept:".csv",onChange:K,className:"hidden"})]}),a.jsxs("button",{onClick:V,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[a.jsx(Ai,{className:"w-3.5 h-3.5"}),"Export CSV"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(ls,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:b,onChange:z=>m(z.target.value),placeholder:"Search by company, contact person, email, or city...",className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("select",{value:v,onChange:z=>p(z.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"All Cities"}),E.map(z=>a.jsx("option",{value:z,children:z},z))]}),a.jsxs("select",{value:g,onChange:z=>y(z.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"All Types"}),S.map(z=>a.jsx("option",{value:z,children:z},z))]}),(b||v||g)&&a.jsx("button",{onClick:()=>{m(""),p(""),y("")},className:"px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Clear Filters"})]})]}),a.jsx("div",{ref:C,className:"flex-1 overflow-auto",style:{maxHeight:"calc(100vh - 250px)"},children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{className:"sticky top-0 bg-gray-50 z-10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 w-10",children:a.jsx("input",{type:"checkbox",checked:d.size===r.length&&r.length>0,onChange:J,className:"rounded"})}),[{key:"created_at",label:"Date"},{key:"company_name",label:"Company Name"},{key:"contact_person",label:"Contact Person"},{key:"designation",label:"Designation"},{key:"email",label:"Email"},{key:"mobile",label:"Mobile"},{key:"landline",label:"Landline"},{key:"phone",label:"Phone"},{key:"country",label:"Country"},{key:"city",label:"City"},{key:"address",label:"Address"},{key:"website",label:"Website"},{key:"customer_type",label:"Type"},{key:"notes",label:"Notes"}].map(({key:z,label:G})=>a.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 text-left text-xs font-semibold text-gray-700 relative",style:{width:x[z],minWidth:x[z]},children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{children:G}),a.jsx("div",{onMouseDown:Z=>U(Z,z),className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 hover:w-1.5 transition-all",style:{touchAction:"none"}})]})},z))]})}),a.jsx("tbody",{children:r.map(z=>a.jsxs("tr",{className:`${d.has(z.id)?"bg-blue-50":"hover:bg-gray-50"} transition`,children:[a.jsx("td",{className:"border border-gray-300 px-2 py-1 text-center",children:a.jsx("input",{type:"checkbox",checked:d.has(z.id),onChange:()=>X(z.id),className:"rounded"})}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.created_at},children:L(z,"created_at")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.company_name},children:L(z,"company_name")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.contact_person},children:L(z,"contact_person")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.designation},children:L(z,"designation")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.email},children:L(z,"email")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.mobile},children:L(z,"mobile")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.landline},children:L(z,"landline")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.phone},children:L(z,"phone")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.country},children:L(z,"country")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.city},children:L(z,"city")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.address},children:L(z,"address")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.website},children:L(z,"website")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.customer_type},children:L(z,"customer_type")}),a.jsx("td",{className:"border border-gray-300 h-8",style:{width:x.notes},children:L(z,"notes")})]},z.id))})]})}),a.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 text-sm text-gray-600",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{children:[r.length," customer(s)",r.length!==e.length&&` (filtered from ${e.length} total)`,d.size>0&&`  ${d.size} selected`]}),a.jsx("span",{className:"text-xs text-gray-500",children:"Double-click any cell to edit  Drag column borders to resize"})]})}),a.jsx(qt,{isOpen:f,onClose:()=>{A(!1),h(new Set)},title:"Bulk Email",children:a.jsx(AAe,{selectedCustomers:Q(),onClose:()=>{A(!1),h(new Set)},onComplete:()=>{A(!1),h(new Set),j()}})})]})}function hAe({inquiryId:e,customerId:t,leadId:r,onActivityLogged:n}){const{profile:s}=jr(),{t:i}=kn(),[o,l]=W.useState([]),[c,u]=W.useState(!0),[d,h]=W.useState(!1),[f,A]=W.useState({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1});W.useEffect(()=>{b()},[e,t,r]);const b=async()=>{try{let w=ae.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name)").order("created_at",{ascending:!1});r&&(w=w.eq("lead_id",r)),t&&(w=w.eq("customer_id",t));const{data:N,error:_}=await w;if(_)throw _;l(N||[])}catch(w){console.error("Error loading activities:",w)}finally{u(!1)}},m=async w=>{w.preventDefault();try{const{data:{user:N}}=await ae.auth.getUser();if(!N)throw new Error("Not authenticated");const _={...f,created_by:N.id,follow_up_date:f.follow_up_date||null,completed_at:f.is_completed?new Date().toISOString():null};r&&(_.lead_id=r),t&&(_.customer_id=t);const{error:C}=await ae.from("crm_activities").insert([_]);if(C)throw C;h(!1),A({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1}),b(),n==null||n()}catch(N){console.error("Error logging activity:",N),alert("Failed to log activity. Please try again.")}},v=async w=>{try{const{error:N}=await ae.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",w);if(N)throw N;b()}catch(N){console.error("Error completing activity:",N),alert("Failed to complete activity. Please try again.")}},p=async w=>{if(confirm("Are you sure you want to delete this activity? This action cannot be undone."))try{const{error:N}=await ae.from("crm_activities").delete().eq("id",w);if(N)throw N;b(),n==null||n()}catch(N){console.error("Error deleting activity:",N),alert("Failed to delete activity. Please try again.")}},g=w=>{switch(w){case"phone_call":return a.jsx(Fl,{className:"w-5 h-5"});case"meeting":return a.jsx(Na,{className:"w-5 h-5"});case"email":return a.jsx(S0,{className:"w-5 h-5"});case"note":return a.jsx(sr,{className:"w-5 h-5"});case"video_call":return a.jsx(IF,{className:"w-5 h-5"});case"whatsapp":return a.jsx(xR,{className:"w-5 h-5"});default:return a.jsx(sr,{className:"w-5 h-5"})}},y=w=>{switch(w){case"phone_call":return"bg-blue-50 text-blue-600 border-blue-200";case"meeting":return"bg-purple-50 text-purple-600 border-purple-200";case"email":return"bg-green-50 text-green-600 border-green-200";case"note":return"bg-gray-50 text-gray-600 border-gray-200";case"video_call":return"bg-indigo-50 text-indigo-600 border-indigo-200";case"whatsapp":return"bg-emerald-50 text-emerald-600 border-emerald-200";default:return"bg-gray-50 text-gray-600 border-gray-200"}},x=w=>({phone_call:"Phone Call",meeting:"Meeting",email:"Email",note:"Note",video_call:"Video Call",whatsapp:"WhatsApp"})[w]||w;return c?a.jsx("div",{className:"flex justify-center py-8",children:"Loading activities..."}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Log"}),a.jsxs("button",{onClick:()=>h(!d),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-4 h-4"}),"Log Activity"]})]}),d&&a.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:a.jsxs("form",{onSubmit:m,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activity Type *"}),a.jsxs("select",{value:f.activity_type,onChange:w=>A({...f,activity_type:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"phone_call",children:"Phone Call"}),a.jsx("option",{value:"meeting",children:"Meeting"}),a.jsx("option",{value:"email",children:"Email"}),a.jsx("option",{value:"note",children:"Note"}),a.jsx("option",{value:"video_call",children:"Video Call"}),a.jsx("option",{value:"whatsapp",children:"WhatsApp (Coming Soon)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),a.jsx("input",{type:"text",value:f.subject,onChange:w=>A({...f,subject:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Brief description",required:!0})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:f.description,onChange:w=>A({...f,description:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Detailed notes about the conversation or activity"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date"}),a.jsx("input",{type:"datetime-local",value:f.follow_up_date,onChange:w=>A({...f,follow_up_date:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsx("div",{className:"flex items-center",children:a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:f.is_completed,onChange:w=>A({...f,is_completed:w.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Mark as completed"})]})})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Log Activity"})]})]})}),a.jsx("div",{className:"space-y-3",children:o.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No activities logged yet. Start by logging your first activity!"}):o.map(w=>a.jsx("div",{className:`border rounded-lg p-4 ${w.is_completed?"bg-gray-50 border-gray-200":"bg-white border-gray-300"}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:`p-2 rounded-lg border ${y(w.activity_type)}`,children:g(w.activity_type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:w.subject}),w.is_completed&&a.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded",children:[a.jsx(yn,{className:"w-3 h-3"}),"Completed"]})]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[x(w.activity_type),"  ",new Date(w.created_at).toLocaleString()]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[!w.is_completed&&w.follow_up_date&&a.jsx("button",{onClick:()=>v(w.id),className:"text-sm px-3 py-1 text-green-600 hover:bg-green-50 rounded-lg transition",children:"Mark Complete"}),a.jsx("button",{onClick:()=>p(w.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",title:"Delete activity",children:a.jsx(nn,{className:"w-4 h-4"})})]})]}),w.description&&a.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:w.description}),w.follow_up_date&&!w.is_completed&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-orange-600",children:[a.jsx(Ra,{className:"w-4 h-4"}),"Follow-up: ",new Date(w.follow_up_date).toLocaleString()]}),w.user_profiles&&a.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["by ",w.user_profiles.full_name]})]})]})},w.id))})]})}function pAe({customerId:e,leadId:t,onAppointmentCreated:r}){const{profile:n}=jr(),[s,i]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState(!0),[d,h]=W.useState(!1),[f,A]=W.useState(null),[b,m]=W.useState({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||""});W.useEffect(()=>{p(),!e&&!t&&v()},[e,t]);const v=async()=>{try{const{data:j,error:E}=await ae.from("crm_contacts").select("id, company_name").order("company_name",{ascending:!0});if(E)throw E;l(j||[])}catch(j){console.error("Error loading contacts:",j)}},p=async()=>{try{let j=ae.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name), crm_contacts(company_name)").in("activity_type",["meeting","video_call","phone_call"]).not("follow_up_date","is",null).order("follow_up_date",{ascending:!0});e?j=j.eq("customer_id",e):t&&(j=j.eq("lead_id",t));const{data:E,error:S}=await j;if(S)throw S;i(E||[])}catch(j){console.error("Error loading appointments:",j)}finally{u(!1)}},g=async j=>{j.preventDefault();try{const{data:{user:E}}=await ae.auth.getUser();if(!E)throw new Error("Not authenticated");const S={activity_type:b.activity_type,subject:b.subject,description:b.description||null,follow_up_date:b.follow_up_date,is_completed:!1,created_by:E.id};if(e?S.customer_id=e:t?S.lead_id=t:b.customer_id&&(S.customer_id=b.customer_id),f){const{error:F}=await ae.from("crm_activities").update(S).eq("id",f.id);if(F)throw F}else{const{error:F}=await ae.from("crm_activities").insert([S]);if(F)throw F}h(!1),A(null),m({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:""}),p(),r==null||r()}catch(E){console.error("Error saving appointment:",E),alert("Failed to save appointment. Please try again.")}},y=j=>{A(j),m({activity_type:j.activity_type,subject:j.subject,description:j.description||"",follow_up_date:j.follow_up_date,location:"",customer_id:j.customer_id||e||""}),h(!0)},x=async j=>{if(confirm("Are you sure you want to delete this appointment?"))try{const{error:E}=await ae.from("crm_activities").delete().eq("id",j);if(E)throw E;p()}catch(E){console.error("Error deleting appointment:",E),alert("Failed to delete appointment. Please try again.")}},w=async j=>{try{const{error:E}=await ae.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",j);if(E)throw E;p()}catch(E){console.error("Error completing appointment:",E),alert("Failed to complete appointment. Please try again.")}},N=j=>{switch(j){case"meeting":return a.jsx(Na,{className:"w-5 h-5"});case"video_call":return a.jsx(IF,{className:"w-5 h-5"});case"phone_call":return a.jsx(Fl,{className:"w-5 h-5"});default:return a.jsx(Na,{className:"w-5 h-5"})}},_=j=>{if(j.is_completed)return"bg-gray-50 border-gray-200 text-gray-600";const E=new Date,S=new Date(j.follow_up_date);return S<E?"bg-red-50 border-red-200 text-red-700":S<new Date(E.getTime()+24*60*60*1e3)?"bg-orange-50 border-orange-200 text-orange-700":"bg-blue-50 border-blue-200 text-blue-700"},C=j=>({meeting:"In-Person Meeting",video_call:"Video Call",phone_call:"Phone Call"})[j]||j;return c?a.jsx("div",{className:"flex justify-center py-8",children:"Loading appointments..."}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Appointments & Meetings"}),a.jsxs("button",{onClick:()=>{A(null),m({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||""}),h(!d)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-4 h-4"}),"Schedule Appointment"]})]}),d&&a.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[!e&&!t&&a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsxs("select",{value:b.customer_id,onChange:j=>m({...b,customer_id:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select a customer..."}),o.map(j=>a.jsx("option",{value:j.id,children:j.company_name},j.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Type *"}),a.jsxs("select",{value:b.activity_type,onChange:j=>m({...b,activity_type:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"meeting",children:"In-Person Meeting"}),a.jsx("option",{value:"video_call",children:"Video Call"}),a.jsx("option",{value:"phone_call",children:"Phone Call"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date & Time *"}),a.jsx("input",{type:"datetime-local",value:b.follow_up_date,onChange:j=>m({...b,follow_up_date:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),a.jsx("input",{type:"text",value:b.subject,onChange:j=>m({...b,subject:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Product demonstration, Price negotiation",required:!0})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description / Agenda"}),a.jsx("textarea",{value:b.description,onChange:j=>m({...b,description:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Meeting agenda, discussion points, etc."})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{h(!1),A(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:f?"Update Appointment":"Schedule Appointment"})]})]})}),a.jsx("div",{className:"space-y-3",children:s.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No appointments scheduled. Create your first appointment!"}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Upcoming Appointments"}),s.filter(j=>!j.is_completed&&new Date(j.follow_up_date)>=new Date).map(j=>a.jsx("div",{className:`border rounded-lg p-4 ${_(j)}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:N(j.activity_type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:j.subject}),j.crm_contacts&&a.jsx("p",{className:"text-sm font-medium text-blue-600 mt-1",children:j.crm_contacts.company_name}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:C(j.activity_type)}),a.jsxs("p",{className:"text-sm font-medium mt-1 flex items-center gap-1",children:[a.jsx(Ra,{className:"w-4 h-4"}),new Date(j.follow_up_date).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>y(j),className:"p-1 hover:bg-white rounded transition",title:"Edit",children:a.jsx(Pg,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>x(j.id),className:"p-1 hover:bg-white rounded transition",title:"Delete",children:a.jsx(nn,{className:"w-4 h-4"})})]})]}),j.description&&a.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:j.description}),a.jsx("div",{className:"mt-3 flex gap-2",children:a.jsx("button",{onClick:()=>w(j.id),className:"text-xs px-3 py-1 bg-white border border-current rounded hover:bg-gray-50 transition",children:"Mark as Completed"})})]})]})},j.id))]}),s.filter(j=>j.is_completed||new Date(j.follow_up_date)<new Date).length>0&&a.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Past Appointments"}),s.filter(j=>j.is_completed||new Date(j.follow_up_date)<new Date).map(j=>a.jsx("div",{className:"border rounded-lg p-4 bg-gray-50 border-gray-200",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 text-gray-400",children:N(j.activity_type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-gray-700",children:j.subject}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[C(j.activity_type),"  ",new Date(j.follow_up_date).toLocaleDateString()]})]})]})},j.id))]})]})})]})}function mAe({canManage:e,onRefresh:t}){const{profile:r}=jr(),[n,s]=W.useState([]),[i,o]=W.useState([]),[l,c]=W.useState(!0),[u,d]=W.useState(""),[h,f]=W.useState(null),[A,b]=W.useState(!1);W.useEffect(()=>{m()},[]),W.useEffect(()=>{if(u){const g=n.filter(y=>y.inquiry_number.toLowerCase().includes(u.toLowerCase())||y.company_name.toLowerCase().includes(u.toLowerCase())||y.product_name.toLowerCase().includes(u.toLowerCase())||y.lost_reason&&y.lost_reason.toLowerCase().includes(u.toLowerCase()));o(g)}else o(n)},[u,n]);const m=async()=>{try{const{data:g,error:y}=await ae.from("crm_inquiries").select("*").eq("pipeline_status","lost").order("lost_at",{ascending:!1});if(y)throw y;s(g||[]),o(g||[])}catch(g){console.error("Error loading archived inquiries:",g)}finally{c(!1)}},v=async g=>{if(confirm(`Reopen inquiry #${g.inquiry_number} and move it back to active deals?`))try{const{error:y}=await ae.from("crm_inquiries").update({pipeline_status:"in_progress",lost_reason:null,lost_at:null,competitor_name:null,competitor_price:null}).eq("id",g.id);if(y)throw y;alert("Inquiry reopened and moved to active deals!"),m(),t()}catch(y){console.error("Error reopening inquiry:",y),alert("Failed to reopen inquiry. Please try again.")}},p=()=>{try{const g=i.map(N=>({"Inquiry No.":N.inquiry_number,Date:new Date(N.inquiry_date).toLocaleDateString("en-GB"),Company:N.company_name,Product:N.product_name,Qty:N.quantity,"Offered Price":N.offered_price?`${N.offered_price} ${N.offered_price_currency}`:"-",Supplier:N.supplier_name||"-","Lost Reason":N.lost_reason||"-",Competitor:N.competitor_name||"-","Competitor Price":N.competitor_price?`$${N.competitor_price}`:"-","Lost Date":N.lost_at?new Date(N.lost_at).toLocaleDateString("en-GB"):"-",Remarks:N.remarks||"-"})),y=Ya.json_to_sheet(g);y["!cols"]=[{wch:12},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:20},{wch:40},{wch:20},{wch:15},{wch:12},{wch:30}];const x=Ya.book_new();Ya.book_append_sheet(x,y,"Lost Deals Archive");const w=`Archive-Lost-Deals-${new Date().toISOString().split("T")[0]}.xlsx`;mx(x,w),alert(`Exported ${g.length} archived inquiries to ${w}`)}catch(g){console.error("Export error:",g),alert("Failed to export data. Please try again.")}};return l?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(un,{className:"w-6 h-6 text-red-600"}),"Lost Deals Archive"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View history of lost inquiries and analyze reasons for improvement"})]}),a.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[a.jsx(Ai,{className:"w-4 h-4"}),"Export to Excel"]})]}),a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:u,onChange:g=>d(g.target.value),placeholder:"Search by inquiry no, company, product, or lost reason...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-semibold",children:i.length})," archived inquiries"]})]})}),i.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(un,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-500",children:u?"No archived inquiries match your search.":"No archived inquiries yet."})]}):a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"No."}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),(r==null?void 0:r.role)==="admin"&&a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Offered"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Reason"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map(g=>a.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[a.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:g.inquiry_number}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(g.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:g.company_name}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:g.product_name}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:g.quantity}),(r==null?void 0:r.role)==="admin"&&a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:g.offered_price?`$${g.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:g.supplier_name||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:a.jsxs("div",{className:"max-w-xs",children:[a.jsx("p",{className:"text-gray-900 line-clamp-2",children:g.lost_reason||"-"}),g.competitor_name&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Competitor: ",g.competitor_name,g.competitor_price&&` ($${g.competitor_price})`]})]})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:g.lost_at?new Date(g.lost_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{f(g),b(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",title:"View Details",children:a.jsx(Kc,{className:"w-4 h-4"})}),e&&a.jsx("button",{onClick:()=>v(g),className:"p-1 text-green-600 hover:bg-green-50 rounded transition",title:"Reopen Deal",children:a.jsx(Jb,{className:"w-4 h-4"})})]})})]},g.id))})]})})}),h&&a.jsx(qt,{isOpen:A,onClose:()=>{b(!1),f(null)},title:`Inquiry #${h.inquiry_number} - Details`,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 pb-4 border-b",children:[a.jsx(lL,{status:"lost"}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Lost on ",h.lost_at?new Date(h.lost_at).toLocaleDateString("en-GB"):"N/A"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Company"}),a.jsx("p",{className:"text-sm text-gray-900",children:h.company_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Product"}),a.jsx("p",{className:"text-sm text-gray-900",children:h.product_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Quantity"}),a.jsx("p",{className:"text-sm text-gray-900",children:h.quantity})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Supplier"}),a.jsx("p",{className:"text-sm text-gray-900",children:h.supplier_name||"-"})]}),(r==null?void 0:r.role)==="admin"&&h.offered_price&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Offered Price"}),a.jsxs("p",{className:"text-sm text-gray-900",children:["$",h.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})," ",h.offered_price_currency]})]})]}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(ea,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-sm font-medium text-red-900 mb-1",children:"Lost Reason"}),a.jsx("p",{className:"text-sm text-red-800",children:h.lost_reason||"No reason provided"}),h.competitor_name&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-red-200",children:[a.jsx("p",{className:"text-xs font-medium text-red-900 mb-1",children:"Competitor Information"}),a.jsxs("p",{className:"text-sm text-red-800",children:[h.competitor_name,h.competitor_price&&` - $${h.competitor_price.toLocaleString("en-US",{minimumFractionDigits:2})}`]})]})]})]})}),h.remarks&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Remarks"}),a.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 rounded p-3",children:h.remarks})]}),e&&a.jsx("div",{className:"flex justify-end pt-4 border-t",children:a.jsxs("button",{onClick:()=>{v(h),b(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[a.jsx(Jb,{className:"w-4 h-4"}),"Reopen This Deal"]})})]})})]})}function cL({onSubmit:e,onCancel:t,initialData:r,isEditing:n=!1}){const[s,i]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState(""),[d,h]=W.useState(!1),[f,A]=W.useState(!1),[b,m]=W.useState(!1),v=W.useRef(null),[p,g]=W.useState({product_name:(r==null?void 0:r.product_name)||"",specification:(r==null?void 0:r.specification)||"",quantity:(r==null?void 0:r.quantity)||"",priority:(r==null?void 0:r.priority)||"medium",inquiry_source:(r==null?void 0:r.inquiry_source)||"email",supplier_name:(r==null?void 0:r.supplier_name)||"",supplier_country:(r==null?void 0:r.supplier_country)||"",customer_id:(r==null?void 0:r.customer_id)||"",company_name:(r==null?void 0:r.company_name)||"",contact_person:(r==null?void 0:r.contact_person)||"",contact_email:(r==null?void 0:r.contact_email)||"",contact_phone:(r==null?void 0:r.contact_phone)||"",price_required:(r==null?void 0:r.price_required)||!1,coa_required:(r==null?void 0:r.coa_required)||!1,sample_required:(r==null?void 0:r.sample_required)||!1,agency_letter_required:(r==null?void 0:r.agency_letter_required)||!1,others_required:(r==null?void 0:r.others_required)||!1,purchase_price:(r==null?void 0:r.purchase_price)||"",purchase_price_currency:(r==null?void 0:r.purchase_price_currency)||"USD",offered_price:(r==null?void 0:r.offered_price)||"",offered_price_currency:(r==null?void 0:r.offered_price_currency)||"USD",delivery_date:(r==null?void 0:r.delivery_date)||"",delivery_terms:(r==null?void 0:r.delivery_terms)||"",aceerp_no:(r==null?void 0:r.aceerp_no)||"",mail_subject:(r==null?void 0:r.mail_subject)||"",pipeline_status:(r==null?void 0:r.pipeline_status)||"new",remarks:(r==null?void 0:r.remarks)||"",internal_notes:(r==null?void 0:r.internal_notes)||"",is_multi_product:(r==null?void 0:r.is_multi_product)||!1,products:(r==null?void 0:r.products)||[]}),[y,x]=W.useState({company_name:"",contact_person:"",email:"",phone:"",country:"Indonesia",address:"",city:"Jakarta Pusat",npwp:"",pbf_license:"",gst_vat_type:"",payment_terms:""});W.useEffect(()=>{w()},[]),W.useEffect(()=>{const j=E=>{v.current&&!v.current.contains(E.target)&&h(!1)};return d&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[d]),W.useEffect(()=>{if(c){const j=s.filter(E=>E.company_name.toLowerCase().includes(c.toLowerCase()));l(j)}else l(s)},[c,s]);const w=async()=>{try{const{data:j,error:E}=await ae.from("customers").select("id, company_name, contact_person, email, phone, country, address, city").eq("is_active",!0).order("company_name");if(E)throw E;i(j||[]),l(j||[])}catch(j){console.error("Error loading customers:",j)}},N=j=>{g({...p,customer_id:j.id,company_name:j.company_name,contact_person:j.contact_person||"",contact_email:j.email||"",contact_phone:j.phone||""}),u(j.company_name),h(!1)},_=async()=>{if(!y.company_name){alert("Customer name is required");return}try{const{data:j,error:E}=await ae.from("customers").insert({...y,is_active:!0}).select().single();if(E)throw E;await w(),N(j),A(!1),x({company_name:"",contact_person:"",email:"",phone:"",country:"Indonesia",address:"",city:"Jakarta Pusat",npwp:"",pbf_license:"",gst_vat_type:"",payment_terms:""})}catch(j){console.error("Error adding customer:",j),alert("Failed to add customer")}},C=async j=>{if(j.preventDefault(),p.is_multi_product){if(!p.company_name){alert("Please fill in Customer");return}}else if(!p.product_name||!p.quantity||!p.company_name){alert("Please fill in all required fields: Product Name, Quantity, and Customer");return}m(!0);try{await e(p)}finally{m(!1)}};return a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:C,className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsx("input",{type:"checkbox",id:"multiProductToggle",checked:p.is_multi_product,onChange:j=>{const E=j.target.checked;g({...p,is_multi_product:E,products:E&&p.products.length===0?[{productName:"",specification:"",quantity:"",supplierName:"",supplierCountry:"",deliveryDate:"",deliveryTerms:""}]:p.products})},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("label",{htmlFor:"multiProductToggle",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Multi-Product Inquiry (Common data will be applied to all products)"})]}),!p.is_multi_product&&a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Product Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:p.product_name,onChange:j=>g({...p,product_name:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter product name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Specification"}),a.jsx("input",{type:"text",value:p.specification,onChange:j=>g({...p,specification:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"BP / USP / EP"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[!p.is_multi_product&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Quantity ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:p.quantity,onChange:j=>g({...p,quantity:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 500 KG",required:!0})]}),a.jsxs("div",{className:p.is_multi_product?"col-span-1":"",children:[a.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Priority ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:p.priority,onChange:j=>g({...p,priority:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"low",children:"Low"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"high",children:"High"}),a.jsx("option",{value:"urgent",children:"Urgent"})]})]}),a.jsxs("div",{className:p.is_multi_product?"col-span-2":"",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Inquiry Source"}),a.jsxs("select",{value:p.inquiry_source,onChange:j=>g({...p,inquiry_source:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"email",children:"Email"}),a.jsx("option",{value:"phone",children:"Phone"}),a.jsx("option",{value:"whatsapp",children:"WhatsApp"}),a.jsx("option",{value:"website",children:"Website"}),a.jsx("option",{value:"referral",children:"Referral"}),a.jsx("option",{value:"other",children:"Other"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Supplier Name"}),a.jsx("input",{type:"text",value:p.supplier_name,onChange:j=>g({...p,supplier_name:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Manufacturer/Supplier"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country of Origin"}),a.jsx("input",{type:"text",value:p.supplier_country,onChange:j=>g({...p,supplier_country:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Supplier country"})]}),a.jsxs("div",{ref:v,className:"relative",children:[a.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Customer ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:c||p.company_name,onChange:j=>{u(j.target.value),h(!0)},onFocus:()=>h(!0),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 pr-8",placeholder:"Search customer...",required:!0}),a.jsx(ls,{className:"absolute right-2 top-2 w-4 h-4 text-gray-400"})]}),d&&a.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[o.map(j=>a.jsxs("div",{onClick:()=>N(j),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm",children:[a.jsx("div",{className:"font-medium",children:j.company_name}),j.contact_person&&a.jsx("div",{className:"text-xs text-gray-500",children:j.contact_person})]},j.id)),o.length===0&&a.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No customers found"})]}),a.jsxs("button",{type:"button",onClick:()=>A(!0),className:"mt-1 text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[a.jsx(Rr,{className:"w-3 h-3"}),"Add New Customer"]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),a.jsx("input",{type:"text",value:p.contact_person,onChange:j=>g({...p,contact_person:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"text",value:p.contact_email,onChange:j=>g({...p,contact_email:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com or multiple: email1@example.com, email2@example.com"}),a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Use comma (,) or semicolon (;) to separate multiple emails"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"tel",value:p.contact_phone,onChange:j=>g({...p,contact_phone:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Mail Subject"}),a.jsx("input",{type:"text",value:p.mail_subject,onChange:j=>g({...p,mail_subject:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject line"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Customer Requested"}),a.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:p.price_required,onChange:j=>g({...p,price_required:j.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),a.jsx("span",{className:"text-xs text-gray-700",children:"Price"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:p.coa_required,onChange:j=>g({...p,coa_required:j.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),a.jsx("span",{className:"text-xs text-gray-700",children:"COA"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:p.sample_required,onChange:j=>g({...p,sample_required:j.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),a.jsx("span",{className:"text-xs text-gray-700",children:"Sample"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:p.agency_letter_required,onChange:j=>g({...p,agency_letter_required:j.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),a.jsx("span",{className:"text-xs text-gray-700",children:"Agency Letter"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:p.others_required,onChange:j=>g({...p,others_required:j.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),a.jsx("span",{className:"text-xs text-gray-700",children:"Others"})]})]})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[a.jsx("h3",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Pricing"}),a.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Purchase Price"}),a.jsx("input",{type:"text",value:p.purchase_price,onChange:j=>g({...p,purchase_price:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"100.00"})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),a.jsxs("select",{value:p.purchase_price_currency,onChange:j=>g({...p,purchase_price_currency:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"USD",children:"USD"}),a.jsx("option",{value:"IDR",children:"IDR"})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offered Price"}),a.jsx("input",{type:"text",value:p.offered_price,onChange:j=>g({...p,offered_price:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"150.00"})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),a.jsxs("select",{value:p.offered_price_currency,onChange:j=>g({...p,offered_price_currency:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"USD",children:"USD"}),a.jsx("option",{value:"IDR",children:"IDR"})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Date"}),a.jsx("input",{type:"date",value:p.delivery_date,onChange:j=>g({...p,delivery_date:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Terms"}),a.jsxs("select",{value:p.delivery_terms,onChange:j=>g({...p,delivery_terms:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select..."}),a.jsx("option",{value:"FOB Jakarta",children:"FOB Jakarta"}),a.jsx("option",{value:"CIF Jakarta",children:"CIF Jakarta"}),a.jsx("option",{value:"FOB Surabaya",children:"FOB Surabaya"}),a.jsx("option",{value:"CIF Surabaya",children:"CIF Surabaya"}),a.jsx("option",{value:"FOB Semarang",children:"FOB Semarang"}),a.jsx("option",{value:"CIF Semarang",children:"CIF Semarang"}),a.jsx("option",{value:"EXW",children:"EXW"}),a.jsx("option",{value:"DDP",children:"DDP"}),a.jsx("option",{value:"DAP",children:"DAP"}),a.jsx("option",{value:"CFR",children:"CFR"}),a.jsx("option",{value:"FCA",children:"FCA"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"ACE ERP No"}),a.jsx("input",{type:"text",value:p.aceerp_no,onChange:j=>g({...p,aceerp_no:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pipeline Status"}),a.jsxs("select",{value:p.pipeline_status,onChange:j=>g({...p,pipeline_status:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"new",children:"New"}),a.jsx("option",{value:"contacted",children:"Contacted"}),a.jsx("option",{value:"qualified",children:"Qualified"}),a.jsx("option",{value:"proposal",children:"Proposal"}),a.jsx("option",{value:"negotiation",children:"Negotiation"}),a.jsx("option",{value:"won",children:"Won"}),a.jsx("option",{value:"lost",children:"Lost"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Remarks"}),a.jsx("textarea",{value:p.remarks,onChange:j=>g({...p,remarks:j.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Customer notes, special requirements..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Internal Notes"}),a.jsx("textarea",{value:p.internal_notes,onChange:j=>g({...p,internal_notes:j.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Private notes (not visible to customer)..."})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 sticky bottom-0 bg-white",children:[a.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:b,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",disabled:b,children:b?"Saving...":n?"Update Inquiry":"Add Inquiry"})]})]}),f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Add New Customer"}),a.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Kr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Company Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:y.company_name,onChange:j=>x({...y,company_name:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Company name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),a.jsx("input",{type:"text",value:y.contact_person,onChange:j=>x({...y,contact_person:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Contact name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"text",value:y.email,onChange:j=>x({...y,email:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"tel",value:y.phone,onChange:j=>x({...y,phone:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country"}),a.jsx("input",{type:"text",value:y.country,onChange:j=>x({...y,country:j.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Indonesia"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Address"}),a.jsx("textarea",{value:y.address,onChange:j=>x({...y,address:j.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Full address"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[a.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{onClick:_,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Customer"})]})]})})]})}function gAe({isOpen:e,matches:t,searchTerm:r,onSelect:n,onCreateNew:s,onCancel:i,inquiryCounts:o={}}){const[l,c]=W.useState(null),u=()=>{const f=t.find(A=>A.customer.id===l);f&&n(f.customer)},d=f=>{switch(f){case"high":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},h=f=>{switch(f){case"exact":return"Exact Match";case"startsWith":return"Starts With";case"contains":return"Contains";case"fuzzy":return"Similar Name";default:return"Match"}};return a.jsx(qt,{isOpen:e,onClose:i,title:"Select Existing Customer",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(ea,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm text-blue-900 font-medium",children:["We found ",t.length," existing customer",t.length!==1?"s":"",' similar to "',r,'"']}),a.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Please select the correct customer or create a new one"})]})]})}),a.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:t.map(f=>{const A=o[f.customer.id]||0,b=l===f.customer.id;return a.jsx("div",{onClick:()=>c(f.customer.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${b?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("input",{type:"radio",checked:b,onChange:()=>c(f.customer.id),className:"h-4 w-4 text-blue-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:f.customer.company_name}),a.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${d(f.confidence)}`,children:[h(f.matchType)," (",f.score,"%)"]})]}),a.jsxs("div",{className:"ml-6 space-y-1",children:[f.customer.contact_person&&a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(Hu,{className:"h-4 w-4 mr-2"}),f.customer.contact_person]}),f.customer.email&&a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(ha,{className:"h-4 w-4 mr-2"}),f.customer.email]}),f.customer.phone&&a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(Fl,{className:"h-4 w-4 mr-2"}),f.customer.phone]}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[a.jsx(Na,{className:"h-4 w-4 mr-2"}),A," ",A===1?"inquiry":"inquiries"," on record"]})]})]}),b&&a.jsx(yn,{className:"h-6 w-6 text-blue-600 flex-shrink-0"})]})},f.customer.id)})}),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("button",{onClick:s,className:"w-full text-left px-4 py-3 border border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center text-blue-600",children:[a.jsx(Hu,{className:"h-5 w-5 mr-2"}),a.jsx("span",{className:"font-medium",children:"None of these - Create New Customer"})]}),a.jsxs("p",{className:"text-xs text-gray-500 ml-7 mt-1",children:['Create a new customer record for "',r,'"']})]})}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"button",onClick:u,disabled:!l,className:`px-4 py-2 rounded-lg text-white ${l?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"}`,children:"Select Customer"})]})]})})}function xAe({isOpen:e,initialData:t,onConfirm:r,onCancel:n}){const[s,i]=W.useState({company_name:t.company_name||"",contact_person:t.contact_person||"",email:t.email||"",phone:t.phone||"",address:t.address||"",city:t.city||"Jakarta Pusat",country:t.country||"Indonesia",pbf_license:t.pbf_license||"",npwp:t.npwp||""}),[o,l]=W.useState(!1),[c,u]=W.useState({}),d=()=>{const A={};return s.company_name.trim()||(A.company_name="Company name is required"),s.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)&&(A.email="Invalid email format"),u(A),Object.keys(A).length===0},h=async()=>{if(d()){l(!0);try{await r(s)}catch(A){console.error("Error creating customer:",A),alert("Failed to create customer. Please try again.")}finally{l(!1)}}},f=(A,b)=>{i(m=>({...m,[A]:b})),c[A]&&u(m=>{const v={...m};return delete v[A],v})};return a.jsx(qt,{isOpen:e,onClose:n,title:"Create New Customer",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(ea,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Creating a new customer record"}),a.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Please verify the information below before creating"})]})]})}),a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.jsx(r0,{className:"inline h-4 w-4 mr-1"}),"Company Name *"]}),a.jsx("input",{type:"text",value:s.company_name,onChange:A=>f("company_name",A.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${c.company_name?"border-red-500":"border-gray-300"}`,placeholder:"Enter company name"}),c.company_name&&a.jsx("p",{className:"text-xs text-red-600 mt-1",children:c.company_name})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.jsx(oo,{className:"inline h-4 w-4 mr-1"}),"Contact Person"]}),a.jsx("input",{type:"text",value:s.contact_person,onChange:A=>f("contact_person",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter contact person name"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.jsx(ha,{className:"inline h-4 w-4 mr-1"}),"Email"]}),a.jsx("input",{type:"email",value:s.email,onChange:A=>f("email",A.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${c.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address"}),c.email&&a.jsx("p",{className:"text-xs text-red-600 mt-1",children:c.email})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.jsx(Fl,{className:"inline h-4 w-4 mr-1"}),"Phone"]}),a.jsx("input",{type:"text",value:s.phone,onChange:A=>f("phone",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.jsx(gR,{className:"inline h-4 w-4 mr-1"}),"Address"]}),a.jsx("textarea",{value:s.address,onChange:A=>f("address",A.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter address"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),a.jsx("select",{value:s.city,onChange:A=>f("city",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:OF.map(A=>a.jsx("option",{value:A,children:A},A))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.jsx(NF,{className:"inline h-4 w-4 mr-1"}),"Country"]}),a.jsx("input",{type:"text",value:s.country,onChange:A=>f("country",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter country"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PBF License"}),a.jsx("input",{type:"text",value:s.pbf_license,onChange:A=>f("pbf_license",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter PBF license number"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NPWP"}),a.jsx("input",{type:"text",value:s.npwp,onChange:A=>f("npwp",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter NPWP number"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:n,disabled:o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),a.jsx("button",{type:"button",onClick:h,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:o?"Creating...":"Create Customer"})]})]})})}function yAe({isOpen:e,customerName:t,changedFields:r,oldValues:n,newValues:s,onUpdateCustomer:i,onKeepExisting:o,onCancel:l}){const c=u=>({email:"Email",phone:"Phone",contact_person:"Contact Person",address:"Address",city:"City",country:"Country"})[u]||u;return a.jsx(qt,{isOpen:e,onClose:l,title:"Update Customer Information?",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(ea,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-yellow-900 font-medium",children:"Contact details differ from master record"}),a.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["The information you entered for ",a.jsx("span",{className:"font-semibold",children:t})," differs from what's stored in the customer database."]})]})]})}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:a.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Changes Detected"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:r.map(u=>a.jsxs("div",{className:"px-4 py-3",children:[a.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase mb-2",children:c(u)}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex-1 bg-red-50 border border-red-200 rounded px-3 py-2",children:[a.jsx("div",{className:"text-xs text-red-600 font-medium mb-0.5",children:"Current"}),a.jsx("div",{className:"text-sm text-gray-900",children:n[u]||a.jsx("span",{className:"text-gray-400 italic",children:"Not set"})})]}),a.jsx(eR,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 bg-green-50 border border-green-200 rounded px-3 py-2",children:[a.jsx("div",{className:"text-xs text-green-600 font-medium mb-0.5",children:"New"}),a.jsx("div",{className:"text-sm text-gray-900",children:s[u]||a.jsx("span",{className:"text-gray-400 italic",children:"Not set"})})]})]})]},u))})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsxs("p",{className:"text-xs text-blue-900",children:[a.jsx("strong",{children:"Tip:"})," Updating the customer record will apply these changes to all future inquiries for this customer."]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Keep Existing"}),a.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Customer Record"})]})]})})}function xx(e){return e?e.toLowerCase().trim().replace(/\s+/g," ").replace(/\b(ltd|limited|inc|incorporated|pvt|private|llc|corp|corporation|co|company|pte|sdn bhd|tbk|pt)\b\.?/gi,"").replace(/[^\w\s]/g,"").trim():""}function vAe(e,t){const r=e.length,n=t.length,s=[];if(r===0)return n;if(n===0)return r;for(let i=0;i<=r;i++)s[i]=[i];for(let i=0;i<=n;i++)s[0][i]=i;for(let i=1;i<=r;i++)for(let o=1;o<=n;o++){const l=e[i-1]===t[o-1]?0:1;s[i][o]=Math.min(s[i-1][o]+1,s[i][o-1]+1,s[i-1][o-1]+l)}return s[r][n]}function bAe(e,t){const r=xx(e),n=xx(t);if(r===n)return 1;const s=Math.max(r.length,n.length);return s===0?1:1-vAe(r,n)/s}function $k(e){if(!e)return"";const t=e.match(/@(.+)$/);return t?t[1].toLowerCase():""}function uL(e,t){if(!e||!t.length)return[];const r=xx(e),n=e.toLowerCase().trim(),s=[];for(const i of t){const o=xx(i.company_name),l=i.company_name.toLowerCase().trim();let c="fuzzy",u=0;if(o===r)c="exact",u=100;else if(l.startsWith(n))c="startsWith",u=90-(l.length-n.length);else if(l.includes(n))c="contains",u=75-l.indexOf(n)*2;else{const f=bAe(e,i.company_name);if(f>=.6)u=Math.round(f*70);else continue}(i.email&&e.includes("@")?$k(i.email)===$k(e):!1)&&(u+=15);let h;u>=90?h="high":u>=70?h="medium":h="low",s.push({customer:i,score:Math.min(u,100),matchType:c,confidence:h})}return s.sort((i,o)=>o.score-i.score)}function wAe(e,t){const r=uL(e,t);return r.length>0&&r[0].score>=90?r[0]:null}function _Ae(e,t){const r=[],n={},s={},i=c=>(c==null?void 0:c.toLowerCase().trim())||"",o=c=>(c==null?void 0:c.replace(/\D/g,""))||"",l=c=>(c==null?void 0:c.trim())||"";if(e.contact_email&&t.email){const c=i(e.contact_email),u=i(t.email);c!==u&&c!==""&&(r.push("email"),n.email=t.email,s.email=e.contact_email)}if(e.contact_phone&&t.phone){const c=o(e.contact_phone),u=o(t.phone);c!==u&&c!==""&&(r.push("phone"),n.phone=t.phone,s.phone=e.contact_phone)}if(e.contact_person&&t.contact_person){const c=l(e.contact_person),u=l(t.contact_person);c!==u&&c!==""&&(r.push("contact_person"),n.contact_person=t.contact_person,s.contact_person=e.contact_person)}return{hasChanges:r.length>0,changedFields:r,oldValues:n,newValues:s}}function NAe(){var z;const{profile:e}=jr(),[t,r]=W.useState([]),[n,s]=W.useState(!0),[i,o]=W.useState(null),[l,c]=W.useState("table"),[u,d]=W.useState(!1),[h,f]=W.useState(null),[A,b]=W.useState(!1),[m,v]=W.useState(null),[p,g]=W.useState(null),[y,x]=W.useState([]),[w,N]=W.useState(!1),[_,C]=W.useState(!1),[j,E]=W.useState(!1),[S,F]=W.useState(null),[I,O]=W.useState({});W.useEffect(()=>{M()},[]);const M=async()=>{try{o(null);const{data:G,error:Z}=await ae.from("crm_inquiries").select("*, user_profiles!assigned_to(full_name)").neq("pipeline_status","lost").order("created_at",{ascending:!1});if(Z)throw Z;r(G||[])}catch{o("Failed to load inquiries. Please try again.")}finally{s(!1)}},P=async()=>{try{const{data:G,error:Z}=await ae.from("customers").select("id, company_name, contact_person, email, phone, country, address, city").eq("is_active",!0);if(Z)throw Z;return G||[]}catch(G){return console.error("Error loading customers:",G),[]}},X=async G=>{try{const{data:Z,error:R}=await ae.from("crm_inquiries").select("customer_id").in("customer_id",G);if(R)throw R;const le={};Z==null||Z.forEach(ee=>{ee.customer_id&&(le[ee.customer_id]=(le[ee.customer_id]||0)+1)}),O(le)}catch(Z){console.error("Error loading inquiry counts:",Z)}},J=async G=>{if(G.customer_id){const ee=(await P()).find(_e=>_e.id===G.customer_id);if(ee){const _e=_Ae({contact_email:G.contact_email,contact_phone:G.contact_phone,contact_person:G.contact_person},ee);if(_e.hasChanges)return F({..._e,customer:ee}),g(G),E(!0),!1}return!0}const Z=await P(),R=uL(G.company_name,Z);if(R.length>0){const le=wAe(G.company_name,Z);return le&&le.score>=95?(G.customer_id=le.customer.id,J(G)):(x(R),g(G),await X(R.map(ee=>ee.customer.id)),N(!0),!1)}else return g(G),C(!0),!1},H=G=>{const Z={...G},R=["delivery_date","inquiry_date"],le=["purchase_price","offered_price"];return R.forEach(ee=>{(Z[ee]===""||Z[ee]===void 0)&&(Z[ee]=null)}),le.forEach(ee=>{Z[ee]===""||Z[ee]===void 0?Z[ee]=null:Z[ee]!==null&&(Z[ee]=parseFloat(Z[ee]))}),Z},V=async G=>{try{const{data:{user:Z}}=await ae.auth.getUser();if(!Z)throw new Error("Not authenticated");if(!h){if(!await J(G))return;if(!G.customer_id){alert("Customer selection is required. Please select or create a customer.");return}}if(h){const{products:R,is_multi_product:le,...ee}=G,_e=H({...ee,specification:G.specification||null,purchase_price:G.purchase_price?parseFloat(G.purchase_price):null,offered_price:G.offered_price?parseFloat(G.offered_price):null}),{error:se}=await ae.from("crm_inquiries").update(_e).eq("id",h.id);if(se)throw se}else{const{products:R,is_multi_product:le,...ee}=G;if(le&&R&&R.length>0){const _e=R.map(Ne=>H({...ee,product_name:Ne.productName||Ne.product_name,specification:Ne.specification||null,quantity:Ne.quantity,supplier_name:Ne.supplierName||ee.supplier_name||null,supplier_country:Ne.supplierCountry||ee.supplier_country||null,delivery_date:Ne.deliveryDate||null,delivery_terms:Ne.deliveryTerms||null,inquiry_date:new Date().toISOString().split("T")[0],assigned_to:Z.id,created_by:Z.id,purchase_price:null,offered_price:null,is_multi_product:!1,has_items:!1})),{data:se,error:te}=await ae.from("crm_inquiries").insert(_e).select();if(te)throw te;if(se&&se.length>0){const Ne=se[0].inquiry_number;for(let Se=0;Se<se.length;Se++)await ae.from("crm_inquiries").update({inquiry_number:`${Ne}.${Se+1}`}).eq("id",se[Se].id)}}else{const _e=H({...ee,specification:G.specification||null,inquiry_date:new Date().toISOString().split("T")[0],assigned_to:Z.id,created_by:Z.id,purchase_price:G.purchase_price?parseFloat(G.purchase_price):null,offered_price:G.offered_price?parseFloat(G.offered_price):null,is_multi_product:!1,has_items:!1}),{error:se}=await ae.from("crm_inquiries").insert([_e]);if(se)throw se}}d(!1),f(null),M()}catch(Z){throw console.error("Error saving inquiry:",Z),alert("Failed to save inquiry. Please try again."),Z}},K=G=>{f(G),d(!0)},B=G=>{p&&(p.customer_id=G.id,N(!1),V(p))},L=async G=>{try{const{data:Z,error:R}=await ae.from("customers").insert({...G,is_active:!0}).select().single();if(R)throw R;p&&(p.customer_id=Z.id,C(!1),V(p))}catch(Z){throw console.error("Error creating customer:",Z),Z}},U=async()=>{if(!(!S||!S.customer))try{const G={};S.changedFields.forEach(R=>{G[R]=S.newValues[R]});const{error:Z}=await ae.from("customers").update(G).eq("id",S.customer.id);if(Z)throw Z;E(!1),p&&V(p)}catch(G){console.error("Error updating customer:",G),alert("Failed to update customer. Please try again.")}},D=()=>{E(!1),p&&V(p)},Q=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="sales";return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center",children:a.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"CRM - Inquiry Management"})}),a.jsxs("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("div",{className:"flex overflow-x-auto",children:[a.jsxs("button",{onClick:()=>c("email"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="email"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(jF,{className:"w-5 h-5"}),"Email Inbox"]}),a.jsxs("button",{onClick:()=>c("table"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="table"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(NR,{className:"w-5 h-5"}),"Table View"]}),a.jsxs("button",{onClick:()=>c("pipeline"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="pipeline"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(pR,{className:"w-5 h-5"}),"Pipeline"]}),a.jsxs("button",{onClick:()=>c("calendar"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="calendar"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Na,{className:"w-5 h-5"}),"Calendar"]}),a.jsxs("button",{onClick:()=>c("customers"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="customers"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Hu,{className:"w-5 h-5"}),"Customers"]}),a.jsxs("button",{onClick:()=>c("activities"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="activities"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(J7,{className:"w-5 h-5"}),"Activities"]}),a.jsxs("button",{onClick:()=>c("appointments"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="appointments"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Ra,{className:"w-5 h-5"}),"Appointments"]}),a.jsxs("button",{onClick:()=>c("archive"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="archive"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(yF,{className:"w-5 h-5"}),"Archive"]})]})}),a.jsxs("div",{className:"p-6",children:[i&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[a.jsx("p",{className:"text-red-700",children:i}),a.jsx("button",{onClick:M,className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm",children:"Retry"})]}),l==="email"&&a.jsx(nee,{}),l==="table"&&a.jsx(lAe,{inquiries:t,onRefresh:M,canManage:Q,onAddInquiry:()=>{f(null),d(!0)}}),l==="pipeline"&&a.jsx(uAe,{canManage:Q,onInquiryClick:G=>K(G)}),l==="calendar"&&a.jsx(cAe,{onReminderCreated:M}),l==="customers"&&a.jsx(fAe,{}),l==="activities"&&a.jsx(hAe,{onActivityLogged:M}),l==="appointments"&&a.jsx(pAe,{onAppointmentCreated:M}),l==="archive"&&a.jsx(mAe,{canManage:Q,onRefresh:M})]})]}),a.jsx(qt,{isOpen:u,onClose:()=>{d(!1),f(null)},title:h?"Edit Inquiry":"Add New Inquiry",children:a.jsx(cL,{onSubmit:V,onCancel:()=>{d(!1),f(null)},initialData:h,isEditing:!!h})}),a.jsx(qt,{isOpen:A,onClose:()=>{b(!1),v(null)},title:"Send Email",children:a.jsx(dAe,{inquiry:m,onClose:()=>{b(!1),v(null)},onSent:()=>{M()}})}),a.jsx(gAe,{isOpen:w,matches:y,searchTerm:(p==null?void 0:p.company_name)||"",onSelect:B,onCreateNew:()=>{N(!1),C(!0)},onCancel:()=>{N(!1),g(null)},inquiryCounts:I}),a.jsx(xAe,{isOpen:_,initialData:{company_name:(p==null?void 0:p.company_name)||"",contact_person:(p==null?void 0:p.contact_person)||"",email:(p==null?void 0:p.contact_email)||"",phone:(p==null?void 0:p.contact_phone)||"",country:(p==null?void 0:p.supplier_country)||"Indonesia"},onConfirm:L,onCancel:()=>{C(!1),g(null)}}),a.jsx(yAe,{isOpen:j,customerName:((z=S==null?void 0:S.customer)==null?void 0:z.company_name)||"",changedFields:(S==null?void 0:S.changedFields)||[],oldValues:(S==null?void 0:S.oldValues)||{},newValues:(S==null?void 0:S.newValues)||{},onUpdateCustomer:U,onKeepExisting:D,onCancel:()=>{E(!1),g(null)}})]})})}function jAe({onEmailSelect:e,selectedEmailId:t}){const[r,n]=W.useState([]),[s,i]=W.useState(!0),[o,l]=W.useState(!1),[c,u]=W.useState(null),d=W.useCallback(async()=>{try{const{data:v,error:p}=await ae.from("crm_email_inbox").select("*").eq("is_processed",!1).order("received_date",{ascending:!1}).limit(50);if(p)throw p;n(v||[])}catch(v){console.error("Error loading emails:",v)}finally{i(!1),l(!1)}},[]),h=W.useCallback(async()=>{l(!0);try{const{data:{session:v}}=await ae.auth.getSession();if(!v){console.error("Not authenticated"),l(!1);return}const p="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",g=new AbortController,y=setTimeout(()=>g.abort(),12e4),x=await fetch(p,{method:"POST",headers:{Authorization:`Bearer ${v.access_token}`,"Content-Type":"application/json"},signal:g.signal});if(clearTimeout(y),!x.ok)throw new Error(`Sync failed: ${x.status}`);await x.json(),await d()}catch(v){console.error("Error syncing emails:",v),await d()}finally{l(!1)}},[d]);W.useEffect(()=>{d();const v=ae.channel("email_inbox_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_email_inbox"},()=>{d()}).subscribe(),p=setInterval(()=>{h()},6e5);return()=>{v.unsubscribe(),clearInterval(p)}},[d,h]),W.useEffect(()=>{(async()=>{const p=sessionStorage.getItem("pendingEmailForInquiry");if(p){console.log("[EmailListPanel] Found pending email in sessionStorage"),sessionStorage.removeItem("pendingEmailForInquiry"),document.body.style.cursor="wait";try{const g=JSON.parse(p);console.log("[EmailListPanel] Parsed email data:",g);const{data:{session:y}}=await ae.auth.getSession();if(!y)throw console.error("[EmailListPanel] No session found"),new Error("Not authenticated");try{const{data:_}=await ae.from("crm_inquiries").select("id, inquiry_number, product_name").eq("mail_subject",g.subject).maybeSingle();if(_){if(!confirm(`This email has already been processed as Inquiry #${_.inquiry_number} (${_.product_name}).

Do you want to reprocess it?`)){console.log("[EmailListPanel] User declined to reprocess existing inquiry"),sessionStorage.removeItem("pendingEmailForCommandCenter");return}console.log("[EmailListPanel] User confirmed reprocessing existing inquiry")}}catch(_){console.warn("[EmailListPanel] Could not check for duplicates (continuing anyway):",_)}console.log("[EmailListPanel] Calling parse-pharma-email edge function");const x="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-pharma-email";console.log("[EmailListPanel] API URL:",x),console.log("[EmailListPanel] Request body:",{emailSubject:g.subject,emailBody:g.body.substring(0,100)+"...",fromEmail:g.fromEmail,fromName:g.fromName});const w=await fetch(x,{method:"POST",headers:{Authorization:`Bearer ${y.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({emailSubject:g.subject,emailBody:g.body,fromEmail:g.fromEmail,fromName:g.fromName})});if(console.log("[EmailListPanel] Response status:",w.status),!w.ok){const _=await w.text();throw console.error("[EmailListPanel] Response error:",_),new Error(`Edge function returned ${w.status}: ${_}`)}const N=await w.json();if(console.log("[EmailListPanel] Parse result:",N),N.success||N.fallbackData){const _={id:"gmail-"+Date.now(),from_email:g.fromEmail,from_name:g.fromName,subject:g.subject,body:g.body,received_date:g.date,is_processed:!1,is_inquiry:!1,parsed_data:null,converted_to_inquiry:null};console.log("[EmailListPanel] Calling onEmailSelect with mock email"),e(_,N.data||N.fallbackData)}else console.error("[EmailListPanel] Parse failed:",N.error),alert("Failed to parse email from Gmail: "+N.error)}catch(g){console.error("[EmailListPanel] Error processing pending email:",g),alert(`Failed to process email: ${g instanceof Error?g.message:String(g)}`)}finally{document.body.style.cursor="default"}}else console.log("[EmailListPanel] No pending email found in sessionStorage")})()},[e]);const f=async v=>{u(v.id),document.body.style.cursor="wait";try{const{data:{session:p}}=await ae.auth.getSession();if(!p)throw new Error("Not authenticated");const x=await(await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-pharma-email",{method:"POST",headers:{Authorization:`Bearer ${p.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({emailSubject:v.subject,emailBody:v.body,fromEmail:v.from_email,fromName:v.from_name})})).json();x.success?e(v,x.data):x.fallbackData?e(v,x.fallbackData):(alert("Failed to parse email: "+x.error),e(v,null))}catch(p){console.error("Error parsing email:",p),alert("Failed to parse email. Please try again.")}finally{u(null),document.body.style.cursor="default"}},A=v=>{var w,N;const p=((w=v.body)==null?void 0:w.toLowerCase())||"",g=((N=v.subject)==null?void 0:N.toLowerCase())||"",y=p+" "+g,x=[];return(y.includes("price")||y.includes("harga")||y.includes("quotation")||y.includes("quote"))&&x.push({icon:El,color:"text-green-600",label:"Price"}),(y.includes("coa")||y.includes("certificate")||y.includes("analysis"))&&x.push({icon:sr,color:"text-blue-600",label:"COA"}),(y.includes("msds")||y.includes("safety")||y.includes("data sheet"))&&x.push({icon:sr,color:"text-orange-600",label:"MSDS"}),(y.includes("sample")||y.includes("sampel"))&&x.push({icon:EF,color:"text-purple-600",label:"Sample"}),x},b=v=>{const g=(v.body||"").split(`
`).filter(N=>N.trim().length>0);let y="",x="",w="";for(const N of g.slice(0,20)){const _=N.toLowerCase();if(!y&&(_.includes("product")||_.includes("material")||_.includes("item"))&&(y=N.replace(/^[^:]+:/,"").trim().substring(0,50)),!x&&(_.includes("qty")||_.includes("quantity")||_.includes("kg")||_.includes("mt"))){const C=N.match(/\d+\s*(kg|mt|ton|units?|pcs)/i);C&&(x=C[0])}!w&&(_.includes("supplier")||_.includes("manufacturer")||_.includes("origin"))&&(w=N.replace(/^[^:]+:/,"").trim().substring(0,30))}return{product:y,quantity:x,supplier:w}},m=v=>{const p=(v.subject+" "+v.body).toLowerCase();return p.includes("urgent")||p.includes("asap")||p.includes("segera")||p.includes("mendesak")};return s?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading emails..."})]})}):a.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ha,{className:"w-5 h-5 text-blue-600"}),a.jsx("h2",{className:"font-semibold text-gray-900",children:"New Emails"}),a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:r.length})]}),a.jsx("button",{onClick:h,disabled:o,className:"p-1.5 hover:bg-gray-200 rounded-lg transition",title:"Refresh emails",children:a.jsx(go,{className:`w-4 h-4 text-gray-600 ${o?"animate-spin":""}`})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[a.jsx(ha,{className:"w-16 h-16 text-gray-300 mb-4"}),a.jsx("p",{className:"text-gray-600 font-medium",children:"No unprocessed emails"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"New emails will appear here automatically"})]}):a.jsx("div",{className:"divide-y divide-gray-100",children:r.map(v=>{const p=b(v),g=A(v),y=m(v),x=t===v.id,w=c===v.id;return a.jsxs("div",{onClick:()=>!w&&f(v),className:`p-4 cursor-pointer transition ${x?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50 border-l-4 border-transparent"} ${w?"opacity-50 cursor-wait":""}`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"font-semibold text-gray-900 truncate",children:v.from_name||v.from_email}),y&&a.jsx("span",{className:"flex-shrink-0 px-1.5 py-0.5 text-xs font-bold bg-red-100 text-red-700 rounded",children:"URGENT"})]}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:v.from_email})]}),w&&a.jsx(dA,{className:"w-5 h-5 text-blue-600 animate-pulse flex-shrink-0 ml-2"})]}),a.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2 line-clamp-1",children:v.subject}),(p.product||p.quantity)&&a.jsxs("div",{className:"space-y-1 mb-2",children:[p.product&&a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ps,{className:"w-3.5 h-3.5 text-gray-400 mt-0.5 flex-shrink-0"}),a.jsx("span",{className:"text-xs text-gray-600 line-clamp-1",children:p.product})]}),p.quantity&&a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{className:"text-xs font-medium text-blue-600",children:p.quantity})})]}),g.length>0&&a.jsx("div",{className:"flex items-center gap-2 mb-2",children:g.map((N,_)=>a.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-gray-100 rounded",title:N.label,children:[a.jsx(N.icon,{className:`w-3 h-3 ${N.color}`}),a.jsx("span",{className:"text-xs text-gray-600",children:N.label})]},_))}),a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsx("span",{className:"text-xs text-gray-500",children:new Date(v.received_date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),!w&&a.jsxs("span",{className:"text-xs text-blue-600 font-medium flex items-center gap-1",children:[a.jsx(dA,{className:"w-3 h-3"}),"AI Parse"]})]})]},v.id)})})})]})}function CAe({email:e,parsedData:t,onSave:r,saving:n}){const[s,i]=W.useState(!1),[o,l]=W.useState(null),[c,u]=W.useState(!1),d=(t==null?void 0:t.products)&&t.products.length>1;W.useEffect(()=>{var A,b;if(console.log("[InquiryFormPanel] useEffect triggered",{email:e,parsedData:t}),t){let m=t.contactPerson||"",v=t.contactEmail||"";if(typeof m=="object"&&!Array.isArray(m)?m=m.name||"":Array.isArray(m)&&(m=((A=m[0])==null?void 0:A.name)||m[0]||""),typeof v=="object"&&!Array.isArray(v)?v=v.email||"":Array.isArray(v)&&(v=((b=v[0])==null?void 0:b.email)||v[0]||""),typeof v=="string"){v=v.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();const y=/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,x=[];let w;for(;(w=y.exec(v))!==null;)x.includes(w[1])||x.push(w[1]);x.length>0&&(v=x.join(", "))}typeof m=="string"&&(m=m.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim());let p=t.companyName||"";typeof p=="string"&&(p=p.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim());const g={product_name:t.productName||"",specification:t.specification||"",quantity:t.quantity||"",supplier_name:t.supplierName||"",supplier_country:t.supplierCountry||"",company_name:p,contact_person:m,contact_email:v,contact_phone:t.contactPhone||"",priority:t.urgency||"medium",delivery_date:t.deliveryDateExpected||"",remarks:t.remarks||"",coa_required:d?!0:t.coaRequested||!1,sample_required:t.sampleRequested||!1,price_required:d?!0:t.priceRequested||!0,agency_letter_required:t.agencyLetterRequested||!1,aceerp_no:"",purchase_price:"",purchase_price_currency:"USD",offered_price:"",offered_price_currency:"USD",delivery_terms:"",inquiry_source:"email",mail_subject:(e==null?void 0:e.subject)||"",is_multi_product:d,products:t.products||[]};console.log("[InquiryFormPanel] Setting initialData:",g),l(g),d&&u(!0)}},[t,e,d]);const h=async A=>{const b={inquiryNumber:"",productName:A.product_name,specification:A.specification||"",quantity:A.quantity,supplierName:A.supplier_name||"",supplierCountry:A.supplier_country||"",companyName:A.company_name,contactPerson:A.contact_person||"",contactEmail:A.contact_email||"",contactPhone:A.contact_phone||"",priority:A.priority,purposeIcons:[],deliveryDateExpected:A.delivery_date||"",remarks:A.remarks||"",coaRequested:A.coa_required||!1,msdsRequested:!1,sampleRequested:A.sample_required||!1,priceRequested:A.price_required||!1,agencyLetterRequested:A.agency_letter_required||!1,aceerp_no:A.aceerp_no||"",purchasePrice:A.purchase_price||"",purchasePriceCurrency:A.purchase_price_currency||"USD",offeredPrice:A.offered_price||"",offeredPriceCurrency:A.offered_price_currency||"USD",deliveryDate:A.delivery_date||"",deliveryTerms:A.delivery_terms||"",isMultiProduct:A.is_multi_product||!1,products:A.products||[]};await r(b)},f={high:"text-green-600 bg-green-50 border-green-200",medium:"text-yellow-600 bg-yellow-50 border-yellow-200",low:"text-red-600 bg-red-50 border-red-200"};return!e||!t?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[a.jsx(sr,{className:"w-20 h-20 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Email Selected"}),a.jsx("p",{className:"text-gray-600 max-w-md",children:"Click on an email from the left panel to automatically parse and fill this inquiry form with AI"}),a.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[a.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[a.jsx(dA,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{children:"AI extracts product, quantity, company, contact"})]}),a.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[a.jsx(Us,{className:"w-4 h-4 text-green-500"}),a.jsx("span",{children:"Only inquiry number needs manual input"})]})]})]}):a.jsxs("div",{className:"flex flex-col h-full bg-white",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-transparent",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Inquiry"}),t&&a.jsx("div",{className:`px-3 py-1 rounded-lg text-sm font-medium border ${f[t.confidence]}`,children:a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(dA,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:["AI Confidence: ",t.confidence.toUpperCase()]}),a.jsxs("span",{className:"text-xs",children:["(",Math.round(t.confidenceScore*100),"%)"]})]})})]}),e&&a.jsxs("div",{className:"mt-3 bg-white border border-gray-300 rounded-lg shadow-sm overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>i(!s),className:"w-full flex items-center justify-between px-5 py-3 hover:bg-gray-50 transition border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-sm font-bold text-blue-700",children:(e.from_name||e.from_email).charAt(0).toUpperCase()})}),a.jsxs("div",{className:"text-left flex-1 min-w-0",children:[a.jsx("p",{className:"text-base font-semibold text-gray-900 truncate",children:e.subject}),a.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[a.jsx("p",{className:"text-sm text-gray-900 font-medium",children:e.from_name||"Unknown"}),a.jsx("span",{className:"text-gray-400 text-xs",children:""}),a.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["<",e.from_email,">"]})]})]})]}),s?a.jsx(Yb,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"}):a.jsx(Fi,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"})]}),s&&a.jsxs("div",{className:"bg-white",children:[a.jsx("div",{className:"px-5 py-3 border-b border-gray-100 bg-gray-50",children:a.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:new Date(e.received_date).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})}),a.jsx("div",{className:"px-5 py-4",children:a.jsx(YT,{htmlContent:e.body,className:"max-h-[600px]"})}),a.jsx("div",{className:"px-5 py-3 bg-blue-50 border-t border-blue-100",children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[a.jsx(dA,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:"AI has extracted data from this email. Review the form fields below."})]})})]})]}),(t==null?void 0:t.autoDetectedCompany)&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700 bg-green-50 px-3 py-1.5 rounded-lg mt-3",children:[a.jsx(Us,{className:"w-4 h-4"}),a.jsx("span",{children:"Company auto-detected from email domain"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Us,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Auto-Generated Inquiry Number"}),a.jsx("p",{className:"text-xs text-green-700",children:"Inquiry number will be automatically generated when you save (format: INQ-2025-NNNN)"})]})]})}),d&&(t==null?void 0:t.products)&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(BF,{className:"w-5 h-5 text-blue-600"}),a.jsxs("h3",{className:"text-sm font-semibold text-blue-900",children:["Multi-Product Inquiry Detected (",t.products.length," Products)"]})]}),a.jsx("button",{type:"button",onClick:()=>u(!c),className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",children:c?a.jsxs(a.Fragment,{children:[a.jsx(Yb,{className:"w-4 h-4"}),"Hide Products"]}):a.jsxs(a.Fragment,{children:[a.jsx(Fi,{className:"w-4 h-4"}),"Show Products"]})})]}),a.jsxs("p",{className:"text-xs text-blue-700 mb-3",children:["This will create a parent inquiry and ",t.products.length," child inquiries with numbers like INQ-2025-001.1, INQ-2025-001.2, etc."]}),c&&a.jsx("div",{className:"bg-white rounded-lg border border-blue-200 overflow-hidden overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-blue-100",children:[a.jsx("thead",{className:"bg-blue-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"#"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Product Name"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Specification"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Quantity"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Supplier / Origin"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Delivery Date"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Delivery Terms"})]})}),a.jsx("tbody",{className:"divide-y divide-blue-100",children:t.products.map((A,b)=>a.jsxs("tr",{className:"hover:bg-blue-50",children:[a.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:b+1}),a.jsx("td",{className:"px-3 py-2 text-xs font-medium text-gray-900",children:A.productName||A.product_name}),a.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.specification||A.spec||"-"}),a.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.quantity||"-"}),a.jsxs("td",{className:"px-3 py-2 text-xs text-gray-700",children:[A.supplierName||A.supplier_name||A.origin||"-",(A.supplierCountry||A.supplier_country)&&` (${A.supplierCountry||A.supplier_country})`]}),a.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.deliveryDate||A.delivery_date||A.tglDatang||A.tgl_datang||"-"}),a.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.deliveryTerms||A.delivery_terms||"-"})]},b))})]})})]}),o&&a.jsx(cL,{onSubmit:h,onCancel:()=>{},initialData:o,isEditing:!1})]})})]})}async function BAe(e,t,r,n,s){var i;try{const{data:o,error:l}=await ae.from("crm_inquiries").select("*").eq("id",e).single();if(l)throw l;let c=o.status,u=!1;const d={};switch(t){case"send_price":d.price_quoted=!0,d.price_quoted_date=new Date().toISOString().split("T")[0],c="price_quoted",u=!0;break;case"send_coa":d.coa_sent=!0,d.coa_sent_date=new Date().toISOString().split("T")[0],o.price_quoted&&o.coa_sent&&(c="negotiation",u=!0);break;case"send_msds":d.msds_sent=!0,d.msds_sent_date=new Date().toISOString().split("T")[0];break;case"send_sample":d.sample_sent=!0,d.sample_sent_date=new Date().toISOString().split("T")[0],c="sample_sent",u=!0;break}if(u&&(d.status=c),Object.keys(d).length>0){const{error:b}=await ae.from("crm_inquiries").update(d).eq("id",e);if(b)throw b}let h;const{data:f}=await ae.rpc("auto_create_followup",{p_inquiry_id:e,p_action_type:t,p_user_id:n});f&&(h=f);const{error:A}=await ae.from("crm_quick_actions_log").insert({inquiry_id:e,action_type:t,action_label:r,email_sent:!!(s!=null&&s.emailTo),email_to:(s==null?void 0:s.emailTo)||null,email_subject:(s==null?void 0:s.emailSubject)||null,email_body:(s==null?void 0:s.emailBody)||null,template_used:(s==null?void 0:s.templateId)||null,old_status:o.status,new_status:c,status_updated:u,follow_up_created:!!h,follow_up_reminder_id:h||null,notes:(s==null?void 0:s.notes)||null,performed_by:n});if(A)throw A;if(s!=null&&s.emailTo&&(s!=null&&s.emailSubject)&&(s!=null&&s.emailBody)){const{error:b}=await ae.from("crm_email_activities").insert({inquiry_id:e,email_type:"sent",from_email:(i=(await ae.auth.getUser()).data.user)==null?void 0:i.email,to_email:[s.emailTo],subject:s.emailSubject,body:s.emailBody,template_id:s.templateId||null,sent_date:new Date().toISOString(),created_by:n});b&&console.error("Error logging email:",b)}return{success:!0,reminderId:h}}catch(o){return console.error("Error performing quick action:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}async function kAe(e,t,r,n,s,i){try{let o=null,l="";switch(n){case"customer_will_revert":o=new Date,o.setDate(o.getDate()+2),l="Customer will revert";break;case"could_not_reach":o=new Date,o.setDate(o.getDate()+1),l="Try calling again";break;case"discussed_price":case"discussed_coa":case"discussed_sample":o=new Date,o.setDate(o.getDate()+3),l="Follow up on discussion";break;case"positive":o=new Date,o.setDate(o.getDate()+2),l="Positive response - follow up";break;case"negative":o=new Date,o.setDate(o.getDate()+7),l="Negative response - check back later";break}const{error:c}=await ae.from("crm_activity_logs").insert({inquiry_id:e,activity_type:t,activity_title:r,activity_description:i||null,outcome:n,next_follow_up_date:o?o.toISOString():null,follow_up_reason:l,created_by:s});if(c)throw c;o&&await ae.from("crm_inquiries").update({next_follow_up:o.toISOString(),last_contact_date:new Date().toISOString()}).eq("id",e);let u;if(o){const{data:d,error:h}=await ae.from("crm_reminders").insert({inquiry_id:e,reminder_type:"follow_up",title:l,due_date:o.toISOString(),assigned_to:s,created_by:s}).select("id").single();!h&&d&&(u=d.id)}return{success:!0,reminderId:u}}catch(o){return console.error("Error logging activity:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}function SAe({inquiry:e,onActionComplete:t}){const[r,n]=W.useState(!1),[s,i]=W.useState("phone_call"),[o,l]=W.useState(!1),c=[{id:"send_price",label:"Send Price",icon:El,color:"bg-green-50 hover:bg-green-100 text-green-700 border-green-200",description:"Auto-updates status & creates 2-day follow-up"},{id:"send_coa",label:"Send COA",icon:sr,color:"bg-blue-50 hover:bg-blue-100 text-blue-700 border-blue-200",description:"Auto-updates status & creates 1-day follow-up"},{id:"send_msds",label:"Send MSDS",icon:sr,color:"bg-orange-50 hover:bg-orange-100 text-orange-700 border-orange-200",description:"Sends MSDS document"},{id:"send_sample",label:"Send Sample",icon:EF,color:"bg-purple-50 hover:bg-purple-100 text-purple-700 border-purple-200",description:"Auto-updates status & creates 3-day follow-up"}],u=[{value:"customer_will_revert",label:"Customer Will Revert",followUpDays:2},{value:"could_not_reach",label:"Could Not Reach",followUpDays:1},{value:"discussed_price",label:"Discussed Price/COA",followUpDays:3},{value:"positive",label:"Positive Response",followUpDays:2},{value:"negative",label:"Negative Response",followUpDays:7},{value:"other",label:"Other",followUpDays:3}],d=async(f,A)=>{if(!(!e||!confirm(`Send ${A}?

This will:
- Update inquiry status
- Create automatic follow-up
- Log the action

Continue?`))){l(!0);try{const{data:{user:m}}=await ae.auth.getUser();if(!m)throw new Error("Not authenticated");const v=await BAe(e.id,f,A,m.id,{emailTo:e.contact_email||void 0,emailSubject:`Re: ${e.email_subject||e.product_name}`,emailBody:`Dear ${e.contact_person||"Sir/Madam"},

Thank you for your inquiry regarding ${e.product_name}.

Please find the ${A.toLowerCase()} attached.

Best regards`});v.success?(alert(`${A} sent successfully!

Status updated & follow-up created automatically.`),t()):alert(`Failed to send ${A}: ${v.error}`)}catch(m){console.error("Error performing quick action:",m),alert("Failed to perform action. Please try again.")}finally{l(!1)}}},h=async f=>{if(e){l(!0);try{const{data:{user:A}}=await ae.auth.getUser();if(!A)throw new Error("Not authenticated");const b=s==="phone_call"?"Phone Call":s==="meeting"?"Meeting":"WhatsApp Message",m=await kAe(e.id,s,b,f,A.id);if(m.success){const v=u.find(p=>p.value===f);alert(`${b} logged!

Follow-up automatically created for ${v==null?void 0:v.followUpDays} days from now.`),n(!1),t()}else alert(`Failed to log activity: ${m.error}`)}catch(A){console.error("Error logging activity:",A),alert("Failed to log activity. Please try again.")}finally{l(!1)}}};return e?a.jsxs("div",{className:"flex flex-col h-full bg-white border-l border-gray-200",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-green-50 to-transparent",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Quick Actions"}),a.jsxs("p",{className:"text-xs text-gray-600",children:["Inquiry #",e.inquiry_number]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[a.jsx(Ri,{className:"w-4 h-4"}),"Send Documents (1-Click)"]}),a.jsx("div",{className:"space-y-2",children:c.map(f=>a.jsx("button",{onClick:()=>d(f.id,f.label),disabled:o,className:`w-full p-3 rounded-lg border-2 transition ${f.color} disabled:opacity-50 disabled:cursor-not-allowed text-left`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(f.icon,{className:"w-5 h-5 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm",children:f.label}),a.jsx("p",{className:"text-xs opacity-75 truncate",children:f.description})]})]})},f.id))})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[a.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[a.jsx(Fl,{className:"w-4 h-4"}),"Log Activity (1-Click)"]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("button",{onClick:()=>{i("phone_call"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Fl,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Call"}),a.jsx("p",{className:"text-xs text-gray-600",children:"Quick outcome selection"})]})]})}),a.jsx("button",{onClick:()=>{i("meeting"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Na,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Meeting"}),a.jsx("p",{className:"text-xs text-gray-600",children:"Record meeting outcome"})]})]})}),a.jsx("button",{onClick:()=>{i("whatsapp"),n(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(S0,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log WhatsApp"}),a.jsx("p",{className:"text-xs text-gray-600",children:"Log WhatsApp conversation"})]})]})})]})]}),a.jsx("div",{className:"border-t border-gray-200 pt-4",children:a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ra,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{className:"text-xs text-blue-800",children:[a.jsx("p",{className:"font-medium mb-1",children:"Auto-Automation Active"}),a.jsxs("ul",{className:"space-y-0.5 text-blue-700",children:[a.jsx("li",{children:" Status updates automatically"}),a.jsx("li",{children:" Follow-ups created automatically"}),a.jsx("li",{children:" All actions logged in timeline"})]})]})]})})})]}),a.jsx(qt,{isOpen:r,onClose:()=>n(!1),title:`Log ${s==="phone_call"?"Phone Call":s==="meeting"?"Meeting":"WhatsApp"}`,children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Select the outcome to automatically update follow-up date:"}),a.jsx("div",{className:"space-y-2",children:u.map(f=>a.jsx("button",{onClick:()=>h(f.value),disabled:o,className:"w-full p-4 text-left border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Us,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{className:"font-medium text-gray-900",children:f.label})]}),a.jsxs("span",{className:"text-xs text-gray-500",children:["+",f.followUpDays,"d follow-up"]})]})},f.value))}),a.jsx("div",{className:"pt-4 border-t border-gray-200",children:a.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Click an outcome to log and auto-create follow-up"})})]})})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[a.jsx(Ri,{className:"w-20 h-20 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Quick Actions"}),a.jsx("p",{className:"text-gray-600 max-w-md",children:"Save an inquiry to see quick action buttons here"}),a.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[a.jsx("p",{children:"One-click actions include:"}),a.jsxs("ul",{className:"list-disc list-inside text-left",children:[a.jsx("li",{children:"Send Price Quote"}),a.jsx("li",{children:"Send COA/MSDS"}),a.jsx("li",{children:"Log Phone Calls"}),a.jsx("li",{children:"Schedule Follow-ups"})]})]})]})}function EAe(e){if(!e)return null;const t=e.trim();if(!t)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const r=t.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2})$/);if(r){const o=r[1].padStart(2,"0"),l=r[2].padStart(2,"0");return`${parseInt(r[3])<50?`20${r[3]}`:`19${r[3]}`}-${l}-${o}`}const n=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(n){const o=n[1].padStart(2,"0"),l=n[2].padStart(2,"0");return`${parseInt(n[3])<50?`20${n[3]}`:`19${n[3]}`}-${l}-${o}`}const s=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(s){const o=s[1].padStart(2,"0"),l=s[2].padStart(2,"0");return`${s[3]}-${l}-${o}`}const i=t.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(i){const o=i[1].padStart(2,"0"),l=i[2].padStart(2,"0");return`${i[3]}-${l}-${o}`}try{const o=new Date(t);if(!isNaN(o.getTime()))return o.toISOString().split("T")[0]}catch{console.warn("Could not parse date:",t)}return null}function FAe(){console.log("[CRMCommandCenter] Component loaded - Dec 7 2025 v1.2");const{profile:e}=jr(),[t,r]=W.useState(null),[n,s]=W.useState(null),[i,o]=W.useState(null),[l,c]=W.useState(!1),u=(f,A)=>{console.log("[CRMCommandCenter] handleEmailSelect called",{email:f,data:A}),r(f),s(A),o(null)},d=async f=>{var A;if(!(!t||!e)){c(!0);try{const{data:{user:b}}=await ae.auth.getUser();if(!b)throw new Error("Not authenticated");let m=null;const v=f.contactEmail.split(/[,;]/)[0].trim();console.log("[CRMCommandCenter] Looking up customer with primaryEmail:",v);const{data:p,error:g}=await ae.from("crm_contacts").select("id, company_name, email, contact_person, phone, address").or(`email.eq.${v},company_name.ilike.${f.companyName}`).limit(1).maybeSingle();if(g)throw console.error("[CRMCommandCenter] Customer lookup error:",g),g;if(p){m=p.id;const N={};f.contactPerson&&!p.contact_person&&(N.contact_person=f.contactPerson),f.contactPhone&&!p.phone&&(N.phone=f.contactPhone),f.contactEmail&&f.contactEmail!==p.email&&(N.email=f.contactEmail),Object.keys(N).length>0&&await ae.from("crm_contacts").update({...N,updated_at:new Date().toISOString()}).eq("id",m)}else{const{data:N,error:_}=await ae.from("crm_contacts").insert({company_name:f.companyName,contact_person:f.contactPerson||null,email:f.contactEmail,phone:f.contactPhone||null,is_active:!0,created_by:b.id}).select().single();if(_)throw console.error("[CRMCommandCenter] Customer creation error:",_),new Error(`Failed to create customer: ${_.message}`);N&&(m=N.id)}if(!m)throw new Error("Failed to get or create customer ID");const y={customer_id:m,inquiry_date:new Date().toISOString().split("T")[0],product_name:f.productName,specification:f.specification||null,quantity:f.quantity,supplier_name:f.supplierName||null,supplier_country:f.supplierCountry||null,company_name:f.companyName,contact_person:f.contactPerson||null,contact_email:f.contactEmail,contact_phone:f.contactPhone||null,mail_subject:t.subject,email_body:t.body,inquiry_source:"email",status:"new",pipeline_status:"new",priority:f.priority,purpose_icons:f.purposeIcons,delivery_date_expected:EAe(f.deliveryDateExpected),ai_confidence_score:(n==null?void 0:n.confidenceScore)||0,auto_detected_company:(n==null?void 0:n.autoDetectedCompany)||!1,auto_detected_contact:(n==null?void 0:n.autoDetectedContact)||!1,coa_sent:!1,msds_sent:!1,sample_sent:!1,price_quoted:!1,price_required:f.priceRequested,coa_required:f.coaRequested,sample_required:f.sampleRequested,agency_letter_required:f.agencyLetterRequested||!1,aceerp_no:f.aceerp_no||null,purchase_price:f.purchasePrice?parseFloat(f.purchasePrice):null,purchase_price_currency:f.purchasePriceCurrency||"USD",offered_price:f.offeredPrice?parseFloat(f.offeredPrice):null,offered_price_currency:f.offeredPriceCurrency||"USD",delivery_date:f.deliveryDate||null,delivery_terms:f.deliveryTerms||null,remarks:f.remarks||null,assigned_to:b.id,created_by:b.id,source:"email",source_email_id:t.id.startsWith("gmail-")?null:t.id};let x;if(f.isMultiProduct&&f.products&&f.products.length>0){const N=f.products.map(j=>({...y,product_name:j.productName,specification:j.specification||null,quantity:j.quantity,supplier_name:j.supplierName||y.supplier_name||null,supplier_country:j.supplierCountry||y.supplier_country||null,delivery_date:j.deliveryDate||y.delivery_date||null,delivery_terms:j.deliveryTerms||y.delivery_terms||null,is_multi_product:!1,has_items:!1}));console.log("[CRMCommandCenter] Inserting multi-product inquiries:",N.length,"items");const{data:_,error:C}=await ae.from("crm_inquiries").insert(N).select();if(C)throw console.error("[CRMCommandCenter] Multi-product insert error:",C),C;if(_&&_.length>0){const j=_[0].inquiry_number;for(let E=0;E<_.length;E++)await ae.from("crm_inquiries").update({inquiry_number:`${j}.${E+1}`}).eq("id",_[E].id);x=_[0]}}else{console.log("[CRMCommandCenter] Inserting single product inquiry");const{data:N,error:_}=await ae.from("crm_inquiries").insert([{...y,is_multi_product:!1,has_items:!1}]).select().single();if(_)throw console.error("[CRMCommandCenter] Single product insert error:",_),_;x=N}if(await ae.from("crm_email_inbox").update({is_processed:!0,is_inquiry:!0,converted_to_inquiry:x.id}).eq("id",t.id),f.coaRequested||f.msdsRequested||f.sampleRequested||f.priceRequested||f.agencyLetterRequested){const N=[];f.priceRequested&&N.push({inquiry_id:x.id,reminder_type:"send_price",title:"Send price quote to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:b.id,created_by:b.id}),f.coaRequested&&N.push({inquiry_id:x.id,reminder_type:"send_coa",title:"Send COA to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:b.id,created_by:b.id}),f.msdsRequested&&N.push({inquiry_id:x.id,reminder_type:"send_msds",title:"Send MSDS to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:b.id,created_by:b.id}),f.sampleRequested&&N.push({inquiry_id:x.id,reminder_type:"send_sample",title:"Send sample to customer",due_date:new Date(Date.now()+3*24*60*60*1e3).toISOString(),assigned_to:b.id,created_by:b.id}),f.agencyLetterRequested&&N.push({inquiry_id:x.id,reminder_type:"send_agency_letter",title:"Send agency letter to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:b.id,created_by:b.id}),N.length>0&&await ae.from("crm_reminders").insert(N)}o(x),s(null);const w=f.isMultiProduct&&f.products?`Inquiry #${x.inquiry_number} created successfully with ${f.products.length} product line items!

Use Quick Actions to send documents for each product.`:`Inquiry #${x.inquiry_number} created successfully!

Use Quick Actions to send documents.`;alert(w)}catch(b){if(console.error("[CRMCommandCenter] Error creating inquiry:",b),console.error("[CRMCommandCenter] Error details:",JSON.stringify(b,null,2)),(A=b.message)!=null&&A.includes("duplicate key"))alert("This inquiry number already exists. Please use a different number.");else{const m=b.message||b.details||b.hint||"Unknown error";alert(`Failed to create inquiry: ${m}

Check console for details.`)}}finally{c(!1)}}},h=()=>{o(null),r(null),s(null)};return a.jsx(Zn,{children:a.jsxs("div",{className:"h-screen flex flex-col",children:[a.jsx("div",{className:"flex-shrink-0 bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-2 border-b border-blue-800",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(LF,{className:"w-5 h-5 text-white"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-white",children:"CRM Command Center"}),a.jsx("p",{className:"text-blue-100 text-xs",children:"AI-powered inquiry processing"})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-blue-200",children:"Quick Actions"}),a.jsx("p",{className:"text-xl font-bold text-white",children:"2 Clicks"})]})]})}),a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:a.jsx(jAe,{onEmailSelect:u,selectedEmailId:(t==null?void 0:t.id)||null})}),a.jsx("div",{className:"flex-1",children:a.jsx(CAe,{email:t,parsedData:n,onSave:d,saving:l})}),a.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:a.jsx(SAe,{inquiry:i,onActionComplete:h})})]}),i&&a.jsx("div",{className:"flex-shrink-0 bg-green-50 border-t border-green-200 px-6 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-800",children:[a.jsx(Us,{className:"w-5 h-5"}),a.jsxs("span",{className:"font-medium",children:["Inquiry #",i.inquiry_number," created successfully! Use Quick Actions on the right "]})]})})]})})}function TAe({isOpen:e,onClose:t,taskId:r,onUpdate:n}){const{user:s}=jr(),[i,o]=W.useState(null),[l,c]=W.useState([]),[u,d]=W.useState([]),[h,f]=W.useState(!0),[A,b]=W.useState(""),[m,v]=W.useState(!1),[p,g]=W.useState(""),[y,x]=W.useState([]),[w,N]=W.useState(!1),[_,C]=W.useState(!1),j=W.useRef(null),E=W.useRef(null);W.useEffect(()=>{e&&r&&(S(),F(),I())},[e,r]);const S=async()=>{var U,D,Q,z;try{f(!0);const{data:G,error:Z}=await ae.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(name)
        `).eq("id",r).single();if(Z)throw Z;const R=G.assigned_users||[],{data:le}=await ae.from("user_profiles").select("id, full_name").in("id",R);o({...G,creator_name:(U=G.creator)==null?void 0:U.full_name,assignee_names:(le==null?void 0:le.map(ee=>ee.full_name))||[],inquiry_number:(D=G.inquiry)==null?void 0:D.inquiry_number,customer_name:(Q=G.customer)==null?void 0:Q.company_name,product_name:(z=G.product)==null?void 0:z.name})}catch(G){console.error("Error loading task:",G)}finally{f(!1)}},F=async()=>{try{const{data:U,error:D}=await ae.from("task_comments").select(`
          *,
          user:user_id(full_name)
        `).eq("task_id",r).eq("is_deleted",!1).order("created_at",{ascending:!0});if(D)throw D;c((U||[]).map(Q=>{var z;return{...Q,user_name:((z=Q.user)==null?void 0:z.full_name)||"Unknown User"}}))}catch(U){console.error("Error loading comments:",U)}},I=async()=>{try{const{data:U,error:D}=await ae.from("user_profiles").select("id, full_name, email").eq("is_active",!0).order("full_name");if(D)throw D;d(U||[])}catch(U){console.error("Error loading users:",U)}},O=U=>{const D=U.target.value;b(D);const Q=D.split(" ").pop()||"";Q.startsWith("@")?(g(Q.slice(1)),v(!0)):v(!1)},M=(U,D)=>{var z;const Q=A.split(" ");Q[Q.length-1]=`@${U} `,b(Q.join(" ")),v(!1),(z=E.current)==null||z.focus()},P=U=>{const D=/@(\w+)/g,Q=[];let z;for(;(z=D.exec(U))!==null;){const G=z[1],Z=u.find(R=>R.full_name.replace(/\s+/g,"")===G);Z&&Q.push(Z.id)}return Q},X=async()=>{const U=[];for(const D of y){const Q=`${Date.now()}_${D.name}`,z=`tasks/${r}/comments/${Q}`,{error:G}=await ae.storage.from("task-attachments").upload(z,D);G?console.error("Error uploading file:",G):U.push(z)}return U},J=async()=>{if(!(!A.trim()&&y.length===0))try{N(!0);const U=await X(),D=P(A),{error:Q}=await ae.from("task_comments").insert([{task_id:r,comment_text:A,user_id:s==null?void 0:s.id,mentions:D,attachment_urls:U}]);if(Q)throw Q;b(""),x([]),F()}catch(U){console.error("Error adding comment:",U),alert("Failed to add comment")}finally{N(!1)}},H=async U=>{try{C(!0);const{error:D}=await ae.from("tasks").update({status:U}).eq("id",r);if(D)throw D;S(),n()}catch(D){console.error("Error updating status:",D),alert("Failed to update status")}finally{C(!1)}},V=U=>{var Q;const D=(Q=U.split(".").pop())==null?void 0:Q.toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(D||"")?a.jsx(n_,{className:"w-4 h-4"}):["pdf"].includes(D||"")?a.jsx(sr,{className:"w-4 h-4"}):a.jsx(wF,{className:"w-4 h-4"})},K=async U=>{try{const{data:D,error:Q}=await ae.storage.from("task-attachments").download(U);if(Q)throw Q;const z=URL.createObjectURL(D),G=document.createElement("a");G.href=z,G.download=U.split("/").pop()||"download",document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(z)}catch(D){console.error("Error downloading file:",D)}},B=U=>{const D={to_do:"bg-gray-100 text-gray-700 border-gray-300",in_progress:"bg-blue-100 text-blue-700 border-blue-300",waiting:"bg-orange-100 text-orange-700 border-orange-300",completed:"bg-green-100 text-green-700 border-green-300"};return D[U]||D.to_do},L=U=>{const D={low:"bg-gray-100 text-gray-700",medium:"bg-yellow-100 text-yellow-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"};return D[U]||D.medium};return h||!i?a.jsx(qt,{isOpen:e,onClose:t,title:"Loading...",children:a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(Mo,{className:"w-8 h-8 animate-spin text-blue-600"})})}):a.jsx(qt,{isOpen:e,onClose:t,title:i.title,size:"xl",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${L(i.priority)}`,children:i.priority.toUpperCase()}),a.jsxs("select",{value:i.status,onChange:U=>H(U.target.value),disabled:_,className:`px-3 py-1 rounded-full text-sm font-medium border-2 ${B(i.status)} cursor-pointer disabled:opacity-50`,children:[a.jsx("option",{value:"to_do",children:"To Do"}),a.jsx("option",{value:"in_progress",children:"In Progress"}),a.jsx("option",{value:"waiting",children:"Waiting"}),a.jsx("option",{value:"completed",children:"Completed"})]})]}),i.description&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:i.description})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Na,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:"Deadline:"}),a.jsx("span",{className:"font-medium text-gray-900",children:new Date(i.deadline).toLocaleString()})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(oo,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:"Created by:"}),a.jsx("span",{className:"font-medium text-gray-900",children:i.creator_name})]}),i.assignee_names.length>0&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(oo,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:"Assigned to:"}),a.jsx("span",{className:"font-medium text-gray-900",children:i.assignee_names.join(", ")})]}),i.inquiry_number&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Dg,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:"Inquiry:"}),a.jsx("span",{className:"font-medium text-blue-600",children:i.inquiry_number})]}),i.customer_name&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(oo,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:"Customer:"}),a.jsx("span",{className:"font-medium text-gray-900",children:i.customer_name})]}),i.product_name&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Dg,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:"Product:"}),a.jsx("span",{className:"font-medium text-gray-900",children:i.product_name})]})]}),i.attachment_urls.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[a.jsx(fo,{className:"w-4 h-4"}),"Attachments (",i.attachment_urls.length,")"]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.attachment_urls.map((U,D)=>a.jsxs("button",{onClick:()=>K(U),className:"flex items-center gap-2 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 text-left",children:[V(U),a.jsx("span",{className:"text-sm text-gray-700 truncate",children:U.split("/").pop()}),a.jsx(Ai,{className:"w-4 h-4 ml-auto text-gray-400"})]},D))})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(S0,{className:"w-5 h-5"}),"Discussion (",l.length,")"]}),a.jsx("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:l.length===0?a.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No comments yet. Start the discussion!"}):l.map(U=>a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-medium text-sm",children:U.user_name.charAt(0).toUpperCase()})}),a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"font-medium text-sm text-gray-900",children:U.user_name}),a.jsx("span",{className:"text-xs text-gray-500",children:new Date(U.created_at).toLocaleString()})]}),a.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:U.comment_text}),U.attachment_urls.length>0&&a.jsx("div",{className:"mt-2 space-y-1",children:U.attachment_urls.map((D,Q)=>a.jsxs("button",{onClick:()=>K(D),className:"flex items-center gap-2 text-xs text-blue-600 hover:text-blue-700",children:[V(D),D.split("/").pop()]},Q))})]})})]},U.id))}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx("textarea",{ref:E,value:A,onChange:O,placeholder:"Add a comment... Use @ to mention someone",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3}),m&&a.jsx("div",{className:"absolute bottom-full left-0 mb-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-10",children:u.filter(U=>U.full_name.toLowerCase().includes(p.toLowerCase())).slice(0,5).map(U=>a.jsxs("button",{onClick:()=>M(U.full_name.replace(/\s+/g,""),U.id),className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs",children:U.full_name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:U.full_name}),a.jsx("p",{className:"text-xs text-gray-500",children:U.email})]})]},U.id))})]}),y.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((U,D)=>a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-lg text-sm",children:[a.jsx(fo,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"text-gray-700",children:U.name}),a.jsx("button",{onClick:()=>x(Q=>Q.filter((z,G)=>G!==D)),className:"text-gray-500 hover:text-red-600",children:a.jsx(Kr,{className:"w-4 h-4"})})]},D))}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("input",{ref:j,type:"file",multiple:!0,onChange:U=>{U.target.files&&x(Array.from(U.target.files))},className:"hidden"}),a.jsxs("button",{onClick:()=>{var U;return(U=j.current)==null?void 0:U.click()},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition",children:[a.jsx(fo,{className:"w-4 h-4"}),"Attach Files"]}),a.jsx("button",{onClick:J,disabled:w||!A.trim()&&y.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:w?a.jsxs(a.Fragment,{children:[a.jsx(Mo,{className:"w-4 h-4 animate-spin"}),"Posting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ri,{className:"w-4 h-4"}),"Post Comment"]})})]})]})]})]})})}function IAe(){const{user:e,profile:t}=jr(),[r,n]=W.useState([]),[s,i]=W.useState([]),[o,l]=W.useState(!0),[c,u]=W.useState(""),[d,h]=W.useState(!1),[f,A]=W.useState(null),[b,m]=W.useState(!1),[v,p]=W.useState(!1),[g,y]=W.useState(null),[x,w]=W.useState({status:[],priority:[],assignedTo:[],view:"my-tasks"}),[N,_]=W.useState({total:0,pending:0,completed:0,overdue:0});W.useEffect(()=>{C()},[e]),W.useEffect(()=>{E()},[r,x,c]);const C=async()=>{try{l(!0);let M=ae.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(product_name)
        `).eq("is_deleted",!1).order("deadline",{ascending:!0});const{data:P,error:X}=await M;if(X)throw X;const J=(P==null?void 0:P.map(B=>B.id))||[],{data:H}=await ae.from("task_comments").select("task_id").in("task_id",J).eq("is_deleted",!1),V={};H==null||H.forEach(B=>{V[B.task_id]=(V[B.task_id]||0)+1});const K=(P||[]).map(B=>{var L,U,D,Q;return{...B,creator_name:(L=B.creator)==null?void 0:L.full_name,inquiry_number:(U=B.inquiry)==null?void 0:U.inquiry_number,customer_name:(D=B.customer)==null?void 0:D.company_name,product_name:(Q=B.product)==null?void 0:Q.product_name,comment_count:V[B.id]||0}});n(K),j(K)}catch(M){console.error("Error loading tasks:",M)}finally{l(!1)}},j=M=>{const P=new Date,X=M.filter(J=>J.assigned_users.includes((e==null?void 0:e.id)||"")||J.created_by===(e==null?void 0:e.id));_({total:X.length,pending:X.filter(J=>J.status!=="completed").length,completed:X.filter(J=>J.status==="completed").length,overdue:X.filter(J=>J.status!=="completed"&&new Date(J.deadline)<P).length})},E=()=>{let M=[...r];if(x.view==="my-tasks")M=M.filter(P=>P.assigned_users.includes((e==null?void 0:e.id)||"")||P.created_by===(e==null?void 0:e.id));else if(x.view==="pending")M=M.filter(P=>P.status!=="completed"&&(P.assigned_users.includes((e==null?void 0:e.id)||"")||P.created_by===(e==null?void 0:e.id)));else if(x.view==="completed")M=M.filter(P=>P.status==="completed"&&(P.assigned_users.includes((e==null?void 0:e.id)||"")||P.created_by===(e==null?void 0:e.id)));else if(x.view==="overdue"){const P=new Date;M=M.filter(X=>X.status!=="completed"&&new Date(X.deadline)<P&&(X.assigned_users.includes((e==null?void 0:e.id)||"")||X.created_by===(e==null?void 0:e.id)))}if(x.status.length>0&&(M=M.filter(P=>x.status.includes(P.status))),x.priority.length>0&&(M=M.filter(P=>x.priority.includes(P.priority))),c){const P=c.toLowerCase();M=M.filter(X=>{var J,H,V,K;return X.title.toLowerCase().includes(P)||((J=X.description)==null?void 0:J.toLowerCase().includes(P))||((H=X.customer_name)==null?void 0:H.toLowerCase().includes(P))||((V=X.product_name)==null?void 0:V.toLowerCase().includes(P))||((K=X.inquiry_number)==null?void 0:K.toLowerCase().includes(P))})}i(M)},S=M=>{switch(M){case"urgent":return a.jsx(_F,{className:"w-4 h-4 text-red-600"});case"high":return a.jsx(zb,{className:"w-4 h-4 text-orange-600"});case"medium":return a.jsx(Ug,{className:"w-4 h-4 text-yellow-600"});default:return a.jsx(vF,{className:"w-4 h-4 text-gray-400"})}},F=M=>{const P={to_do:"bg-gray-100 text-gray-700",in_progress:"bg-blue-100 text-blue-700",waiting:"bg-orange-100 text-orange-700",completed:"bg-green-100 text-green-700"},X={to_do:"To Do",in_progress:"In Progress",waiting:"Waiting",completed:"Completed"};return a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P[M]}`,children:X[M]})},I=M=>{const P=new Date(M),X=new Date,J=P.getTime()-X.getTime(),H=Math.floor(J/(1e3*60*60)),V=Math.floor(H/24);return J<0?a.jsx("span",{className:"text-red-600 font-medium",children:"Overdue"}):H<24?a.jsxs("span",{className:"text-orange-600 font-medium",children:["Due in ",H,"h"]}):V<7?a.jsxs("span",{className:"text-yellow-600 font-medium",children:["Due in ",V,"d"]}):a.jsx("span",{className:"text-gray-600",children:P.toLocaleDateString()})},O=async M=>{if(confirm("Are you sure you want to delete this task?"))try{const{error:P}=await ae.from("tasks").update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:e==null?void 0:e.id}).eq("id",M);if(P)throw P;C()}catch(P){console.error("Error deleting task:",P),alert("Failed to delete task")}};return o?a.jsx(Zn,{children:a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):a.jsxs(Zn,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tasks"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and track team assignments"})]}),a.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"New Task"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(Us,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Tasks"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.total})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(Ra,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.pending})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(Us,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.completed})]})]})}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(ea,{className:"w-6 h-6 text-red-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.overdue})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[a.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:"my-tasks",label:"My Tasks"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"overdue",label:"Overdue"},{value:"all",label:"All Tasks"}].map(M=>a.jsx("button",{onClick:()=>w({...x,view:M.value}),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${x.view===M.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:M.label},M.value))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-64",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search tasks...",value:c,onChange:M=>u(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsx("button",{onClick:()=>h(!d),className:`px-4 py-2 border rounded-lg transition ${d?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:a.jsx(fR,{className:"w-5 h-5"})})]})]}),d&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsx("div",{className:"space-y-2",children:["to_do","in_progress","waiting","completed"].map(M=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:x.status.includes(M),onChange:P=>{P.target.checked?w({...x,status:[...x.status,M]}):w({...x,status:x.status.filter(X=>X!==M)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700 capitalize",children:M.replace("_"," ")})]},M))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),a.jsx("div",{className:"space-y-2",children:["urgent","high","medium","low"].map(M=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:x.priority.includes(M),onChange:P=>{P.target.checked?w({...x,priority:[...x.priority,M]}):w({...x,priority:x.priority.filter(X=>X!==M)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-sm text-gray-700 capitalize",children:M})]},M))})]}),a.jsx("div",{className:"flex items-end",children:a.jsx("button",{onClick:()=>w({...x,status:[],priority:[],assignedTo:[]}),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Clear All Filters"})})]})]}),a.jsx("div",{className:"divide-y divide-gray-200",children:s.length===0?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx(Us,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tasks found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:c||x.status.length>0||x.priority.length>0?"Try adjusting your filters or search query":"Create your first task to get started"}),!c&&x.status.length===0&&a.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Create Task"]})]}):s.map(M=>a.jsx("div",{className:"p-4 hover:bg-gray-50 transition cursor-pointer",onClick:()=>{A(M),m(!0)},children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"mt-1",children:S(M.priority)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("h3",{className:"font-medium text-gray-900 truncate",children:M.title}),M.attachment_urls.length>0&&a.jsx(fo,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]}),M.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:M.description}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2",children:[F(M.status),a.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[a.jsx(Na,{className:"w-4 h-4"}),I(M.deadline)]}),M.comment_count>0&&a.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[a.jsx(S0,{className:"w-4 h-4"}),M.comment_count]}),M.inquiry_number&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[a.jsx(Og,{className:"w-3 h-3"}),M.inquiry_number]}),M.customer_name&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[a.jsx(oo,{className:"w-3 h-3"}),M.customer_name]}),M.tags.length>0&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[a.jsx(Dg,{className:"w-3 h-3"}),M.tags[0],M.tags.length>1&&` +${M.tags.length-1}`]})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:P=>{P.stopPropagation(),y(g===M.id?null:M.id)},className:"p-1 hover:bg-gray-100 rounded transition",children:a.jsx(vR,{className:"w-5 h-5 text-gray-600"})}),g===M.id&&a.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[a.jsxs("button",{onClick:P=>{P.stopPropagation(),A(M),m(!0),y(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[a.jsx(Kc,{className:"w-4 h-4"}),"View Details"]}),(M.created_by===(e==null?void 0:e.id)||(t==null?void 0:t.role)==="admin")&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:P=>{P.stopPropagation(),y(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[a.jsx(Rs,{className:"w-4 h-4"}),"Edit Task"]}),a.jsxs("button",{onClick:P=>{P.stopPropagation(),O(M.id),y(null)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[a.jsx(nn,{className:"w-4 h-4"}),"Delete Task"]})]})]})]})]})},M.id))})]})]}),v&&a.jsx(oL,{isOpen:v,onClose:()=>p(!1),onSuccess:()=>{p(!1),C()}}),b&&f&&a.jsx(TAe,{isOpen:b,onClose:()=>{m(!1),A(null)},taskId:f.id,onUpdate:C})]})}function LAe({challan:e,items:t,onClose:r}){var d,h,f,A,b,m,v;const n=W.useRef(null),s=()=>{window.print()},i=async()=>{if(n.current)try{const p=await td(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:E=>{const S=E.getElementById("challan-print-content");S&&(S.style.width="210mm")}}),g=p.toDataURL("image/png",1),y=new Lt("p","mm","a4"),x=y.internal.pageSize.getWidth(),w=y.internal.pageSize.getHeight(),N=p.width,_=p.height,C=x/N,j=_*C;if(j>w){let E=0,S=j;for(;S>0;)y.addImage(g,"PNG",0,E,x,j),S-=w,E-=w,S>0&&y.addPage()}else y.addImage(g,"PNG",0,0,x,j);y.save(`Delivery-Challan-${e.challan_number}.pdf`)}catch(p){console.error("Error generating PDF:",p),alert("Failed to generate PDF. Please try again.")}},o=p=>{const g=new Date(p),y=g.getDate(),x=g.getMonth()+1,w=g.getFullYear();return`${y.toString().padStart(2,"0")}-${x.toString().padStart(2,"0")}-${w}`},l=p=>{const g=new Date(p),x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][g.getMonth()],w=g.getFullYear();return`${x} ${w}`},c=t.reduce((p,g)=>p+g.quantity,0),u=((h=(d=t[0])==null?void 0:d.products)==null?void 0:h.unit)||"kg";return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[a.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:a.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[a.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Surat Jalan ",e.challan_number]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:s,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(QA,{className:"h-4 w-4"}),"Cetak"]}),a.jsxs("button",{onClick:i,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[a.jsx(Ai,{className:"h-4 w-4"}),"PDF"]}),a.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:a.jsx(Kr,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{id:"challan-print-content",ref:n,className:"p-8",children:[a.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[a.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:a.jsxs("g",{children:[a.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),a.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),a.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"SURAT JALAN"})})]}),a.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No izin PBF"}),a.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),a.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),a.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[a.jsx("div",{className:"mb-1",children:a.jsx("span",{className:"font-bold",children:"Company Name:"})}),a.jsx("div",{className:"ml-4 mb-2",children:a.jsx("p",{className:"font-semibold",children:((f=e.customers)==null?void 0:f.company_name)||""})}),a.jsx("div",{className:"mb-1",children:a.jsx("span",{className:"font-bold",children:"Address:"})}),a.jsxs("div",{className:"ml-4 mb-2",children:[a.jsx("p",{children:e.delivery_address||""}),a.jsx("p",{children:((A=e.customers)==null?void 0:A.city)||""})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-bold",children:"Phone:"}),a.jsx("span",{className:"ml-2",children:((b=e.customers)==null?void 0:b.phone)||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"No.Izin PBF:"}),a.jsx("span",{className:"ml-2",children:((m=e.customers)==null?void 0:m.pbf_license)||"-"})]})]}),a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right w-64",children:[a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-bold",children:"Challan No: "}),a.jsx("span",{children:e.challan_number})]}),a.jsxs("div",{className:"mb-1",children:[a.jsx("span",{className:"font-bold",children:"Challan Date: "}),a.jsx("span",{children:o(e.challan_date)})]}),e.vehicle_number&&a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Vehicle No: "}),a.jsx("span",{children:e.vehicle_number})]})]})]})}),a.jsx("div",{className:"mb-2 border-2 border-black print:mb-1.5",children:a.jsxs("table",{className:"w-full border-collapse text-[9px] print:text-[8px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-black",children:[a.jsx("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"3%"},children:"No"}),a.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-left font-bold print:px-0.5 print:py-1",style:{width:"27%"},children:["Nama Produk",a.jsx("br",{}),"Product Name"]}),a.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"13%"},children:["No Batch",a.jsx("br",{}),"Batch No"]}),a.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"8%"},children:["Exp.",a.jsx("br",{}),"Date"]}),a.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"15%"},children:["Kemasan",a.jsx("br",{}),"Packaging"]}),a.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"6%"},children:["Jml",a.jsx("br",{}),"Packs"]}),a.jsxs("th",{className:"px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"10%"},children:["Kuantitas",a.jsx("br",{}),"Quantity"]})]})}),a.jsxs("tbody",{children:[t.map((p,g)=>{var y,x,w,N,_;return a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:g+1}),a.jsx("td",{className:"border-r border-black px-1 py-1 print:px-0.5 print:py-0.5",children:(y=p.products)==null?void 0:y.product_name}),a.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:(x=p.batches)==null?void 0:x.batch_number}),a.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:(w=p.batches)!=null&&w.expiry_date?l(p.batches.expiry_date):"-"}),a.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:p.pack_type&&p.pack_size&&p.number_of_packs?`${p.pack_size} ${((N=p.products)==null?void 0:N.unit)||"kg"}/${p.pack_type}`:p.pack_type&&p.pack_size?`${p.pack_size} ${p.pack_type}`:"-"}),a.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:p.number_of_packs||"-"}),a.jsxs("td",{className:"px-1 py-1 text-center print:px-0.5 print:py-0.5",children:[p.quantity.toLocaleString()," ",((_=p.products)==null?void 0:_.unit)||u]})]},p.id)}),a.jsxs("tr",{className:"border-t-2 border-black bg-gray-50 font-bold",children:[a.jsx("td",{colSpan:6,className:"border-r border-black px-1 py-1 text-right print:px-0.5 print:py-0.5",children:"Total Kuantitas / Total Quantity:"}),a.jsxs("td",{className:"px-1 py-1 text-center print:px-0.5 print:py-0.5",children:[c.toLocaleString()," ",u]})]})]})]})}),a.jsxs("div",{className:"mb-2 p-1.5 print:mb-1.5 print:p-1",children:[a.jsx("p",{className:"text-[9px] font-semibold print:text-[8px]",children:"Catatan / Notes:"}),e.notes?a.jsx("p",{className:"text-[9px] print:text-[8px] mt-0.5",children:e.notes}):a.jsx("p",{className:"text-[9px] print:text-[8px] mt-0.5",children:"Produk dikirim dalam kondisi sesuai persyaratan penyimpanan / Goods are delivered under controlled storage conditions."})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-2 print:gap-1.5",children:[a.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[a.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Disiapkan Oleh",a.jsx("br",{}),"Prepared By"]}),a.jsx("div",{className:"mb-8 print:mb-6",children:a.jsx("div",{className:"h-10 print:h-8"})}),a.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),a.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),a.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[a.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Dikirim Oleh",a.jsx("br",{}),"Delivered By"]}),a.jsx("div",{className:"mb-8 print:mb-6",children:a.jsx("div",{className:"h-10 print:h-8"})}),a.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),a.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),a.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[a.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Farmasi",a.jsx("br",{}),"Pharmacist"]}),a.jsx("div",{className:"mb-8 print:mb-6",children:a.jsx("div",{className:"h-10 print:h-8"})}),a.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),a.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),a.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[a.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Diterima Oleh",a.jsx("br",{}),"Received By"]}),a.jsx("div",{className:"mb-8 print:mb-6",children:a.jsx("div",{className:"h-10 print:h-8"})}),a.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),a.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),a.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:((v=e.customers)==null?void 0:v.company_name)||""})]})]})]})]})]})}),a.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #challan-print-content,
          #challan-print-content * {
            visibility: visible;
          }

          #challan-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #challan-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}const OAe=e=>e?new Date(e)<new Date:!1;function UAe(){const{profile:e}=jr(),{setCurrentPage:t,setNavigationData:r}=Ho(),[n,s]=W.useState([]),[i,o]=W.useState([]),[l,c]=W.useState([]),[u,d]=W.useState([]),[h,f]=W.useState(!0),[A,b]=W.useState(!1),[m,v]=W.useState(!1),[p,g]=W.useState(null),[y,x]=W.useState([]),[w,N]=W.useState(null),[_,C]=W.useState(null),[j,E]=W.useState([]),[S,F]=W.useState(!1),[I,O]=W.useState(""),[M,P]=W.useState(null),[X,J]=W.useState({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),[H,V]=W.useState([]),[K,B]=W.useState([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}]);W.useEffect(()=>{D(),z(),G(),Z(),U()},[]);const L=async pe=>{try{let Fe=ae.from("sales_orders").select(`
          id,
          so_number,
          customer_id,
          status,
          customers(company_name)
        `).in("status",["approved","stock_reserved","shortage","pending_delivery"]).eq("is_archived",!1).order("so_date",{ascending:!1});pe&&(Fe=Fe.eq("customer_id",pe));const{data:Ke,error:Xe}=await Fe;if(Xe)throw Xe;V(Ke||[])}catch(Fe){console.error("Error loading sales orders:",Fe)}},U=async()=>{try{const{data:pe,error:Fe}=await ae.from("app_settings").select("*").limit(1).maybeSingle();if(Fe)throw Fe;N(pe)}catch(pe){console.error("Error loading company settings:",pe)}},D=async()=>{try{const{data:pe,error:Fe}=await ae.from("delivery_challans").select("*, customers(company_name, address, city, phone, pbf_license)").order("challan_date",{ascending:!1});if(Fe)throw Fe;const{data:Ke,error:Xe}=await ae.from("dc_invoicing_summary").select("*");Xe&&console.error("Error loading invoicing status:",Xe);const tt=new Map;(Ke||[]).forEach(ke=>{tt.set(ke.challan_id,{status:ke.dc_status,total_items:ke.total_items,not_invoiced_items:ke.not_invoiced_items,partially_invoiced_items:ke.partially_invoiced_items,fully_invoiced_items:ke.fully_invoiced_items,linked_invoices:ke.linked_invoice_numbers||[]})});const st=(pe||[]).map(ke=>{const Ee=tt.get(ke.id);return{...ke,invoicing_status:(Ee==null?void 0:Ee.status)||"not_invoiced",total_items:(Ee==null?void 0:Ee.total_items)||0,invoiced_items:(Ee==null?void 0:Ee.fully_invoiced_items)+(Ee==null?void 0:Ee.partially_invoiced_items)||0,linked_invoices:(Ee==null?void 0:Ee.linked_invoices)||[]}});s(st)}catch(pe){console.error("Error loading challans:",pe)}finally{f(!1)}},Q=async()=>{try{const{data:pe}=await ae.from("app_settings").select("financial_year_start").limit(1).maybeSingle();let Fe=new Date().getFullYear().toString().slice(-2);pe!=null&&pe.financial_year_start&&(Fe=new Date(pe.financial_year_start).getFullYear().toString().slice(-2));const Ke="DO",{data:Xe}=await ae.from("delivery_challans").select("challan_number").or(`challan_number.like.DO-${Fe}%,challan_number.like.DC-${Fe}%`);let tt=1;if(Xe&&Xe.length>0){const ke=Xe.map(Ee=>{const Je=Ee.challan_number.match(/(\d+)$/);return Je?parseInt(Je[1],10):0}).filter(Ee=>!isNaN(Ee));ke.length>0&&(tt=Math.max(...ke)+1)}const st=String(tt).padStart(4,"0");return`${Ke}-${Fe}-${st}`}catch(pe){return console.error("Error generating challan number:",pe),"DO-25-0001"}},z=async()=>{try{const{data:pe,error:Fe}=await ae.from("customers").select("id, company_name, address, city").eq("is_active",!0).order("company_name");if(Fe)throw Fe;o(pe||[])}catch(pe){console.error("Error loading customers:",pe)}},G=async()=>{try{const{data:pe,error:Fe}=await ae.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(Fe)throw Fe;c(pe||[])}catch(pe){console.error("Error loading products:",pe)}},Z=async()=>{try{const{data:pe,error:Fe}=await ae.from("batches").select("id, batch_number, product_id, current_stock, reserved_stock, expiry_date, packaging_details, import_date").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!0});if(Fe)throw Fe;d(pe||[])}catch(pe){console.error("Error loading batches:",pe)}},R=async pe=>{try{const{data:Fe,error:Ke}=await ae.from("delivery_challan_items").select("*, products(product_name, product_code, unit), batches(batch_number, expiry_date, packaging_details, current_stock)").eq("challan_id",pe);if(Ke)throw Ke;return Fe||[]}catch(Fe){return console.error("Error loading challan items:",Fe),[]}},le=pe=>u.filter(Ke=>Ke.product_id===pe&&!OAe(Ke.expiry_date)).sort((Ke,Xe)=>{const tt=new Date(Ke.import_date).getTime(),st=new Date(Xe.import_date).getTime();return tt-st})[0]||null,ee=pe=>{const Fe=i.find(Ke=>Ke.id===pe);Fe&&(J({...X,customer_id:pe,sales_order_id:"",delivery_address:`${Fe.address}, ${Fe.city}`}),L(pe))},_e=async pe=>{if(J({...X,sales_order_id:pe}),pe){const Fe=H.find(Ke=>Ke.id===pe);if(Fe){J(Ke=>({...Ke,customer_id:Fe.customer_id}));try{const{data:Ke,error:Xe}=await ae.from("sales_order_items").select(`
              id,
              product_id,
              quantity,
              products(product_name)
            `).eq("sales_order_id",pe);if(Xe)throw Xe;if(Ke&&Ke.length>0){const tt=Ke.map(st=>{const ke=u.filter(xt=>xt.product_id===st.product_id&&xt.current_stock-(xt.reserved_stock||0)>0),Ee=ke.length>0?ke[0]:null;if(!Ee)return{product_id:st.product_id,batch_id:"",quantity:st.quantity,pack_size:null,pack_type:null,number_of_packs:null};let Je=null,rt=null,Ze=null;if(Ee.packaging_details){const xt=Ee.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);xt&&(Ze=parseInt(xt[1],10),rt=xt[2].toLowerCase(),Je=parseFloat(xt[3]))}return{product_id:st.product_id,batch_id:Ee.id,quantity:st.quantity,pack_size:Je,pack_type:rt,number_of_packs:Ze||1}});B(tt)}}catch(Ke){console.error("Error loading SO items:",Ke),alert("Failed to load Sales Order items. Please try again.")}}}else B([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},se=(pe,Fe)=>{const Ke=u.find(Xe=>Xe.id===Fe);if(Ke){const Xe=[...K];let tt=null,st=null,ke=null;if(Ke.packaging_details){const Ee=Ke.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);Ee&&(ke=parseInt(Ee[1],10),st=Ee[2].toLowerCase(),tt=parseFloat(Ee[3]))}Xe[pe]={...Xe[pe],batch_id:Fe,pack_size:tt,pack_type:st,number_of_packs:ke||1,quantity:tt&&ke?tt*ke:0},B(Xe)}},te=(pe,Fe)=>{const Ke=[...K],Xe=Ke[pe];Xe.pack_size&&(Ke[pe]={...Xe,number_of_packs:Fe,quantity:Xe.pack_size*Fe},B(Ke))},Ne=()=>{B([...K,{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},Se=pe=>{K.length>1&&B(K.filter((Fe,Ke)=>Ke!==pe))},Ae=async pe=>{C(pe),J({challan_number:pe.challan_number,customer_id:pe.customer_id,challan_date:pe.challan_date,delivery_address:pe.delivery_address,vehicle_number:pe.vehicle_number||"",driver_name:pe.driver_name||"",notes:pe.notes||""});const Fe=await R(pe.id);E(Fe),Fe.length>0&&B(Fe.map(Ke=>({product_id:Ke.product_id,batch_id:Ke.batch_id,quantity:Ke.quantity,pack_size:Ke.pack_size,pack_type:Ke.pack_type,number_of_packs:Ke.number_of_packs}))),b(!0)},ye=async pe=>{if(pe.preventDefault(),K.filter(st=>!st.product_id||!st.batch_id||st.quantity<=0).length>0){alert("Please select product, batch, and enter quantity for all items before saving.");return}if(K.filter(st=>!st.batch_id||st.batch_id==="").length>0){alert("Some items do not have a batch selected. Please select a batch for all items.");return}if(K.filter(st=>!st.product_id||st.product_id==="").length>0){alert("Some items do not have a product selected. Please select a product for all items.");return}const tt=new Map;for(const st of K){const ke=tt.get(st.batch_id)||0;tt.set(st.batch_id,ke+st.quantity)}for(const[st,ke]of tt.entries()){const Ee=u.find(Je=>Je.id===st);if(Ee){let Je=Ee.current_stock-(Ee.reserved_stock||0);if(_){const rt=j.filter(Ze=>Ze.batch_id===st).reduce((Ze,xt)=>Ze+xt.quantity,0);Je+=rt}if(ke>Je){const rt=l.find(Ze=>{var xt;return Ze.id===((xt=K.find(mt=>mt.batch_id===st))==null?void 0:xt.product_id)});alert(`Insufficient available stock for batch ${Ee.batch_number}!

Product: ${(rt==null?void 0:rt.product_name)||"Unknown"}
Batch: ${Ee.batch_number}
Available: ${Je} kg
Total Requested (across all items): ${ke} kg

You are using this batch in multiple items. Please reduce quantities or select different batches.`);return}}}try{const{data:{user:st}}=await ae.auth.getUser();if(!st)throw new Error("Not authenticated");const ke={challan_number:X.challan_number,customer_id:X.customer_id,sales_order_id:X.sales_order_id||null,challan_date:X.challan_date,delivery_address:X.delivery_address,vehicle_number:X.vehicle_number||null,driver_name:X.driver_name||null,notes:X.notes||null,approval_status:"pending_approval",created_by:st.id};let Ee;if(_){const{data:Je,error:rt}=await ae.from("delivery_challans").update(ke).eq("id",_.id).select().single();if(rt)throw rt;const Ze=K.map(bt=>({product_id:bt.product_id,batch_id:bt.batch_id,quantity:bt.quantity,pack_size:bt.pack_size,pack_type:bt.pack_type,number_of_packs:bt.number_of_packs})),{data:xt,error:mt}=await ae.rpc("edit_delivery_challan",{p_challan_id:_.id,p_new_items:Ze});if(mt)throw mt;if(!(xt!=null&&xt.success))throw new Error((xt==null?void 0:xt.error)||"Failed to update DC items");Ee=Je.id}else{const{data:Je,error:rt}=await ae.from("delivery_challans").insert([ke]).select().single();if(rt)throw rt;Ee=Je.id}if(!_){const Je=K.map(Ze=>({challan_id:Ee,product_id:Ze.product_id,batch_id:Ze.batch_id,quantity:Ze.quantity,pack_size:Ze.pack_size,pack_type:Ze.pack_type,number_of_packs:Ze.number_of_packs})),{error:rt}=await ae.from("delivery_challan_items").insert(Je);if(rt)throw await ae.from("delivery_challans").delete().eq("id",Ee),rt}if(!_&&X.sales_order_id){const{data:Je}=await ae.from("sales_order_items").select("id, product_id, quantity, delivered_quantity").eq("sales_order_id",X.sales_order_id);if(Je){let rt=!0;for(const xt of Je){const mt=K.find(vt=>vt.product_id===xt.product_id),bt=(xt.delivered_quantity||0)+((mt==null?void 0:mt.quantity)||0);await ae.from("sales_order_items").update({delivered_quantity:bt}).eq("id",xt.id),bt<xt.quantity&&(rt=!1)}const Ze=rt?"delivered":"partially_delivered";await ae.from("sales_orders").update({status:Ze,is_archived:rt,archived_at:rt?new Date().toISOString():null,archived_by:rt?st.id:null,archive_reason:rt?"Delivery Challan created and all items delivered":null}).eq("id",X.sales_order_id)}}b(!1),Pe(),D(),Z(),alert(`Delivery Challan ${_?"updated":"created"} successfully!`)}catch(st){console.error("Error saving challan:",st);const ke=(st==null?void 0:st.message)||"Unknown error occurred";ke.includes("batch_id")?alert("Error: Invalid batch selection. Please ensure all items have a valid batch selected."):ke.includes("foreign key")?alert("Error: Invalid product or batch selection. Please check your selections."):alert(`Failed to save challan: ${ke}`)}},Le=async pe=>{if(confirm("Are you sure you want to delete this delivery challan? This will revert the linked Sales Order status."))try{const{data:Fe}=await ae.from("delivery_challans").select("sales_order_id, id").eq("id",pe).single(),{error:Ke}=await ae.from("delivery_challans").delete().eq("id",pe);if(Ke)throw Ke;Fe!=null&&Fe.sales_order_id&&await ae.from("sales_orders").update({status:"pending_delivery",is_archived:!1,archived_at:null,archived_by:null,archive_reason:null}).eq("id",Fe.sales_order_id),D(),alert("Delivery Challan deleted successfully. Sales Order status has been reverted.")}catch(Fe){console.error("Error deleting challan:",Fe),alert("Failed to delete challan. Please try again.")}},Re=async pe=>{if(confirm("Approve this Delivery Challan? It will be available for invoice creation."))try{const{data:{user:Fe}}=await ae.auth.getUser();if(!Fe)throw new Error("Not authenticated");const{error:Ke}=await ae.from("delivery_challans").update({approval_status:"approved",approved_by:Fe.id,approved_at:new Date().toISOString()}).eq("id",pe);if(Ke)throw Ke;alert("Delivery Challan approved successfully!"),D()}catch(Fe){console.error("Error approving challan:",Fe.message),alert("Failed to approve challan")}},we=async()=>{if(!M||!I.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:pe}}=await ae.auth.getUser();if(!pe)throw new Error("Not authenticated");const{error:Fe}=await ae.from("delivery_challans").update({approval_status:"rejected",rejected_by:pe.id,rejected_at:new Date().toISOString(),rejection_reason:I}).eq("id",M);if(Fe)throw Fe;alert("Delivery Challan rejected"),F(!1),O(""),P(null),D()}catch(pe){console.error("Error rejecting challan:",pe.message),alert("Failed to reject challan")}},Pe=()=>{C(null),E([]),J({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),B([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},ze=[{key:"challan_number",label:"DO Number"},{key:"customer",label:"Customer",render:pe=>{var Fe;return a.jsx("div",{className:"font-medium",children:(Fe=pe.customers)==null?void 0:Fe.company_name})}},{key:"challan_date",label:"Date",render:pe=>new Date(pe.challan_date).toLocaleDateString()},{key:"approval_status",label:"Status / Approval",render:pe=>{const Fe={pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},Ke={pending_approval:"Pending Approval",approved:"Approved",rejected:"Rejected"};return a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Fe[pe.approval_status]}`,children:Ke[pe.approval_status]}),pe.approval_status==="pending_approval"&&(e==null?void 0:e.role)==="admin"&&a.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[a.jsx("button",{onClick:Xe=>{Xe.stopPropagation(),Re(pe.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Delivery Challan",children:a.jsx(yn,{className:"w-6 h-6 text-green-600"})}),a.jsx("button",{onClick:Xe=>{Xe.stopPropagation(),P(pe.id),F(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Delivery Challan",children:a.jsx(un,{className:"w-6 h-6 text-red-600"})})]}),pe.approval_status==="approved"&&a.jsx(yn,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),pe.approval_status==="rejected"&&a.jsx(un,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}},{key:"invoicing_status",label:"Invoicing Status",render:pe=>{const Fe={not_invoiced:"bg-gray-100 text-gray-700",partially_invoiced:"bg-yellow-100 text-yellow-700",fully_invoiced:"bg-blue-100 text-blue-700"},Ke={not_invoiced:"Not Invoiced",partially_invoiced:"Partially Invoiced",fully_invoiced:"Fully Invoiced"},Xe=pe.invoicing_status||"not_invoiced";return a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${Fe[Xe]}`,children:Ke[Xe]}),pe.total_items>0&&a.jsxs("div",{className:"text-xs text-gray-500",children:[pe.invoiced_items||0,"/",pe.total_items," items invoiced"]}),pe.linked_invoices&&pe.linked_invoices.length>0&&a.jsx("div",{className:"text-xs text-blue-600 font-medium",children:pe.linked_invoices.join(", ")})]})}}],Ve=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="accounts"||(e==null?void 0:e.role)==="sales"||(e==null?void 0:e.role)==="warehouse",lt={total:n.length};return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Delivery Challan (Surat Jalan)"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage delivery orders and dispatch records"})]}),Ve&&a.jsxs("button",{onClick:async()=>{Pe();const pe=await Q();J(Fe=>({...Fe,challan_number:pe})),b(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Create Delivery Challan"]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Delivery Challans"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:lt.total})]}),a.jsx(ws,{columns:ze,data:n,loading:h,actions:pe=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:async()=>{const Fe=await R(pe.id);g(pe),x(Fe),v(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Challan",children:a.jsx(Kc,{className:"w-4 h-4"})}),Ve&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:async()=>{const Fe=await R(pe.id);r({sourceType:"delivery_challan",customerId:pe.customer_id,challanNumber:pe.challan_number,challanId:pe.id,items:Fe}),t("sales")},className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Create Invoice from DO",children:a.jsx(sr,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Ae(pe),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Challan",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Le(pe.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Challan",children:a.jsx(nn,{className:"w-4 h-4"})})]})]})}),a.jsx(qt,{isOpen:A,onClose:()=>{b(!1),Pe()},title:_?`Edit DC - ${X.challan_number}`:`Create DC - ${X.challan_number}`,size:"xl",children:a.jsxs("form",{onSubmit:ye,className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsxs("select",{value:X.customer_id,onChange:pe=>ee(pe.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!X.sales_order_id,children:[a.jsx("option",{value:"",children:"Select Customer"}),i.map(pe=>a.jsx("option",{value:pe.id,children:pe.company_name},pe.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Linked Sales Order"}),a.jsxs("select",{value:X.sales_order_id,onChange:pe=>_e(pe.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",disabled:!X.customer_id,children:[a.jsx("option",{value:"",children:"No Sales Order / Manual Entry"}),H.map(pe=>a.jsxs("option",{value:pe.id,children:[pe.so_number," (",pe.status,")"]},pe.id))]}),X.customer_id&&H.length===0&&a.jsx("p",{className:"text-xs text-orange-600 mt-1",children:" No active sales orders for this customer"}),!X.customer_id&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a customer first"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle Number"}),a.jsx("input",{type:"text",value:X.vehicle_number,onChange:pe=>J({...X,vehicle_number:pe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"B 1234 XYZ"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver Name"}),a.jsx("input",{type:"text",value:X.driver_name,onChange:pe=>J({...X,driver_name:pe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Driver name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",value:X.challan_date,onChange:pe=>J({...X,challan_date:pe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Address *"}),a.jsx("textarea",{value:X.delivery_address,onChange:pe=>J({...X,delivery_address:pe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:X.notes,onChange:pe=>J({...X,notes:pe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Additional notes..."})]})]}),a.jsxs("div",{className:"border-t pt-3 mt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Items to Dispatch"}),a.jsx("button",{type:"button",onClick:Ne,className:"text-sm px-3 py-1 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg font-medium transition-colors",children:"+ Add Item"})]}),a.jsx("div",{className:"space-y-2",children:K.map((pe,Fe)=>{const Ke=new Map;K.forEach((st,ke)=>{if(ke!==Fe&&st.batch_id){const Ee=Ke.get(st.batch_id)||0;Ke.set(st.batch_id,Ee+st.quantity)}});const Xe=u.filter(st=>{const ke=st.current_stock-(st.reserved_stock||0),Ee=Ke.get(st.id)||0;return st.product_id===pe.product_id&&ke-Ee>0}),tt=u.find(st=>st.id===pe.batch_id);return a.jsxs("div",{className:"relative p-2 bg-gray-50 rounded border border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"Product *"}),a.jsxs("select",{value:pe.product_id,onChange:st=>{const ke=[...K];ke[Fe]={...ke[Fe],product_id:st.target.value,batch_id:""},B(ke)},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Product"}),l.map(st=>a.jsx("option",{value:st.id,children:st.product_name},st.id))]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Batch *"}),pe.product_id&&Xe.length>0&&a.jsx("button",{type:"button",onClick:()=>{const st=le(pe.product_id);st&&se(Fe,st.id)},className:"text-[10px] text-blue-600 hover:text-blue-700 font-medium",title:"Select oldest batch (FIFO)",children:"Use FIFO"})]}),pe.product_id?Xe.length>0?a.jsxs("select",{value:pe.batch_id,onChange:st=>se(Fe,st.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Batch"}),Xe.map((st,ke)=>{const Ee=ke===0?" ":"",Je=st.current_stock-(st.reserved_stock||0),rt=Ke.get(st.id)||0,Ze=Je-rt;return a.jsxs("option",{value:st.id,children:[st.batch_number," (Avl: ",Ze,"kg)",Ee]},st.id)})]}):a.jsxs("div",{className:"w-full px-2 py-1 text-xs border border-red-300 rounded bg-red-50 text-red-700 flex items-center gap-1",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"No stock available"})]}):a.jsx("div",{className:"w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100 text-gray-400",children:"Select product first"})]})]}),tt&&a.jsx("div",{className:"mb-2",children:a.jsxs("table",{className:"w-full text-[10px] border border-gray-300",children:[a.jsx("thead",{className:"bg-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-1 py-0.5 text-left border-r border-gray-300",children:"Batch"}),a.jsx("th",{className:"px-1 py-0.5 text-left border-r border-gray-300",children:"Expiry"}),a.jsx("th",{className:"px-1 py-0.5 text-left border-r border-gray-300",children:"Packaging"}),a.jsx("th",{className:"px-1 py-0.5 text-right border-r border-gray-300",children:"Total"}),a.jsx("th",{className:"px-1 py-0.5 text-right font-semibold",children:"Available"})]})}),a.jsx("tbody",{children:a.jsxs("tr",{className:"bg-white",children:[a.jsx("td",{className:"px-1 py-0.5 border-r border-gray-300",children:tt.batch_number}),a.jsx("td",{className:"px-1 py-0.5 border-r border-gray-300",children:tt.expiry_date?new Date(tt.expiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-"}),a.jsx("td",{className:"px-1 py-0.5 border-r border-gray-300",children:tt.packaging_details||"-"}),a.jsxs("td",{className:"px-1 py-0.5 text-right border-r border-gray-300",children:[tt.current_stock,"kg"]}),a.jsxs("td",{className:"px-1 py-0.5 text-right font-bold text-green-600",children:[(()=>{const st=tt.current_stock-(tt.reserved_stock||0),ke=Ke.get(tt.id)||0;return st-ke})(),"kg"]})]})})]})}),pe.pack_size&&a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"No. of Packs *"}),a.jsx("input",{type:"number",value:pe.number_of_packs||"",onChange:st=>te(Fe,Number(st.target.value)),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,min:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"Pack Size"}),a.jsx("input",{type:"text",value:`${pe.pack_size} kg`,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100",disabled:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"Total Qty (Kg)"}),a.jsx("input",{type:"text",value:`${pe.quantity} kg`,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100",disabled:!0})]})]}),K.length>1&&a.jsx("button",{type:"button",onClick:()=>Se(Fe),className:"absolute top-1 right-1 text-xs text-red-600 hover:text-red-800 bg-white px-2 py-0.5 rounded border border-red-300 shadow-sm",children:"Remove"})]},Fe)})})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t mt-3",children:[a.jsx("button",{type:"button",onClick:()=>{b(!1),Pe()},className:"px-5 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:_?"Update Challan":"Create Challan"})]})]})}),m&&p&&a.jsx(LAe,{challan:p,items:y,onClose:()=>v(!1),companySettings:w}),S&&a.jsx(qt,{isOpen:S,onClose:()=>{F(!1),O(""),P(null)},title:"Reject Delivery Challan",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:I,onChange:pe=>O(pe.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this delivery challan..."})]}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{onClick:()=>{F(!1),O(""),P(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:we,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!I.trim(),children:"Reject Challan"})]})]})})]})})}function PAe({invoice:e,items:t,onClose:r}){const n=W.useRef(null),{t:s,language:i}=kn(),o=p=>{if(p==null)return"Rp 0";const g=p%1!==0;return`${p.toLocaleString("id-ID",{minimumFractionDigits:g?2:0,maximumFractionDigits:2})}`},l=p=>{const g=new Date(p),y=i==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=g.getDate(),w=y[g.getMonth()],N=g.getFullYear();return`${x} ${w} ${N}`},c=p=>{const g=new Date(p),x=(i==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"])[g.getMonth()],w=g.getFullYear();return`${x} ${w}`},u=p=>i==="id"?d(p):h(p),d=p=>{if(p===0)return"Nol";const g=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],y=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],x=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],w=N=>{if(N===0)return"";if(N<10)return g[N];if(N>=10&&N<20)return y[N-10];if(N<100){const E=Math.floor(N/10),S=N%10;return x[E]+(S>0?" "+g[S]:"")}const _=Math.floor(N/100),C=N%100;return(_===1?"Seratus":g[_]+" Ratus")+(C>0?" "+w(C):"")};if(p<1e3)return w(p);if(p<1e6){const N=Math.floor(p/1e3),_=p%1e3;return(N===1?"Seribu":w(N)+" Ribu")+(_>0?" "+w(_):"")}if(p<1e9){const N=Math.floor(p/1e6),_=p%1e6,C=w(N)+" Juta",j=_>=1e3?(Math.floor(_/1e3)===1?"Seribu":w(Math.floor(_/1e3))+" Ribu")+(_%1e3>0?" "+w(_%1e3):""):_>0?w(_):"";return C+(j?" "+j:"")}return p.toString()},h=p=>{if(p===0)return"Zero";const g=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],y=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],x=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],w=N=>{if(N===0)return"";if(N<10)return g[N];if(N>=10&&N<20)return y[N-10];if(N<100){const j=Math.floor(N/10),E=N%10;return x[j]+(E>0?" "+g[E]:"")}const _=Math.floor(N/100),C=N%100;return g[_]+" Hundred"+(C>0?" "+w(C):"")};if(p<1e3)return w(p);if(p<1e6){const N=Math.floor(p/1e3),_=p%1e3;return w(N)+" Thousand"+(_>0?" "+w(_):"")}if(p<1e9){const N=Math.floor(p/1e6),_=p%1e6,C=_>=1e3?w(Math.floor(_/1e3))+" Thousand"+(_%1e3>0?" "+w(_%1e3):""):_>0?w(_):"";return w(N)+" Million"+(C?" "+C:"")}return p.toString()},f=()=>{window.print()},A=async()=>{if(n.current)try{const p=await td(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:E=>{const S=E.getElementById("invoice-print-content");S&&(S.style.width="210mm")}}),g=p.toDataURL("image/png",1),y=new Lt("p","mm","a4"),x=y.internal.pageSize.getWidth(),w=y.internal.pageSize.getHeight(),N=p.width,_=p.height,C=x/N,j=_*C;if(j>w){let E=0,S=j;for(;S>0;)y.addImage(g,"PNG",0,E,x,j),S-=w,E-=w,S>0&&y.addPage()}else y.addImage(g,"PNG",0,0,x,j);y.save(`Invoice-${e.invoice_number}.pdf`)}catch(p){console.error("Error generating PDF:",p),alert("Failed to generate PDF. Please try again.")}},b=e.customers,m=e.payment_terms_days||30,v=()=>m===0?"Advance / Immediate":`${m} ${i==="id"?"Hari":"Days"}`;return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[a.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:a.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[a.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[i==="id"?"Faktur":"Invoice"," ",e.invoice_number]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:f,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(QA,{className:"h-4 w-4"}),i==="id"?"Cetak":"Print"]}),a.jsxs("button",{onClick:A,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[a.jsx(Ai,{className:"h-4 w-4"}),"PDF"]}),a.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:a.jsx(Kr,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{id:"invoice-print-content",ref:n,className:"p-8",children:[a.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[a.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:a.jsxs("g",{children:[a.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),a.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),a.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"INVOICE"})})]}),a.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No izin PBF"}),a.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),a.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),a.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Company Name:"}),a.jsxs("span",{className:"font-semibold",children:[" ",(b==null?void 0:b.company_name)||""]})]}),a.jsxs("div",{className:"pt-1 flex",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),a.jsxs("div",{children:[a.jsx("p",{children:(b==null?void 0:b.address)||""}),a.jsx("p",{children:(b==null?void 0:b.city)||""})]})]}),a.jsxs("div",{className:"flex pt-1",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),a.jsx("span",{children:(b==null?void 0:b.phone)||""})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),a.jsx("span",{children:(b==null?void 0:b.npwp)||""})]})]}),a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"200px"},children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Invoice No:"}),a.jsx("span",{className:"ml-2",children:e.invoice_number})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Invoice Date:"}),a.jsx("span",{className:"ml-2",children:l(e.invoice_date)})]}),a.jsxs("div",{className:"pt-1",children:[a.jsx("span",{className:"font-bold",children:"Po No:"}),a.jsx("span",{className:"ml-2",children:e.po_number||"N/A"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Payment Terms:"}),a.jsx("span",{className:"ml-2",children:v()})]})]})]})}),a.jsx("div",{children:a.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),a.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Exp. Date"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Total Qty"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),a.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price (IDR)"}),a.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Sub Total (IDR)"})]})}),a.jsxs("tbody",{children:[t.map((p,g)=>{var _,C,j,E;const y=p.quantity||0,x=p.unit_price||0,w=y*x,N=(_=p.batches)!=null&&_.expiry_date?c(p.batches.expiry_date):"-";return a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:g+1}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((C=p.products)==null?void 0:C.product_name)||"Unknown Product"}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((j=p.batches)==null?void 0:j.batch_number)||"N/A"}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:N}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:y.toLocaleString()}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((E=p.products)==null?void 0:E.unit)||"Kg"}),a.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:o(x)}),a.jsx("td",{className:"p-1.5 text-right print:p-1",children:o(w)})]},p.id||g)}),t.length<2&&Array.from({length:2-t.length}).map((p,g)=>a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${g}`))]})]})}),a.jsxs("div",{className:"border-2 border-black border-t-0",children:[a.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[a.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[a.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:i==="id"?"Amount In words:":"Amount in words:"}),a.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:["IDR ",u(Math.round(e.total_amount))," RUPIAH"]})]}),a.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[a.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"Sub Total"}),a.jsx("span",{className:"font-bold",children:o(e.subtotal)})]}),a.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),a.jsx("span",{className:"font-bold",children:o(e.tax_amount)})]}),a.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"Grand Total"}),a.jsx("span",{className:"font-bold text-sm print:text-xs",children:o(e.total_amount)})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[a.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[a.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Bank Details:"}),a.jsxs("div",{className:"space-y-0.5 print:space-y-0",children:[a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Bank Name"}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{children:"BCA"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Branch"}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{children:"Sunter Mall, Jakarta"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account Name"}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{className:"whitespace-nowrap",children:"PT. Shubham Anzen Pharma Jaya"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account No."}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{children:"0930 2010 14 (IDR)"})]})]})]}),a.jsxs("div",{className:"p-3 print:p-2",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),a.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),a.jsx("div",{className:"border-2 border-black border-t-0 p-2.5 print:p-2",children:a.jsx("p",{className:"text-xs font-semibold text-center print:text-[10px]",children:i==="id"?`Pembayaran jatuh tempo dalam ${v()} sejak tanggal barang dikirim.`:`Payment is due within ${v()} from the date on which the goods are delivered.`})}),e.notes&&a.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:a.jsxs("p",{className:"text-xs print:text-[10px]",children:[a.jsx("span",{className:"font-bold",children:"Notes: "}),a.jsx("span",{children:e.notes})]})})]})]})}),a.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #invoice-print-content,
          #invoice-print-content * {
            visibility: visible;
          }

          #invoice-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #invoice-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function DAe({options:e,selectedDCIds:t,onChange:r,placeholder:n="Select Delivery Challans"}){var b;const[s,i]=W.useState(!1),[o,l]=W.useState(""),c=W.useRef(null);W.useEffect(()=>{function m(v){c.current&&!c.current.contains(v.target)&&i(!1)}return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const u=e.filter(m=>m.challan_number.toLowerCase().includes(o.toLowerCase())),d=m=>{t.includes(m)?r(t.filter(v=>v!==m)):r([...t,m])},h=()=>{t.length===u.length?r([]):r(u.map(m=>m.challan_id))},f=t.length,A=f===0?n:f===1?((b=e.find(m=>m.challan_id===t[0]))==null?void 0:b.challan_number)||`${f} DCs selected`:`${f} DCs selected`;return a.jsxs("div",{className:"relative",ref:c,children:[a.jsxs("button",{type:"button",onClick:()=>i(!s),className:"w-full px-2 py-1.5 text-sm text-left bg-white border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent flex items-center justify-between",children:[a.jsx("span",{className:f===0?"text-gray-400":"text-gray-900",children:A}),a.jsx(Fi,{className:`w-3 h-3 transition-transform ${s?"transform rotate-180":""}`})]}),s&&a.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-96 overflow-hidden flex flex-col",children:[a.jsx("div",{className:"p-2 border-b border-gray-200",children:a.jsxs("div",{className:"relative",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",value:o,onChange:m=>l(m.target.value),placeholder:"Search...",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",onClick:m=>m.stopPropagation()})]})}),a.jsxs("div",{className:"overflow-y-auto max-h-80",children:[u.length>1&&a.jsx("div",{className:"px-3 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-200 sticky top-0 bg-white",onClick:h,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center ${t.length===u.length?"bg-green-600 border-green-600":t.length>0?"bg-gray-300 border-gray-300":"border-gray-300"}`,children:t.length>0&&a.jsx(Xb,{className:"w-3 h-3 text-white"})}),a.jsx("span",{className:"font-medium text-gray-900",children:"(Select All)"})]})}),u.length===0?a.jsx("div",{className:"px-3 py-4 text-center text-gray-500",children:"No delivery challans found"}):u.map(m=>{const v=t.includes(m.challan_id);return a.jsx("div",{className:"px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:()=>d(m.challan_id),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center ${v?"bg-green-600 border-green-600":"border-gray-300"}`,children:v&&a.jsx(Xb,{className:"w-3 h-3 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-gray-900",children:m.challan_number}),a.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(m.challan_date).toLocaleDateString(),"  ",m.item_count," items pending"]})]})]})},m.challan_id)})]})]})]})}function RAe(){const{t:e}=kn(),{profile:t}=jr(),{navigationData:r,clearNavigationData:n,setCurrentPage:s}=Ho(),[i,o]=W.useState([]),[l,c]=W.useState([]),[u,d]=W.useState([]),[h,f]=W.useState([]),[A,b]=W.useState([]),[m,v]=W.useState([]),[p,g]=W.useState([]),[y,x]=W.useState(""),[w,N]=W.useState([]),[_,C]=W.useState(new Map),[j,E]=W.useState(new Set),[S,F]=W.useState(!0),[I,O]=W.useState(!1),[M,P]=W.useState(!1),[X,J]=W.useState(null),[H,V]=W.useState(null),[K,B]=W.useState([]),[L,U]=W.useState({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),[D,Q]=W.useState([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]);W.useEffect(()=>{G(),R(),le(),ee()},[]),W.useEffect(()=>{(r==null?void 0:r.sourceType)==="delivery_challan"&&(Ne(r),n())},[r]),W.useEffect(()=>{p.length>0&&L.customer_id&&!X&&z()},[p]);const z=async()=>{try{const{data:ke,error:Ee}=await ae.from("pending_dc_items_by_customer").select("*").eq("customer_id",L.customer_id).in("challan_id",p);if(Ee)throw Ee;const Je=await Promise.all((ke||[]).map(async rt=>{const Ze=rt.selling_price||rt.unit_price||0;return{product_id:rt.product_id,batch_id:rt.batch_id,quantity:rt.remaining_quantity,unit_price:Ze,tax_rate:11,total:0,delivery_challan_item_id:rt.dc_item_id,dc_number:rt.challan_number,max_quantity:rt.remaining_quantity}}));Je.length>0?Q(Je.map(rt=>({...rt,total:Ae(rt)}))):Q([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])}catch(ke){console.error("Error loading DC items:",ke)}},G=async()=>{try{const{data:ke,error:Ee}=await ae.from("sales_invoices").select("*, customers(company_name, address, city, phone, npwp, pharmacy_license, gst_vat_type)").order("invoice_date",{ascending:!1});if(Ee)throw Ee;const Je=await Promise.all((ke||[]).map(async rt=>{const{data:Ze}=await ae.rpc("get_invoice_paid_amount",{p_invoice_id:rt.id}),xt=Ze||0,mt=rt.total_amount-xt;return{...rt,paid_amount:xt,balance_amount:mt}}));o(Je)}catch(ke){console.error("Error loading invoices:",ke)}finally{F(!1)}},Z=async()=>{try{const{data:ke}=await ae.from("app_settings").select("invoice_prefix, invoice_start_number").maybeSingle(),Ee=(ke==null?void 0:ke.invoice_prefix)||"SAPJ",Je=(ke==null?void 0:ke.invoice_start_number)||1,{data:rt}=await ae.from("sales_invoices").select("invoice_number").like("invoice_number",`${Ee}%`);let Ze=Je;if(rt&&rt.length>0){const mt=rt.map(bt=>{const vt=bt.invoice_number.match(/(\d+)$/);return vt?parseInt(vt[1],10):0}).filter(bt=>!isNaN(bt));mt.length>0&&(Ze=Math.max(...mt)+1)}const xt=String(Ze).padStart(3,"0");return`${Ee}-${xt}`}catch(ke){return console.error("Error generating invoice number:",ke),"SAPJ-001"}},R=async()=>{try{const{data:ke,error:Ee}=await ae.from("customers").select("id, company_name, gst_vat_type").eq("is_active",!0).order("company_name");if(Ee)throw Ee;c(ke||[])}catch(ke){console.error("Error loading customers:",ke)}},le=async()=>{try{const{data:ke,error:Ee}=await ae.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(Ee)throw Ee;d(ke||[])}catch(ke){console.error("Error loading products:",ke)}},ee=async()=>{try{const{data:ke,error:Ee}=await ae.from("batches").select("id, batch_number, product_id, current_stock, import_price, duty_charges, freight_charges, other_charges, import_quantity, import_date, expiry_date").eq("is_active",!0).order("import_date",{ascending:!0});if(Ee)throw Ee;f(ke||[])}catch(ke){console.error("Error loading batches:",ke)}},_e=async ke=>{try{const{data:Ee,error:Je}=await ae.from("delivery_challans").select("id, challan_number, challan_date, delivery_address, vehicle_number, notes").eq("customer_id",ke).order("challan_date",{ascending:!1});if(Je)throw Je;const{data:rt,error:Ze}=await ae.from("sales_invoices").select("linked_challan_ids").not("linked_challan_ids","is",null);if(Ze)throw Ze;const xt=new Set;rt==null||rt.forEach(bt=>{var vt;(vt=bt.linked_challan_ids)==null||vt.forEach(Nt=>xt.add(Nt))});const mt=(Ee==null?void 0:Ee.filter(bt=>!xt.has(bt.id)))||[];b(mt)}catch(Ee){console.error("Error loading pending challans:",Ee),b([])}},se=async ke=>{try{const{data:Ee,error:Je}=await ae.from("dc_invoicing_summary").select("challan_id, challan_number, challan_date, total_quantity, total_remaining_quantity").eq("customer_id",ke).gt("total_remaining_quantity",0).order("challan_date",{ascending:!1});if(Je)throw Je;const rt=(Ee||[]).map(Ze=>({challan_id:Ze.challan_id,challan_number:Ze.challan_number,challan_date:Ze.challan_date,item_count:Ze.total_remaining_quantity}));v(rt)}catch(Ee){console.error("Error loading pending DC options:",Ee),v([])}},te=()=>{Q([...D,{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0,delivery_challan_item_id:null}])},Ne=async ke=>{const Ee=await Z();U({invoice_number:Ee,customer_id:ke.customerId,invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:ke.challanNumber,po_number:"",notes:`Created from Delivery Challan: ${ke.challanNumber}`}),ke.customerId&&await _e(ke.customerId);const Je=ke.items.map(rt=>{const Ze=h.find(bt=>bt.id===rt.batch_id),mt=(Ze?(Ze.import_price+Ze.duty_charges+Ze.freight_charges+Ze.other_charges)/Ze.import_quantity:0)*1.25;return{product_id:rt.product_id,batch_id:rt.batch_id,quantity:rt.quantity,unit_price:Math.round(mt),tax_rate:11,total:0}});Q(Je.map(rt=>({...rt,total:Ae(rt)}))),O(!0)},Se=async ke=>{try{const{data:Ee,error:Je}=await ae.from("sales_invoice_items").select(`
          *,
          products(product_name, product_code, unit),
          batches(batch_number, expiry_date),
          delivery_challan_item_id
        `).eq("invoice_id",ke);if(Je)throw Je;const rt=await Promise.all((Ee||[]).map(async Ze=>{var xt;if(Ze.delivery_challan_item_id){const{data:mt}=await ae.from("delivery_challan_items").select("challan_id, delivery_challans(challan_number)").eq("id",Ze.delivery_challan_item_id).maybeSingle();return{...Ze,dc_number:(xt=mt==null?void 0:mt.delivery_challans)==null?void 0:xt.challan_number}}return Ze}));return B(rt||[]),rt||[]}catch(Ee){return console.error("Error loading invoice items:",Ee),[]}},Ae=ke=>{const Ee=ke.quantity*ke.unit_price,Je=Ee*(ke.tax_rate/100);return Ee+Je},ye=ke=>{if(!ke)return 0;const Ee=h.find(rt=>rt.id===ke);return!Ee||!Ee.import_quantity?0:(Ee.import_price+Ee.duty_charges+Ee.freight_charges+Ee.other_charges)/Ee.import_quantity},Le=(ke,Ee)=>Ee===0?0:(ke-Ee)/ke*100,Re=(ke,Ee=25)=>{const Je=ye(ke);return Math.round(Je*(1+Ee/100))},we=(ke,Ee)=>{const Je=Ae(Ee),rt=[...D];rt[ke]={...Ee,total:Je},Q(rt)},Pe=ke=>{D.length>1&&Q(D.filter((Ee,Je)=>Je!==ke))},ze=()=>{const ke=D.reduce((rt,Ze)=>rt+Ze.quantity*Ze.unit_price,0),Ee=D.reduce((rt,Ze)=>{const xt=Ze.quantity*Ze.unit_price;return rt+xt*(Ze.tax_rate/100)},0),Je=ke+Ee-L.discount;return{subtotal:ke,taxAmount:Ee,total:Je}},Ve=async ke=>{ke.preventDefault();try{const{data:{user:Ee}}=await ae.auth.getUser();if(!Ee)throw new Error("Not authenticated");const Je=ze(),rt=new Date(L.invoice_date);let Ze=new Date(rt),xt=30;L.payment_terms==="advance"||L.payment_terms==="50-50"?xt=0:(xt=parseInt(L.payment_terms),isNaN(xt)||Ze.setDate(Ze.getDate()+xt));let mt;if(X){const{error:Nt}=await ae.from("sales_invoice_items").delete().eq("invoice_id",X.id);if(Nt)throw Nt;const{data:Bt,error:tr}=await ae.from("sales_invoices").update({invoice_number:L.invoice_number,customer_id:L.customer_id,invoice_date:L.invoice_date,due_date:Ze.toISOString().split("T")[0],discount_amount:L.discount,delivery_challan_number:null,po_number:L.po_number||null,payment_terms_days:xt,notes:L.notes||null,subtotal:Je.subtotal,tax_amount:Je.taxAmount,total_amount:Je.total,linked_challan_ids:p.length>0?p:null}).eq("id",X.id).select().single();if(tr)throw tr;mt=Bt}else{const{data:Nt,error:Bt}=await ae.from("sales_invoices").insert([{invoice_number:L.invoice_number,customer_id:L.customer_id,invoice_date:L.invoice_date,due_date:Ze.toISOString().split("T")[0],discount_amount:L.discount,delivery_challan_number:null,po_number:L.po_number||null,payment_terms_days:xt,notes:L.notes||null,subtotal:Je.subtotal,tax_amount:Je.taxAmount,total_amount:Je.total,payment_status:"pending",created_by:Ee.id,linked_challan_ids:p.length>0?p:null}]).select().single();if(Bt)throw Bt;mt=Nt}const bt=D.map(Nt=>({invoice_id:mt.id,product_id:Nt.product_id,batch_id:Nt.batch_id,quantity:Nt.quantity,unit_price:Nt.unit_price,tax_rate:Nt.tax_rate,delivery_challan_item_id:Nt.delivery_challan_item_id||null})),{error:vt}=await ae.from("sales_invoice_items").insert(bt);if(vt)throw vt;await G(),await ee(),O(!1),Ke()}catch(Ee){console.error("Error saving invoice:",Ee),alert(`Failed to save invoice: ${Ee.message||"Unknown error"}. Please check console for details.`)}},lt=async ke=>{V(ke),await Se(ke.id),P(!0)},pe=async ke=>{J(ke),U({invoice_number:ke.invoice_number,customer_id:ke.customer_id,invoice_date:ke.invoice_date,payment_terms:String(ke.payment_terms_days||30),discount:ke.discount_amount,delivery_challan_number:ke.delivery_challan_number||"",po_number:ke.po_number||"",notes:ke.notes||""});const Ee=await Se(ke.id);Ee.length>0&&Q(Ee.map(Je=>{const rt={product_id:Je.product_id,batch_id:Je.batch_id,quantity:Je.quantity,unit_price:Je.unit_price,tax_rate:Je.tax_rate,total:0,delivery_challan_item_id:Je.delivery_challan_item_id,dc_number:Je.dc_number};return{...rt,total:Ae(rt)}})),await se(ke.customer_id),ke.linked_challan_ids&&ke.linked_challan_ids.length>0&&g(ke.linked_challan_ids),O(!0)},Fe=async ke=>{if(confirm("Are you sure you want to delete this invoice?"))try{const{error:Ee}=await ae.from("sales_invoices").delete().eq("id",ke);if(Ee)throw Ee;G()}catch(Ee){console.error("Error deleting invoice:",Ee),alert("Failed to delete invoice. Please try again.")}},Ke=()=>{J(null),x(""),b([]),v([]),g([]),U({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),Q([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])},Xe=[{key:"invoice_number",label:"Invoice #"},{key:"customer",label:"Customer",render:ke=>{var Ee;return a.jsx("div",{className:"font-medium",children:(Ee=ke.customers)==null?void 0:Ee.company_name})}},{key:"invoice_date",label:"Date",render:ke=>new Date(ke.invoice_date).toLocaleDateString()},{key:"total_amount",label:"Total Amount",render:ke=>a.jsxs("span",{className:"font-medium",children:["Rp ",ke.total_amount.toLocaleString("id-ID")]})},{key:"paid_amount",label:"Paid Amount",render:ke=>a.jsxs("span",{className:"text-green-600 font-medium",children:["Rp ",(ke.paid_amount||0).toLocaleString("id-ID")]})},{key:"balance_amount",label:"Balance",render:ke=>a.jsxs("span",{className:`font-medium ${(ke.balance_amount||0)===0?"text-gray-400":"text-orange-600"}`,children:["Rp ",(ke.balance_amount||0).toLocaleString("id-ID")]})},{key:"payment_status",label:"Payment Status",render:ke=>a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${ke.payment_status==="paid"?"bg-green-100 text-green-800":ke.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ke.payment_status==="pending"?"Unpaid":ke.payment_status==="partial"?"Partially Paid":"Paid"})}],tt=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts"||(t==null?void 0:t.role)==="sales",st={total:i.length,totalRevenue:i.reduce((ke,Ee)=>ke+Ee.total_amount,0),pending:i.filter(ke=>ke.payment_status==="pending").length,paid:i.filter(ke=>ke.payment_status==="paid").length};return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Invoices"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage sales invoices and track payments"})]}),tt&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:async()=>{Ke();const ke=await Z();U(Ee=>({...Ee,invoice_number:ke})),O(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Create Invoice"]}),a.jsxs("button",{onClick:()=>{s("credit-notes")},className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition",children:[a.jsx(AR,{className:"w-5 h-5"}),"Credit Notes"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Invoices"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:st.total})]}),a.jsxs("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:[a.jsx("p",{className:"text-sm text-blue-600",children:"Total Revenue"}),a.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:["Rp ",st.totalRevenue.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-6",children:[a.jsx("p",{className:"text-sm text-red-600",children:"Pending Payment"}),a.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:st.pending})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-6",children:[a.jsx("p",{className:"text-sm text-green-600",children:"Paid"}),a.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:st.paid})]})]}),a.jsx(ws,{columns:Xe,data:i,loading:S,actions:tt?ke=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>lt(ke),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Invoice",children:a.jsx(Kc,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>pe(ke),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Invoice",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Fe(ke.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Invoice",children:a.jsx(nn,{className:"w-4 h-4"})})]}):void 0}),a.jsx(qt,{isOpen:I,onClose:()=>{O(!1),Ke()},title:X?"Edit Sales Invoice":"Create Sales Invoice",size:"xl",children:a.jsxs("form",{onSubmit:Ve,className:"space-y-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Invoice No *"}),a.jsx("input",{type:"text",value:L.invoice_number,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",required:!0,readOnly:!0,disabled:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Invoice Date *"}),a.jsx("input",{type:"date",value:L.invoice_date,onChange:ke=>U({...L,invoice_date:ke.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Payment Terms *"}),a.jsxs("select",{value:L.payment_terms,onChange:ke=>U({...L,payment_terms:ke.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"0",children:"Immediate"}),a.jsx("option",{value:"15",children:"15 Days"}),a.jsx("option",{value:"30",children:"30 Days"}),a.jsx("option",{value:"45",children:"45 Days"}),a.jsx("option",{value:"60",children:"60 Days"}),a.jsx("option",{value:"advance",children:"Advance"}),a.jsx("option",{value:"50-50",children:"50% Adv & 50% on Delivery"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsxs("select",{value:L.customer_id,onChange:ke=>{const Ee=ke.target.value;U({...L,customer_id:Ee}),x(""),b([]),g([]),Q([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]),Ee?se(Ee):v([])},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"",children:"Select Customer"}),l.map(ke=>a.jsx("option",{value:ke.id,children:ke.company_name},ke.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Challans"}),a.jsx(DAe,{options:m,selectedDCIds:p,onChange:g,placeholder:"Select DCs"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PO Number"}),a.jsx("input",{type:"text",value:L.po_number,onChange:ke=>U({...L,po_number:ke.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Customer PO Number"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("input",{type:"text",value:L.notes,onChange:ke=>U({...L,notes:ke.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Additional notes"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Discount (Rp)"}),a.jsx("input",{type:"number",value:L.discount===0?"":L.discount,onChange:ke=>U({...L,discount:ke.target.value===""?0:Number(ke.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",placeholder:"0"})]})]})]}),a.jsxs("div",{className:"border-t pt-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"text-xs font-semibold text-gray-900",children:"Line Items"}),a.jsx("button",{type:"button",onClick:te,className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Manual Item"})]}),a.jsx("div",{className:"space-y-1.5",children:D.map((ke,Ee)=>{var bt;const Je=h.filter(vt=>vt.product_id===ke.product_id),rt=ye(ke.batch_id),Ze=Le(ke.unit_price,rt),xt=Re(ke.batch_id),mt=!!ke.delivery_challan_item_id;return a.jsxs("div",{className:"p-2 bg-gray-50 rounded space-y-1 border-l-2",style:{borderLeftColor:mt?"#3b82f6":"#10b981"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[mt?a.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-blue-100 text-blue-700 rounded",children:["From DC: ",ke.dc_number]}):a.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-green-100 text-green-700 rounded",children:"Manual Item"}),mt&&ke.max_quantity&&a.jsxs("span",{className:"text-[10px] text-gray-500",children:["Max: ",ke.max_quantity," units"]})]}),!mt&&D.length>1&&a.jsx("button",{type:"button",onClick:()=>Pe(Ee),className:"text-red-600 hover:text-red-700",children:a.jsx(nn,{className:"w-3 h-3"})})]}),a.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[a.jsxs("div",{className:"col-span-3",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product *"}),a.jsxs("select",{value:ke.product_id,onChange:vt=>we(Ee,{...ke,product_id:vt.target.value,batch_id:null}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",disabled:mt,required:!0,children:[a.jsx("option",{value:"",children:"Select Product"}),u.map(vt=>a.jsx("option",{value:vt.id,children:vt.product_name},vt.id))]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Batch"}),a.jsxs("select",{value:ke.batch_id||"",onChange:vt=>{const Nt=vt.target.value||null,Bt=Re(Nt);we(Ee,{...ke,batch_id:Nt,unit_price:Bt})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",disabled:!ke.product_id||y!==""||mt,children:[a.jsx("option",{value:"",children:"Select Batch"}),Je.filter(vt=>vt.current_stock>0).map(vt=>a.jsxs("option",{value:vt.id,children:[vt.batch_number," (",vt.current_stock," stock)"]},vt.id)),ke.batch_id&&Je.find(vt=>vt.id===ke.batch_id&&vt.current_stock===0)&&a.jsxs("option",{value:ke.batch_id,children:[(bt=Je.find(vt=>vt.id===ke.batch_id))==null?void 0:bt.batch_number," (from challan)"]},ke.batch_id)]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Quantity *"}),a.jsx("input",{type:"number",value:ke.quantity===0?"":ke.quantity,onChange:vt=>we(Ee,{...ke,quantity:vt.target.value===""?1:Number(vt.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"1",placeholder:"1"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price *"}),a.jsx("input",{type:"number",step:"0.01",value:ke.unit_price===0?"":ke.unit_price,onChange:vt=>we(Ee,{...ke,unit_price:vt.target.value===""?0:parseFloat(vt.target.value)||0}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"0",placeholder:"0"})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Tax %"}),a.jsx("input",{type:"number",value:ke.tax_rate===0?"":ke.tax_rate,onChange:vt=>we(Ee,{...ke,tax_rate:vt.target.value===""?0:Number(vt.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"0",placeholder:"11"})]}),a.jsxs("div",{className:"col-span-2 flex items-end gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Total"}),a.jsx("input",{type:"text",value:(ke.total||0).toFixed(2),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]}),D.length>1&&a.jsx("button",{type:"button",onClick:()=>Pe(Ee),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove Item",children:a.jsx(nn,{className:"w-4 h-4"})})]})]}),ke.batch_id&&rt>0&&a.jsxs("div",{className:"flex items-center gap-2 text-[10px] px-2 py-1 bg-white rounded border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-gray-600",children:"Cost/Unit:"}),a.jsxs("span",{className:"font-semibold text-gray-900",children:["Rp ",rt.toLocaleString("id-ID",{maximumFractionDigits:0})]})]}),a.jsx("div",{className:"h-3 w-px bg-gray-300"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-gray-600",children:"Suggested Price (25%):"}),a.jsxs("span",{className:"font-semibold text-blue-600",children:["Rp ",xt.toLocaleString("id-ID")]})]}),a.jsx("div",{className:"h-3 w-px bg-gray-300"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-gray-600",children:"Current Margin:"}),a.jsxs("span",{className:`font-semibold ${Ze>=20?"text-green-600":Ze>=10?"text-yellow-600":"text-red-600"}`,children:[Ze.toFixed(1),"%"]})]}),a.jsx("div",{className:"h-3 w-px bg-gray-300"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-gray-600",children:"Profit/Unit:"}),a.jsxs("span",{className:`font-semibold ${ke.unit_price>rt?"text-green-600":"text-red-600"}`,children:["Rp ",(ke.unit_price-rt).toLocaleString("id-ID",{maximumFractionDigits:0})]})]})]})]},Ee)})}),a.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded",children:a.jsxs("div",{className:"space-y-1 text-xs",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{className:"font-medium",children:["Rp ",ze().subtotal.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Tax:"}),a.jsxs("span",{className:"font-medium",children:["Rp ",ze().taxAmount.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Discount:"}),a.jsxs("span",{className:"font-medium",children:["-Rp ",L.discount.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"flex justify-between text-sm font-bold border-t pt-1",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{className:"text-blue-600",children:["Rp ",ze().total.toLocaleString("id-ID")]})]})]})})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{O(!1),Ke()},className:"px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:X?"Update Invoice":"Create Invoice"})]})]})}),M&&H&&a.jsx(PAe,{invoice:H,items:K,onClose:()=>{P(!1),V(null),B([])}})]})})}function QAe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState(!0),[i,o]=W.useState(!1),[l,c]=W.useState(null),[u,d]=W.useState({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0});W.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:v,error:p}=await ae.from("bank_accounts").select("*").order("created_at",{ascending:!1});if(p)throw p;r(v||[])}catch(v){console.error("Error loading bank accounts:",v)}finally{s(!1)}},f=async v=>{v.preventDefault();try{const{data:{user:p}}=await ae.auth.getUser();if(!p)throw new Error("Not authenticated");if(l){const{error:g}=await ae.from("bank_accounts").update(u).eq("id",l.id);if(g)throw g}else{const{error:g}=await ae.from("bank_accounts").insert([{...u,current_balance:u.opening_balance,created_by:p.id}]);if(g)throw g}o(!1),b(),h()}catch(p){console.error("Error saving bank account:",p),alert(`Failed to save bank account: ${p.message}`)}},A=v=>{c(v),d({account_name:v.account_name,bank_name:v.bank_name,account_number:v.account_number,account_type:v.account_type,currency:v.currency,opening_balance:v.opening_balance}),o(!0)},b=()=>{c(null),d({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0})},m=[{key:"account_name",label:"Account Name"},{key:"bank_name",label:"Bank"},{key:"account_number",label:"Account #"},{key:"type",label:"Type",render:v=>a.jsx("span",{className:"capitalize",children:v.account_type})},{key:"balance",label:"Balance",render:v=>a.jsxs("span",{className:"font-semibold",children:["Rp ",v.current_balance.toLocaleString("id-ID")]})},{key:"status",label:"Status",render:v=>a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:v.is_active?"Active":"Inactive"})}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Bank Accounts"}),e&&a.jsxs("button",{onClick:()=>{b(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Add Bank Account"]})]}),a.jsx(ws,{columns:m,data:t,loading:n,actions:e?v=>a.jsx("button",{onClick:()=>A(v),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(Rs,{className:"w-4 h-4"})}):void 0}),a.jsx(qt,{isOpen:i,onClose:()=>{o(!1),b()},title:l?"Edit Bank Account":"Add Bank Account",children:a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name *"}),a.jsx("input",{type:"text",value:u.account_name,onChange:v=>d({...u,account_name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name *"}),a.jsx("input",{type:"text",value:u.bank_name,onChange:v=>d({...u,bank_name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number *"}),a.jsx("input",{type:"text",value:u.account_number,onChange:v=>d({...u,account_number:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type *"}),a.jsxs("select",{value:u.account_type,onChange:v=>d({...u,account_type:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"savings",children:"Savings"}),a.jsx("option",{value:"current",children:"Current"}),a.jsx("option",{value:"credit_card",children:"Credit Card"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),a.jsxs("select",{value:u.currency,onChange:v=>d({...u,currency:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"IDR",children:"IDR (Indonesian Rupiah)"}),a.jsx("option",{value:"USD",children:"USD (US Dollar)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance *"}),a.jsx("input",{type:"number",value:u.opening_balance===0?"":u.opening_balance,onChange:v=>d({...u,opening_balance:v.target.value===""?0:Number(v.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,step:"0.01"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{o(!1),b()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Add"," Account"]})]})]})})]})}function MAe({canManage:e}){var M;const{setCurrentPage:t}=Ho(),[r,n]=W.useState("invoices"),[s,i]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState([]),[d,h]=W.useState(!0),[f,A]=W.useState(!1),[b,m]=W.useState(!1),[v,p]=W.useState(null),[g,y]=W.useState([]),[x,w]=W.useState({}),[N,_]=W.useState({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""}),C=W.useCallback(async()=>{try{const[P,X,J]=await Promise.all([ae.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]).order("due_date",{ascending:!0}),ae.from("customer_payments").select("*, customers(company_name), sales_invoices(invoice_number), bank_accounts(account_name)").order("payment_date",{ascending:!1}).limit(50),ae.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name")]);if(P.error)throw P.error;if(X.error)throw X.error;if(J.error)throw J.error;const H=await Promise.all((P.data||[]).map(async V=>{const{data:K}=await ae.rpc("get_invoice_paid_amount",{p_invoice_id:V.id});return{...V,paid_amount:K||0}}));i(H),l(X.data||[]),u(J.data||[])}catch(P){console.error("Error loading data:",P)}finally{h(!1),A(!1)}},[]);W.useEffect(()=>{C();const P=setInterval(C,3e4);return()=>clearInterval(P)},[C]);const j=()=>{A(!0),C()},E=async P=>{p(P);const X=P.total_amount-(P.paid_amount||0);_({...N,payment_number:`PAY-${Date.now()}`,amount:X});try{const{data:J,error:H}=await ae.from("sales_invoices").select("*").eq("customer_id",P.customer_id).in("payment_status",["pending","partial"]).order("invoice_date",{ascending:!0});if(H)throw H;const V=await Promise.all((J||[]).map(async K=>{const{data:B}=await ae.rpc("get_invoice_paid_amount",{p_invoice_id:K.id});return{...K,paid_amount:B||0}}));y(V),w({[P.id]:X})}catch(J){console.error("Error loading customer invoices:",J)}m(!0)},S=async P=>{if(P.preventDefault(),!v)return;const X=Object.values(x).reduce((J,H)=>J+H,0);if(X>N.amount){alert("Total allocated amount cannot exceed payment amount");return}if(X===0){alert("Please allocate the payment to at least one invoice");return}try{const{data:{user:J}}=await ae.auth.getUser();if(!J)throw new Error("Not authenticated");const{data:H,error:V}=await ae.from("customer_payments").insert([{payment_number:N.payment_number,customer_id:v.customer_id,invoice_id:null,payment_date:N.payment_date,amount:N.amount,payment_method:N.payment_method,bank_account_id:N.bank_account_id||null,reference_number:N.reference_number||null,notes:N.notes||null,created_by:J.id}]).select().single();if(V)throw V;const K=Object.entries(x).filter(([L,U])=>U>0).map(([L,U])=>({invoice_id:L,payment_id:H.id,allocated_amount:U,created_by:J.id})),{error:B}=await ae.from("invoice_payment_allocations").insert(K);if(B)throw B;m(!1),p(null),y([]),w({}),F(),C(),alert("Payment recorded and allocated successfully!")}catch(J){console.error("Error recording payment:",J),alert(`Failed to record payment: ${J.message}`)}},F=()=>{_({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},I=[{key:"invoice_number",label:"Invoice #",render:P=>a.jsx("button",{onClick:()=>t("sales"),className:"text-blue-600 hover:underline font-medium",children:P.invoice_number})},{key:"customer",label:"Customer",render:P=>{var X;return((X=P.customers)==null?void 0:X.company_name)||"N/A"}},{key:"invoice_date",label:"Date",render:P=>new Date(P.invoice_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:P=>{const X=new Date(P.due_date),H=X<new Date&&P.payment_status!=="paid";return a.jsx("span",{className:H?"text-red-600 font-semibold":"",children:X.toLocaleDateString()})}},{key:"total_amount",label:"Amount",render:P=>`Rp ${P.total_amount.toLocaleString("id-ID")}`},{key:"paid",label:"Paid",render:P=>a.jsxs("span",{className:"text-green-600",children:["Rp ",(P.paid_amount||0).toLocaleString("id-ID")]})},{key:"balance",label:"Balance",render:P=>a.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",(P.total_amount-(P.paid_amount||0)).toLocaleString("id-ID")]})},{key:"status",label:"Status",render:P=>a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${P.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:P.payment_status})}],O=[{key:"payment_number",label:"Payment #",render:P=>P.payment_number},{key:"payment_date",label:"Date",render:P=>new Date(P.payment_date).toLocaleDateString()},{key:"customer",label:"Customer",render:P=>{var X;return((X=P.customers)==null?void 0:X.company_name)||"N/A"}},{key:"invoice",label:"Invoice",render:P=>{var X;return((X=P.sales_invoices)==null?void 0:X.invoice_number)||"N/A"}},{key:"amount",label:"Amount",render:P=>a.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",P.amount.toLocaleString("id-ID")]})},{key:"method",label:"Method",render:P=>a.jsx("span",{className:"capitalize",children:P.payment_method.replace("_"," ")})},{key:"bank",label:"Bank Account",render:P=>{var X;return((X=P.bank_accounts)==null?void 0:X.account_name)||"Cash"}}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>n("invoices"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="invoices"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Outstanding Invoices (",s.length,")"]}),a.jsx("button",{onClick:()=>n("payments"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Payment History"})]}),a.jsxs("button",{onClick:j,disabled:f,className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition",title:"Refresh data",children:[a.jsx(go,{className:`w-4 h-4 ${f?"animate-spin":""}`}),a.jsx("span",{className:"text-sm",children:"Refresh"})]})]}),r==="invoices"&&s.length>0&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[a.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:a.jsx(ui,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-900",children:"Recording Customer Payments"}),a.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Click the green ",a.jsx("span",{className:"font-semibold",children:'"Record Payment"'}),' button next to any invoice to record payment received from customers. The invoice status will automatically change from "pending" to "paid" once full payment is allocated.']})]})]}),r==="invoices"?a.jsx(a.Fragment,{children:s.length===0&&!d?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(ui,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),a.jsx("p",{className:"text-lg font-medium",children:"All Caught Up!"}),a.jsx("p",{className:"text-sm mt-2",children:"No outstanding invoices - all payments received!"})]}):a.jsx(ws,{columns:I,data:s,loading:d,actions:e?P=>a.jsxs("button",{onClick:()=>E(P),className:"flex items-center gap-1.5 px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition shadow-sm",children:[a.jsx("span",{className:"text-lg",children:"+"}),"Record Payment"]}):void 0})}):a.jsx(ws,{columns:O,data:o,loading:d}),a.jsx(qt,{isOpen:b,onClose:()=>{m(!1),p(null),y([]),w({}),F()},title:"Record Customer Payment",size:"lg",children:a.jsxs("form",{onSubmit:S,className:"space-y-4",children:[v&&a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:a.jsxs("div",{className:"text-sm",children:[a.jsx("div",{className:"font-medium text-lg mb-2",children:(M=v.customers)==null?void 0:M.company_name}),a.jsx("div",{className:"text-gray-600",children:"Recording payment for customer invoices"})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Number *"}),a.jsx("input",{type:"text",value:N.payment_number,onChange:P=>_({...N,payment_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),a.jsx("input",{type:"date",value:N.payment_date,onChange:P=>_({...N,payment_date:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),a.jsx("input",{type:"number",value:N.amount===0?"":N.amount,onChange:P=>_({...N,amount:P.target.value===""?0:Number(P.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),a.jsxs("select",{value:N.payment_method,onChange:P=>_({...N,payment_method:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),a.jsx("option",{value:"cheque",children:"Cheque"}),a.jsx("option",{value:"credit_card",children:"Credit Card"}),a.jsx("option",{value:"other",children:"Other"})]})]}),N.payment_method!=="cash"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),a.jsxs("select",{value:N.bank_account_id,onChange:P=>_({...N,bank_account_id:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select Bank Account"}),c.map(P=>a.jsxs("option",{value:P.id,children:[P.account_name," - ",P.bank_name]},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),a.jsx("input",{type:"text",value:N.reference_number,onChange:P=>_({...N,reference_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Bank reference or cheque number"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:N.notes,onChange:P=>_({...N,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]})]}),g.length>0&&a.jsxs("div",{className:"border rounded-lg p-4 space-y-3 max-h-96 overflow-y-auto",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:"Allocate Payment to Invoices"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Select invoices and enter amount to allocate to each"}),g.map(P=>{const X=P.total_amount-(P.paid_amount||0),J=x[P.id]!==void 0,H=x[P.id]||0;return a.jsx("div",{className:"border rounded p-3 space-y-2",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[a.jsx("input",{type:"checkbox",checked:J,onChange:V=>{if(V.target.checked)w(K=>({...K,[P.id]:Math.min(X,N.amount-Object.values(x).reduce((B,L)=>B+L,0))}));else{const K={...x};delete K[P.id],w(K)}},className:"mt-1"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm",children:P.invoice_number}),a.jsxs("div",{className:"text-xs text-gray-600",children:["Date: ",new Date(P.invoice_date).toLocaleDateString()]}),a.jsxs("div",{className:"text-xs mt-1",children:["Total: Rp ",P.total_amount.toLocaleString("id-ID")]}),a.jsxs("div",{className:"text-xs text-orange-600 font-medium",children:["Balance: Rp ",X.toLocaleString("id-ID")]})]})]}),J&&a.jsx("div",{className:"ml-3 w-32",children:a.jsx("input",{type:"number",value:H||"",onChange:V=>{const K=parseFloat(V.target.value)||0;if(K>X){alert("Cannot allocate more than balance");return}w(B=>({...B,[P.id]:K}))},className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Amount",min:"0",max:X,step:"0.01"})})]})},P.id)}),a.jsxs("div",{className:"border-t pt-3 space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"font-medium",children:"Payment Amount:"}),a.jsxs("span",{className:"font-bold",children:["Rp ",N.amount.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Allocated:"}),a.jsxs("span",{className:Object.values(x).reduce((P,X)=>P+X,0)>N.amount?"text-red-600 font-bold":"text-green-600",children:["Rp ",Object.values(x).reduce((P,X)=>P+X,0).toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Unallocated:"}),a.jsxs("span",{className:"text-gray-600",children:["Rp ",(N.amount-Object.values(x).reduce((P,X)=>P+X,0)).toLocaleString("id-ID")]})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{m(!1),p(null),y([]),w({}),F()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",disabled:Object.values(x).reduce((P,X)=>P+X,0)===0,children:"Record Payment"})]})]})})]})}function HAe({canManage:e}){const{profile:t}=jr(),[r,n]=W.useState("bills"),[s,i]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState([]),[d,h]=W.useState(!0),[f,A]=W.useState(!1),[b,m]=W.useState(!1),[v,p]=W.useState(null),[g,y]=W.useState(null),[x,w]=W.useState({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""}),[N,_]=W.useState({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""});W.useEffect(()=>{C()},[]);const C=async()=>{h(!0),await Promise.all([j(),E(),S()]),h(!1)},j=async()=>{try{const{data:R,error:le}=await ae.from("vendor_bills").select("*").order("bill_date",{ascending:!1});if(le)throw le;i(R||[])}catch(R){console.error("Error loading bills:",R)}},E=async()=>{try{const{data:R,error:le}=await ae.from("vendor_payments").select(`
          *,
          vendor_bills (
            bill_number,
            vendor_name
          ),
          bank_accounts (
            account_name,
            bank_name
          )
        `).order("payment_date",{ascending:!1});if(le)throw le;l(R||[])}catch(R){console.error("Error loading payments:",R)}},S=async()=>{try{const{data:R,error:le}=await ae.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name");if(le)throw le;u(R||[])}catch(R){console.error("Error loading bank accounts:",R)}},F=async()=>{const R="BILL",le=new Date().getFullYear(),{data:ee}=await ae.from("vendor_bills").select("bill_number").like("bill_number",`${R}-${le}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(ee!=null&&ee.bill_number){const _e=parseInt(ee.bill_number.split("-")[2]);return`${R}-${le}-${String(_e+1).padStart(5,"0")}`}return`${R}-${le}-00001`},I=async()=>{const R="VPAY",le=new Date().getFullYear(),{data:ee}=await ae.from("vendor_payments").select("payment_number").like("payment_number",`${R}-${le}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(ee!=null&&ee.payment_number){const _e=parseInt(ee.payment_number.split("-")[2]);return`${R}-${le}-${String(_e+1).padStart(5,"0")}`}return`${R}-${le}-00001`},O=async R=>{R.preventDefault();try{const{data:{user:le}}=await ae.auth.getUser();if(!le)throw new Error("Not authenticated");const ee=x.amount+x.tax_amount;if(v){const{error:_e}=await ae.from("vendor_bills").update({vendor_name:x.vendor_name,vendor_id:x.vendor_id||null,bill_date:x.bill_date,due_date:x.due_date||null,amount:x.amount,tax_amount:x.tax_amount,total_amount:ee,category:x.category,description:x.description||null}).eq("id",v.id);if(_e)throw _e}else{const _e=await F(),{error:se}=await ae.from("vendor_bills").insert([{bill_number:_e,vendor_name:x.vendor_name,vendor_id:x.vendor_id||null,bill_date:x.bill_date,due_date:x.due_date||null,amount:x.amount,tax_amount:x.tax_amount,total_amount:ee,category:x.category,description:x.description||null,created_by:le.id}]);if(se)throw se}A(!1),V(),j()}catch(le){console.error("Error saving bill:",le),alert("Failed to save bill. Please try again.")}},M=async R=>{R.preventDefault();try{const{data:{user:le}}=await ae.auth.getUser();if(!le)throw new Error("Not authenticated");if(g){const{error:ee}=await ae.from("vendor_payments").update({payment_date:N.payment_date,amount:N.amount,payment_method:N.payment_method,bank_account_id:N.bank_account_id||null,reference_number:N.reference_number||null,notes:N.notes||null}).eq("id",g.id);if(ee)throw ee}else{const ee=await I(),{error:_e}=await ae.from("vendor_payments").insert([{payment_number:ee,bill_id:N.bill_id,payment_date:N.payment_date,amount:N.amount,payment_method:N.payment_method,bank_account_id:N.bank_account_id||null,reference_number:N.reference_number||null,notes:N.notes||null,created_by:le.id}]);if(_e)throw _e}m(!1),K(),E(),j()}catch(le){console.error("Error saving payment:",le),alert("Failed to save payment. Please try again.")}},P=R=>{p(R),w({bill_number:R.bill_number,vendor_name:R.vendor_name,vendor_id:R.vendor_id||"",bill_date:R.bill_date,due_date:R.due_date||"",amount:R.amount,tax_amount:R.tax_amount,category:R.category,description:R.description||""}),A(!0)},X=R=>{y(R),_({bill_id:R.bill_id,payment_date:R.payment_date,amount:R.amount,payment_method:R.payment_method,bank_account_id:R.bank_account_id||"",reference_number:R.reference_number||"",notes:R.notes||""}),m(!0)},J=async R=>{if(confirm("Are you sure you want to delete this bill?"))try{const{error:le}=await ae.from("vendor_bills").delete().eq("id",R);if(le)throw le;j()}catch(le){console.error("Error deleting bill:",le),alert("Failed to delete bill. Please try again.")}},H=async R=>{if(confirm("Are you sure you want to delete this payment?"))try{const{error:le}=await ae.from("vendor_payments").delete().eq("id",R);if(le)throw le;E(),j()}catch(le){console.error("Error deleting payment:",le),alert("Failed to delete payment. Please try again.")}},V=()=>{p(null),w({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""})},K=()=>{y(null),_({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},B=R=>{switch(R){case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},L=R=>R?{inventory:"Inventory",expense:"Expense",asset:"Asset",other:"Other"}[R]||R:"N/A",U=R=>({cash:"Cash",bank_transfer:"Bank Transfer",cheque:"Cheque",credit_card:"Credit Card",other:"Other"})[R]||R,D=s.filter(R=>R.payment_status!=="paid").reduce((R,le)=>R+le.total_amount,0),Q=s.filter(R=>!R.due_date||R.payment_status==="paid"?!1:new Date(R.due_date)<new Date),z=[{key:"bill_number",label:"Bill Number",render:R=>a.jsx("span",{className:"font-medium text-gray-900",children:R.bill_number})},{key:"vendor_name",label:"Vendor",render:R=>R.vendor_name},{key:"bill_date",label:"Bill Date",render:R=>new Date(R.bill_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:R=>{if(!R.due_date)return"N/A";const le=new Date(R.due_date),ee=le<new Date&&R.payment_status!=="paid";return a.jsxs("span",{className:ee?"text-red-600 font-medium":"",children:[le.toLocaleDateString(),ee&&a.jsx(ea,{className:"w-3 h-3 inline ml-1"})]})}},{key:"category",label:"Category",render:R=>L(R.category)},{key:"total_amount",label:"Total Amount",render:R=>a.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",R.total_amount.toLocaleString("id-ID")]})},{key:"payment_status",label:"Status",render:R=>a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${B(R.payment_status)}`,children:R.payment_status.toUpperCase()})}],G=[{key:"payment_number",label:"Payment Number",render:R=>a.jsx("span",{className:"font-medium text-gray-900",children:R.payment_number})},{key:"bill",label:"Bill Number",render:R=>{var le;return((le=R.vendor_bills)==null?void 0:le.bill_number)||"N/A"}},{key:"vendor",label:"Vendor",render:R=>{var le;return((le=R.vendor_bills)==null?void 0:le.vendor_name)||"N/A"}},{key:"payment_date",label:"Payment Date",render:R=>new Date(R.payment_date).toLocaleDateString()},{key:"amount",label:"Amount",render:R=>a.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",R.amount.toLocaleString("id-ID")]})},{key:"payment_method",label:"Method",render:R=>U(R.payment_method)},{key:"bank_account",label:"Bank Account",render:R=>R.bank_accounts?`${R.bank_accounts.account_name} - ${R.bank_accounts.bank_name}`:"N/A"}],Z=s.filter(R=>R.payment_status!=="paid");return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-red-100",children:"Total Payable"}),a.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rp ",D.toLocaleString("id-ID")]})]}),a.jsx(El,{className:"w-8 h-8 text-red-200"})]})}),a.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-orange-600",children:"Overdue Bills"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:Q.length})]}),a.jsx(ea,{className:"w-8 h-8 text-orange-400"})]})}),a.jsx("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-blue-600",children:"Total Bills"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:s.length})]}),a.jsx(sr,{className:"w-8 h-8 text-blue-400"})]})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>n("bills"),className:`px-4 py-2 rounded-lg transition ${r==="bills"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[a.jsx(sr,{className:"w-4 h-4 inline mr-2"}),"Bills"]}),a.jsxs("button",{onClick:()=>n("payments"),className:`px-4 py-2 rounded-lg transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[a.jsx(El,{className:"w-4 h-4 inline mr-2"}),"Payments"]})]}),e&&a.jsxs("div",{className:"flex gap-2",children:[r==="bills"&&a.jsxs("button",{onClick:()=>{V(),A(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Add Bill"]}),r==="payments"&&a.jsxs("button",{onClick:()=>{K(),m(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Record Payment"]})]})]}),r==="bills"?a.jsx(ws,{columns:z,data:s,loading:d,actions:e?R=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>P(R),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>J(R.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(nn,{className:"w-4 h-4"})})]}):void 0}):a.jsx(ws,{columns:G,data:o,loading:d,actions:e?R=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>X(R),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>H(R.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(nn,{className:"w-4 h-4"})})]}):void 0}),a.jsx(qt,{isOpen:f,onClose:()=>{A(!1),V()},title:v?"Edit Vendor Bill":"Add Vendor Bill",children:a.jsxs("form",{onSubmit:O,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Name *"}),a.jsx("input",{type:"text",value:x.vendor_name,onChange:R=>w({...x,vendor_name:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor ID (Optional)"}),a.jsx("input",{type:"text",value:x.vendor_id,onChange:R=>w({...x,vendor_id:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),a.jsxs("select",{value:x.category||"",onChange:R=>w({...x,category:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"expense",children:"Expense"}),a.jsx("option",{value:"inventory",children:"Inventory"}),a.jsx("option",{value:"asset",children:"Asset"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Date *"}),a.jsx("input",{type:"date",value:x.bill_date,onChange:R=>w({...x,bill_date:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),a.jsx("input",{type:"date",value:x.due_date,onChange:R=>w({...x,due_date:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),a.jsx("input",{type:"number",value:x.amount===0?"":x.amount,onChange:R=>w({...x,amount:R.target.value===""?0:Number(R.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Amount (Rp)"}),a.jsx("input",{type:"number",value:x.tax_amount===0?"":x.tax_amount,onChange:R=>w({...x,tax_amount:R.target.value===""?0:Number(R.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),a.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["Rp ",(x.amount+x.tax_amount).toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:x.description,onChange:R=>w({...x,description:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{A(!1),V()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:v?"Update Bill":"Add Bill"})]})]})}),a.jsx(qt,{isOpen:b,onClose:()=>{m(!1),K()},title:g?"Edit Payment":"Record Payment",children:a.jsxs("form",{onSubmit:M,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill *"}),a.jsxs("select",{value:N.bill_id,onChange:R=>{const le=R.target.value,ee=Z.find(_e=>_e.id===le);_({...N,bill_id:le,amount:ee?ee.total_amount:0})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!g,children:[a.jsx("option",{value:"",children:"Select a bill"}),Z.map(R=>a.jsxs("option",{value:R.id,children:[R.bill_number," - ",R.vendor_name," (Rp ",R.total_amount.toLocaleString("id-ID"),")"]},R.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),a.jsx("input",{type:"date",value:N.payment_date,onChange:R=>_({...N,payment_date:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),a.jsx("input",{type:"number",value:N.amount===0?"":N.amount,onChange:R=>_({...N,amount:R.target.value===""?0:Number(R.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),a.jsxs("select",{value:N.payment_method,onChange:R=>_({...N,payment_method:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"cheque",children:"Cheque"}),a.jsx("option",{value:"credit_card",children:"Credit Card"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),a.jsxs("select",{value:N.bank_account_id,onChange:R=>_({...N,bank_account_id:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Select bank account"}),c.map(R=>a.jsxs("option",{value:R.id,children:[R.account_name," - ",R.bank_name]},R.id))]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),a.jsx("input",{type:"text",value:N.reference_number,onChange:R=>_({...N,reference_number:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Transaction/Check number"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:N.notes,onChange:R=>_({...N,notes:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{m(!1),K()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:g?"Update Payment":"Record Payment"})]})]})})]})}function qAe(){const[e,t]=W.useState([]),[r,n]=W.useState(!0),[s,i]=W.useState(new Date().toISOString().split("T")[0]);W.useEffect(()=>{o()},[s]);const o=async()=>{try{n(!0);const{data:d,error:h}=await ae.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]);if(h)throw h;const f=await Promise.all((d||[]).map(async m=>{const{data:v}=await ae.rpc("get_invoice_paid_amount",{p_invoice_id:m.id}),p=v||0,g=m.total_amount-p,y=new Date(m.due_date),x=new Date(s),w=Math.floor((x.getTime()-y.getTime())/(1e3*60*60*24));return{...m,balance:g,days_overdue:w}})),A=new Map;f.forEach(m=>{var g;const v=m.customer_id;A.has(v)||A.set(v,{customer_id:v,customer_name:((g=m.customers)==null?void 0:g.company_name)||"Unknown",total_outstanding:0,current:0,days_1_30:0,days_31_60:0,days_61_90:0,days_90_plus:0,invoice_count:0});const p=A.get(v);p.total_outstanding+=m.balance,p.invoice_count+=1,m.days_overdue<0?p.current+=m.balance:m.days_overdue<=30?p.days_1_30+=m.balance:m.days_overdue<=60?p.days_31_60+=m.balance:m.days_overdue<=90?p.days_61_90+=m.balance:p.days_90_plus+=m.balance});const b=Array.from(A.values()).sort((m,v)=>v.total_outstanding-m.total_outstanding);t(b)}catch(d){console.error("Error loading ageing data:",d),alert("Failed to load ageing report")}finally{n(!1)}},l=()=>{const d=["Customer","Total Outstanding","Current (Not Due)","1-30 Days","31-60 Days","61-90 Days","90+ Days","Invoice Count"],h=e.map(v=>[v.customer_name,v.total_outstanding,v.current,v.days_1_30,v.days_31_60,v.days_61_90,v.days_90_plus,v.invoice_count]),f=[d.join(","),...h.map(v=>v.join(","))].join(`
`),A=new Blob([f],{type:"text/csv"}),b=URL.createObjectURL(A),m=document.createElement("a");m.href=b,m.download=`ageing_report_${s}.csv`,m.click(),URL.revokeObjectURL(b)},c=e.reduce((d,h)=>({total_outstanding:d.total_outstanding+h.total_outstanding,current:d.current+h.current,days_1_30:d.days_1_30+h.days_1_30,days_31_60:d.days_31_60+h.days_31_60,days_61_90:d.days_61_90+h.days_61_90,days_90_plus:d.days_90_plus+h.days_90_plus,invoice_count:d.invoice_count+h.invoice_count}),{total_outstanding:0,current:0,days_1_30:0,days_31_60:0,days_61_90:0,days_90_plus:0,invoice_count:0}),u=c.days_1_30+c.days_31_60+c.days_61_90+c.days_90_plus;return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Accounts Receivable Ageing Report"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Track overdue invoices by ageing buckets"})]}),a.jsxs("button",{onClick:l,disabled:e.length===0,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(uR,{className:"w-4 h-4"}),"Export CSV"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Outstanding"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:["Rp ",c.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[c.invoice_count," invoices"]})]}),a.jsx(ui,{className:"w-10 h-10 text-gray-400"})]})}),a.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-6 border border-green-200",children:[a.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Current (Not Due)"}),a.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["Rp ",c.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[c.total_outstanding>0?(c.current/c.total_outstanding*100).toFixed(1):0,"% of total"]})]}),a.jsxs("div",{className:"bg-orange-50 rounded-lg shadow p-6 border border-orange-200",children:[a.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Overdue"}),a.jsxs("p",{className:"text-2xl font-bold text-orange-900 mt-1",children:["Rp ",u.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[c.total_outstanding>0?(u/c.total_outstanding*100).toFixed(1):0,"% of total"]})]}),a.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-6 border border-red-200",children:[a.jsx("p",{className:"text-sm text-red-700 font-medium",children:"90+ Days Critical"}),a.jsxs("p",{className:"text-2xl font-bold text-red-900 mt-1",children:["Rp ",c.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Immediate action required"})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx(Na,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{className:"font-medium text-gray-700",children:"As of Date:"})]}),a.jsx("input",{type:"date",value:s,onChange:d=>i(d.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Report generated as of ",new Date(s).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoices"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Outstanding"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-green-700 uppercase tracking-wider",children:"Current"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-yellow-700 uppercase tracking-wider",children:"1-30 Days"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-orange-700 uppercase tracking-wider",children:"31-60 Days"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-red-700 uppercase tracking-wider",children:"61-90 Days"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-red-900 uppercase tracking-wider",children:"90+ Days"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3",children:"Loading ageing data..."})]})})}):e.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:[a.jsx(ui,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg font-medium",children:"No Outstanding Invoices"}),a.jsx("p",{className:"text-sm mt-2",children:"All invoices are fully paid!"})]})}):a.jsxs(a.Fragment,{children:[e.map(d=>a.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:d.customer_name})}),a.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-500",children:d.invoice_count}),a.jsxs("td",{className:"px-6 py-4 text-right text-sm font-bold text-gray-900",children:["Rp ",d.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsx("td",{className:"px-6 py-4 text-right text-sm",children:d.current>0?a.jsxs("span",{className:"text-green-600 font-medium",children:["Rp ",d.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):a.jsx("span",{className:"text-gray-300",children:"-"})}),a.jsx("td",{className:"px-6 py-4 text-right text-sm",children:d.days_1_30>0?a.jsxs("span",{className:"text-yellow-600 font-medium",children:["Rp ",d.days_1_30.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):a.jsx("span",{className:"text-gray-300",children:"-"})}),a.jsx("td",{className:"px-6 py-4 text-right text-sm",children:d.days_31_60>0?a.jsxs("span",{className:"text-orange-600 font-medium",children:["Rp ",d.days_31_60.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):a.jsx("span",{className:"text-gray-300",children:"-"})}),a.jsx("td",{className:"px-6 py-4 text-right text-sm",children:d.days_61_90>0?a.jsxs("span",{className:"text-red-600 font-medium",children:["Rp ",d.days_61_90.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):a.jsx("span",{className:"text-gray-300",children:"-"})}),a.jsx("td",{className:"px-6 py-4 text-right text-sm",children:d.days_90_plus>0?a.jsxs("span",{className:"text-red-900 font-bold",children:["Rp ",d.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}):a.jsx("span",{className:"text-gray-300",children:"-"})})]},d.customer_id)),a.jsxs("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-300",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL"}),a.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:c.invoice_count}),a.jsxs("td",{className:"px-6 py-4 text-right text-sm text-gray-900",children:["Rp ",c.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("td",{className:"px-6 py-4 text-right text-sm text-green-700",children:["Rp ",c.current.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("td",{className:"px-6 py-4 text-right text-sm text-yellow-700",children:["Rp ",c.days_1_30.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("td",{className:"px-6 py-4 text-right text-sm text-orange-700",children:["Rp ",c.days_31_60.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("td",{className:"px-6 py-4 text-right text-sm text-red-700",children:["Rp ",c.days_61_90.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),a.jsxs("td",{className:"px-6 py-4 text-right text-sm text-red-900",children:["Rp ",c.days_90_plus.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})})]})})})]})})}const Mv=[{value:"asset",label:"Asset",color:"bg-blue-100 text-blue-800"},{value:"liability",label:"Liability",color:"bg-red-100 text-red-800"},{value:"equity",label:"Equity",color:"bg-purple-100 text-purple-800"},{value:"revenue",label:"Revenue",color:"bg-green-100 text-green-800"},{value:"expense",label:"Expense",color:"bg-orange-100 text-orange-800"},{value:"contra",label:"Contra",color:"bg-gray-100 text-gray-800"}];function KAe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState(!0),[i,o]=W.useState(!1),[l,c]=W.useState(null),[u,d]=W.useState(new Set(["asset","liability","equity","revenue","expense"])),[h,f]=W.useState(""),[A,b]=W.useState({code:"",name:"",name_id:"",account_type:"expense",account_group:"",parent_id:"",is_header:!1,normal_balance:"debit",description:""});W.useEffect(()=>{m()},[]);const m=async()=>{try{const{data:_,error:C}=await ae.from("chart_of_accounts").select("*").order("code");if(C)throw C;r(_||[])}catch(_){console.error("Error loading accounts:",_)}finally{s(!1)}},v=async _=>{_.preventDefault();try{const C={...A,parent_id:A.parent_id||null,name_id:A.name_id||null,description:A.description||null};if(l){const{error:j}=await ae.from("chart_of_accounts").update(C).eq("id",l.id);if(j)throw j}else{const{error:j}=await ae.from("chart_of_accounts").insert([C]);if(j)throw j}o(!1),y(),m()}catch(C){console.error("Error saving account:",C),alert("Failed to save account: "+C.message)}},p=_=>{c(_),b({code:_.code,name:_.name,name_id:_.name_id||"",account_type:_.account_type,account_group:_.account_group||"",parent_id:_.parent_id||"",is_header:_.is_header,normal_balance:_.normal_balance,description:_.description||""}),o(!0)},g=async _=>{if(confirm("Are you sure you want to delete this account?"))try{const{error:C}=await ae.from("chart_of_accounts").delete().eq("id",_);if(C)throw C;m()}catch(C){console.error("Error deleting account:",C),alert("Failed to delete account: "+C.message)}},y=()=>{c(null),b({code:"",name:"",name_id:"",account_type:"expense",account_group:"",parent_id:"",is_header:!1,normal_balance:"debit",description:""})},x=_=>{const C=new Set(u);C.has(_)?C.delete(_):C.add(_),d(C)},w=t.filter(_=>_.code.toLowerCase().includes(h.toLowerCase())||_.name.toLowerCase().includes(h.toLowerCase())||_.name_id&&_.name_id.toLowerCase().includes(h.toLowerCase())),N=Mv.reduce((_,C)=>(_[C.value]=w.filter(j=>j.account_type===C.value),_),{});return n?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search accounts...",value:h,onChange:_=>f(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e&&a.jsxs("button",{onClick:()=>{y(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Add Account"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:Mv.map(_=>{var C,j;return a.jsxs("div",{className:"border-b last:border-b-0",children:[a.jsx("button",{onClick:()=>x(_.value),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[u.has(_.value)?a.jsx(Fi,{className:"w-5 h-5"}):a.jsx(Sc,{className:"w-5 h-5"}),a.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${_.color}`,children:_.label}),a.jsxs("span",{className:"text-gray-500 text-sm",children:["(",((C=N[_.value])==null?void 0:C.length)||0," accounts)"]})]})}),u.has(_.value)&&((j=N[_.value])==null?void 0:j.length)>0&&a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 text-xs text-gray-500 uppercase",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left",children:"Code"}),a.jsx("th",{className:"px-4 py-2 text-left",children:"Account Name"}),a.jsx("th",{className:"px-4 py-2 text-left",children:"Indonesian Name"}),a.jsx("th",{className:"px-4 py-2 text-left",children:"Group"}),a.jsx("th",{className:"px-4 py-2 text-center",children:"Normal"}),e&&a.jsx("th",{className:"px-4 py-2 text-right",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y",children:N[_.value].map(E=>a.jsxs("tr",{className:`hover:bg-gray-50 ${E.is_header?"font-semibold bg-gray-50":""}`,children:[a.jsx("td",{className:"px-4 py-2 font-mono text-sm",children:E.code}),a.jsx("td",{className:"px-4 py-2",children:E.name}),a.jsx("td",{className:"px-4 py-2 text-gray-500",children:E.name_id||"-"}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:E.account_group||"-"}),a.jsx("td",{className:"px-4 py-2 text-center",children:a.jsx("span",{className:`text-xs px-2 py-1 rounded ${E.normal_balance==="debit"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:E.normal_balance})}),e&&a.jsxs("td",{className:"px-4 py-2 text-right",children:[a.jsx("button",{onClick:()=>p(E),className:"text-blue-600 hover:text-blue-800 mr-2",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>g(E.id),className:"text-red-600 hover:text-red-800",children:a.jsx(nn,{className:"w-4 h-4"})})]})]},E.id))})]})]},_.value)})}),a.jsx(qt,{isOpen:i,onClose:()=>o(!1),title:l?"Edit Account":"Add Account",children:a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Code *"}),a.jsx("input",{type:"text",required:!0,value:A.code,onChange:_=>b({...A,code:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., 1101"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type *"}),a.jsx("select",{required:!0,value:A.account_type,onChange:_=>b({...A,account_type:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:Mv.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name (English) *"}),a.jsx("input",{type:"text",required:!0,value:A.name,onChange:_=>b({...A,name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name (Indonesian)"}),a.jsx("input",{type:"text",value:A.name_id,onChange:_=>b({...A,name_id:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Group"}),a.jsx("input",{type:"text",value:A.account_group,onChange:_=>b({...A,account_group:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Normal Balance *"}),a.jsxs("select",{required:!0,value:A.normal_balance,onChange:_=>b({...A,normal_balance:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"debit",children:"Debit"}),a.jsx("option",{value:"credit",children:"Credit"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Account"}),a.jsxs("select",{value:A.parent_id,onChange:_=>b({...A,parent_id:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"None (Top Level)"}),t.filter(_=>_.is_header).map(_=>a.jsxs("option",{value:_.id,children:[_.code," - ",_.name]},_.id))]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"is_header",checked:A.is_header,onChange:_=>b({...A,is_header:_.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"is_header",className:"text-sm text-gray-700",children:"This is a header/group account (not for posting)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:A.description,onChange:_=>b({...A,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Create"," Account"]})]})]})})]})}function $Ae({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState(!0),[i,o]=W.useState(!1),[l,c]=W.useState(null),[u,d]=W.useState(""),[h,f]=W.useState({supplier_code:"",company_name:"",contact_person:"",email:"",phone:"",address:"",city:"",country:"Indonesia",npwp:"",pkp_status:!1,payment_terms_days:30,bank_name:"",bank_account_number:"",bank_account_name:""});W.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:x,error:w}=await ae.from("suppliers").select("*").order("company_name");if(w)throw w;r(x||[])}catch(x){console.error("Error loading suppliers:",x)}finally{s(!1)}},b=async()=>{const x=new Date().getFullYear().toString().slice(-2),{count:w}=await ae.from("suppliers").select("*",{count:"exact",head:!0});return`SUP${x}-${String((w||0)+1).padStart(4,"0")}`},m=async x=>{x.preventDefault();try{const{data:{user:w}}=await ae.auth.getUser();if(!w)throw new Error("Not authenticated");const N={...h,supplier_code:h.supplier_code||await b(),contact_person:h.contact_person||null,email:h.email||null,phone:h.phone||null,address:h.address||null,city:h.city||null,npwp:h.npwp||null,bank_name:h.bank_name||null,bank_account_number:h.bank_account_number||null,bank_account_name:h.bank_account_name||null};if(l){const{error:_}=await ae.from("suppliers").update(N).eq("id",l.id);if(_)throw _}else{const{error:_}=await ae.from("suppliers").insert([{...N,created_by:w.id}]);if(_)throw _}o(!1),g(),A()}catch(w){console.error("Error saving supplier:",w),alert("Failed to save supplier: "+w.message)}},v=x=>{c(x),f({supplier_code:x.supplier_code||"",company_name:x.company_name,contact_person:x.contact_person||"",email:x.email||"",phone:x.phone||"",address:x.address||"",city:x.city||"",country:x.country,npwp:x.npwp||"",pkp_status:x.pkp_status,payment_terms_days:x.payment_terms_days,bank_name:x.bank_name||"",bank_account_number:x.bank_account_number||"",bank_account_name:x.bank_account_name||""}),o(!0)},p=async x=>{if(confirm("Are you sure you want to delete this supplier?"))try{const{error:w}=await ae.from("suppliers").delete().eq("id",x);if(w)throw w;A()}catch(w){console.error("Error deleting supplier:",w),alert("Failed to delete supplier: "+w.message)}},g=()=>{c(null),f({supplier_code:"",company_name:"",contact_person:"",email:"",phone:"",address:"",city:"",country:"Indonesia",npwp:"",pkp_status:!1,payment_terms_days:30,bank_name:"",bank_account_number:"",bank_account_name:""})},y=t.filter(x=>x.company_name.toLowerCase().includes(u.toLowerCase())||x.supplier_code&&x.supplier_code.toLowerCase().includes(u.toLowerCase())||x.npwp&&x.npwp.includes(u));return n?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search suppliers...",value:u,onChange:x=>d(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e&&a.jsxs("button",{onClick:()=>{g(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Add Supplier"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPWP"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"PKP"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Terms"}),e&&a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsxs("tbody",{className:"divide-y",children:[y.map(x=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:x.supplier_code||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(r0,{className:"w-4 h-4 text-gray-400"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:x.company_name}),x.city&&a.jsx("div",{className:"text-sm text-gray-500",children:x.city})]})]})}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"text-sm",children:x.contact_person||"-"}),x.phone&&a.jsx("div",{className:"text-sm text-gray-500",children:x.phone})]}),a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:x.npwp||"-"}),a.jsx("td",{className:"px-4 py-3 text-center",children:x.pkp_status?a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded",children:"PKP"}):a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:"Non-PKP"})}),a.jsxs("td",{className:"px-4 py-3 text-sm",children:[x.payment_terms_days," days"]}),e&&a.jsxs("td",{className:"px-4 py-3 text-right",children:[a.jsx("button",{onClick:()=>v(x),className:"text-blue-600 hover:text-blue-800 mr-2",children:a.jsx(Rs,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>p(x.id),className:"text-red-600 hover:text-red-800",children:a.jsx(nn,{className:"w-4 h-4"})})]})]},x.id)),y.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No suppliers found"})})]})]})}),a.jsx(qt,{isOpen:i,onClose:()=>o(!1),title:l?"Edit Supplier":"Add Supplier",children:a.jsxs("form",{onSubmit:m,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Code"}),a.jsx("input",{type:"text",value:h.supplier_code,onChange:x=>f({...h,supplier_code:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Auto-generated if empty"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),a.jsx("input",{type:"text",required:!0,value:h.company_name,onChange:x=>f({...h,company_name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),a.jsx("input",{type:"text",value:h.contact_person,onChange:x=>f({...h,contact_person:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"text",value:h.phone,onChange:x=>f({...h,phone:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:h.email,onChange:x=>f({...h,email:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),a.jsx("textarea",{value:h.address,onChange:x=>f({...h,address:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),a.jsx("input",{type:"text",value:h.city,onChange:x=>f({...h,city:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),a.jsx("input",{type:"text",value:h.country,onChange:x=>f({...h,country:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Tax Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NPWP"}),a.jsx("input",{type:"text",value:h.npwp,onChange:x=>f({...h,npwp:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"00.000.000.0-000.000"})]}),a.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[a.jsx("input",{type:"checkbox",id:"pkp_status",checked:h.pkp_status,onChange:x=>f({...h,pkp_status:x.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"pkp_status",className:"text-sm text-gray-700",children:"PKP (Pengusaha Kena Pajak)"})]})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Bank Details"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),a.jsx("input",{type:"text",value:h.bank_name,onChange:x=>f({...h,bank_name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),a.jsx("input",{type:"text",value:h.bank_account_number,onChange:x=>f({...h,bank_account_number:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name"}),a.jsx("input",{type:"text",value:h.bank_account_name,onChange:x=>f({...h,bank_account_name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms (Days)"}),a.jsx("input",{type:"number",value:h.payment_terms_days,onChange:x=>f({...h,payment_terms_days:parseInt(x.target.value)||30}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Create"," Supplier"]})]})]})})]})}function VAe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState([]),[i,o]=W.useState([]),[l,c]=W.useState(!0),[u,d]=W.useState(!1),[h,f]=W.useState(!1),[A,b]=W.useState(null),[m,v]=W.useState([]),[p,g]=W.useState(""),[y,x]=W.useState({invoice_number:"",supplier_id:"",invoice_date:new Date().toISOString().split("T")[0],due_date:"",subtotal:0,tax_amount:0,faktur_pajak_number:"",notes:"",document_urls:[]});W.useEffect(()=>{w(),N()},[]);const w=async()=>{try{const{data:P,error:X}=await ae.from("purchase_invoices").select("*, suppliers(company_name)").order("invoice_date",{ascending:!1});if(X)throw X;r(P||[])}catch(P){console.error("Error loading invoices:",P)}finally{c(!1)}},N=async()=>{const{data:P}=await ae.from("suppliers").select("id, company_name, npwp, pkp_status").order("company_name");s(P||[])},_=async P=>{const{data:X}=await ae.from("batches").select("*, products(product_name)").eq("supplier_id",P).is("purchase_invoice_id",null).order("import_date",{ascending:!1});o(X||[])},C=async P=>{P.preventDefault();try{const{data:{user:X}}=await ae.auth.getUser();if(!X)throw new Error("Not authenticated");const J=y.subtotal+y.tax_amount,H={invoice_number:y.invoice_number,supplier_id:y.supplier_id,invoice_date:y.invoice_date,due_date:y.due_date||null,subtotal:y.subtotal,tax_amount:y.tax_amount,total_amount:J,faktur_pajak_number:y.faktur_pajak_number||null,notes:y.notes||null,document_urls:y.document_urls.length>0?y.document_urls:null,created_by:X.id},{error:V}=await ae.from("purchase_invoices").insert([H]);if(V)throw V;d(!1),F(),w()}catch(X){console.error("Error saving invoice:",X),alert("Failed to save: "+X.message)}},j=async()=>{if(!(!A||m.length===0))try{const{error:P}=await ae.from("batches").update({purchase_invoice_id:A.id}).in("id",m);if(P)throw P;f(!1),v([]),b(null),alert("Batches linked successfully!")}catch(P){console.error("Error linking batches:",P),alert("Failed to link: "+P.message)}},E=async P=>{b(P),await _(P.supplier_id),f(!0)},S=async P=>{if(confirm("Are you sure you want to delete this invoice?"))try{await ae.from("batches").update({purchase_invoice_id:null}).eq("purchase_invoice_id",P);const{error:X}=await ae.from("purchase_invoices").delete().eq("id",P);if(X)throw X;w()}catch(X){console.error("Error deleting invoice:",X),alert("Failed to delete: "+X.message)}},F=()=>{x({invoice_number:"",supplier_id:"",invoice_date:new Date().toISOString().split("T")[0],due_date:"",subtotal:0,tax_amount:0,faktur_pajak_number:"",notes:"",document_urls:[]})},I=()=>{const P=n.find(X=>X.id===y.supplier_id);if(P!=null&&P.pkp_status){const X=y.subtotal*.11;x(J=>({...J,tax_amount:Math.round(X)}))}},O=P=>{switch(P){case"paid":return"bg-green-100 text-green-700";case"partial":return"bg-yellow-100 text-yellow-700";case"unpaid":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},M=t.filter(P=>{var X;return P.invoice_number.toLowerCase().includes(p.toLowerCase())||((X=P.suppliers)==null?void 0:X.company_name.toLowerCase().includes(p.toLowerCase()))});return l?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search invoices...",value:p,onChange:P=>g(P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e&&a.jsxs("button",{onClick:()=>{F(),d(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[a.jsx(Rr,{className:"w-5 h-5"}),"New Purchase Invoice"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Faktur Pajak"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Balance"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"}),e&&a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsxs("tbody",{className:"divide-y",children:[M.map(P=>{var X;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:P.invoice_number}),a.jsx("td",{className:"px-4 py-3",children:new Date(P.invoice_date).toLocaleDateString("id-ID")}),a.jsx("td",{className:"px-4 py-3",children:(X=P.suppliers)==null?void 0:X.company_name}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:P.faktur_pajak_number||"-"}),a.jsxs("td",{className:"px-4 py-3 text-right",children:["Rp ",P.total_amount.toLocaleString("id-ID")]}),a.jsxs("td",{className:"px-4 py-3 text-right text-red-600",children:["Rp ",P.balance_amount.toLocaleString("id-ID")]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs capitalize ${O(P.status)}`,children:P.status})}),e&&a.jsxs("td",{className:"px-4 py-3 text-right",children:[a.jsx("button",{onClick:()=>E(P),className:"text-purple-600 hover:text-purple-800 mr-2",title:"Link Batches",children:a.jsx(mR,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>S(P.id),className:"text-red-600 hover:text-red-800",children:a.jsx(nn,{className:"w-4 h-4"})})]})]},P.id)}),M.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No purchase invoices found"})})]})]})}),a.jsx(qt,{isOpen:u,onClose:()=>d(!1),title:"New Purchase Invoice",children:a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number *"}),a.jsx("input",{type:"text",required:!0,value:y.invoice_number,onChange:P=>x({...y,invoice_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),a.jsxs("select",{required:!0,value:y.supplier_id,onChange:P=>x({...y,supplier_id:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select supplier"}),n.map(P=>a.jsxs("option",{value:P.id,children:[P.company_name," ",P.pkp_status?"(PKP)":""]},P.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date *"}),a.jsx("input",{type:"date",required:!0,value:y.invoice_date,onChange:P=>x({...y,invoice_date:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),a.jsx("input",{type:"date",value:y.due_date,onChange:P=>x({...y,due_date:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subtotal (Rp) *"}),a.jsx("input",{type:"number",required:!0,value:y.subtotal,onChange:P=>x({...y,subtotal:parseFloat(P.target.value)||0}),onBlur:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPN (Rp)"}),a.jsx("input",{type:"number",value:y.tax_amount,onChange:P=>x({...y,tax_amount:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:a.jsxs("div",{className:"flex justify-between font-medium text-lg",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["Rp ",(y.subtotal+y.tax_amount).toLocaleString("id-ID")]})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faktur Pajak Number"}),a.jsx("input",{type:"text",value:y.faktur_pajak_number,onChange:P=>x({...y,faktur_pajak_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"000-00.00000000"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:y.notes,onChange:P=>x({...y,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attach Documents"}),a.jsx(a_,{currentUrls:y.document_urls,onUploadComplete:P=>x({...y,document_urls:P}),folder:"purchase-invoices"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save Invoice"})]})]})}),a.jsx(qt,{isOpen:h,onClose:()=>{f(!1),v([])},title:"Link Batches to Invoice",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Select batches from this supplier to link to invoice: ",a.jsx("strong",{children:A==null?void 0:A.invoice_number})]}),i.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No unlinked batches found for this supplier"}):a.jsx("div",{className:"max-h-64 overflow-y-auto border rounded-lg",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left w-8"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Batch"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Amount"})]})}),a.jsx("tbody",{className:"divide-y",children:i.map(P=>{var J;const X=P.import_price+P.duty_charges+P.freight_charges+P.other_charges;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"checkbox",checked:m.includes(P.id),onChange:H=>{H.target.checked?v([...m,P.id]):v(m.filter(V=>V!==P.id))},className:"rounded"})}),a.jsx("td",{className:"px-3 py-2 font-mono",children:P.batch_number}),a.jsx("td",{className:"px-3 py-2",children:(J=P.products)==null?void 0:J.product_name}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["Rp ",X.toLocaleString("id-ID")]})]},P.id)})})]})}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{f(!1),v([])},className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{onClick:j,disabled:m.length===0,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:["Link ",m.length," Batch(es)"]})]})]})})]})}function GAe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState([]),[i,o]=W.useState([]),[l,c]=W.useState([]),[u,d]=W.useState(!0),[h,f]=W.useState(!1),[A,b]=W.useState(""),[m,v]=W.useState([]),[p,g]=W.useState({voucher_date:new Date().toISOString().split("T")[0],customer_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,description:""});W.useEffect(()=>{y(),x(),w()},[]),W.useEffect(()=>{p.customer_id?N(p.customer_id):(c([]),v([]))},[p.customer_id]);const y=async()=>{try{const{data:I,error:O}=await ae.from("receipt_vouchers").select("*, customers(company_name), bank_accounts(account_name, bank_name)").order("voucher_date",{ascending:!1});if(O)throw O;r(I||[])}catch(I){console.error("Error loading vouchers:",I)}finally{d(!1)}},x=async()=>{const{data:I}=await ae.from("customers").select("id, company_name").order("company_name");s(I||[])},w=async()=>{const{data:I}=await ae.from("bank_accounts").select("id, account_name, bank_name, account_number").eq("is_active",!0);o(I||[])},N=async I=>{const{data:O}=await ae.from("sales_invoices").select("id, invoice_number, invoice_date, total_amount, paid_amount, balance_amount").eq("customer_id",I).gt("balance_amount",0).order("invoice_date");c(O||[]),v([])},_=async()=>{const I=new Date().getFullYear().toString().slice(-2),O=(new Date().getMonth()+1).toString().padStart(2,"0"),{count:M}=await ae.from("receipt_vouchers").select("*",{count:"exact",head:!0}).like("voucher_number",`RV${I}${O}%`);return`RV${I}${O}-${String((M||0)+1).padStart(4,"0")}`},C=(I,O)=>{v(M=>M.find(X=>X.invoiceId===I)?O<=0?M.filter(X=>X.invoiceId!==I):M.map(X=>X.invoiceId===I?{...X,amount:O}:X):O>0?[...M,{invoiceId:I,amount:O}]:M)},j=m.reduce((I,O)=>I+O.amount,0),E=async I=>{if(I.preventDefault(),m.length>0&&j>p.amount){alert("Total allocated amount cannot exceed payment amount");return}try{const{data:{user:O}}=await ae.auth.getUser();if(!O)throw new Error("Not authenticated");const M=await _(),{data:P,error:X}=await ae.from("receipt_vouchers").insert([{voucher_number:M,voucher_date:p.voucher_date,customer_id:p.customer_id,payment_method:p.payment_method,bank_account_id:p.bank_account_id||null,reference_number:p.reference_number||null,amount:p.amount,description:p.description||null,created_by:O.id}]).select().single();if(X)throw X;for(const J of m){await ae.from("voucher_allocations").insert({voucher_type:"receipt",receipt_voucher_id:P.id,sales_invoice_id:J.invoiceId,allocated_amount:J.amount});const H=l.find(V=>V.id===J.invoiceId);if(H){const V=(H.paid_amount||0)+J.amount,K=H.total_amount-V;await ae.from("sales_invoices").update({paid_amount:V,balance_amount:K,status:K<=0?"paid":"partial"}).eq("id",J.invoiceId)}}f(!1),S(),y()}catch(O){console.error("Error saving voucher:",O),alert("Failed to save: "+O.message)}},S=()=>{g({voucher_date:new Date().toISOString().split("T")[0],customer_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,description:""}),v([]),c([])},F=t.filter(I=>{var O;return I.voucher_number.toLowerCase().includes(A.toLowerCase())||((O=I.customers)==null?void 0:O.company_name.toLowerCase().includes(A.toLowerCase()))});return u?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search receipts...",value:A,onChange:I=>b(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e&&a.jsxs("button",{onClick:()=>{S(),f(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:[a.jsx(yh,{className:"w-5 h-5"}),"New Receipt"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Voucher No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Amount"})]})}),a.jsxs("tbody",{className:"divide-y",children:[F.map(I=>{var O;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:I.voucher_number}),a.jsx("td",{className:"px-4 py-3",children:new Date(I.voucher_date).toLocaleDateString("id-ID")}),a.jsx("td",{className:"px-4 py-3",children:(O=I.customers)==null?void 0:O.company_name}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs capitalize",children:I.payment_method.replace("_"," ")})}),a.jsx("td",{className:"px-4 py-3 text-sm",children:I.reference_number||"-"}),a.jsxs("td",{className:"px-4 py-3 text-right font-medium text-green-600",children:["Rp ",I.amount.toLocaleString("id-ID")]})]},I.id)}),F.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No receipt vouchers found"})})]})]})}),a.jsx(qt,{isOpen:h,onClose:()=>f(!1),title:"New Receipt Voucher",children:a.jsxs("form",{onSubmit:E,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",required:!0,value:p.voucher_date,onChange:I=>g({...p,voucher_date:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsxs("select",{required:!0,value:p.customer_id,onChange:I=>g({...p,customer_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select customer"}),n.map(I=>a.jsx("option",{value:I.id,children:I.company_name},I.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),a.jsxs("select",{required:!0,value:p.payment_method,onChange:I=>g({...p,payment_method:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),a.jsx("option",{value:"check",children:"Check"}),a.jsx("option",{value:"giro",children:"Giro"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),a.jsx("input",{type:"number",required:!0,value:p.amount,onChange:I=>g({...p,amount:parseFloat(I.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),p.payment_method!=="cash"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),a.jsxs("select",{value:p.bank_account_id,onChange:I=>g({...p,bank_account_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select account"}),i.map(I=>a.jsxs("option",{value:I.id,children:[I.bank_name," - ",I.account_name]},I.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference No."}),a.jsx("input",{type:"text",value:p.reference_number,onChange:I=>g({...p,reference_number:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Check/Transfer reference"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:p.description,onChange:I=>g({...p,description:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),l.length>0&&a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Allocate to Invoices"}),a.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Invoice"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Balance"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Allocate"})]})}),a.jsx("tbody",{className:"divide-y",children:l.map(I=>{var O;return a.jsxs("tr",{children:[a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("div",{className:"font-mono",children:I.invoice_number}),a.jsx("div",{className:"text-gray-500 text-xs",children:new Date(I.invoice_date).toLocaleDateString("id-ID")})]}),a.jsxs("td",{className:"px-3 py-2 text-right text-red-600",children:["Rp ",I.balance_amount.toLocaleString("id-ID")]}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"number",min:0,max:I.balance_amount,value:((O=m.find(M=>M.invoiceId===I.id))==null?void 0:O.amount)||"",onChange:M=>C(I.id,parseFloat(M.target.value)||0),className:"w-24 px-2 py-1 border rounded text-right",placeholder:"0"})})]},I.id)})})]})}),a.jsxs("div",{className:"mt-2 text-right text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Total Allocated:"}),a.jsxs("span",{className:`ml-2 font-medium ${j>p.amount?"text-red-600":"text-green-600"}`,children:["Rp ",j.toLocaleString("id-ID")]}),a.jsxs("span",{className:"text-gray-400 ml-1",children:["/ Rp ",p.amount.toLocaleString("id-ID")]})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Save Receipt"})]})]})})]})}function WAe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState([]),[i,o]=W.useState([]),[l,c]=W.useState([]),[u,d]=W.useState([]),[h,f]=W.useState(!0),[A,b]=W.useState(!1),[m,v]=W.useState(""),[p,g]=W.useState([]),[y,x]=W.useState({voucher_date:new Date().toISOString().split("T")[0],supplier_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,pph_code_id:"",pph_amount:0,description:""});W.useEffect(()=>{w(),N(),_(),C()},[]),W.useEffect(()=>{y.supplier_id?j(y.supplier_id):(c([]),g([]))},[y.supplier_id]),W.useEffect(()=>{if(y.pph_code_id&&y.amount>0){const P=u.find(X=>X.id===y.pph_code_id);if(P){const X=y.amount*(P.rate/100);x(J=>({...J,pph_amount:Math.round(X)}))}}else x(P=>({...P,pph_amount:0}))},[y.pph_code_id,y.amount,u]);const w=async()=>{try{const{data:P,error:X}=await ae.from("payment_vouchers").select("*, suppliers(company_name), bank_accounts(account_name, bank_name)").order("voucher_date",{ascending:!1});if(X)throw X;r(P||[])}catch(P){console.error("Error loading vouchers:",P)}finally{f(!1)}},N=async()=>{const{data:P}=await ae.from("suppliers").select("id, company_name").order("company_name");s(P||[])},_=async()=>{const{data:P}=await ae.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0);o(P||[])},C=async()=>{const{data:P}=await ae.from("tax_codes").select("id, code, name, rate").eq("is_withholding",!0);d(P||[])},j=async P=>{const{data:X}=await ae.from("purchase_invoices").select("id, invoice_number, invoice_date, total_amount, paid_amount, balance_amount").eq("supplier_id",P).gt("balance_amount",0).order("invoice_date");c(X||[]),g([])},E=async()=>{const P=new Date().getFullYear().toString().slice(-2),X=(new Date().getMonth()+1).toString().padStart(2,"0"),{count:J}=await ae.from("payment_vouchers").select("*",{count:"exact",head:!0}).like("voucher_number",`PV${P}${X}%`);return`PV${P}${X}-${String((J||0)+1).padStart(4,"0")}`},S=(P,X)=>{g(J=>J.find(V=>V.invoiceId===P)?X<=0?J.filter(V=>V.invoiceId!==P):J.map(V=>V.invoiceId===P?{...V,amount:X}:V):X>0?[...J,{invoiceId:P,amount:X}]:J)};p.reduce((P,X)=>P+X.amount,0);const F=y.amount-y.pph_amount,I=async P=>{P.preventDefault();try{const{data:{user:X}}=await ae.auth.getUser();if(!X)throw new Error("Not authenticated");const J=await E(),{data:H,error:V}=await ae.from("payment_vouchers").insert([{voucher_number:J,voucher_date:y.voucher_date,supplier_id:y.supplier_id,payment_method:y.payment_method,bank_account_id:y.bank_account_id||null,reference_number:y.reference_number||null,amount:y.amount,pph_amount:y.pph_amount,pph_code_id:y.pph_code_id||null,description:y.description||null,created_by:X.id}]).select().single();if(V)throw V;for(const K of p){await ae.from("voucher_allocations").insert({voucher_type:"payment",payment_voucher_id:H.id,purchase_invoice_id:K.invoiceId,allocated_amount:K.amount});const B=l.find(L=>L.id===K.invoiceId);if(B){const L=(B.paid_amount||0)+K.amount,U=B.total_amount-L;await ae.from("purchase_invoices").update({paid_amount:L,status:U<=0?"paid":"partial"}).eq("id",K.invoiceId)}}b(!1),O(),w()}catch(X){console.error("Error saving voucher:",X),alert("Failed to save: "+X.message)}},O=()=>{x({voucher_date:new Date().toISOString().split("T")[0],supplier_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,pph_code_id:"",pph_amount:0,description:""}),g([]),c([])},M=t.filter(P=>{var X;return P.voucher_number.toLowerCase().includes(m.toLowerCase())||((X=P.suppliers)==null?void 0:X.company_name.toLowerCase().includes(m.toLowerCase()))});return h?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search payments...",value:m,onChange:P=>v(P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e&&a.jsxs("button",{onClick:()=>{O(),b(!0)},className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:[a.jsx(vh,{className:"w-5 h-5"}),"New Payment"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Voucher No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Gross"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"PPh"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Net Paid"})]})}),a.jsxs("tbody",{className:"divide-y",children:[M.map(P=>{var X;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:P.voucher_number}),a.jsx("td",{className:"px-4 py-3",children:new Date(P.voucher_date).toLocaleDateString("id-ID")}),a.jsx("td",{className:"px-4 py-3",children:(X=P.suppliers)==null?void 0:X.company_name}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs capitalize",children:P.payment_method.replace("_"," ")})}),a.jsxs("td",{className:"px-4 py-3 text-right",children:["Rp ",P.amount.toLocaleString("id-ID")]}),a.jsx("td",{className:"px-4 py-3 text-right text-orange-600",children:P.pph_amount>0?`Rp ${P.pph_amount.toLocaleString("id-ID")}`:"-"}),a.jsxs("td",{className:"px-4 py-3 text-right font-medium text-red-600",children:["Rp ",P.net_amount.toLocaleString("id-ID")]})]},P.id)}),M.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No payment vouchers found"})})]})]})}),a.jsx(qt,{isOpen:A,onClose:()=>b(!1),title:"New Payment Voucher",children:a.jsxs("form",{onSubmit:I,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",required:!0,value:y.voucher_date,onChange:P=>x({...y,voucher_date:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),a.jsxs("select",{required:!0,value:y.supplier_id,onChange:P=>x({...y,supplier_id:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select supplier"}),n.map(P=>a.jsx("option",{value:P.id,children:P.company_name},P.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),a.jsxs("select",{required:!0,value:y.payment_method,onChange:P=>x({...y,payment_method:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),a.jsx("option",{value:"check",children:"Check"}),a.jsx("option",{value:"giro",children:"Giro"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gross Amount (Rp) *"}),a.jsx("input",{type:"number",required:!0,value:y.amount,onChange:P=>x({...y,amount:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),y.payment_method!=="cash"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),a.jsxs("select",{value:y.bank_account_id,onChange:P=>x({...y,bank_account_id:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select account"}),i.map(P=>a.jsxs("option",{value:P.id,children:[P.bank_name," - ",P.account_name]},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference No."}),a.jsx("input",{type:"text",value:y.reference_number,onChange:P=>x({...y,reference_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"PPh Withholding (Potong Pajak)"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPh Type"}),a.jsxs("select",{value:y.pph_code_id,onChange:P=>x({...y,pph_code_id:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"No withholding"}),u.map(P=>a.jsxs("option",{value:P.id,children:[P.code," - ",P.name," (",P.rate,"%)"]},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPh Amount"}),a.jsx("input",{type:"number",value:y.pph_amount,onChange:P=>x({...y,pph_amount:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-orange-50"})]})]}),a.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Gross Amount:"}),a.jsxs("span",{children:["Rp ",y.amount.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"flex justify-between text-sm text-orange-600",children:[a.jsx("span",{children:"Less: PPh Withholding:"}),a.jsxs("span",{children:["-Rp ",y.pph_amount.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"flex justify-between font-medium text-lg border-t mt-2 pt-2",children:[a.jsx("span",{children:"Net Payment:"}),a.jsxs("span",{className:"text-red-600",children:["Rp ",F.toLocaleString("id-ID")]})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:y.description,onChange:P=>x({...y,description:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),l.length>0&&a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Allocate to Purchase Invoices"}),a.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Invoice"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Balance"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Allocate"})]})}),a.jsx("tbody",{className:"divide-y",children:l.map(P=>{var X;return a.jsxs("tr",{children:[a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("div",{className:"font-mono",children:P.invoice_number}),a.jsx("div",{className:"text-gray-500 text-xs",children:new Date(P.invoice_date).toLocaleDateString("id-ID")})]}),a.jsxs("td",{className:"px-3 py-2 text-right text-red-600",children:["Rp ",P.balance_amount.toLocaleString("id-ID")]}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"number",min:0,max:P.balance_amount,value:((X=p.find(J=>J.invoiceId===P.id))==null?void 0:X.amount)||"",onChange:J=>S(P.id,parseFloat(J.target.value)||0),className:"w-24 px-2 py-1 border rounded text-right",placeholder:"0"})})]},P.id)})})]})})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Save Payment"})]})]})})]})}const zAe=["Office Supplies","Transportation","Meals & Entertainment","Postage & Courier","Cleaning & Maintenance","Utilities","Miscellaneous"],XAe=["Cash from Office","Bank Transfer","Bank Withdrawal","Cheque Encashment","Other"];function YAe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState([]),[i,o]=W.useState(!0),[l,c]=W.useState(!1),[u,d]=W.useState(0),[h,f]=W.useState(!1),[A,b]=W.useState([]),[m,v]=W.useState({transaction_type:"expense",transaction_date:new Date().toISOString().split("T")[0],amount:0,description:"",expense_category:"",bank_account_id:"",paid_to:"",paid_by_staff_name:"",source:"",received_by_staff_name:""}),p=W.useCallback(async()=>{try{const[C,j,E]=await Promise.all([ae.from("petty_cash_transactions").select(`
            *,
            bank_accounts(account_name, bank_name)
          `).order("transaction_date",{ascending:!1}).order("created_at",{ascending:!1}).limit(100),ae.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name"),ae.from("petty_cash_transactions").select("transaction_type, amount")]);if(C.error)throw C.error;if(j.error)throw j.error;if(r(C.data||[]),s(j.data||[]),E.error)console.error("Error fetching balance data:",E.error);else{const F=(E.data||[]).reduce((I,O)=>O.transaction_type==="withdraw"?I+Number(O.amount):I-Number(O.amount),0);d(F)}}catch(C){console.error("Error loading petty cash:",C)}finally{o(!1),f(!1)}},[]);W.useEffect(()=>{p();const C=setInterval(p,3e4);return()=>clearInterval(C)},[p]);const g=()=>{f(!0),p()},y=async C=>{const j=C==="withdraw"?"PCW":"PCE",E=new Date().getFullYear().toString().slice(-2),S=(new Date().getMonth()+1).toString().padStart(2,"0"),{count:F}=await ae.from("petty_cash_transactions").select("*",{count:"exact",head:!0}).like("transaction_number",`${j}${E}${S}%`);return`${j}${E}${S}-${String((F||0)+1).padStart(4,"0")}`},x=(C,j)=>{if(C.target.files){const E=Array.from(C.target.files).map(S=>({file:S,type:j}));b(S=>[...S,...E])}},w=C=>{b(j=>j.filter((E,S)=>S!==C))},N=async C=>{if(C.preventDefault(),m.amount<=0){alert("Amount must be greater than 0");return}if(m.transaction_type==="expense"&&m.amount>u){alert("Insufficient cash balance. Please add funds first.");return}try{const{data:{user:j}}=await ae.auth.getUser();if(!j)throw new Error("Not authenticated");const S={transaction_number:await y(m.transaction_type),transaction_date:m.transaction_date,transaction_type:m.transaction_type,amount:m.amount,description:m.description,created_by:j.id};m.transaction_type==="expense"?(S.expense_category=m.expense_category||null,S.paid_to=m.paid_to||null,S.paid_by_staff_name=m.paid_by_staff_name||null):(S.bank_account_id=m.bank_account_id||null,S.source=m.source||null,S.received_by_staff_name=m.received_by_staff_name||null);const{data:F,error:I}=await ae.from("petty_cash_transactions").insert([S]).select().single();if(I)throw I;if(A.length>0&&F)for(const{file:O,type:M}of A){const P=O.name.split(".").pop(),X=`${F.id}/${Date.now()}_${M}.${P}`,{error:J}=await ae.storage.from("petty-cash-receipts").upload(X,O);if(!J){const{data:H}=ae.storage.from("petty-cash-receipts").getPublicUrl(X);H&&await ae.from("petty_cash_documents").insert({petty_cash_transaction_id:F.id,file_type:M,file_name:O.name,file_url:H.publicUrl,file_size:O.size,uploaded_by:j.id})}}c(!1),_(),p()}catch(j){console.error("Error saving transaction:",j),alert("Failed to save: "+j.message)}},_=()=>{v({transaction_type:"expense",transaction_date:new Date().toISOString().split("T")[0],amount:0,description:"",expense_category:"",bank_account_id:"",paid_to:"",paid_by_staff_name:"",source:"",received_by_staff_name:""}),b([])};return i?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ew,{className:"w-6 h-6"}),a.jsx("span",{className:"text-green-100 font-medium",children:"Petty Cash Balance"})]}),a.jsxs("div",{className:"text-4xl font-bold",children:["Rp ",u.toLocaleString("id-ID")]}),a.jsx("p",{className:"text-green-100 text-sm mt-2",children:"Available for cash expenses"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:g,disabled:h,className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition",title:"Refresh",children:a.jsx(go,{className:`w-5 h-5 ${h?"animate-spin":""}`})}),e&&a.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 bg-white text-green-600 px-4 py-2 rounded-lg hover:bg-green-50 font-medium transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"New Entry"]})]})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-2",children:[a.jsx(yh,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"Funds Added"})]}),a.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["Rp ",t.filter(C=>C.transaction_type==="withdraw").reduce((C,j)=>C+j.amount,0).toLocaleString("id-ID")]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total withdrawn from bank"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2 text-red-600 mb-2",children:[a.jsx(vh,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:"Expenses Paid"})]}),a.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["Rp ",t.filter(C=>C.transaction_type==="expense").reduce((C,j)=>C+j.amount,0).toLocaleString("id-ID")]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total spent from petty cash"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b bg-gray-50",children:a.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Transactions"})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Txn No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Paid To / Source"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Staff"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Debit (In)"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Credit (Out)"})]})}),a.jsxs("tbody",{className:"divide-y",children:[t.map(C=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(C.transaction_date).toLocaleDateString("id-ID")}),a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:C.transaction_number}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-medium ${C.transaction_type==="withdraw"?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"}`,children:C.transaction_type==="withdraw"?a.jsxs(a.Fragment,{children:[a.jsx(yh,{className:"w-3 h-3"}),"Add Funds"]}):a.jsxs(a.Fragment,{children:[a.jsx(vh,{className:"w-3 h-3"}),"Expense"]})})}),a.jsxs("td",{className:"px-4 py-3 text-sm",children:[a.jsx("div",{children:C.description}),C.expense_category&&a.jsx("span",{className:"text-xs text-gray-500",children:C.expense_category})]}),a.jsxs("td",{className:"px-4 py-3 text-sm text-gray-600",children:[C.transaction_type==="expense"?C.paid_to:C.source,C.bank_accounts&&a.jsx("span",{className:"text-xs block text-gray-400",children:C.bank_accounts.account_name})]}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:C.transaction_type==="expense"?C.paid_by_staff_name:C.received_by_staff_name}),a.jsx("td",{className:"px-4 py-3 text-right font-medium text-blue-600",children:C.transaction_type==="withdraw"?`Rp ${C.amount.toLocaleString("id-ID")}`:"-"}),a.jsx("td",{className:"px-4 py-3 text-right font-medium text-red-600",children:C.transaction_type==="expense"?`Rp ${C.amount.toLocaleString("id-ID")}`:"-"})]},C.id)),t.length===0&&a.jsx("tr",{children:a.jsxs("td",{colSpan:8,className:"px-4 py-12 text-center text-gray-500",children:[a.jsx(ew,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{className:"font-medium",children:"No transactions yet"}),a.jsx("p",{className:"text-sm mt-1",children:'Click "New Entry" to add funds or record an expense'})]})})]})]})})]}),a.jsx(qt,{isOpen:l,onClose:()=>{c(!1),_()},title:"Petty Cash Entry",size:"lg",children:a.jsxs("form",{onSubmit:N,className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2 p-1 bg-gray-100 rounded-lg",children:[a.jsxs("button",{type:"button",onClick:()=>v({...m,transaction_type:"withdraw"}),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-md transition ${m.transaction_type==="withdraw"?"bg-green-600 text-white shadow":"text-gray-600 hover:bg-gray-200"}`,children:[a.jsx(yh,{className:"w-5 h-5"}),"Add Funds (Income)"]}),a.jsxs("button",{type:"button",onClick:()=>v({...m,transaction_type:"expense"}),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-md transition ${m.transaction_type==="expense"?"bg-orange-600 text-white shadow":"text-gray-600 hover:bg-gray-200"}`,children:[a.jsx(vh,{className:"w-5 h-5"}),"Add Expense"]})]}),m.transaction_type==="withdraw"?a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-green-700 mb-4",children:"Add money to petty cash fund"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),a.jsx("input",{type:"number",required:!0,min:"1",value:m.amount||"",onChange:C=>v({...m,amount:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",placeholder:"5000000"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",required:!0,value:m.transaction_date,onChange:C=>v({...m,transaction_date:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source *"}),a.jsxs("select",{required:!0,value:m.source,onChange:C=>v({...m,source:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"",children:"Select source"}),XAe.map(C=>a.jsx("option",{value:C,children:C},C))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Received By (Staff) *"}),a.jsx("input",{type:"text",required:!0,value:m.received_by_staff_name,onChange:C=>v({...m,received_by_staff_name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",placeholder:"Staff member name"})]}),m.source==="Bank Transfer"||m.source==="Bank Withdrawal"?a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),a.jsxs("select",{value:m.bank_account_id,onChange:C=>v({...m,bank_account_id:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",children:[a.jsx("option",{value:"",children:"Select bank account"}),n.map(C=>a.jsxs("option",{value:C.id,children:[C.account_name," - ",C.bank_name]},C.id))]})]}):null,a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purpose / Description *"}),a.jsx("textarea",{required:!0,value:m.description,onChange:C=>v({...m,description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500",rows:2,placeholder:"Petty cash fund replenishment"})]})]})]}):a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-orange-700 mb-1",children:"Record a new petty cash expense with receipt details"}),a.jsxs("p",{className:"text-xs text-orange-600 mb-4",children:["Available Balance: Rp ",u.toLocaleString("id-ID")]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),a.jsx("input",{type:"number",required:!0,min:"1",max:u,value:m.amount||"",onChange:C=>v({...m,amount:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",placeholder:"Enter amount"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",required:!0,value:m.transaction_date,onChange:C=>v({...m,transaction_date:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paid To *"}),a.jsx("input",{type:"text",required:!0,value:m.paid_to,onChange:C=>v({...m,paid_to:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",placeholder:"Vendor/Person name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paid By (Staff) *"}),a.jsx("input",{type:"text",required:!0,value:m.paid_by_staff_name,onChange:C=>v({...m,paid_by_staff_name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",placeholder:"Staff member name"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purpose / Description *"}),a.jsx("textarea",{required:!0,value:m.description,onChange:C=>v({...m,description:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",rows:2,placeholder:"For what purpose?"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:m.expense_category,onChange:C=>v({...m,expense_category:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500",children:[a.jsx("option",{value:"",children:"Select category"}),zAe.map(C=>a.jsx("option",{value:C,children:C},C))]})]})]})]}),a.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[a.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.jsx(SA,{className:"w-4 h-4"}),"Attachments (Optional)"]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Proof Attachment"}),a.jsxs("label",{className:"flex flex-col items-center justify-center h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition",children:[a.jsx(sr,{className:"w-6 h-6 text-gray-400"}),a.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Upload"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*,.pdf",onChange:C=>x(C,"proof")})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Bill/Invoice"}),a.jsxs("label",{className:"flex flex-col items-center justify-center h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition",children:[a.jsx(sr,{className:"w-6 h-6 text-gray-400"}),a.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Upload"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*,.pdf",onChange:C=>x(C,"invoice")})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Material Photo"}),a.jsxs("label",{className:"flex flex-col items-center justify-center h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition",children:[a.jsx(n_,{className:"w-6 h-6 text-gray-400"}),a.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Upload"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:C=>x(C,"photo")})]})]})]}),A.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:A.map((C,j)=>a.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 px-3 py-1.5 rounded-lg text-sm",children:[a.jsx("span",{className:"text-xs text-gray-500 uppercase",children:C.type}),a.jsx("span",{className:"truncate max-w-32",children:C.file.name}),a.jsx("button",{type:"button",onClick:()=>w(j),className:"text-gray-400 hover:text-red-500",children:a.jsx(Kr,{className:"w-4 h-4"})})]},j))})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{c(!1),_()},className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:`px-6 py-2 text-white rounded-lg transition ${m.transaction_type==="withdraw"?"bg-green-600 hover:bg-green-700":"bg-orange-600 hover:bg-orange-700"}`,children:m.transaction_type==="withdraw"?"Add Funds":"Add Expense"})]})]})})]})}const Vk={sales_invoice:"Sales Invoice",purchase_invoice:"Purchase Invoice",receipt:"Receipt Voucher",payment:"Payment Voucher",petty_cash:"Petty Cash",manual:"Manual Entry"};function JAe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState(!0),[i,o]=W.useState(""),[l,c]=W.useState(null),[u,d]=W.useState([]),[h,f]=W.useState(!1),[A,b]=W.useState({start:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[m,v]=W.useState("all");W.useEffect(()=>{p()},[A,m]);const p=async()=>{try{let N=ae.from("journal_entries").select("*").gte("entry_date",A.start).lte("entry_date",A.end).order("entry_date",{ascending:!1}).order("entry_number",{ascending:!1});m!=="all"&&(N=N.eq("source_module",m));const{data:_,error:C}=await N;if(C)throw C;r(_||[])}catch(N){console.error("Error loading entries:",N)}finally{s(!1)}},g=async N=>{try{const{data:_,error:C}=await ae.from("journal_entry_lines").select("*, chart_of_accounts(code, name), customers(company_name), suppliers(company_name)").eq("journal_entry_id",N).order("line_number");if(C)throw C;d(_||[])}catch(_){console.error("Error loading lines:",_)}},y=async N=>{c(N),await g(N.id),f(!0)},x=t.filter(N=>N.entry_number.toLowerCase().includes(i.toLowerCase())||N.reference_number&&N.reference_number.toLowerCase().includes(i.toLowerCase())||N.description&&N.description.toLowerCase().includes(i.toLowerCase())),w={debit:x.reduce((N,_)=>N+_.total_debit,0),credit:x.reduce((N,_)=>N+_.total_credit,0)};return n?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search entries...",value:i,onChange:N=>o(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"date",value:A.start,onChange:N=>b({...A,start:N.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"date",value:A.end,onChange:N=>b({...A,end:N.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("select",{value:m,onChange:N=>v(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"all",children:"All Sources"}),a.jsx("option",{value:"sales_invoice",children:"Sales Invoices"}),a.jsx("option",{value:"purchase_invoice",children:"Purchase Invoices"}),a.jsx("option",{value:"receipt",children:"Receipts"}),a.jsx("option",{value:"payment",children:"Payments"}),a.jsx("option",{value:"petty_cash",children:"Petty Cash"}),a.jsx("option",{value:"manual",children:"Manual"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-blue-600",children:"Total Debit"}),a.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:["Rp ",w.debit.toLocaleString("id-ID")]})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-green-600",children:"Total Credit"}),a.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["Rp ",w.credit.toLocaleString("id-ID")]})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Entry No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Source"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Debit"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Credit"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"View"})]})}),a.jsxs("tbody",{className:"divide-y",children:[x.map(N=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:N.entry_number}),a.jsx("td",{className:"px-4 py-3",children:new Date(N.entry_date).toLocaleDateString("id-ID")}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:N.source_module?Vk[N.source_module]||N.source_module:"Manual"})}),a.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:N.reference_number||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs truncate",children:N.description||"-"}),a.jsxs("td",{className:"px-4 py-3 text-right text-blue-600",children:["Rp ",N.total_debit.toLocaleString("id-ID")]}),a.jsxs("td",{className:"px-4 py-3 text-right text-green-600",children:["Rp ",N.total_credit.toLocaleString("id-ID")]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("button",{onClick:()=>y(N),className:"text-blue-600 hover:text-blue-800",children:a.jsx(sr,{className:"w-4 h-4"})})})]},N.id)),x.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No journal entries found"})})]})]})}),a.jsx(qt,{isOpen:h,onClose:()=>f(!1),title:`Journal Entry: ${l==null?void 0:l.entry_number}`,children:l&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Date:"}),a.jsx("span",{className:"ml-2 font-medium",children:new Date(l.entry_date).toLocaleDateString("id-ID")})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Source:"}),a.jsx("span",{className:"ml-2",children:l.source_module?Vk[l.source_module]:"Manual"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Reference:"}),a.jsx("span",{className:"ml-2 font-mono",children:l.reference_number||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Posted:"}),a.jsx("span",{className:"ml-2",children:new Date(l.posted_at).toLocaleString("id-ID")})]})]}),l.description&&a.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:l.description}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Account"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Description"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Debit"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Credit"})]})}),a.jsx("tbody",{className:"divide-y",children:u.map(N=>{var _,C;return a.jsxs("tr",{children:[a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("div",{className:"font-mono text-xs text-gray-500",children:(_=N.chart_of_accounts)==null?void 0:_.code}),a.jsx("div",{children:(C=N.chart_of_accounts)==null?void 0:C.name}),N.customers&&a.jsx("div",{className:"text-xs text-blue-600",children:N.customers.company_name}),N.suppliers&&a.jsx("div",{className:"text-xs text-purple-600",children:N.suppliers.company_name})]}),a.jsx("td",{className:"px-3 py-2 text-gray-600",children:N.description||"-"}),a.jsx("td",{className:"px-3 py-2 text-right text-blue-600",children:N.debit>0?`Rp ${N.debit.toLocaleString("id-ID")}`:""}),a.jsx("td",{className:"px-3 py-2 text-right text-green-600",children:N.credit>0?`Rp ${N.credit.toLocaleString("id-ID")}`:""})]},N.id)})}),a.jsx("tfoot",{className:"bg-gray-50 font-medium",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:2,className:"px-3 py-2 text-right",children:"Total:"}),a.jsxs("td",{className:"px-3 py-2 text-right text-blue-700",children:["Rp ",l.total_debit.toLocaleString("id-ID")]}),a.jsxs("td",{className:"px-3 py-2 text-right text-green-700",children:["Rp ",l.total_credit.toLocaleString("id-ID")]})]})})]})}),l.total_debit!==l.total_credit&&a.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:"Warning: Debit and Credit totals do not match!"})]})})]})}function ZAe({initialReport:e="trial_balance"}){const[t,r]=W.useState(e),[n,s]=W.useState(!1),[i,o]=W.useState([]),[l,c]=W.useState({start:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]});W.useEffect(()=>{u()},[t,l]);const u=async()=>{s(!0);try{const{data:y,error:x}=await ae.rpc("get_trial_balance",{p_start_date:l.start,p_end_date:l.end});if(!x&&y)o(y);else{const{data:w,error:N}=await ae.from("trial_balance_view").select("*").order("code");if(N)throw N;o(w||[])}}catch(y){console.error("Error loading report:",y)}finally{s(!1)}},d=i.reduce((y,x)=>({debit:y.debit+x.total_debit,credit:y.credit+x.total_credit}),{debit:0,credit:0}),h=i.filter(y=>y.account_type==="revenue").reduce((y,x)=>y+Math.abs(x.balance),0),f=i.filter(y=>y.account_type==="expense").reduce((y,x)=>y+Math.abs(x.balance),0),A=h-f,b=i.filter(y=>y.account_type==="asset").reduce((y,x)=>y+x.balance,0),m=i.filter(y=>{var x;return y.account_type==="contra"&&((x=y.account_group)==null?void 0:x.includes("Assets"))}).reduce((y,x)=>y+Math.abs(x.balance),0),v=i.filter(y=>y.account_type==="liability").reduce((y,x)=>y+Math.abs(x.balance),0),p=i.filter(y=>y.account_type==="equity").reduce((y,x)=>y+Math.abs(x.balance),0),g=[{id:"trial_balance",label:"Trial Balance"},{id:"pnl",label:"Profit & Loss"},{id:"balance_sheet",label:"Balance Sheet"}];return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[a.jsx("div",{className:"flex gap-2",children:g.map(y=>a.jsx("button",{onClick:()=>r(y.id),className:`px-4 py-2 rounded-lg font-medium transition ${t===y.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:y.label},y.id))}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Na,{className:"w-4 h-4 text-gray-500"}),a.jsx("input",{type:"date",value:l.start,onChange:y=>c({...l,start:y.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"date",value:l.end,onChange:y=>c({...l,end:y.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[a.jsx(go,{className:"w-4 h-4"}),"Refresh"]})]})]}),n?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs(a.Fragment,{children:[t==="trial_balance"&&a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[a.jsx("h3",{className:"font-semibold text-lg",children:"Trial Balance"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["As of ",new Date(l.end).toLocaleDateString("id-ID")]})]}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Account Name"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Debit"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Credit"})]})}),a.jsxs("tbody",{className:"divide-y",children:[i.map(y=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-mono text-sm",children:y.code}),a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("div",{children:y.name}),y.name_id&&a.jsx("div",{className:"text-sm text-gray-500",children:y.name_id})]}),a.jsx("td",{className:"px-4 py-2 text-right text-blue-600",children:y.balance>0?`Rp ${y.balance.toLocaleString("id-ID")}`:""}),a.jsx("td",{className:"px-4 py-2 text-right text-green-600",children:y.balance<0?`Rp ${Math.abs(y.balance).toLocaleString("id-ID")}`:""})]},y.code)),i.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-gray-500",children:"No transactions found"})})]}),a.jsx("tfoot",{className:"bg-gray-100 font-bold",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:2,className:"px-4 py-3 text-right",children:"Total:"}),a.jsxs("td",{className:"px-4 py-3 text-right text-blue-700",children:["Rp ",d.debit.toLocaleString("id-ID")]}),a.jsxs("td",{className:"px-4 py-3 text-right text-green-700",children:["Rp ",d.credit.toLocaleString("id-ID")]})]})})]})]}),t==="pnl"&&a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[a.jsx("h3",{className:"font-semibold text-lg",children:"Profit & Loss Statement"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Period: ",new Date(l.start).toLocaleDateString("id-ID")," - ",new Date(l.end).toLocaleDateString("id-ID")]})]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"font-semibold text-green-700 mb-2 border-b pb-2",children:"Revenue (Pendapatan)"}),a.jsx("table",{className:"w-full",children:a.jsxs("tbody",{children:[i.filter(y=>y.account_type==="revenue").map(y=>a.jsxs("tr",{children:[a.jsx("td",{className:"py-1 font-mono text-sm text-gray-500",children:y.code}),a.jsx("td",{className:"py-1",children:y.name}),a.jsxs("td",{className:"py-1 text-right text-green-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID")]})]},y.code)),a.jsxs("tr",{className:"font-semibold border-t",children:[a.jsx("td",{colSpan:2,className:"py-2",children:"Total Revenue"}),a.jsxs("td",{className:"py-2 text-right text-green-700",children:["Rp ",h.toLocaleString("id-ID")]})]})]})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"font-semibold text-red-700 mb-2 border-b pb-2",children:"Expenses (Beban)"}),a.jsx("table",{className:"w-full",children:a.jsxs("tbody",{children:[i.filter(y=>y.account_type==="expense").map(y=>a.jsxs("tr",{children:[a.jsx("td",{className:"py-1 font-mono text-sm text-gray-500",children:y.code}),a.jsx("td",{className:"py-1",children:y.name}),a.jsxs("td",{className:"py-1 text-right text-red-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID")]})]},y.code)),a.jsxs("tr",{className:"font-semibold border-t",children:[a.jsx("td",{colSpan:2,className:"py-2",children:"Total Expenses"}),a.jsxs("td",{className:"py-2 text-right text-red-700",children:["Rp ",f.toLocaleString("id-ID")]})]})]})})]}),a.jsx("div",{className:`p-4 rounded-lg ${A>=0?"bg-green-50":"bg-red-50"}`,children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-lg",children:"Net Income (Laba Bersih)"}),a.jsxs("span",{className:`font-bold text-2xl ${A>=0?"text-green-700":"text-red-700"}`,children:["Rp ",A.toLocaleString("id-ID")]})]})})]})]}),t==="balance_sheet"&&a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[a.jsx("h3",{className:"font-semibold text-lg",children:"Balance Sheet (Neraca)"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["As of ",new Date(l.end).toLocaleDateString("id-ID")]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-blue-700 mb-2 border-b pb-2",children:"Assets (Aset)"}),a.jsx("table",{className:"w-full",children:a.jsxs("tbody",{children:[i.filter(y=>y.account_type==="asset").map(y=>a.jsxs("tr",{children:[a.jsxs("td",{className:"py-1",children:[a.jsx("span",{className:"font-mono text-xs text-gray-500 mr-2",children:y.code}),y.name]}),a.jsxs("td",{className:"py-1 text-right text-blue-600",children:["Rp ",y.balance.toLocaleString("id-ID")]})]},y.code)),i.filter(y=>{var x;return y.account_type==="contra"&&((x=y.account_group)==null?void 0:x.includes("Assets"))}).map(y=>a.jsxs("tr",{className:"text-gray-500",children:[a.jsxs("td",{className:"py-1",children:[a.jsx("span",{className:"font-mono text-xs mr-2",children:y.code}),y.name]}),a.jsxs("td",{className:"py-1 text-right",children:["(",Math.abs(y.balance).toLocaleString("id-ID"),")"]})]},y.code)),a.jsxs("tr",{className:"font-semibold border-t-2",children:[a.jsx("td",{className:"py-2",children:"Total Assets"}),a.jsxs("td",{className:"py-2 text-right text-blue-700",children:["Rp ",(b-m).toLocaleString("id-ID")]})]})]})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-red-700 mb-2 border-b pb-2",children:"Liabilities (Kewajiban)"}),a.jsx("table",{className:"w-full",children:a.jsxs("tbody",{children:[i.filter(y=>y.account_type==="liability").map(y=>a.jsxs("tr",{children:[a.jsxs("td",{className:"py-1",children:[a.jsx("span",{className:"font-mono text-xs text-gray-500 mr-2",children:y.code}),y.name]}),a.jsxs("td",{className:"py-1 text-right text-red-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID")]})]},y.code)),a.jsxs("tr",{className:"font-semibold border-t",children:[a.jsx("td",{className:"py-2",children:"Total Liabilities"}),a.jsxs("td",{className:"py-2 text-right text-red-700",children:["Rp ",v.toLocaleString("id-ID")]})]})]})}),a.jsx("h4",{className:"font-semibold text-purple-700 mb-2 border-b pb-2 mt-6",children:"Equity (Modal)"}),a.jsx("table",{className:"w-full",children:a.jsxs("tbody",{children:[i.filter(y=>y.account_type==="equity").map(y=>a.jsxs("tr",{children:[a.jsxs("td",{className:"py-1",children:[a.jsx("span",{className:"font-mono text-xs text-gray-500 mr-2",children:y.code}),y.name]}),a.jsxs("td",{className:"py-1 text-right text-purple-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID")]})]},y.code)),a.jsxs("tr",{children:[a.jsx("td",{className:"py-1",children:"Current Year Earnings"}),a.jsxs("td",{className:`py-1 text-right ${A>=0?"text-green-600":"text-red-600"}`,children:["Rp ",A.toLocaleString("id-ID")]})]}),a.jsxs("tr",{className:"font-semibold border-t",children:[a.jsx("td",{className:"py-2",children:"Total Equity"}),a.jsxs("td",{className:"py-2 text-right text-purple-700",children:["Rp ",(p+A).toLocaleString("id-ID")]})]})]})}),a.jsx("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg",children:a.jsxs("div",{className:"flex justify-between font-bold",children:[a.jsx("span",{children:"Total Liabilities + Equity"}),a.jsxs("span",{children:["Rp ",(v+p+A).toLocaleString("id-ID")]})]})})]})]})]})]})]})}function efe({canManage:e}){const[t,r]=W.useState([]),[n,s]=W.useState(""),[i,o]=W.useState([]),[l,c]=W.useState(!1),[u,d]=W.useState(!1),[h,f]=W.useState("all"),[A,b]=W.useState({start:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),m=W.useRef(null);W.useEffect(()=>{v()},[]),W.useEffect(()=>{n&&p()},[n,A]);const v=async()=>{try{const{data:j,error:E}=await ae.from("bank_accounts").select("id, account_name, bank_name, account_number").order("account_name");if(E)throw E;r(j||[]),j&&j.length>0&&s(j[0].id)}catch(j){console.error("Error loading bank accounts:",j)}},p=async()=>{if(n){c(!0);try{const{data:j,error:E}=await ae.from("bank_statement_lines").select("*").eq("bank_account_id",n).gte("transaction_date",A.start).lte("transaction_date",A.end).order("transaction_date",{ascending:!1});if(E)throw E;const S=(j||[]).map(F=>({id:F.id,date:F.transaction_date,description:F.description||"",reference:F.reference||"",debit:F.debit_amount||0,credit:F.credit_amount||0,balance:F.running_balance||0,status:F.reconciliation_status||"unmatched",matchedEntry:F.matched_entry_id}));o(S)}catch(j){console.error("Error loading statement lines:",j),o([])}finally{c(!1)}}},g=async j=>{var S;const E=(S=j.target.files)==null?void 0:S[0];if(!(!E||!n)){d(!0);try{const F=new FileReader;F.onload=async I=>{var O;try{const M=(O=I.target)==null?void 0:O.result,P=px(M,{type:"binary"}),X=P.SheetNames[0],J=P.Sheets[X],H=Ya.sheet_to_json(J,{header:1}),V=y(H);if(V.length===0){alert("No valid transactions found in the file. Please check the format.");return}const{data:{user:K}}=await ae.auth.getUser(),B=V.map(U=>({bank_account_id:n,transaction_date:U.date,description:U.description,reference:U.reference,debit_amount:U.debit,credit_amount:U.credit,running_balance:U.balance,reconciliation_status:"unmatched",created_by:K==null?void 0:K.id})),{error:L}=await ae.from("bank_statement_lines").insert(B);if(L)throw L;await x(),p(),alert(`Successfully imported ${V.length} transactions`)}catch(M){console.error("Error parsing file:",M),alert("Failed to parse file: "+M.message)}},F.readAsBinaryString(E)}finally{d(!1),m.current&&(m.current.value="")}}},y=j=>{const E=[],S=j[0]||[];let F=-1,I=-1,O=-1,M=-1,P=-1,X=-1;S.forEach((J,H)=>{const V=String(J||"").toLowerCase();(V.includes("date")||V.includes("tanggal"))&&(F=H),(V.includes("description")||V.includes("keterangan")||V.includes("uraian"))&&(I=H),(V.includes("ref")||V.includes("no."))&&(O=H),(V.includes("debit")||V.includes("keluar"))&&(M=H),(V.includes("credit")||V.includes("kredit")||V.includes("masuk"))&&(P=H),(V.includes("balance")||V.includes("saldo"))&&(X=H)}),F===-1&&(F=0),I===-1&&(I=1),M===-1&&(M=2),P===-1&&(P=3),X===-1&&(X=4);for(let J=1;J<j.length;J++){const H=j[J];if(!H||H.length===0)continue;const V=H[F];let K="";if(typeof V=="number")K=new Date((V-25569)*86400*1e3).toISOString().split("T")[0];else if(V){const U=String(V).split(/[\/\-\.]/);U.length===3&&(U[0].length===4?K=`${U[0]}-${U[1].padStart(2,"0")}-${U[2].padStart(2,"0")}`:K=`${U[2]}-${U[1].padStart(2,"0")}-${U[0].padStart(2,"0")}`)}if(!K)continue;const B=L=>{if(!L)return 0;const U=String(L).replace(/[^\d.-]/g,"");return parseFloat(U)||0};E.push({id:`temp-${J}`,date:K,description:String(H[I]||""),reference:O>=0?String(H[O]||""):"",debit:B(H[M]),credit:B(H[P]),balance:B(H[X]),status:"unmatched"})}return E},x=async()=>{try{const{data:j,error:E}=await ae.from("bank_statement_lines").select("*").eq("bank_account_id",n).eq("reconciliation_status","unmatched");if(E)throw E;if(!j||j.length===0)return;const{data:S}=await ae.from("journal_entries").select("id, entry_number, entry_date, description, total_debit").eq("is_posted",!0).gte("entry_date",A.start).lte("entry_date",A.end),F=S||[];for(const I of j){const O=I.debit_amount||I.credit_amount,M=new Date(I.transaction_date),P=F.find(X=>{const J=new Date(X.entry_date),H=Math.abs(M.getTime()-J.getTime())/(1e3*60*60*24),V=Math.abs(X.total_debit-O)<1e4;return H<=3&&V});P&&await ae.from("bank_statement_lines").update({reconciliation_status:"suggested",matched_entry_id:P.id}).eq("id",I.id)}}catch(j){console.error("Error auto-matching:",j)}},w=async j=>{try{await ae.from("bank_statement_lines").update({reconciliation_status:"matched"}).eq("id",j),p()}catch(E){console.error("Error confirming match:",E)}},N=async j=>{try{await ae.from("bank_statement_lines").update({reconciliation_status:"unmatched",matched_entry_id:null}).eq("id",j),p()}catch(E){console.error("Error rejecting match:",E)}},_=i.filter(j=>h==="all"?!0:j.status===h),C={total:i.length,matched:i.filter(j=>j.status==="matched").length,suggested:i.filter(j=>j.status==="suggested").length,unmatched:i.filter(j=>j.status==="unmatched").length};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("select",{value:n,onChange:j=>s(j.target.value),className:"px-3 py-1.5 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500",children:t.map(j=>a.jsxs("option",{value:j.id,children:[j.bank_name," - ",j.account_number]},j.id))}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Na,{className:"w-4 h-4 text-gray-400"}),a.jsx("input",{type:"date",value:A.start,onChange:j=>b({...A,start:j.target.value}),className:"px-2 py-1 border rounded text-sm"}),a.jsx("span",{className:"text-gray-400",children:"to"}),a.jsx("input",{type:"date",value:A.end,onChange:j=>b({...A,end:j.target.value}),className:"px-2 py-1 border rounded text-sm"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>{x(),p()},className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[a.jsx(go,{className:"w-4 h-4"}),"Auto-Match"]}),e&&a.jsxs(a.Fragment,{children:[a.jsx("input",{ref:m,type:"file",accept:".xlsx,.xls,.csv",onChange:g,className:"hidden"}),a.jsxs("button",{onClick:()=>{var j;return(j=m.current)==null?void 0:j.click()},disabled:u||!n,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[a.jsx(SA,{className:"w-4 h-4"}),u?"Uploading...":"Upload Statement"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsxs("button",{onClick:()=>f("all"),className:`p-3 rounded-lg text-left transition ${h==="all"?"bg-blue-50 border-2 border-blue-500":"bg-gray-50 border border-gray-200"}`,children:[a.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C.total}),a.jsx("div",{className:"text-xs text-gray-500",children:"Total Transactions"})]}),a.jsxs("button",{onClick:()=>f("matched"),className:`p-3 rounded-lg text-left transition ${h==="matched"?"bg-green-50 border-2 border-green-500":"bg-gray-50 border border-gray-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Us,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"text-2xl font-bold text-green-700",children:C.matched})]}),a.jsx("div",{className:"text-xs text-gray-500",children:"Matched"})]}),a.jsxs("button",{onClick:()=>f("suggested"),className:`p-3 rounded-lg text-left transition ${h==="suggested"?"bg-yellow-50 border-2 border-yellow-500":"bg-gray-50 border border-gray-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ea,{className:"w-5 h-5 text-yellow-600"}),a.jsx("span",{className:"text-2xl font-bold text-yellow-700",children:C.suggested})]}),a.jsx("div",{className:"text-xs text-gray-500",children:"Suggested Match"})]}),a.jsxs("button",{onClick:()=>f("unmatched"),className:`p-3 rounded-lg text-left transition ${h==="unmatched"?"bg-red-50 border-2 border-red-500":"bg-gray-50 border border-gray-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(un,{className:"w-5 h-5 text-red-600"}),a.jsx("span",{className:"text-2xl font-bold text-red-700",children:C.unmatched})]}),a.jsx("div",{className:"text-xs text-gray-500",children:"Unmatched"})]})]}),l?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(go,{className:"w-6 h-6 animate-spin text-blue-600"})}):_.length===0?a.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed",children:[a.jsx(CF,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-1",children:"No Bank Transactions"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Upload a bank statement (Excel/CSV) to start reconciling"}),e&&a.jsxs("button",{onClick:()=>{var j;return(j=m.current)==null?void 0:j.click()},className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(SA,{className:"w-4 h-4"}),"Upload BCA Statement"]})]}):a.jsx("div",{className:"bg-white border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600",children:"Date"}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600",children:"Description"}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-600",children:"Reference"}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600",children:"Debit"}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-600",children:"Credit"}),a.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:_.map(j=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2 text-gray-700",children:new Date(j.date).toLocaleDateString("id-ID")}),a.jsx("td",{className:"px-3 py-2 text-gray-700 max-w-xs truncate",children:j.description}),a.jsx("td",{className:"px-3 py-2 text-gray-500 font-mono text-xs",children:j.reference||"-"}),a.jsx("td",{className:"px-3 py-2 text-right text-red-600 font-medium",children:j.debit>0?`Rp ${j.debit.toLocaleString("id-ID")}`:"-"}),a.jsx("td",{className:"px-3 py-2 text-right text-green-600 font-medium",children:j.credit>0?`Rp ${j.credit.toLocaleString("id-ID")}`:"-"}),a.jsxs("td",{className:"px-3 py-2 text-center",children:[j.status==="matched"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:[a.jsx(Us,{className:"w-3 h-3"})," Matched"]}),j.status==="suggested"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-700",children:[a.jsx(ea,{className:"w-3 h-3"})," Review"]}),j.status==="unmatched"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700",children:[a.jsx(un,{className:"w-3 h-3"})," Unmatched"]}),j.status==="created"&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:[a.jsx(Rr,{className:"w-3 h-3"})," Created"]})]}),a.jsxs("td",{className:"px-3 py-2 text-center",children:[j.status==="suggested"&&a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:()=>w(j.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Confirm Match",children:a.jsx(Us,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>N(j.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject Match",children:a.jsx(un,{className:"w-4 h-4"})})]}),j.status==="unmatched"&&e&&a.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",title:"Create Entry",children:[a.jsx(Rr,{className:"w-3 h-3"}),"Create"]})]})]},j.id))})]})})]})}const Hv={record:{label:"Record Transaction",icon:Rr,color:"blue",description:"Daily accounting entries",tabs:[{id:"purchase_invoices",label:"Purchase Invoice",icon:wR,desc:"Record supplier invoices"},{id:"receipts",label:"Receipt Voucher",icon:yh,desc:"Record customer payments"},{id:"payments",label:"Payment Voucher",icon:vh,desc:"Record supplier payments"},{id:"petty_cash",label:"Petty Cash",icon:ew,desc:"Small daily expenses"},{id:"journal",label:"Journal Entry",icon:sr,desc:"Manual journal entries"}]},track:{label:"Track",icon:ui,color:"green",description:"Monitor balances & status",tabs:[{id:"receivables",label:"Receivables",icon:ui,desc:"Customer outstanding"},{id:"payables",label:"Payables",icon:FF,desc:"Supplier outstanding"},{id:"reconciliation",label:"Bank Reconciliation",icon:CF,desc:"Match bank statements"},{id:"ageing",label:"Ageing Report",icon:k4,desc:"Overdue analysis"}]},reports:{label:"Reports",icon:k4,color:"purple",description:"Financial statements",tabs:[{id:"trial_balance",label:"Trial Balance",icon:sr,desc:"Account balances"},{id:"pnl",label:"Profit & Loss",icon:ui,desc:"Income statement"},{id:"balance_sheet",label:"Balance Sheet",icon:sr,desc:"Financial position"}]},masters:{label:"Masters",icon:S4,color:"gray",description:"Setup & configuration",tabs:[{id:"coa",label:"Chart of Accounts",icon:S4,desc:"Account structure"},{id:"suppliers",label:"Suppliers",icon:r0,desc:"Vendor master"},{id:"banks",label:"Bank Accounts",icon:cR,desc:"Company bank accounts"}]}};function tfe(){const{t:e}=kn(),{profile:t}=jr(),[r,n]=W.useState("record"),[s,i]=W.useState("purchase_invoices"),[o,l]=W.useState([]),[c,u]=W.useState([]),[d,h]=W.useState(!0),[f,A]=W.useState(null),[b,m]=W.useState(!1),[v,p]=W.useState(null),[g,y]=W.useState({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",document_urls:[]}),x=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts";W.useEffect(()=>{s==="petty_cash"&&(N(),_())},[s]);const w=O=>{n(O);const M=Hv[O].tabs[0];i(M.id)},N=async()=>{try{A(null);const{data:O,error:M}=await ae.from("finance_expenses").select("*, batches(batch_number)").order("expense_date",{ascending:!1}).order("created_at",{ascending:!1});if(M)throw M;l(O||[])}catch(O){console.error("Error loading expenses:",O),A(O.message)}finally{h(!1)}},_=async()=>{try{const{data:O}=await ae.from("batches").select("id, batch_number").order("batch_number");u(O||[])}catch(O){console.error("Error loading batches:",O)}},C=async O=>{O.preventDefault();try{const{data:{user:M}}=await ae.auth.getUser();if(!M)throw new Error("Not authenticated");const P={expense_category:g.expense_category,amount:g.amount,expense_date:g.expense_date,description:g.description||null,batch_id:g.batch_id||null,document_urls:g.document_urls.length>0?g.document_urls:null};if(v){const{error:X}=await ae.from("finance_expenses").update(P).eq("id",v.id);if(X)throw X}else{const{error:X}=await ae.from("finance_expenses").insert([{...P,created_by:M.id}]);if(X)throw X}m(!1),j(),N()}catch(M){console.error("Error saving expense:",M),alert("Failed to save expense: "+M.message)}},j=()=>{p(null),y({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",document_urls:[]})},E={duty:"Duty & Customs",freight:"Freight",warehouse_rent:"Warehouse Rent",utilities:"Utilities",salary:"Salary",other:"Other"},S={blue:"bg-blue-600 hover:bg-blue-700 text-white",green:"bg-green-600 hover:bg-green-700 text-white",purple:"bg-purple-600 hover:bg-purple-700 text-white",gray:"bg-gray-600 hover:bg-gray-700 text-white"},F={blue:"bg-blue-50 text-blue-700 hover:bg-blue-100 border border-blue-200",green:"bg-green-50 text-green-700 hover:bg-green-100 border border-green-200",purple:"bg-purple-50 text-purple-700 hover:bg-purple-100 border border-purple-200",gray:"bg-gray-50 text-gray-700 hover:bg-gray-100 border border-gray-200"},I=()=>{switch(s){case"purchase_invoices":return a.jsx(VAe,{canManage:x});case"receipts":return a.jsx(GAe,{canManage:x});case"payments":return a.jsx(WAe,{canManage:x});case"petty_cash":return a.jsx(YAe,{canManage:x});case"journal":return a.jsx(JAe,{canManage:x});case"receivables":return a.jsx(MAe,{canManage:x});case"payables":return a.jsx(HAe,{canManage:x});case"reconciliation":return a.jsx(efe,{canManage:x});case"ageing":return a.jsx(qAe,{});case"trial_balance":case"pnl":case"balance_sheet":return a.jsx(ZAe,{initialReport:s});case"coa":return a.jsx(KAe,{canManage:x});case"suppliers":return a.jsx($Ae,{canManage:x});case"banks":return a.jsx(QAe,{canManage:x});default:return a.jsx("div",{className:"text-center py-12 text-gray-500",children:"Select a module"})}};return a.jsxs(Zn,{children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h1",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(El,{className:"w-6 h-6"}),"Finance & Accounting"]})}),a.jsx("div",{className:"grid grid-cols-4 gap-3",children:Object.entries(Hv).map(([O,M])=>{const P=M.icon,X=r===O,J=X?S[M.color]:F[M.color];return a.jsxs("button",{onClick:()=>w(O),className:`p-3 rounded-lg transition-all ${J} ${X?"shadow-md ring-2 ring-offset-2 ring-"+M.color+"-500":""}`,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(P,{className:"w-5 h-5"}),a.jsx("span",{className:"font-semibold text-sm",children:M.label})]}),a.jsx("p",{className:`text-xs mt-1 ${X?"opacity-90":"opacity-70"}`,children:M.description})]},O)})}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("div",{className:"w-48 shrink-0",children:a.jsx("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:Hv[r].tabs.map((O,M)=>{const P=O.icon,X=s===O.id;return a.jsxs("button",{onClick:()=>i(O.id),className:`w-full text-left px-3 py-2.5 flex items-center gap-2 transition-all border-l-3 ${X?"bg-blue-50 border-l-blue-600 text-blue-700":"border-l-transparent hover:bg-gray-50 text-gray-700"} ${M!==0?"border-t border-gray-100":""}`,children:[a.jsx(P,{className:`w-4 h-4 ${X?"text-blue-600":"text-gray-400"}`}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("div",{className:"text-sm font-medium truncate",children:O.label})}),X&&a.jsx(Sc,{className:"w-4 h-4 text-blue-400"})]},O.id)})})}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-4",children:I()})})]})]}),a.jsx(qt,{isOpen:b,onClose:()=>m(!1),title:v?"Edit Expense":"Add Expense",children:a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),a.jsx("select",{required:!0,value:g.expense_category,onChange:O=>y({...g,expense_category:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",children:Object.entries(E).map(([O,M])=>a.jsx("option",{value:O,children:M},O))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),a.jsx("input",{type:"number",required:!0,min:0,value:g.amount,onChange:O=>y({...g,amount:parseFloat(O.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",required:!0,value:g.expense_date,onChange:O=>y({...g,expense_date:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Batch"}),a.jsxs("select",{value:g.batch_id,onChange:O=>y({...g,batch_id:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",children:[a.jsx("option",{value:"",children:"None"}),c.map(O=>a.jsx("option",{value:O.id,children:O.batch_number},O.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:g.description,onChange:O=>y({...g,description:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",rows:2})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attach Documents"}),a.jsx(a_,{currentUrls:g.document_urls,onUploadComplete:O=>y({...g,document_urls:O}),folder:"expenses"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50 text-sm",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:[v?"Update":"Create"," Expense"]})]})]})})]})}function rfe(){const[e,t]=W.useState(null),[r,n]=W.useState(!0),[s,i]=W.useState(!1);W.useEffect(()=>{o();const h=setInterval(()=>{o()},5e3);return()=>clearInterval(h)},[]);const o=async()=>{try{console.log("[GmailSettings] === LOADING CONNECTION ===");const{data:{user:h}}=await ae.auth.getUser();if(console.log("[GmailSettings] Current user:",h==null?void 0:h.id),!h)return;const{data:f,error:A}=await ae.from("gmail_connections").select("*").eq("user_id",h.id).eq("is_connected",!0).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(console.log("[GmailSettings] Query result - data:",f),console.log("[GmailSettings] Query result - error:",A),A&&A.code!=="PGRST116")throw A;t(f),console.log("[GmailSettings] Connection set:",f==null?void 0:f.email_address)}catch(h){console.error("[GmailSettings] Error loading Gmail connection:",h)}finally{n(!1)}},l=()=>{const h="90568246766-durgkfgje103589m6cuk99sv8kim69ec.apps.googleusercontent.com",f=`${window.location.origin}/auth/gmail/callback`;if(console.log(" Gmail OAuth Configuration:"),console.log("Redirect URI:",f),console.log(`
 Add this to Google Cloud Console:`),console.log("   https://console.cloud.google.com/apis/credentials"),!confirm(` IMPORTANT: Before connecting Gmail

You must add this redirect URI to Google Cloud Console:

${f}

Steps:
1. Go to: https://console.cloud.google.com/apis/credentials
2. Click your OAuth Client ID
3. Under "Authorized redirect URIs", add:
   ${f}
4. Click "Save"
5. Wait 5 minutes for changes to propagate

Have you completed these steps?`))return;const b=["https://www.googleapis.com/auth/gmail.readonly","https://www.googleapis.com/auth/gmail.modify","https://www.googleapis.com/auth/gmail.send","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile"].join(" "),m=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${h}&redirect_uri=${encodeURIComponent(f)}&response_type=code&scope=${encodeURIComponent(b)}&access_type=offline&prompt=consent`,v=600,p=700,g=window.screenX+(window.outerWidth-v)/2,y=window.screenY+(window.outerHeight-p)/2;window.open(m,"Gmail OAuth",`width=${v},height=${p},left=${g},top=${y},toolbar=no,menubar=no`)},c=async()=>{if(confirm("Are you sure you want to disconnect your Gmail account? Email syncing will stop."))try{const{data:{user:h}}=await ae.auth.getUser();if(!h)return;const{error:f}=await ae.from("gmail_connections").delete().eq("user_id",h.id);if(f)throw f;alert("Gmail account disconnected successfully"),o()}catch(h){console.error("Error disconnecting Gmail:",h),alert("Failed to disconnect Gmail account")}},u=async()=>{if(e)try{const{error:h}=await ae.from("gmail_connections").update({sync_enabled:!e.sync_enabled}).eq("id",e.id);if(h)throw h;o()}catch(h){console.error("Error toggling sync:",h),alert("Failed to update sync settings")}},d=async()=>{if(s)return;i(!0),console.log({title:"Email Sync Started",message:"Syncing emails in background. You can continue using the app."});try{const{data:{session:f}}=await ae.auth.getSession();if(!f){alert("Please sign in to sync emails"),i(!1);return}const A="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",b=new AbortController,m=setTimeout(()=>b.abort(),12e4),v=await fetch(A,{method:"POST",headers:{Authorization:`Bearer ${f.access_token}`,"Content-Type":"application/json"},signal:b.signal});if(clearTimeout(m),!v.ok){const g=await v.text();throw new Error(`Server error (${v.status}): ${g}`)}const p=await v.json();if(p.success)alert(`Email sync completed!

 Total messages found: ${p.totalMessages}
 New emails processed: ${p.processedCount}
 New inquiries: ${p.newInquiriesCount}`),o();else throw new Error(p.error||"Sync failed")}catch(f){console.error("Error syncing emails:",f),f instanceof Error&&f.name==="AbortError"?alert("Sync is taking longer than expected. It will continue in the background. Check back in a few minutes."):alert(`Failed to sync emails: ${f instanceof Error?f.message:"Unknown error"}`)}finally{i(!1)}};return r?a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(SF,{className:"w-5 h-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold",children:"Gmail Integration"})]}),e!=null&&e.is_connected?a.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm font-medium text-green-700",children:"Connected"})]}):a.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),a.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Not Connected"})]})]}),e!=null&&e.is_connected?a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[a.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:a.jsx(yn,{className:"w-8 h-8 text-green-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Gmail Connected"}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.email_address}),e.last_sync&&a.jsxs("p",{className:"text-xs text-gray-500",children:["Last synced: ",new Date(e.last_sync).toLocaleString()]}),e.access_token_expires_at&&a.jsxs("p",{className:"text-xs text-gray-500",children:["Token expires: ",new Date(e.access_token_expires_at).toLocaleString()]})]})]}),a.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition",children:[a.jsx(kF,{className:"w-4 h-4"}),"Disconnect"]})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:"Sync Settings"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Automatic Email Sync"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Fetch new emails every 10 minutes"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.sync_enabled,onChange:u,className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsxs("button",{onClick:d,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-medium disabled:opacity-50",children:[a.jsx(go,{className:`w-4 h-4 ${s?"animate-spin":""}`}),s?"Syncing...":"Sync Now"]})})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(ea,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium mb-1",children:"Important Security Information"}),a.jsxs("ul",{className:"space-y-1 text-xs",children:[a.jsx("li",{children:" Your Gmail password is never stored or accessed by this app"}),a.jsx("li",{children:" Access tokens are encrypted in the database"}),a.jsx("li",{children:" You can revoke access anytime from Google Account settings"}),a.jsx("li",{children:" Only emails marked as inquiry-related are processed"})]})]})]})})]}):a.jsx("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(ha,{className:"w-8 h-8 text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Connect Your Gmail Account"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Securely connect your Gmail account to automatically fetch pharmaceutical inquiry emails. Your password is never stored - we use Google's OAuth2 for maximum security."}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"What you'll get:"}),a.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[a.jsx("li",{children:" Automatic email fetching every 10 minutes"}),a.jsx("li",{children:" AI-powered inquiry extraction from emails"}),a.jsx("li",{children:" Send emails directly from CRM"}),a.jsx("li",{children:" Complete email activity tracking"})]})]}),a.jsxs("button",{onClick:l,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-medium",children:[a.jsx(ha,{className:"w-5 h-5"}),"Connect Gmail Account"]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["By connecting, you authorize this app to read and send emails on your behalf. You can revoke access anytime from your ",a.jsx("a",{href:"https://myaccount.google.com/permissions",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Google Account settings"}),"."]})]})]})}),!1]})}function nfe({users:e,onRefresh:t}){const[r,n]=W.useState(!1),[s,i]=W.useState(!1),[o,l]=W.useState(!1),[c,u]=W.useState(null),[d,h]=W.useState(null),[f,A]=W.useState(!1),[b,m]=W.useState(""),[v,p]=W.useState({username:"",email:"",password:"",full_name:"",role:"sales"}),g=async E=>{E.preventDefault(),A(!0);try{const{data:S,error:F}=await ae.auth.signUp({email:v.email,password:v.password,options:{data:{full_name:v.full_name,email_verified:!0}}});if(F)throw F;if(!S.user)throw new Error("Failed to create user");const{error:I}=await ae.from("user_profiles").insert([{id:S.user.id,username:v.username.toLowerCase(),email:v.email,full_name:v.full_name,role:v.role,is_active:!0}]);if(I)throw I;alert(`User ${v.full_name} created successfully! Username: ${v.username}`),n(!1),p({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(S){console.error("Error creating user:",S),alert(S.message||"Failed to create user. Please try again.")}finally{A(!1)}},y=async E=>{if(E.preventDefault(),!!c){A(!0);try{const{error:S}=await ae.from("user_profiles").update({username:v.username.toLowerCase(),full_name:v.full_name,role:v.role}).eq("id",c.id);if(S)throw S;alert(`User ${v.full_name} updated successfully!`),i(!1),u(null),p({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(S){console.error("Error updating user:",S),alert(S.message||"Failed to update user. Please try again.")}finally{A(!1)}}},x=E=>{u(E),p({username:E.username,email:E.email,password:"",full_name:E.full_name,role:E.role}),i(!0)},w=async(E,S)=>{if(confirm(`Are you sure you want to ${S?"deactivate":"activate"} this user?`))try{const{error:I}=await ae.from("user_profiles").update({is_active:!S}).eq("id",E);if(I)throw I;alert(`User ${S?"deactivated":"activated"} successfully!`),t()}catch(I){console.error("Error updating user status:",I),alert("Failed to update user status.")}},N=async(E,S)=>{if(confirm(`Are you sure you want to permanently delete user "${S}"? This action cannot be undone.`))try{const{error:F}=await ae.from("user_profiles").delete().eq("id",E);if(F)throw F;alert("User deleted successfully!"),t()}catch(F){console.error("Error deleting user:",F),alert("Failed to delete user. The user may have associated records.")}},_=E=>{h(E),m(""),l(!0)},C=async E=>{if(E.preventDefault(),!!d){if(b.length<6){alert("Password must be at least 6 characters long");return}A(!0);try{const{data:{session:S}}=await ae.auth.getSession();if(!S)throw new Error("Not authenticated");const F=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/admin-update-password",{method:"POST",headers:{Authorization:`Bearer ${S.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({user_id:d.id,new_password:b})}),I=await F.json();if(!F.ok)throw new Error(I.error||"Failed to update password");alert(`Password updated successfully for ${d.full_name}!`),l(!1),h(null),m("")}catch(S){console.error("Error changing password:",S),alert(S.message||"Failed to change password. Please try again.")}finally{A(!1)}}},j=E=>{switch(E){case"admin":return"bg-purple-100 text-purple-800 border-purple-300";case"sales":return"bg-blue-100 text-blue-800 border-blue-300";case"accounts":return"bg-green-100 text-green-800 border-green-300";case"warehouse":return"bg-orange-100 text-orange-800 border-orange-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(oo,{className:"w-5 h-5"}),"User Management"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage system users, roles, and access permissions"})]}),a.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[a.jsx(Zb,{className:"w-4 h-4"}),"Add New User"]})]}),a.jsx("div",{className:"space-y-3",children:e.length===0?a.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsx(oo,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No users found"}),a.jsx("button",{onClick:()=>n(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Add your first user"})]}):e.map(E=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-md",children:a.jsx("span",{className:"text-white font-bold text-lg",children:E.full_name.charAt(0).toUpperCase()})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:E.full_name}),a.jsxs("p",{className:"text-sm text-gray-600 font-mono",children:["@",E.username]}),a.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mt-0.5",children:[a.jsx(ha,{className:"w-3 h-3"}),E.email]}),a.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Created: ",new Date(E.created_at).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:`px-3 py-1 border rounded-full text-xs font-medium capitalize flex items-center gap-1.5 ${j(E.role)}`,children:[a.jsx(Ny,{className:"w-3 h-3"}),E.role]}),a.jsx("button",{onClick:()=>x(E),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit user",children:a.jsx(Pg,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>_(E),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg transition",title:"Change password",children:a.jsx(qp,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>w(E.id,E.is_active),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition flex items-center gap-1.5 ${E.is_active?"bg-green-100 text-green-800 hover:bg-green-200 border border-green-300":"bg-red-100 text-red-800 hover:bg-red-200 border border-red-300"}`,title:E.is_active?"Click to deactivate":"Click to activate",children:E.is_active?a.jsxs(a.Fragment,{children:[a.jsx(yn,{className:"w-3.5 h-3.5"}),"Active"]}):a.jsxs(a.Fragment,{children:[a.jsx(un,{className:"w-3.5 h-3.5"}),"Inactive"]})}),a.jsx("button",{onClick:()=>N(E.id,E.username),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete user",children:a.jsx(nn,{className:"w-4 h-4"})})]})]},E.id))}),a.jsx(qt,{isOpen:r,onClose:()=>{n(!1),p({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Add New User",children:a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:a.jsx("p",{className:"text-sm text-blue-800",children:"Create a new user account. The user will be able to log in with their username and password."})}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(oo,{className:"w-4 h-4"}),"Full Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:v.full_name,onChange:E=>p({...v,full_name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(oo,{className:"w-4 h-4"}),"Username ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:v.username,onChange:E=>p({...v,username:E.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(ha,{className:"w-4 h-4"}),"Email Address ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"email",value:v.email,onChange:E=>p({...v,email:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"user@company.com",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For system notifications only. Login uses username."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(qp,{className:"w-4 h-4"}),"Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"password",value:v.password,onChange:E=>p({...v,password:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Minimum 6 characters",minLength:6,required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters. User can change this after logging in."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(Ny,{className:"w-4 h-4"}),"Role ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:v.role,onChange:E=>p({...v,role:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[a.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),a.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),a.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),a.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{n(!1),p({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:f,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:f?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Zb,{className:"w-4 h-4"}),"Create User"]})})]})]})}),a.jsx(qt,{isOpen:s,onClose:()=>{i(!1),u(null),p({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Edit User",children:a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:a.jsx("p",{className:"text-sm text-amber-800",children:"Editing user profile. Email cannot be changed. To reset password, user must use password reset feature."})}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(oo,{className:"w-4 h-4"}),"Full Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:v.full_name,onChange:E=>p({...v,full_name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(oo,{className:"w-4 h-4"}),"Username ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:v.username,onChange:E=>p({...v,username:E.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(ha,{className:"w-4 h-4"}),"Email Address"]}),a.jsx("input",{type:"email",value:v.email,className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed",disabled:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(Ny,{className:"w-4 h-4"}),"Role ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:v.role,onChange:E=>p({...v,role:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[a.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),a.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),a.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),a.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{i(!1),u(null),p({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:f,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:f?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Pg,{className:"w-4 h-4"}),"Save Changes"]})})]})]})}),a.jsx(qt,{isOpen:o,onClose:()=>{l(!1),h(null),m("")},title:"Change User Password",children:a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 mb-4",children:[a.jsx("p",{className:"text-sm text-orange-800 font-medium mb-2",children:"Admin Password Reset"}),a.jsxs("p",{className:"text-sm text-orange-800",children:["You are about to change the password for ",a.jsx("strong",{children:d==null?void 0:d.full_name})," (",d==null?void 0:d.username,"). The user will be able to log in immediately with the new password."]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[a.jsx(qp,{className:"w-4 h-4"}),"New Password ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"password",value:b,onChange:E=>m(E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter new password (minimum 6 characters)",minLength:6,required:!0,autoFocus:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters. Make sure to communicate the new password to the user securely."})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:"Security Note:"})," After changing the password, communicate it to the user through a secure channel. Encourage them to change it after logging in."]})}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{l(!1),h(null),m("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:f,children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:f?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(qp,{className:"w-4 h-4"}),"Change Password"]})})]})]})})]})}function afe(){const[e,t]=W.useState([]),[r,n]=W.useState(!0),[s,i]=W.useState(!1),[o,l]=W.useState(null),[c,u]=W.useState({template_name:"",subject:"",body:"",category:"custom",variables:[]}),d=[{value:"price_quote",label:"Price Quote"},{value:"coa_msds",label:"COA/MSDS"},{value:"follow_up",label:"Follow-up"},{value:"thank_you",label:"Thank You"},{value:"custom",label:"Custom"}],h=["{{contact_person}}","{{company_name}}","{{product_name}}","{{specification}}","{{quantity}}","{{supplier_name}}","{{supplier_country}}","{{inquiry_number}}","{{user_name}}"];W.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:x,error:w}=await ae.from("crm_email_templates").select("*").order("created_at",{ascending:!1});if(w)throw w;t(x||[])}catch(x){console.error("Error loading templates:",x)}finally{n(!1)}},A=async x=>{x.preventDefault();try{const{data:{user:w}}=await ae.auth.getUser();if(!w)throw new Error("Not authenticated");if(o){const{error:N}=await ae.from("crm_email_templates").update({template_name:c.template_name,subject:c.subject,body:c.body,category:c.category,variables:c.variables,updated_at:new Date().toISOString()}).eq("id",o.id);if(N)throw N;alert("Template updated successfully!")}else{const{error:N}=await ae.from("crm_email_templates").insert([{...c,created_by:w.id,is_active:!0,use_count:0}]);if(N)throw N;alert("Template created successfully!")}y(),i(!1),f()}catch(w){console.error("Error saving template:",w),alert(w.message||"Failed to save template")}},b=x=>{l(x),u({template_name:x.template_name,subject:x.subject,body:x.body,category:x.category,variables:x.variables||[]}),i(!0)},m=async x=>{try{const{data:{user:w}}=await ae.auth.getUser();if(!w)throw new Error("Not authenticated");const{error:N}=await ae.from("crm_email_templates").insert([{template_name:`${x.template_name} (Copy)`,subject:x.subject,body:x.body,category:x.category,variables:x.variables,created_by:w.id,is_active:!0,use_count:0}]);if(N)throw N;alert("Template duplicated successfully!"),f()}catch(w){console.error("Error duplicating template:",w),alert("Failed to duplicate template")}},v=async(x,w)=>{if(confirm(`Are you sure you want to delete "${w}"?`))try{const{error:N}=await ae.from("crm_email_templates").delete().eq("id",x);if(N)throw N;alert("Template deleted successfully!"),f()}catch(N){console.error("Error deleting template:",N),alert("Failed to delete template")}},p=async(x,w)=>{try{const{error:N}=await ae.from("crm_email_templates").update({is_active:!w}).eq("id",x);if(N)throw N;f()}catch(N){console.error("Error updating template:",N),alert("Failed to update template status")}},g=x=>{u(w=>({...w,body:w.body+" "+x,variables:w.variables.includes(x)?w.variables:[...w.variables,x]}))},y=()=>{l(null),u({template_name:"",subject:"",body:"",category:"custom",variables:[]})};return r?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(sr,{className:"w-5 h-5"}),"Email Templates"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage reusable email templates with variable placeholders"})]}),a.jsxs("button",{onClick:()=>{y(),i(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[a.jsx(Rr,{className:"w-4 h-4"}),"New Template"]})]}),a.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.length===0?a.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsx(sr,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"No templates found"}),a.jsx("button",{onClick:()=>i(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Create your first template"})]}):e.map(x=>{var w,N;return a.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:x.template_name}),a.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-700 rounded",children:((w=d.find(_=>_.value===x.category))==null?void 0:w.label)||x.category})]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[a.jsx("strong",{children:"Subject:"})," ",x.subject]}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[a.jsxs("span",{children:["Used ",x.use_count," times"]}),((N=x.variables)==null?void 0:N.length)>0&&a.jsxs("span",{children:["Variables: ",x.variables.length]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>p(x.id,x.is_active),className:`p-2 rounded-lg transition ${x.is_active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-50"}`,title:x.is_active?"Active":"Inactive",children:x.is_active?a.jsx(yn,{className:"w-4 h-4"}):a.jsx(un,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>m(x),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition",title:"Duplicate",children:a.jsx(lR,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>b(x),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit",children:a.jsx(Pg,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>v(x.id,x.template_name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:a.jsx(nn,{className:"w-4 h-4"})})]})]})},x.id)})}),a.jsx(qt,{isOpen:s,onClose:()=>{i(!1),y()},title:o?"Edit Template":"Create New Template",children:a.jsxs("form",{onSubmit:A,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Name *"}),a.jsx("input",{type:"text",value:c.template_name,onChange:x=>u({...c,template_name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"e.g., Price Quote - English"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),a.jsx("select",{value:c.category,onChange:x=>u({...c,category:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:d.map(x=>a.jsx("option",{value:x.value,children:x.label},x.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Subject *"}),a.jsx("input",{type:"text",value:c.subject,onChange:x=>u({...c,subject:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"Use variables like {{product_name}}"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Body (HTML) *"}),a.jsx("div",{className:"mb-2 flex flex-wrap gap-1",children:h.map(x=>a.jsx("button",{type:"button",onClick:()=>g(x),className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:x},x))}),a.jsx("textarea",{value:c.body,onChange:x=>u({...c,body:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Enter email template body..."})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{i(!1),y()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:o?"Update Template":"Create Template"})]})]})})]})}function sfe(){const[e,t]=W.useState(!1),[r,n]=W.useState(!1),[s,i]=W.useState([]),[o,l]=W.useState(null),[c,u]=W.useState(new Set),[d,h]=W.useState(100),f=async()=>{t(!0);try{const{data:{user:p}}=await ae.auth.getUser();if(!p){alert("Please log in to extract contacts.");return}const{data:g,error:y}=await ae.from("gmail_connections").select("*").eq("user_id",p.id).eq("is_connected",!0).maybeSingle();if(y&&y.code!=="PGRST116"){console.error("Error fetching Gmail connection:",y),alert(`Database error: ${y.message}. Please contact support.`);return}if(!g||!g.access_token){alert("Gmail is not connected. Please connect Gmail first in Settings  Gmail tab.");return}const x="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/extract-gmail-contacts";console.log("Calling edge function:",x);const w=await fetch(x,{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY","Content-Type":"application/json"},body:JSON.stringify({access_token:g.access_token,max_emails:d,user_id:p.id,connection_id:g.id})});console.log("Response status:",w.status);const N=await w.json();if(console.log("Response data:",N),!w.ok)throw new Error(N.error||`HTTP ${w.status}: ${w.statusText}`);if(N.success)i(N.contacts),l({total_emails:N.total_emails_scanned||N.total_emails,total_contacts:N.total_contacts}),u(new Set(N.contacts.map((_,C)=>C))),N.message&&alert(`Success! ${N.message}`);else throw new Error(N.error||"Failed to extract contacts")}catch(p){console.error("Error extracting contacts:",p);const g=p.message||"Unknown error occurred";alert(`Failed to extract contacts: ${g}

Please check:
1. Gmail is connected in Settings  Gmail tab
2. Your Gmail connection hasn't expired
3. Try reconnecting Gmail if issues persist`)}finally{t(!1)}},A=()=>{if(s.length===0){alert("No contacts to export");return}const p=s.filter((w,N)=>c.has(N)),g=Ya.json_to_sheet(p.map(w=>({"Company Name":w.companyName,"Customer Name":w.customerName,"Email IDs":w.emailIds,Phone:w.phone,Mobile:w.mobile,Website:w.website,Address:w.address,Source:w.source}))),y=Ya.book_new();Ya.book_append_sheet(y,g,"Clients");const x=[{wch:30},{wch:25},{wch:40},{wch:18},{wch:18},{wch:30},{wch:40},{wch:12}];g["!cols"]=x,mx(y,`Extracted_Contacts_${new Date().toISOString().split("T")[0]}.xlsx`)},b=async()=>{if(c.size===0){alert("Please select contacts to import");return}if(confirm(`Are you sure you want to import ${c.size} contact(s) to the Customers database?

This will create new customer records for selected contacts.`)){n(!0);try{const y=s.filter((N,_)=>c.has(_)).map(N=>{var _;return{company_name:N.companyName||"Unknown Company",contact_person:N.customerName||"",email:((_=N.emailIds.split(";")[0])==null?void 0:_.trim())||"",phone:N.phone||N.mobile||"",website:N.website||"",address:N.address||"",country:"Indonesia",city:"Jakarta Pusat",is_active:!0}}),{data:x,error:w}=await ae.from("customers").upsert(y,{onConflict:"email",ignoreDuplicates:!1}).select();if(w)throw w;alert(`Successfully imported ${(x==null?void 0:x.length)||c.size} customer(s)!`),i([]),l(null),u(new Set)}catch(g){console.error("Error importing customers:",g),alert("Failed to import some customers. They may already exist in the database.")}finally{n(!1)}}},m=()=>{c.size===s.length?u(new Set):u(new Set(s.map((p,g)=>g)))},v=p=>{const g=new Set(c);g.has(p)?g.delete(p):g.add(p),u(g)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Extract Data from Gmail"}),a.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered extraction of contact information from Gmail using OpenAI. The system intelligently extracts company names, contacts, phone numbers, and websites from email signatures. It filters out email body content and enriches company data automatically."}),a.jsxs("div",{className:"mt-2 bg-blue-50 border border-blue-200 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs text-blue-900 font-medium",children:"AI-Powered Features:"}),a.jsxs("ul",{className:"text-xs text-blue-700 mt-1 space-y-1 ml-4 list-disc",children:[a.jsx("li",{children:'AI extracts REAL company names from signatures (e.g., "PT Genero Pharmaceuticals")'}),a.jsx("li",{children:"Filters out email greetings, body text, and system emails"}),a.jsx("li",{children:"Tracks processed emails - click again to get NEXT batch of NEW emails"}),a.jsx("li",{children:"High-quality extraction - processes 100-500 emails (takes time for AI quality)"})]})]})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Emails to Scan"}),a.jsx("input",{type:"number",value:d,onChange:p=>h(Math.max(50,Math.min(500,parseInt(p.target.value)||100))),min:"50",max:"500",step:"50",className:"w-48 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Range: 50 - 500 emails. Recommended: 100-200 for quality"})]}),a.jsx("div",{className:"flex-shrink-0 pt-6",children:a.jsx("button",{onClick:f,disabled:e,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e?a.jsxs(a.Fragment,{children:[a.jsx(go,{className:"h-5 w-5 animate-spin"}),"Extracting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ha,{className:"h-5 w-5"}),"Extract Contacts"]})})})]}),o&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(yn,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"AI Extraction completed successfully!"}),a.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["AI processed ",o.total_emails," NEW unprocessed emails and extracted ",o.total_contacts," high-quality contacts"]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:'Click "Extract Contacts" again to process the next batch of NEW emails'})]})]})})]}),s.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h3",{className:"text-md font-semibold text-gray-900",children:["Extracted Contacts (",c.size," selected)"]}),a.jsx("button",{onClick:m,className:"text-sm text-blue-600 hover:text-blue-700",children:c.size===s.length?"Deselect All":"Select All"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:A,disabled:c.size===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(Ai,{className:"h-4 w-4"}),"Export to Excel"]}),a.jsx("button",{onClick:b,disabled:r||c.size===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?a.jsxs(a.Fragment,{children:[a.jsx(go,{className:"h-4 w-4 animate-spin"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(SA,{className:"h-4 w-4"}),"Import to Customers"]})})]})]}),a.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:c.size===s.length,onChange:m,className:"rounded border-gray-300"})}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact Person"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email IDs"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mobile"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Website"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map((p,g)=>a.jsxs("tr",{className:`hover:bg-gray-50 ${c.has(g)?"bg-blue-50":""}`,children:[a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"checkbox",checked:c.has(g),onChange:()=>v(g),className:"rounded border-gray-300"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.companyName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:p.customerName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs truncate",title:p.emailIds,children:p.emailIds||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:p.phone||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:p.mobile||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-blue-600 max-w-xs truncate",title:p.website,children:p.website||"-"})]},g))})]})})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(ea,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-yellow-900 font-medium",children:"Review before importing"}),a.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Please review the extracted contacts carefully. The system attempts to deduplicate and merge contacts from the same company, but you should verify the data before importing to your customer database."})]})]})})]})]})}function ife(){const{t:e}=kn(),{profile:t}=jr(),[r,n]=W.useState("company"),[s,i]=W.useState(!0),[o,l]=W.useState(!1),[c,u]=W.useState(null),[d,h]=W.useState([]),[f,A]=W.useState({company_name:"",company_address:"",company_phone:"",company_email:"",tax_rate:11,invoice_prefix:"SAPJ",invoice_start_number:1,email_host:"",email_port:587,email_username:"",low_stock_threshold:100,expiry_alert_days:30,default_language:"en",financial_year_start:"2024-01-01",financial_year_end:"2024-12-31",current_financial_year:"2024"});W.useEffect(()=>{(t==null?void 0:t.role)==="admin"&&(b(),m())},[t]);const b=async()=>{try{const{data:p,error:g}=await ae.from("app_settings").select("*").limit(1).maybeSingle();if(g)throw g;p&&(u(p),A({company_name:p.company_name||"",company_address:p.company_address||"",company_phone:p.company_phone||"",company_email:p.company_email||"",tax_rate:p.tax_rate||11,invoice_prefix:p.invoice_prefix||"SAPJ",invoice_start_number:p.invoice_start_number||1,email_host:p.email_host||"",email_port:p.email_port||587,email_username:p.email_username||"",low_stock_threshold:p.low_stock_threshold||100,expiry_alert_days:p.expiry_alert_days||30,default_language:p.default_language||"en",financial_year_start:p.financial_year_start||"2024-01-01",financial_year_end:p.financial_year_end||"2024-12-31",current_financial_year:p.current_financial_year||"2024"}))}catch(p){console.error("Error loading settings:",p)}finally{i(!1)}},m=async()=>{try{const{data:p,error:g}=await ae.from("user_profiles").select("id, email, full_name, role, is_active, created_at, username").order("created_at",{ascending:!1});if(g)throw g;h(p||[])}catch(p){console.error("Error loading users:",p),h([])}},v=async p=>{p.preventDefault(),l(!0);try{if(c){const{error:g}=await ae.from("app_settings").update({...f,email_host:f.email_host||null,email_username:f.email_username||null}).eq("id",c.id);if(g)throw g}else{const{error:g}=await ae.from("app_settings").insert([{...f,email_host:f.email_host||null,email_username:f.email_username||null}]);if(g)throw g}alert("Settings saved successfully!"),b()}catch(g){console.error("Error saving settings:",g),alert("Failed to save settings. Please try again.")}finally{l(!1)}};return(t==null?void 0:t.role)!=="admin"?a.jsx(Zn,{children:a.jsxs("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-xl text-gray-600",children:"You do not have permission to access settings."}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Only administrators can view and modify system settings."})]})}):s?a.jsx(Zn,{children:a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Configure system settings and manage users"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex -mb-px",children:[a.jsx("button",{onClick:()=>n("company"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="company"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(r0,{className:"w-4 h-4"}),"Company Profile"]})}),a.jsx("button",{onClick:()=>n("users"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="users"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Hu,{className:"w-4 h-4"}),"Users"]})}),a.jsx("button",{onClick:()=>n("financial"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="financial"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Na,{className:"w-4 h-4"}),"Financial Year"]})}),a.jsx("button",{onClick:()=>n("system"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="system"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ps,{className:"w-4 h-4"}),"System"]})}),a.jsx("button",{onClick:()=>n("gmail"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="gmail"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ha,{className:"w-4 h-4"}),"Gmail"]})}),a.jsx("button",{onClick:()=>n("templates"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="templates"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sr,{className:"w-4 h-4"}),"Email Templates"]})}),a.jsx("button",{onClick:()=>n("extract"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${r==="extract"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ai,{className:"w-4 h-4"}),"Extract Data"]})})]})}),a.jsxs("div",{className:"p-6",children:[r==="gmail"&&a.jsx(rfe,{}),r==="templates"&&a.jsx(afe,{}),r==="extract"&&a.jsx(sfe,{}),r==="company"&&a.jsxs("form",{onSubmit:v,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(r0,{className:"w-5 h-5"}),"Company Information"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),a.jsx("input",{type:"text",value:f.company_name,onChange:p=>A({...f,company_name:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),a.jsx("textarea",{value:f.company_address,onChange:p=>A({...f,company_address:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"text",value:f.company_phone,onChange:p=>A({...f,company_phone:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:f.company_email,onChange:p=>A({...f,company_email:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(El,{className:"w-5 h-5"}),"Financial Settings"]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Tax Rate (%)"}),a.jsx("input",{type:"number",value:f.tax_rate,onChange:p=>A({...f,tax_rate:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Prefix"}),a.jsx("input",{type:"text",value:f.invoice_prefix,onChange:p=>A({...f,invoice_prefix:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Start Number"}),a.jsx("input",{type:"number",value:f.invoice_start_number,onChange:p=>A({...f,invoice_start_number:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[a.jsx(jy,{className:"w-5 h-5"}),o?"Saving...":"Save Settings"]})})]}),r==="users"&&a.jsx(nfe,{users:d,onRefresh:m}),r==="financial"&&a.jsxs("form",{onSubmit:v,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(Na,{className:"w-5 h-5"}),"Financial Year Configuration"]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:a.jsx("p",{className:"text-sm text-blue-800",children:"Configure your company's financial year period. This will be used to filter reports and dashboard statistics. The system will automatically organize data based on the selected financial year."})}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Financial Year *"}),a.jsxs("select",{value:f.current_financial_year,onChange:p=>{const g=p.target.value;A({...f,current_financial_year:g,financial_year_start:`${g}-01-01`,financial_year_end:`${g}-12-31`})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[a.jsx("option",{value:"2023",children:"2023"}),a.jsx("option",{value:"2024",children:"2024"}),a.jsx("option",{value:"2025",children:"2025"}),a.jsx("option",{value:"2026",children:"2026"}),a.jsx("option",{value:"2027",children:"2027"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the active financial year"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),a.jsx("input",{type:"date",value:f.financial_year_start,onChange:p=>A({...f,financial_year_start:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year start date"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),a.jsx("input",{type:"date",value:f.financial_year_end,onChange:p=>A({...f,financial_year_end:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year end date"})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[a.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Active Financial Year Period:"}),a.jsxs("p",{className:"text-lg font-bold text-green-900",children:[new Date(f.financial_year_start).toLocaleDateString()," - ",new Date(f.financial_year_end).toLocaleDateString()]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[a.jsx(jy,{className:"w-5 h-5"}),o?"Saving...":"Save Financial Year"]})})]}),r==="system"&&a.jsxs("form",{onSubmit:v,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(Ps,{className:"w-5 h-5"}),"Inventory Alerts"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Low Stock Threshold"}),a.jsx("input",{type:"number",value:f.low_stock_threshold,onChange:p=>A({...f,low_stock_threshold:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when stock falls below this quantity"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Alert Days"}),a.jsx("input",{type:"number",value:f.expiry_alert_days,onChange:p=>A({...f,expiry_alert_days:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when products will expire within this many days"})]})]})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(ha,{className:"w-5 h-5"}),"Email Configuration (Optional)"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),a.jsx("input",{type:"text",value:f.email_host,onChange:p=>A({...f,email_host:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"smtp.example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Port"}),a.jsx("input",{type:"number",value:f.email_port,onChange:p=>A({...f,email_port:Number(p.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Username"}),a.jsx("input",{type:"text",value:f.email_username,onChange:p=>A({...f,email_username:p.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"user@example.com"})]})]})]}),a.jsxs("div",{className:"border-t pt-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Language Preference"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Language"}),a.jsxs("select",{value:f.default_language,onChange:p=>A({...f,default_language:p.target.value}),className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"en",children:"English"}),a.jsx("option",{value:"id",children:"Indonesian"})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[a.jsx(jy,{className:"w-5 h-5"}),o?"Saving...":"Save Settings"]})})]})]})]})]})})}const qv=[{email:"admin@pharma.com",password:"admin123",fullName:"Admin User",role:"admin"},{email:"accounts@pharma.com",password:"accounts123",fullName:"Accounts Manager",role:"accounts"},{email:"sales@pharma.com",password:"sales123",fullName:"Sales Representative",role:"sales"},{email:"warehouse@pharma.com",password:"warehouse123",fullName:"Warehouse Staff",role:"warehouse"}];function ofe(){const[e,t]=W.useState(!1),[r,n]=W.useState([]),[s,i]=W.useState(!0),o=async()=>{t(!0),n([]);const l=[];for(const c of qv){try{const{data:u,error:d}=await ae.auth.signUp({email:c.email,password:c.password});if(d){l.push({email:c.email,success:!1,message:`Auth error: ${d.message}`});continue}if(!u.user){l.push({email:c.email,success:!1,message:"No user data returned"});continue}const{error:h}=await ae.from("user_profiles").insert({id:u.user.id,email:c.email,full_name:c.fullName,role:c.role,language:"en",is_active:!0});if(h){l.push({email:c.email,success:!1,message:`Profile error: ${h.message}`});continue}l.push({email:c.email,success:!0,message:`Created successfully (${c.role})`})}catch(u){l.push({email:c.email,success:!1,message:`Error: ${u.message}`})}n([...l])}t(!1)};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl p-8",children:[a.jsx("div",{className:"flex items-center justify-center mb-6",children:a.jsx("div",{className:"bg-blue-600 p-3 rounded-full",children:a.jsx(Zb,{className:"w-8 h-8 text-white"})})}),a.jsx("h1",{className:"text-3xl font-bold text-center text-gray-900 mb-2",children:"Database Setup"}),a.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Create sample users for your Pharma Trading System"}),s&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Important Instructions:"}),a.jsxs("ol",{className:"text-sm text-blue-800 space-y-2 list-decimal list-inside",children:[a.jsx("li",{children:"This page will create 4 test users with their profiles"}),a.jsx("li",{children:"Make sure your Supabase email confirmation is disabled in your project settings"}),a.jsx("li",{children:"If email confirmation is enabled, you'll need to confirm emails manually"}),a.jsx("li",{children:"Click the button below to create all users at once"})]}),a.jsx("button",{onClick:()=>i(!1),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Got it, hide this"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Users to create:"}),a.jsx("div",{className:"space-y-2",children:qv.map(l=>a.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:l.email}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Password: ",l.password," | Role: ",l.role]})]}),a.jsx("span",{className:`px-2 py-1 text-xs rounded ${l.role==="admin"?"bg-red-100 text-red-700":l.role==="accounts"?"bg-green-100 text-green-700":l.role==="sales"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:l.role})]},l.email))})]}),a.jsx("button",{onClick:o,disabled:e,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium text-lg mb-6",children:e?"Creating Users...":"Create All Users"}),r.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Results:"}),r.map((l,c)=>a.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${l.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[l.success?a.jsx(yn,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}):a.jsx(un,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:`font-medium ${l.success?"text-green-900":"text-red-900"}`,children:l.email}),a.jsx("div",{className:`text-sm ${l.success?"text-green-700":"text-red-700"}`,children:l.message})]})]},c))]}),r.length>0&&r.every(l=>l.success)&&a.jsxs("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"Success!"}),a.jsx("p",{className:"text-sm text-green-800 mb-3",children:"All users created successfully. You can now navigate to the login page and use any of these credentials:"}),a.jsx("div",{className:"text-sm text-green-800 space-y-1",children:qv.map(l=>a.jsxs("div",{children:[" ",l.email," / ",l.password]},l.email))}),a.jsx("button",{onClick:()=>window.location.href="/",className:"mt-4 w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition font-medium",children:"Go to Login"})]}),r.length>0&&r.some(l=>!l.success)&&a.jsxs("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Partial Success"}),a.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Some users failed to create. This is usually because:"}),a.jsxs("ul",{className:"text-sm text-yellow-800 list-disc list-inside space-y-1",children:[a.jsx("li",{children:"The email already exists"}),a.jsx("li",{children:"Email confirmation is required (check Supabase Auth settings)"}),a.jsx("li",{children:"RLS policies prevented profile creation"})]}),a.jsx("p",{className:"text-sm text-yellow-800 mt-3",children:"See CREATE_USERS.md for manual setup instructions."})]})]})})}function lfe(){const[e,t]=W.useState("loading"),[r,n]=W.useState("Processing Gmail connection...");W.useEffect(()=>{s()},[]);const s=async()=>{try{console.log("Starting Gmail OAuth callback...");const i=new URLSearchParams(window.location.search),o=i.get("code"),l=i.get("error");if(console.log("Callback params:",{hasCode:!!o,error:l}),l){t("error"),n(`Authorization failed: ${l}`),setTimeout(()=>window.close(),3e3);return}if(!o){t("error"),n("No authorization code received"),setTimeout(()=>window.close(),3e3);return}console.log("[GmailCallback] === CHECKING AUTH ===");const{data:{user:c}}=await ae.auth.getUser();if(console.log("[GmailCallback] Current user:",c==null?void 0:c.id),!c){console.error("[GmailCallback] No user found!"),t("error"),n("User not authenticated"),setTimeout(()=>window.close(),3e3);return}const u="90568246766-durgkfgje103589m6cuk99sv8kim69ec.apps.googleusercontent.com",d="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",h=`${window.location.origin}/auth/gmail/callback`;console.log("OAuth config:",{hasClientId:!!u,hasClientSecret:!!d,redirectUri:h}),console.log("Exchanging code for token...");const f=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code:o,client_id:u,client_secret:d,redirect_uri:h,grant_type:"authorization_code"})});if(!f.ok){const y=await f.text();throw console.error("Token exchange failed:",y),new Error(`Token exchange failed: ${y}`)}const A=await f.json();console.log("Token received, fetching profile...");const b=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${A.access_token}`}});if(!b.ok){const y=await b.text();throw console.error("Profile fetch failed:",{status:b.status,statusText:b.statusText,body:y}),new Error(`Failed to fetch Gmail profile (${b.status}): ${y}`)}const m=await b.json();console.log("Profile fetched:",m.email);const v=new Date;v.setSeconds(v.getSeconds()+A.expires_in),console.log("[GmailCallback] === SAVING TO DATABASE ==="),console.log("[GmailCallback] Saving for user_id:",c.id),console.log("[GmailCallback] Email:",m.email),console.log("[GmailCallback] Expires at:",v.toISOString());const{data:p,error:g}=await ae.from("gmail_connections").upsert({user_id:c.id,email_address:m.email,access_token:A.access_token,refresh_token:A.refresh_token,access_token_expires_at:v.toISOString(),is_connected:!0,sync_enabled:!0,last_sync:null},{onConflict:"user_id,email_address"}).select();if(console.log("[GmailCallback] Insert result:",p),console.log("[GmailCallback] Insert error:",g),g)throw console.error("[GmailCallback] Database error:",g),g;console.log("[GmailCallback] Gmail connection saved to database successfully"),t("success"),n("Gmail connected successfully! You can close this window."),setTimeout(()=>{window.opener&&window.opener.location.reload(),window.close()},2e3)}catch(i){console.error("Callback error:",i),t("error"),n(i instanceof Error?i.message:"Failed to connect Gmail"),setTimeout(()=>window.close(),5e3)}};return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e==="loading"&&a.jsxs(a.Fragment,{children:[a.jsx(Mo,{className:"w-16 h-16 text-blue-600 mx-auto mb-4 animate-spin"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connecting Gmail..."}),a.jsx("p",{className:"text-gray-600",children:r})]}),e==="success"&&a.jsxs(a.Fragment,{children:[a.jsx(yn,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Success!"}),a.jsx("p",{className:"text-gray-600",children:r})]}),e==="error"&&a.jsxs(a.Fragment,{children:[a.jsx(un,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connection Failed"}),a.jsx("p",{className:"text-gray-600",children:r}),a.jsx("button",{onClick:()=>window.close(),className:"mt-4 px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition",children:"Close Window"})]})]})})}function cfe({existingOrder:e,onSuccess:t,onCancel:r}){const{user:n}=jr(),{t:s}=kn(),[i,o]=W.useState([]),[l,c]=W.useState([]),[u,d]=W.useState({}),[h,f]=W.useState(!1),[A,b]=W.useState({customer_id:"",customer_po_number:"",customer_po_date:new Date().toISOString().split("T")[0],so_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",notes:"",currency:"IDR"}),[m,v]=W.useState(null),[p,g]=W.useState([{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}]);W.useEffect(()=>{y(),x()},[]),W.useEffect(()=>{if(e&&(b({customer_id:e.customer_id,customer_po_number:e.customer_po_number,customer_po_date:e.customer_po_date,so_date:e.so_date,expected_delivery_date:e.expected_delivery_date||"",notes:e.notes||"",currency:e.currency||"IDR"}),e.sales_order_items&&e.sales_order_items.length>0)){const J=e.sales_order_items.map(H=>({product_id:H.product_id,quantity:H.quantity,unit_price:H.unit_price,discount_percent:H.discount_percent,discount_amount:H.discount_amount,tax_percent:H.tax_percent,tax_amount:H.tax_amount,line_total:H.line_total,item_delivery_date:H.item_delivery_date||"",notes:H.notes||""}));g(J),J.forEach(H=>{H.product_id&&w(H.product_id)})}},[e]);const y=async()=>{try{const{data:J,error:H}=await ae.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(H)throw H;o(J||[])}catch(J){console.error("Error fetching customers:",J.message)}},x=async()=>{try{const{data:J,error:H}=await ae.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(H)throw H;c(J||[])}catch(J){console.error("Error fetching products:",J.message)}},w=async J=>{try{const{data:H,error:V}=await ae.from("batches").select("id, current_stock").eq("product_id",J);if(V)throw V;const K=(H==null?void 0:H.reduce((D,Q)=>D+Number(Q.current_stock),0))||0,{data:B}=await ae.from("stock_reservations").select("reserved_quantity").eq("product_id",J).eq("status","active"),L=(B==null?void 0:B.reduce((D,Q)=>D+Number(Q.reserved_quantity),0))||0,U=K-L;d(D=>({...D,[J]:{total_stock:K,reserved_stock:L,free_stock:U}}))}catch(H){console.error("Error fetching stock info:",H.message)}},N=(J,H)=>{if(!l.find(B=>B.id===H))return;const K=[...p];K[J].product_id=H,K[J].unit_price=0,g(K),_(J),w(H)},_=J=>{const H=p[J],V=H.quantity*H.unit_price,K=H.discount_percent>0?V*H.discount_percent/100:H.discount_amount,B=V-K,L=B*H.tax_percent/100,U=B+L,D=[...p];D[J]={...H,discount_amount:K,tax_amount:L,line_total:U},g(D)},C=(J,H,V)=>{const K=[...p];K[J]={...K[J],[H]:V};const B=K[J],L=B.quantity*B.unit_price,U=B.discount_percent>0?L*B.discount_percent/100:B.discount_amount,D=L-U,Q=D*B.tax_percent/100,z=D+Q;K[J]={...B,discount_amount:U,tax_amount:Q,line_total:z},g(K)},j=()=>{g([...p,{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}])},E=J=>{if(p.length===1){alert("At least one item is required");return}console.log("Removing item at index:",J,"Current items count:",p.length);const H=p.filter((V,K)=>K!==J);console.log("New items count after removal:",H.length),g(H)},S=async()=>{if(!m)return null;try{console.log("Starting file upload:",m.name);const J=m.name.split(".").pop(),V=`customer-po/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${J}`}`;console.log("Uploading to path:",V);const{data:K,error:B}=await ae.storage.from("sales-order-documents").upload(V,m,{cacheControl:"3600",upsert:!1});if(B)throw console.error("Upload error:",B),B;console.log("File uploaded successfully:",K);const{data:{publicUrl:L}}=ae.storage.from("sales-order-documents").getPublicUrl(V);return console.log("Public URL generated:",L),L}catch(J){throw console.error("Error uploading file:",J),alert(`Failed to upload PO file: ${J.message||"Unknown error"}`),J}},F=async(J,H=!1)=>{if(J.preventDefault(),!A.customer_id){alert("Please select a customer");return}if(!A.customer_po_number.trim()){alert("Please enter customer PO number");return}if(p.length===0||p.some(K=>!K.product_id||K.quantity<=0)){alert("Please add valid items to the order");return}const V=e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status);if(!(V&&e&&!confirm(` Warning: This order has been approved or is awaiting approval.

Editing will:
 Release existing stock reservations
 Require re-approval from admin
 Reset status to "Pending Approval"

Do you want to continue?`)))try{f(!0);let K=(e==null?void 0:e.customer_po_file_url)||null;if(m&&(console.log("Uploading PO file..."),K=await S(),console.log("PO file URL:",K),!K))throw new Error("File upload returned no URL");const B=p.reduce((D,Q)=>D+(Q.quantity*Q.unit_price-Q.discount_amount),0),L=p.reduce((D,Q)=>D+Q.tax_amount,0),U=p.reduce((D,Q)=>D+Q.line_total,0);if(e){if(V){console.log("Releasing stock reservations for order:",e.id);const{error:ee}=await ae.rpc("fn_release_reservation_by_so_id",{p_so_id:e.id,p_released_by:n==null?void 0:n.id});ee&&console.error("Error releasing reservations:",ee)}let D;V||H?D="pending_approval":D="draft",console.log("Updating order. Items count:",p.length);const{error:Q}=await ae.from("sales_orders").update({customer_id:A.customer_id,customer_po_number:A.customer_po_number,customer_po_date:A.customer_po_date,customer_po_file_url:K,so_date:A.so_date,currency:A.currency,expected_delivery_date:A.expected_delivery_date||null,notes:A.notes||null,status:D,subtotal_amount:B,tax_amount:L,total_amount:U,updated_at:new Date().toISOString()}).eq("id",e.id);if(Q)throw Q;const{error:z}=await ae.from("sales_order_items").delete().eq("sales_order_id",e.id);if(z)throw z;const G=p.map(ee=>({sales_order_id:e.id,product_id:ee.product_id,quantity:ee.quantity,unit_price:ee.unit_price,discount_percent:ee.discount_percent,discount_amount:ee.discount_amount,tax_percent:ee.tax_percent,tax_amount:ee.tax_amount,line_total:ee.line_total,item_delivery_date:ee.item_delivery_date||null,notes:ee.notes||null}));console.log("Inserting items. Count:",G.length);const{data:Z,error:R}=await ae.from("sales_order_items").insert(G).select();if(R)throw R;console.log("Items inserted successfully. Count:",(Z==null?void 0:Z.length)||0),Z&&Z.length!==p.length&&(console.error("WARNING: Item count mismatch!",{expected:p.length,inserted:Z.length}),alert(` Warning: Expected ${p.length} items but only ${Z.length} were saved. Please verify the order.`)),alert(`Sales order updated successfully${V?" and submitted for re-approval. Stock reservations have been released.":H?" and submitted for approval":""}!`)}else{const{data:D,error:Q}=await ae.from("sales_orders").insert({so_number:"",customer_id:A.customer_id,customer_po_number:A.customer_po_number,customer_po_date:A.customer_po_date,customer_po_file_url:K,so_date:A.so_date,currency:A.currency,expected_delivery_date:A.expected_delivery_date||null,notes:A.notes||null,status:H?"pending_approval":"draft",subtotal_amount:B,tax_amount:L,total_amount:U,created_by:n==null?void 0:n.id}).select().single();if(Q)throw Q;const z=p.map(Z=>({sales_order_id:D.id,product_id:Z.product_id,quantity:Z.quantity,unit_price:Z.unit_price,discount_percent:Z.discount_percent,discount_amount:Z.discount_amount,tax_percent:Z.tax_percent,tax_amount:Z.tax_amount,line_total:Z.line_total,item_delivery_date:Z.item_delivery_date||null,notes:Z.notes||null})),{error:G}=await ae.from("sales_order_items").insert(z);if(G)throw G;alert(`Sales order created successfully${H?" and submitted for approval":""}!`)}t()}catch(K){console.error(e?"Error updating sales order:":"Error creating sales order:",K.message),alert((e?"Failed to update sales order: ":"Failed to create sales order: ")+K.message)}finally{f(!1)}},I=(J,H)=>{const V=u[J];if(!V)return null;const K=V.free_stock>=H;return a.jsxs("div",{className:`text-xs ${K?"text-green-600":"text-red-600"}`,children:[s("salesOrders.freeStock"),": ",V.free_stock," ",!K&&"(Insufficient!)"]})},O=p.reduce((J,H)=>J+(H.quantity*H.unit_price-H.discount_amount),0),M=p.reduce((J,H)=>J+H.tax_amount,0),P=p.reduce((J,H)=>J+H.line_total,0),X=J=>{const H=J.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0});return A.currency==="USD"?`$ ${H}`:`Rp ${H}`};return a.jsxs("form",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("sales.customer")," *"]}),a.jsxs("select",{value:A.customer_id,onChange:J=>b({...A,customer_id:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[a.jsxs("option",{value:"",children:[s("common.filter")," ",s("sales.customer")]}),i.map(J=>a.jsx("option",{value:J.id,children:J.company_name},J.id))]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("salesOrders.customerPoNumber")," *"]}),a.jsx("input",{type:"text",value:A.customer_po_number,onChange:J=>b({...A,customer_po_number:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("salesOrders.customerPoDate")," *"]}),a.jsx("input",{type:"date",value:A.customer_po_date,onChange:J=>b({...A,customer_po_date:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.soDate")}),a.jsx("input",{type:"date",value:A.so_date,onChange:J=>b({...A,so_date:J.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),a.jsxs("select",{value:A.currency,onChange:J=>b({...A,currency:J.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[a.jsx("option",{value:"IDR",children:"IDR (Rp)"}),a.jsx("option",{value:"USD",children:"USD ($)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.expectedDeliveryDate")}),a.jsx("input",{type:"date",value:A.expected_delivery_date,onChange:J=>b({...A,expected_delivery_date:J.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.uploadPo")}),(e==null?void 0:e.customer_po_file_url)&&!m&&a.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sr,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{className:"text-sm text-blue-700",children:"PO file already uploaded"})]}),a.jsx("a",{href:e.customer_po_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"View"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:J=>{var H;return v(((H=J.target.files)==null?void 0:H[0])||null)},className:"w-full border rounded-lg px-3 py-2"}),m&&a.jsx("button",{type:"button",onClick:()=>v(null),className:"text-red-600 hover:text-red-800",title:"Remove selected file",children:a.jsx(Kr,{className:"w-5 h-5"})})]}),m&&a.jsxs("p",{className:"mt-1 text-sm text-green-600 flex items-center gap-1",children:[a.jsx(sr,{className:"w-4 h-4"}),"Ready to upload: ",m.name]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.notes")}),a.jsx("textarea",{value:A.notes,onChange:J=>b({...A,notes:J.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Items"}),a.jsxs("button",{type:"button",onClick:j,className:"flex items-center gap-1 text-blue-600 hover:text-blue-800 text-sm",children:[a.jsx(Rr,{className:"w-4 h-4"})," ",s("sales.addItem")]})]}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:p.map((J,H)=>a.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"text-xs text-gray-600",children:[s("salesOrders.product")," *"]}),a.jsxs("select",{value:J.product_id,onChange:V=>N(H,V.target.value),className:"w-full border rounded px-2 py-1 text-sm",required:!0,children:[a.jsx("option",{value:"",children:"Select Product"}),l.map(V=>a.jsx("option",{value:V.id,children:V.product_name},V.id))]}),J.product_id&&I(J.product_id,J.quantity)]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs text-gray-600",children:[s("sales.quantity")," *"]}),a.jsx("input",{type:"text",value:J.quantity===0?"":J.quantity,onChange:V=>{const K=V.target.value;if(K==="")C(H,"quantity",0);else{const B=parseFloat(K);isNaN(B)||C(H,"quantity",B)}},onBlur:V=>{V.target.value===""&&C(H,"quantity",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter quantity",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:s("sales.unitPrice")}),a.jsx("input",{type:"text",value:J.unit_price===0?"":J.unit_price,onChange:V=>{const K=V.target.value;if(K==="")C(H,"unit_price",0);else{const B=parseFloat(K);isNaN(B)||C(H,"unit_price",B)}},onBlur:V=>{V.target.value===""&&C(H,"unit_price",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter price"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.discountPercent")}),a.jsx("input",{type:"text",value:J.discount_percent===0?"":J.discount_percent,onChange:V=>{const K=V.target.value;if(K==="")C(H,"discount_percent",0);else{const B=parseFloat(K);!isNaN(B)&&B>=0&&B<=100&&C(H,"discount_percent",B)}},onBlur:V=>{V.target.value===""&&C(H,"discount_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.taxPercent")}),a.jsx("input",{type:"text",value:J.tax_percent===0?"":J.tax_percent,onChange:V=>{const K=V.target.value;if(K==="")C(H,"tax_percent",0);else{const B=parseFloat(K);!isNaN(B)&&B>=0&&B<=100&&C(H,"tax_percent",B)}},onBlur:V=>{V.target.value===""&&C(H,"tax_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]})]}),a.jsxs("div",{className:"grid grid-cols-6 gap-2 mt-2",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Item Delivery Date"}),a.jsx("input",{type:"date",value:J.item_delivery_date,onChange:V=>C(H,"item_delivery_date",V.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),a.jsxs("div",{className:"col-span-3",children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Notes"}),a.jsx("input",{type:"text",value:J.notes,onChange:V=>C(H,"notes",V.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),a.jsxs("div",{className:"flex items-end justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.lineTotal")}),a.jsx("div",{className:"text-sm font-medium",children:X(J.line_total)})]}),a.jsx("button",{type:"button",onClick:()=>E(H),className:"text-red-600 hover:text-red-800",children:a.jsx(nn,{className:"w-4 h-4"})})]})]})]},H))})]}),a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{children:[s("sales.subtotal"),":"]}),a.jsx("span",{className:"font-medium",children:X(O)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{children:[s("sales.tax"),":"]}),a.jsx("span",{className:"font-medium",children:X(M)})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[a.jsxs("span",{children:[s("salesOrders.grandTotal"),":"]}),a.jsx("span",{children:X(P)})]})]})}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",disabled:h,children:s("common.cancel")}),!(e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status))&&a.jsx("button",{type:"button",onClick:J=>F(J,!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",disabled:h,children:s(h?"common.loading":"salesOrders.saveAsDraft")}),a.jsx("button",{type:"button",onClick:J=>F(J,!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:h,children:h?`${s("common.submit")}...`:e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status)?"Submit for Re-Approval":s("salesOrders.submitForApproval")})]})]})}function ufe({salesOrder:e,items:t,onClose:r}){const n=W.useRef(null),{t:s,language:i}=kn(),o=e.currency||"IDR",l=o==="IDR"?"Rp":o==="USD"?"$":o,c=p=>p==null?`${l} 0`:o==="IDR"?`${p.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`:`${l} ${p.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,u=p=>{const g=new Date(p),y=i==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],x=g.getDate(),w=y[g.getMonth()],N=g.getFullYear();return`${x} ${w} ${N}`},d=p=>i==="id"?h(p):f(p),h=p=>{if(p===0)return"Nol";const g=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],y=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],x=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],w=N=>{if(N===0)return"";if(N<10)return g[N];if(N>=10&&N<20)return y[N-10];if(N<100){const E=Math.floor(N/10),S=N%10;return x[E]+(S>0?" "+g[S]:"")}const _=Math.floor(N/100),C=N%100;return(_===1?"Seratus":g[_]+" Ratus")+(C>0?" "+w(C):"")};if(p<1e3)return w(p);if(p<1e6){const N=Math.floor(p/1e3),_=p%1e3;return(N===1?"Seribu":w(N)+" Ribu")+(_>0?" "+w(_):"")}if(p<1e9){const N=Math.floor(p/1e6),_=p%1e6,C=w(N)+" Juta",j=_>=1e3?(Math.floor(_/1e3)===1?"Seribu":w(Math.floor(_/1e3))+" Ribu")+(_%1e3>0?" "+w(_%1e3):""):_>0?w(_):"";return C+(j?" "+j:"")}return p.toString()},f=p=>{if(p===0)return"Zero";const g=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],y=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],x=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],w=N=>{if(N===0)return"";if(N<10)return g[N];if(N>=10&&N<20)return y[N-10];if(N<100){const j=Math.floor(N/10),E=N%10;return x[j]+(E>0?" "+g[E]:"")}const _=Math.floor(N/100),C=N%100;return g[_]+" Hundred"+(C>0?" "+w(C):"")};if(p<1e3)return w(p);if(p<1e6){const N=Math.floor(p/1e3),_=p%1e3;return w(N)+" Thousand"+(_>0?" "+w(_):"")}if(p<1e9){const N=Math.floor(p/1e6),_=p%1e6,C=_>=1e3?w(Math.floor(_/1e3))+" Thousand"+(_%1e3>0?" "+w(_%1e3):""):_>0?w(_):"";return w(N)+" Million"+(C?" "+C:"")}return p.toString()},A=()=>{window.print()},b=async()=>{if(n.current)try{const p=await td(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:E=>{const S=E.getElementById("proforma-print-content");S&&(S.style.width="210mm")}}),g=p.toDataURL("image/png",1),y=new Lt("p","mm","a4"),x=y.internal.pageSize.getWidth(),w=y.internal.pageSize.getHeight(),N=p.width,_=p.height,C=x/N,j=_*C;if(j>w){let E=0,S=j;for(;S>0;)y.addImage(g,"PNG",0,E,x,j),S-=w,E-=w,S>0&&y.addPage()}else y.addImage(g,"PNG",0,0,x,j);y.save(`Proforma-Invoice-${e.so_number}.pdf`)}catch(p){console.error("Error generating PDF:",p),alert("Failed to generate PDF. Please try again.")}},m=e.customers,v=t.some(p=>(p.discount_amount||0)>0);return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[a.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:a.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[a.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[i==="id"?"Faktur Proforma":"Proforma Invoice"," ",e.so_number]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:A,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(QA,{className:"h-4 w-4"}),i==="id"?"Cetak":"Print"]}),a.jsxs("button",{onClick:b,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[a.jsx(Ai,{className:"h-4 w-4"}),"PDF"]}),a.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:a.jsx(Kr,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{id:"proforma-print-content",ref:n,className:"p-8",children:[a.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[a.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:a.jsxs("g",{children:[a.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),a.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),a.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:i==="id"?"FAKTUR PROFORMA":"PROFORMA INVOICE"})})]}),a.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No izin PBF"}),a.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),a.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),a.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Company Name:"}),a.jsxs("span",{className:"font-semibold",children:[" ",(m==null?void 0:m.company_name)||""]})]}),a.jsxs("div",{className:"pt-1 flex",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),a.jsxs("div",{children:[a.jsx("p",{children:(m==null?void 0:m.address)||""}),a.jsx("p",{children:(m==null?void 0:m.city)||""})]})]}),a.jsxs("div",{className:"flex pt-1",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),a.jsx("span",{children:(m==null?void 0:m.phone)||""})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),a.jsx("span",{children:(m==null?void 0:m.npwp)||""})]})]}),a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"220px"},children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"SO Number:"}),a.jsx("span",{className:"ml-2",children:e.so_number})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"SO Date:"}),a.jsx("span",{className:"ml-2",children:u(e.so_date)})]}),a.jsxs("div",{className:"pt-1",children:[a.jsx("span",{className:"font-bold",children:"Customer PO No:"}),a.jsx("span",{className:"ml-2",children:e.customer_po_number})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Customer PO Date:"}),a.jsx("span",{className:"ml-2",children:u(e.customer_po_date)})]}),e.expected_delivery_date&&a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Expected Delivery:"}),a.jsx("span",{className:"ml-2",children:u(e.expected_delivery_date)})]})]})]})}),a.jsx("div",{children:a.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),a.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Total Qty"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),a.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1 ",children:i==="id"?`Unit Price (${o})`:`Unit Price (${o})`}),v&&a.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Discount"}),a.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:i==="id"?`Sub Total (${o})`:`Sub Total (${o})`})]})}),a.jsxs("tbody",{children:[t.map((p,g)=>{var _,C;const y=p.quantity||0,x=p.unit_price||0,w=p.discount_amount||0,N=y*x-w;return a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:g+1}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((_=p.products)==null?void 0:_.product_name)||"Unknown Product"}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:y.toLocaleString()}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((C=p.products)==null?void 0:C.unit)||"Kg"}),a.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1 ",children:c(x)}),v&&a.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:c(w)}),a.jsx("td",{className:"p-1.5 text-right print:p-1",children:c(N)})]},p.id||g)}),t.length<2&&Array.from({length:2-t.length}).map((p,g)=>a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),v&&a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${g}`))]})]})}),a.jsxs("div",{className:"border-2 border-black border-t-0",children:[a.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[a.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[a.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:i==="id"?"Amount In words:":"Amount in words:"}),a.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:[o," ",d(Math.round(e.total_amount))," ",o==="IDR"?"RUPIAH":o==="USD"?"DOLLARS":""]})]}),a.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[a.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"Sub Total"}),a.jsx("span",{className:"font-bold",children:c(e.subtotal_amount)})]}),a.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),a.jsx("span",{className:"font-bold",children:c(e.tax_amount)})]}),a.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"Grand Total"}),a.jsx("span",{className:"font-bold text-sm print:text-xs",children:c(e.total_amount)})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[a.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[a.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Bank Details:"}),a.jsxs("div",{className:"space-y-0.5 print:space-y-0",children:[a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Bank Name"}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{children:"BCA"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Branch"}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{children:"Sunter Mall, Jakarta"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account Name"}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{className:"whitespace-nowrap",children:"PT. Shubham Anzen Pharma Jaya"})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account No."}),a.jsx("span",{className:"mr-2",children:":"}),a.jsx("span",{children:"0930 2010 14 (IDR)"})]})]})]}),a.jsxs("div",{className:"p-3 print:p-2",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),a.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),e.notes&&a.jsx("div",{className:"border-2 border-black border-t-0 p-2 print:p-1.5",children:a.jsxs("p",{className:"text-xs print:text-[10px]",children:[a.jsx("span",{className:"font-bold",children:"Notes: "}),a.jsx("span",{children:e.notes})]})}),a.jsx("div",{className:"border-2 border-black border-t-0 p-2.5 print:p-2",children:a.jsx("p",{className:"text-xs font-semibold text-center print:text-[10px]",children:i==="id"?"Ini adalah Faktur Proforma dan bukan tagihan resmi. Faktur resmi akan diterbitkan setelah pengiriman barang.":"This is a Proforma Invoice and not an official bill. Official invoice will be issued after delivery of goods."})})]})]})}),a.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #proforma-print-content,
          #proforma-print-content * {
            visibility: visible;
          }

          #proforma-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #proforma-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function dfe(){var Ve,lt;const{user:e,profile:t}=jr(),{t:r}=kn(),[n,s]=W.useState("active"),[i,o]=W.useState([]),[l,c]=W.useState([]),[u,d]=W.useState([]),[h,f]=W.useState(!0),[A,b]=W.useState(""),[m,v]=W.useState("all"),[p,g]=W.useState(!1),[y,x]=W.useState(!1),[w,N]=W.useState(null),[_,C]=W.useState(null),[j,E]=W.useState(!1),[S,F]=W.useState(""),[I,O]=W.useState(null),[M,P]=W.useState(!1),[X,J]=W.useState(null),[H,V]=W.useState(!1),[K,B]=W.useState(""),[L,U]=W.useState(null),[D,Q]=W.useState(!1),[z,G]=W.useState(null);W.useEffect(()=>{Z(),R()},[n]),W.useEffect(()=>{ee()},[A,m,i,n]);const Z=async()=>{try{f(!0);let pe=ae.from("sales_orders").select(`
          *,
          customers (
            id,
            company_name,
            address,
            city,
            phone,
            npwp,
            pharmacy_license,
            gst_vat_type
          ),
          sales_order_items (
            id,
            product_id,
            quantity,
            unit_price,
            discount_percent,
            discount_amount,
            tax_percent,
            tax_amount,
            line_total,
            item_delivery_date,
            notes,
            delivered_quantity,
            products (
              id,
              product_name,
              product_code,
              unit
            )
          )
        `);n==="active"?pe=pe.eq("is_archived",!1):pe=pe.eq("is_archived",!0);const{data:Fe,error:Ke}=await pe.order("created_at",{ascending:!1});if(Ke)throw Ke;o(Fe||[])}catch(pe){console.error("Error fetching sales orders:",pe.message),alert("Failed to load sales orders")}finally{f(!1)}},R=async()=>{try{const{data:pe,error:Fe}=await ae.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(Fe)throw Fe;d(pe||[])}catch(pe){console.error("Error fetching customers:",pe.message)}},le=(pe,Fe)=>{const Ke=pe.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0});return Fe==="USD"?`$ ${Ke}`:`Rp ${Ke}`},ee=()=>{let pe=i;A&&(pe=pe.filter(Fe=>{var Ke;return Fe.so_number.toLowerCase().includes(A.toLowerCase())||Fe.customer_po_number.toLowerCase().includes(A.toLowerCase())||((Ke=Fe.customers)==null?void 0:Ke.company_name.toLowerCase().includes(A.toLowerCase()))})),m!=="all"&&(pe=pe.filter(Fe=>Fe.status===m)),c(pe)},_e=pe=>{const Ke={draft:{color:"bg-gray-100 text-gray-800",label:"Draft"},pending_approval:{color:"bg-yellow-100 text-yellow-800",label:"Pending Approval"},approved:{color:"bg-green-100 text-green-800",label:"Approved"},rejected:{color:"bg-red-100 text-red-800",label:"Rejected"},stock_reserved:{color:"bg-blue-100 text-blue-800",label:"Stock Reserved"},shortage:{color:"bg-orange-100 text-orange-800",label:"Shortage"},pending_delivery:{color:"bg-purple-100 text-purple-800",label:"Pending Delivery"},partially_delivered:{color:"bg-indigo-100 text-indigo-800",label:"Partially Delivered"},delivered:{color:"bg-teal-100 text-teal-800",label:"Delivered"},closed:{color:"bg-gray-100 text-gray-800",label:"Closed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[pe]||{color:"bg-gray-100 text-gray-800",label:pe};return a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Ke.color}`,children:Ke.label})},se=async pe=>{if(confirm("Submit this sales order for approval?"))try{const{error:Fe}=await ae.from("sales_orders").update({status:"pending_approval",updated_at:new Date().toISOString()}).eq("id",pe);if(Fe)throw Fe;alert("Sales order submitted for approval successfully!"),Z()}catch(Fe){console.error("Error submitting for approval:",Fe.message),alert("Failed to submit for approval")}},te=async()=>{if(!L||!K.trim()){alert("Please enter an archive reason");return}try{const{data:{user:pe}}=await ae.auth.getUser();if(!pe)throw new Error("Not authenticated");const{error:Fe}=await ae.from("sales_orders").update({is_archived:!0,archived_at:new Date().toISOString(),archived_by:pe.id,archive_reason:K,updated_at:new Date().toISOString()}).eq("id",L);if(Fe)throw Fe;alert("Sales order archived successfully!"),V(!1),B(""),U(null),Z()}catch(pe){console.error("Error archiving order:",pe.message),alert("Failed to archive order")}},Ne=async pe=>{if(confirm("Unarchive this sales order?"))try{const{error:Fe}=await ae.from("sales_orders").update({is_archived:!1,archived_at:null,archived_by:null,archive_reason:null,updated_at:new Date().toISOString()}).eq("id",pe);if(Fe)throw Fe;alert("Sales order unarchived successfully!"),Z()}catch(Fe){console.error("Error unarchiving order:",Fe.message),alert("Failed to unarchive order")}},Se=async pe=>{const Fe=prompt("Enter cancellation reason:");if(Fe)try{const{data:{user:Ke}}=await ae.auth.getUser();if(!Ke)throw new Error("Not authenticated");const{error:Xe}=await ae.rpc("fn_cancel_sales_order",{p_so_id:pe,p_canceller_id:Ke.id,p_reason:Fe});if(Xe)throw Xe;alert("Sales order cancelled successfully!"),Z()}catch(Ke){console.error("Error cancelling order:",Ke.message),alert("Failed to cancel order")}},Ae=async pe=>{if(confirm("Are you sure you want to delete this sales order?"))try{const{error:Fe}=await ae.from("sales_orders").delete().eq("id",pe);if(Fe)throw Fe;alert("Sales order deleted successfully!"),Z()}catch(Fe){console.error("Error deleting order:",Fe.message),alert("Failed to delete order")}},ye=pe=>{N(pe),x(!0)},Le=pe=>{C(pe),g(!0)},Re=async pe=>{if(confirm("Approve this sales order? Stock will be reserved automatically."))try{const{data:{user:Fe}}=await ae.auth.getUser();if(!Fe)throw new Error("Not authenticated");const{error:Ke}=await ae.from("sales_orders").update({status:"approved",approved_by:Fe.id,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",pe);if(Ke)throw Ke;const{data:Xe,error:tt}=await ae.rpc("fn_reserve_stock_for_so_v2",{p_so_id:pe});if(tt)console.error("Error reserving stock:",tt),console.error("Supabase request failed",tt),alert("Order approved but stock reservation failed: "+tt.message);else if(Xe&&Xe.length>0){const st=Xe[0];st.success?alert(" Sales order approved and stock fully reserved!"):alert(` Order approved with stock shortage.

`+st.message+`

Import requirements have been created automatically.`)}else alert("Sales order approved!");Z()}catch(Fe){console.error("Error approving order:",Fe.message),alert("Failed to approve order")}},we=async()=>{if(!I||!S.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:pe}}=await ae.auth.getUser();if(!pe)throw new Error("Not authenticated");const{error:Fe}=await ae.from("sales_orders").update({status:"rejected",rejected_by:pe.id,rejected_at:new Date().toISOString(),rejection_reason:S,updated_at:new Date().toISOString()}).eq("id",I);if(Fe)throw Fe;alert("Sales order rejected"),E(!1),F(""),O(null),Z()}catch(pe){console.error("Error rejecting order:",pe.message),alert("Failed to reject order")}},Pe=pe=>{J(pe),P(!0)},ze={total:i.length,pending_approval:i.filter(pe=>pe.status==="pending_approval").length,stock_reserved:i.filter(pe=>pe.status==="stock_reserved").length,shortage:i.filter(pe=>pe.status==="shortage").length,delivered:i.filter(pe=>pe.status==="delivered").length};return a.jsx(Zn,{children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Orders"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer purchase orders and track delivery"})]}),a.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[a.jsx(Rr,{className:"w-5 h-5"}),"New Sales Order"]})]}),a.jsx("div",{className:"mb-6 border-b border-gray-200",children:a.jsxs("nav",{className:"flex gap-4",children:[a.jsx("button",{onClick:()=>s("active"),className:`px-4 py-2 font-medium border-b-2 transition ${n==="active"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Orders"}),a.jsx("button",{onClick:()=>s("archived"),className:`px-4 py-2 font-medium border-b-2 transition ${n==="archived"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Archived Orders"})]})}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Orders"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:ze.total})]}),a.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending Approval"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:ze.pending_approval})]}),a.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Stock Reserved"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:ze.stock_reserved})]}),a.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Shortage"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-orange-600",children:ze.shortage})]}),a.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Delivered"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:ze.delivered})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[a.jsxs("div",{className:"p-4 border-b flex gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),a.jsx("input",{type:"text",placeholder:"Search by SO number, PO number, or customer...",value:A,onChange:pe=>b(pe.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),a.jsxs("select",{value:m,onChange:pe=>v(pe.target.value),className:"border rounded-lg px-4 py-2",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"pending_approval",children:"Pending Approval"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"stock_reserved",children:"Stock Reserved"}),a.jsx("option",{value:"shortage",children:"Shortage"}),a.jsx("option",{value:"pending_delivery",children:"Pending Delivery"}),a.jsx("option",{value:"partially_delivered",children:"Partially Delivered"}),a.jsx("option",{value:"delivered",children:"Delivered"}),a.jsx("option",{value:"rejected",children:"Rejected"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Number"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PO Number"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Delivery Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Docs"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status / Approval"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):l.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"No sales orders found"})}):l.map(pe=>{var Fe;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:pe.so_number})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"text-sm text-gray-900",children:(Fe=pe.customers)==null?void 0:Fe.company_name})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-900",children:pe.customer_po_number}),a.jsx("div",{className:"text-xs text-gray-500",children:new Date(pe.customer_po_date).toLocaleDateString()})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(pe.so_date).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:pe.expected_delivery_date?new Date(pe.expected_delivery_date).toLocaleDateString():"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:le(pe.total_amount,pe.currency||"IDR")}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"flex items-center justify-center",children:pe.customer_po_file_url?a.jsxs("button",{onClick:()=>Pe(pe.customer_po_file_url),className:"inline-flex items-center gap-1 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg border border-blue-200 hover:bg-blue-100 transition",title:"View Customer PO",children:[a.jsx(sr,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"1"})]}):a.jsx("span",{className:"text-gray-400 text-sm",children:"-"})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_e(pe.status),pe.status==="pending_approval"&&(t==null?void 0:t.role)==="admin"&&a.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[a.jsx("button",{onClick:Ke=>{Ke.stopPropagation(),Re(pe.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Order",children:a.jsx(yn,{className:"w-6 h-6 text-green-600"})}),a.jsx("button",{onClick:Ke=>{Ke.stopPropagation(),O(pe.id),E(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Order",children:a.jsx(un,{className:"w-6 h-6 text-red-600"})})]}),pe.status==="approved"&&a.jsx(yn,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),pe.status==="rejected"&&a.jsx(un,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>ye(pe),className:"text-blue-600 hover:text-blue-800",title:"View",children:a.jsx(Kc,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>{G(pe),Q(!0)},className:"text-purple-600 hover:text-purple-800",title:"View Proforma Invoice",children:a.jsx(dR,{className:"w-4 h-4"})}),!["delivered","closed","cancelled","partially_delivered","pending_delivery"].includes(pe.status)&&a.jsx("button",{onClick:()=>Le(pe),className:"text-indigo-600 hover:text-indigo-800",title:"Edit",children:a.jsx(Rs,{className:"w-4 h-4"})}),pe.status==="draft"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>se(pe.id),className:"text-green-600 hover:text-green-800",title:"Submit for Approval",children:a.jsx(E4,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>Ae(pe.id),className:"text-red-600 hover:text-red-800",title:"Delete",children:a.jsx(nn,{className:"w-4 h-4"})})]}),!["cancelled","closed","delivered","rejected"].includes(pe.status)&&n==="active"&&a.jsx("button",{onClick:()=>Se(pe.id),className:"text-orange-600 hover:text-orange-800",title:"Cancel",children:a.jsx(un,{className:"w-4 h-4"})}),n==="active"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&["delivered","cancelled"].includes(pe.status)&&a.jsx("button",{onClick:()=>{U(pe.id),V(!0)},className:"text-gray-600 hover:text-gray-800",title:"Archive Order",children:a.jsx(sr,{className:"w-4 h-4"})}),n==="archived"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&a.jsx("button",{onClick:()=>Ne(pe.id),className:"text-green-600 hover:text-green-800",title:"Unarchive Order",children:a.jsx(E4,{className:"w-4 h-4"})})]})})]},pe.id)})})]})})]}),p&&a.jsx(qt,{isOpen:p,onClose:()=>{g(!1),C(null)},title:_?"Edit Sales Order":"Create Sales Order",maxWidth:"max-w-6xl",children:a.jsx(cfe,{existingOrder:_||void 0,onSuccess:()=>{g(!1),C(null),Z()},onCancel:()=>{g(!1),C(null)}})}),y&&w&&a.jsx(qt,{isOpen:y,onClose:()=>{x(!1),N(null)},title:`Sales Order: ${w.so_number}`,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer"}),a.jsx("p",{className:"text-sm text-gray-900",children:(Ve=w.customers)==null?void 0:Ve.company_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),a.jsx("div",{className:"mt-1",children:_e(w.status)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer PO Number"}),a.jsx("p",{className:"text-sm text-gray-900",children:w.customer_po_number})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Customer PO Date"}),a.jsx("p",{className:"text-sm text-gray-900",children:new Date(w.customer_po_date).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"SO Date"}),a.jsx("p",{className:"text-sm text-gray-900",children:new Date(w.so_date).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Expected Delivery"}),a.jsx("p",{className:"text-sm text-gray-900",children:w.expected_delivery_date?new Date(w.expected_delivery_date).toLocaleDateString():"Not specified"})]})]}),w.notes&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-900 mt-1",children:w.notes})]}),w.customer_po_file_url&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Customer PO Attachment"}),a.jsxs("a",{href:w.customer_po_file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-lg border border-blue-200 hover:bg-blue-100 transition",children:[a.jsx(fo,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"View Customer PO"}),a.jsx(Og,{className:"w-4 h-4"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Items"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Qty"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Price"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Total"})]})}),a.jsx("tbody",{children:(lt=w.sales_order_items)==null?void 0:lt.map(pe=>{var Fe;return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-4 py-2",children:(Fe=pe.products)==null?void 0:Fe.product_name}),a.jsx("td",{className:"px-4 py-2 text-right",children:pe.quantity}),a.jsx("td",{className:"px-4 py-2 text-right",children:le(pe.unit_price,w.currency||"IDR")}),a.jsx("td",{className:"px-4 py-2 text-right",children:le(pe.line_total,w.currency||"IDR")})]},pe.id)})}),a.jsx("tfoot",{className:"bg-gray-50 font-medium",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:3,className:"px-4 py-2 text-right",children:"Total:"}),a.jsx("td",{className:"px-4 py-2 text-right",children:le(w.total_amount,w.currency||"IDR")})]})})]})]}),w.rejection_reason&&a.jsxs("div",{className:"bg-red-50 p-3 rounded",children:[a.jsx("label",{className:"text-sm font-medium text-red-700",children:"Rejection Reason"}),a.jsx("p",{className:"text-sm text-red-900 mt-1",children:w.rejection_reason})]})]})}),j&&a.jsx(qt,{isOpen:j,onClose:()=>{E(!1),F(""),O(null)},title:"Reject Sales Order",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:S,onChange:pe=>F(pe.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this sales order..."})]}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{onClick:()=>{E(!1),F(""),O(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:we,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!S.trim(),children:"Reject Order"})]})]})}),H&&a.jsx(qt,{isOpen:H,onClose:()=>{V(!1),B(""),U(null)},title:"Archive Sales Order",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Archive Reason ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:K,onChange:pe=>B(pe.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter reason for archiving this sales order (e.g., Completed and delivered, Cancelled by customer)..."})]}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[a.jsx("button",{onClick:()=>{V(!1),B(""),U(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:te,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:!K.trim(),children:"Archive Order"})]})]})}),M&&X&&a.jsx(qt,{isOpen:M,onClose:()=>{P(!1),J(null)},title:"Customer Purchase Order",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("a",{href:X,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[a.jsx(sr,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Customer Purchase Order"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click to open in new tab"})]}),a.jsx(Og,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),a.jsx("div",{className:"text-xs text-gray-500 text-center pt-2",children:"Document opens in a new browser tab"})]})}),D&&z&&a.jsx(ufe,{salesOrder:z,items:z.sales_order_items||[],onClose:()=>{Q(!1),G(null)}})]})})}function Afe({requirements:e,onRefresh:t,canEdit:r}){const[n,s]=W.useState(null),[i,o]=W.useState(""),l=W.useRef(null),c=[{value:"high",label:"High",color:"text-red-600",bgColor:"bg-red-50"},{value:"medium",label:"Medium",color:"text-orange-600",bgColor:"bg-orange-50"},{value:"low",label:"Low",color:"text-green-600",bgColor:"bg-green-50"}],u=[{value:"pending",label:"Pending",color:"text-gray-600",bgColor:"bg-gray-50"},{value:"ordered",label:"Ordered",color:"text-blue-600",bgColor:"bg-blue-50"},{value:"partially_received",label:"Partially Received",color:"text-yellow-600",bgColor:"bg-yellow-50"},{value:"received",label:"Received",color:"text-green-600",bgColor:"bg-green-50"},{value:"cancelled",label:"Cancelled",color:"text-red-600",bgColor:"bg-red-50"}];W.useEffect(()=>{n&&l.current&&l.current.focus()},[n]);const d=(g,y,x)=>{if(console.log("startEditing called:",{id:g,field:y,currentValue:x,canEdit:r}),!r){console.log("Cannot edit - canEdit is false");return}s({id:g,field:y}),o(x||""),console.log("Editing cell set:",{id:g,field:y})},h=()=>{s(null),o("")},f=async(g,y)=>{try{const x={};y==="required_quantity"||y==="shortage_quantity"||y==="lead_time_days"?x[y]=Number(i):x[y]=i;const{error:w}=await ae.from("import_requirements").update(x).eq("id",g);if(w)throw w;t(),h()}catch(x){console.error("Error updating import requirement:",x),alert("Failed to update")}},A=(g,y,x)=>{g.key==="Enter"?f(y,x):g.key==="Escape"&&h()},b=g=>c.find(x=>x.value===g)||c[1],m=g=>u.find(x=>x.value===g)||u[0],v=g=>{const y=new Date,w=new Date(g).getTime()-y.getTime();return Math.ceil(w/(1e3*60*60*24))},p=g=>g<0?"text-red-700 font-bold":g<=7?"text-red-600 font-semibold":g<=30?"text-orange-600":"text-gray-600";return a.jsxs("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:[a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Product"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Sales Order"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Required Qty"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Shortage Qty"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Delivery Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Priority"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Lead Time"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Notes"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(g=>{var N,_,C,j;const y=v(g.required_delivery_date),x=b(g.priority),w=m(g.status);return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:(N=g.products)==null?void 0:N.product_name}),a.jsx("div",{className:"text-xs text-gray-500",children:(_=g.products)==null?void 0:_.product_code})]}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(C=g.sales_orders)==null?void 0:C.so_number}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(j=g.customers)==null?void 0:j.company_name}),a.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===g.id&&n.field==="required_quantity"?a.jsx("input",{ref:l,type:"number",value:i,onChange:E=>o(E.target.value),onBlur:()=>f(g.id,"required_quantity"),onKeyDown:E=>A(E,g.id,"required_quantity"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):a.jsx("div",{onClick:()=>d(g.id,"required_quantity",g.required_quantity),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:g.required_quantity.toLocaleString()})}),a.jsx("td",{className:"px-4 py-3 text-sm text-red-600 font-semibold",children:g.shortage_quantity.toLocaleString()}),a.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===g.id&&n.field==="required_delivery_date"?a.jsx("input",{ref:l,type:"date",value:i,onChange:E=>o(E.target.value),onBlur:()=>f(g.id,"required_delivery_date"),onKeyDown:E=>A(E,g.id,"required_delivery_date"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):a.jsxs("div",{onClick:()=>d(g.id,"required_delivery_date",g.required_delivery_date),className:`${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[a.jsx("div",{className:"text-sm",children:new Date(g.required_delivery_date).toLocaleDateString()}),a.jsx("div",{className:`text-xs ${p(y)}`,children:y<0?`${Math.abs(y)} days overdue`:`${y} days`})]})}),a.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===g.id&&n.field==="priority"?a.jsx("select",{ref:l,value:i,onChange:E=>o(E.target.value),onBlur:()=>f(g.id,"priority"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))}):a.jsx("div",{onClick:()=>d(g.id,"priority",g.priority),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${x.color} ${x.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:x.label})}),a.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===g.id&&n.field==="status"?a.jsx("select",{ref:l,value:i,onChange:E=>o(E.target.value),onBlur:()=>f(g.id,"status"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(E=>a.jsx("option",{value:E.value,children:E.label},E.value))}):a.jsx("div",{onClick:()=>d(g.id,"status",g.status),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${w.color} ${w.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:w.label})}),a.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===g.id&&n.field==="lead_time_days"?a.jsx("input",{ref:l,type:"number",value:i,onChange:E=>o(E.target.value),onBlur:()=>f(g.id,"lead_time_days"),onKeyDown:E=>A(E,g.id,"lead_time_days"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):a.jsxs("div",{onClick:()=>d(g.id,"lead_time_days",g.lead_time_days),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[g.lead_time_days," days"]})}),a.jsx("td",{className:"px-4 py-3",children:(n==null?void 0:n.id)===g.id&&n.field==="notes"?a.jsx("textarea",{ref:l,value:i,onChange:E=>o(E.target.value),onBlur:()=>f(g.id,"notes"),rows:2,className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):a.jsx("div",{onClick:()=>d(g.id,"notes",g.notes),className:`text-sm text-gray-600 max-w-xs truncate ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,title:g.notes||"Click to add notes",children:g.notes||"-"})})]},g.id)})})]}),e.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No import requirements found"})]})}function ffe(){const{profile:e}=jr(),[t,r]=W.useState([]),[n,s]=W.useState({}),[i,o]=W.useState(!0),[l,c]=W.useState("pending"),[u,d]=W.useState("all"),h=!0;W.useEffect(()=>{f()},[l]);const f=async()=>{try{o(!0);let v=ae.from("import_requirements").select(`
          *,
          products (product_name, product_code),
          sales_orders (so_number),
          customers (company_name)
        `).order("priority",{ascending:!0}).order("required_delivery_date",{ascending:!0});l!=="all"&&(v=v.eq("status",l));const{data:p,error:g}=await v;if(g)throw g;r(p||[]);const y=[...new Set(p==null?void 0:p.map(x=>x.product_id))];y.length>0&&await A(y)}catch(v){console.error("Error fetching import requirements:",v.message),alert("Failed to load import requirements")}finally{o(!1)}},A=async v=>{try{const p={};for(const g of v){const{data:y}=await ae.from("batches").select("current_stock").eq("product_id",g),x=(y==null?void 0:y.reduce((_,C)=>_+Number(C.current_stock),0))||0,{data:w}=await ae.from("stock_reservations").select("reserved_quantity").eq("product_id",g).eq("status","active"),N=(w==null?void 0:w.reduce((_,C)=>_+Number(C.reserved_quantity),0))||0;p[g]={product_id:g,total_stock:x,reserved_stock:N,free_stock:x-N}}s(p)}catch(p){console.error("Error fetching stock info:",p.message)}},b=t.filter(v=>u==="all"?!0:v.priority===u),m={total:t.length,high_priority:t.filter(v=>v.priority==="high"&&v.status==="pending").length,pending:t.filter(v=>v.status==="pending").length,ordered:t.filter(v=>v.status==="ordered").length};return a.jsx(Zn,{children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Requirements"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage product import needs based on stock shortages"})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6",children:[a.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:a.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[a.jsx(Ps,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-600 flex-shrink-0"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Requirements"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:m.total})]})]})}),a.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:a.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[a.jsx(as,{className:"w-5 h-5 md:w-6 md:h-6 text-red-600 flex-shrink-0"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"High Priority"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-red-600",children:m.high_priority})]})]})}),a.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:a.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[a.jsx(Na,{className:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 flex-shrink-0"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:m.pending})]})]})}),a.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:a.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[a.jsx(ui,{className:"w-5 h-5 md:w-6 md:h-6 text-green-600 flex-shrink-0"}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Ordered"}),a.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:m.ordered})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[a.jsxs("div",{className:"p-4 border-b flex gap-4",children:[a.jsxs("select",{value:l,onChange:v=>c(v.target.value),className:"border rounded-lg px-4 py-2",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"ordered",children:"Ordered"}),a.jsx("option",{value:"partially_received",children:"Partially Received"}),a.jsx("option",{value:"received",children:"Received"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]}),a.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"border rounded-lg px-4 py-2",children:[a.jsx("option",{value:"all",children:"All Priorities"}),a.jsx("option",{value:"high",children:"High Priority"}),a.jsx("option",{value:"medium",children:"Medium Priority"}),a.jsx("option",{value:"low",children:"Low Priority"})]}),a.jsxs("div",{className:"ml-auto text-sm text-gray-600 flex items-center gap-2",children:[a.jsx(Ps,{className:"w-4 h-4"}),"Click any cell to edit"]})]}),i?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):a.jsx(Afe,{requirements:b,onRefresh:f,canEdit:h})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(as,{className:"w-5 h-5 text-blue-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"About Import Requirements"}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Import requirements are automatically generated when sales orders are approved but stock is insufficient. The system tracks shortages and helps procurement plan imports based on customer delivery dates and priorities."})]})]})})]})})}function hfe({creditNote:e,items:t,onClose:r}){const n=W.useRef(null),{language:s}=kn(),i=A=>A==null?"Rp 0":`${A.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})}`,o=A=>{const b=new Date(A),m=s==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v=b.getDate(),p=m[b.getMonth()],g=b.getFullYear();return`${v} ${p} ${g}`},l=A=>s==="id"?c(A):u(A),c=A=>{if(A===0)return"Nol";const b=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],m=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],v=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],p=g=>{if(g===0)return"";if(g<10)return b[g];if(g>=10&&g<20)return m[g-10];if(g<100){const N=Math.floor(g/10),_=g%10;return v[N]+(_>0?" "+b[_]:"")}const y=Math.floor(g/100),x=g%100;return(y===1?"Seratus":b[y]+" Ratus")+(x>0?" "+p(x):"")};if(A<1e3)return p(A);if(A<1e6){const g=Math.floor(A/1e3),y=A%1e3;return(g===1?"Seribu":p(g)+" Ribu")+(y>0?" "+p(y):"")}if(A<1e9){const g=Math.floor(A/1e6),y=A%1e6,x=p(g)+" Juta",w=y>=1e3?(Math.floor(y/1e3)===1?"Seribu":p(Math.floor(y/1e3))+" Ribu")+(y%1e3>0?" "+p(y%1e3):""):y>0?p(y):"";return x+(w?" "+w:"")}return A.toString()},u=A=>{if(A===0)return"Zero";const b=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],m=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],v=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],p=g=>{if(g===0)return"";if(g<10)return b[g];if(g>=10&&g<20)return m[g-10];if(g<100){const w=Math.floor(g/10),N=g%10;return v[w]+(N>0?" "+b[N]:"")}const y=Math.floor(g/100),x=g%100;return b[y]+" Hundred"+(x>0?" "+p(x):"")};if(A<1e3)return p(A);if(A<1e6){const g=Math.floor(A/1e3),y=A%1e3;return p(g)+" Thousand"+(y>0?" "+p(y):"")}if(A<1e9){const g=Math.floor(A/1e6),y=A%1e6,x=y>=1e3?p(Math.floor(y/1e3))+" Thousand"+(y%1e3>0?" "+p(y%1e3):""):y>0?p(y):"";return p(g)+" Million"+(x?" "+x:"")}return A.toString()},d=()=>{window.print()},h=async()=>{if(n.current)try{const A=await td(n.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:n.current.scrollWidth,windowHeight:n.current.scrollHeight,onclone:N=>{const _=N.getElementById("credit-note-print-content");_&&(_.style.width="210mm")}}),b=A.toDataURL("image/png",1),m=new Lt("p","mm","a4"),v=m.internal.pageSize.getWidth(),p=m.internal.pageSize.getHeight(),g=A.width,y=A.height,x=v/g,w=y*x;if(w>p){let N=0,_=w;for(;_>0;)m.addImage(b,"PNG",0,N,v,w),_-=p,N-=p,_>0&&m.addPage()}else m.addImage(b,"PNG",0,0,v,w);m.save(`CreditNote-${e.credit_note_number}.pdf`)}catch(A){console.error("Error generating PDF:",A),alert("Failed to generate PDF. Please try again.")}},f=e.customers;return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[a.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:a.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[a.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[s==="id"?"Nota Kredit":"Credit Note"," ",e.credit_note_number]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:d,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(QA,{className:"h-4 w-4"}),s==="id"?"Cetak":"Print"]}),a.jsxs("button",{onClick:h,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[a.jsx(Ai,{className:"h-4 w-4"}),"PDF"]}),a.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:a.jsx(Kr,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{id:"credit-note-print-content",ref:n,className:"p-8",children:[a.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[a.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:a.jsxs("g",{children:[a.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),a.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),a.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),a.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("h2",{className:"text-3xl font-bold text-red-600 print:text-2xl",children:"CREDIT NOTE"})})]}),a.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No izin PBF"}),a.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),a.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),a.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Company Name:"}),a.jsxs("span",{className:"font-semibold",children:[" ",(f==null?void 0:f.company_name)||""]})]}),a.jsxs("div",{className:"pt-1 flex",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),a.jsxs("div",{children:[a.jsx("p",{children:(f==null?void 0:f.address)||""}),a.jsx("p",{children:(f==null?void 0:f.city)||""})]})]}),a.jsxs("div",{className:"flex pt-1",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),a.jsx("span",{children:(f==null?void 0:f.phone)||""})]}),a.jsxs("div",{className:"flex",children:[a.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),a.jsx("span",{children:(f==null?void 0:f.npwp)||""})]})]}),a.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"200px"},children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Credit Note No:"}),a.jsx("span",{className:"ml-2",children:e.credit_note_number})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-bold",children:"Date:"}),a.jsx("span",{className:"ml-2",children:o(e.credit_note_date)})]}),e.original_invoice_number&&a.jsxs("div",{className:"pt-1",children:[a.jsx("span",{className:"font-bold",children:"Original Invoice:"}),a.jsx("span",{className:"ml-2",children:e.original_invoice_number})]})]})]})}),a.jsx("div",{children:a.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),a.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),a.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Quantity"}),a.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price (IDR)"}),a.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Sub Total (IDR)"})]})}),a.jsxs("tbody",{children:[t.map((A,b)=>{var g,y;const m=A.quantity||0,v=A.unit_price||0,p=m*v;return a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:b+1}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((g=A.products)==null?void 0:g.product_name)||"Unknown Product"}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((y=A.batches)==null?void 0:y.batch_number)||"N/A"}),a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:m.toLocaleString()}),a.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:i(v)}),a.jsx("td",{className:"p-1.5 text-right print:p-1",children:i(p)})]},A.id||b)}),t.length<2&&Array.from({length:2-t.length}).map((A,b)=>a.jsxs("tr",{className:"border-b border-black",children:[a.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),a.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${b}`))]})]})}),a.jsxs("div",{className:"border-2 border-black border-t-0",children:[a.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[a.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[a.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:s==="id"?"Amount In words:":"Amount in words:"}),a.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:["IDR ",l(Math.round(e.total_amount))," RUPIAH"]})]}),a.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[a.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"Sub Total"}),a.jsx("span",{className:"font-bold",children:i(e.subtotal)})]}),a.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),a.jsx("span",{className:"font-bold",children:i(e.tax_amount)})]}),a.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[a.jsx("span",{className:"font-bold",children:"Total Credit"}),a.jsx("span",{className:"font-bold text-sm text-red-600 print:text-xs",children:i(e.total_amount)})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[a.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[a.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Reason for Credit:"}),a.jsx("p",{className:"text-sm",children:e.reason})]}),a.jsxs("div",{className:"p-3 print:p-2",children:[a.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),a.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),a.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),e.notes&&a.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:a.jsxs("p",{className:"text-xs print:text-[10px]",children:[a.jsx("span",{className:"font-bold",children:"Notes: "}),a.jsx("span",{children:e.notes})]})})]})]})}),a.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #credit-note-print-content,
          #credit-note-print-content * {
            visibility: visible;
          }

          #credit-note-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #credit-note-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function pfe(){const{t:e}=kn(),{user:t,profile:r}=jr(),[n,s]=W.useState([]),[i,o]=W.useState(!0),[l,c]=W.useState(!1),[u,d]=W.useState(!1),[h,f]=W.useState(null),[A,b]=W.useState([]),[m,v]=W.useState([]),[p,g]=W.useState([]),[y,x]=W.useState([]),[w,N]=W.useState([]),[_,C]=W.useState({credit_note_number:"",credit_note_date:new Date().toISOString().split("T")[0],customer_id:"",original_invoice_id:"",original_invoice_number:"",reason:"",notes:"",currency:"IDR"}),[j,E]=W.useState([{product_id:"",batch_id:"",quantity:0,unit_price:0}]);W.useEffect(()=>{S()},[]);const S=async()=>{o(!0),await F(),await I(),await O(),o(!1)},F=async()=>{try{const{data:se,error:te}=await ae.from("credit_notes").select(`
          *,
          customers(company_name, address, city, phone, npwp, pharmacy_license)
        `).order("created_at",{ascending:!1});if(te)throw te;s(se||[])}catch(se){console.error("Error loading credit notes:",se)}},I=async()=>{try{const{data:se,error:te}=await ae.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(te)throw te;v(se||[])}catch(se){console.error("Error loading customers:",se)}},O=async()=>{try{const{data:se,error:te}=await ae.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(te)throw te;g(se||[])}catch(se){console.error("Error loading products:",se)}},M=async se=>{try{const{data:te,error:Ne}=await ae.from("batches").select("id, batch_number, product_id, current_stock").eq("product_id",se).eq("is_active",!0).order("batch_number");if(Ne)throw Ne;x(te||[])}catch(te){console.error("Error loading batches:",te)}},P=async se=>{f(se);try{const{data:te,error:Ne}=await ae.from("credit_note_items").select(`
          *,
          products(product_name, product_code),
          batches(batch_number)
        `).eq("credit_note_id",se.id);if(Ne)throw Ne;b(te||[]),d(!0)}catch(te){console.error("Error loading credit note items:",te)}},X=async se=>{try{const{data:te,error:Ne}=await ae.from("sales_invoices").select("id, invoice_number, invoice_date, total_amount").eq("customer_id",se).order("invoice_date",{ascending:!1});if(Ne)throw Ne;N(te||[])}catch(te){console.error("Error loading invoices:",te)}},J=se=>{C({..._,customer_id:se,original_invoice_id:"",original_invoice_number:""}),se?X(se):N([])},H=async se=>{const te=w.find(Ne=>Ne.id===se);C({..._,original_invoice_id:se,original_invoice_number:(te==null?void 0:te.invoice_number)||""}),se?await V(se):E([{product_id:"",batch_id:"",quantity:0,unit_price:0}])},V=async se=>{try{const{data:te,error:Ne}=await ae.from("sales_invoice_items").select(`
          product_id,
          batch_id,
          quantity,
          unit_price,
          products(product_name, product_code),
          batches(batch_number, current_stock)
        `).eq("invoice_id",se);if(Ne)throw Ne;if(te&&te.length>0){const Se=te.map(Ae=>({product_id:Ae.product_id,batch_id:Ae.batch_id||"",quantity:Ae.quantity,unit_price:Ae.unit_price}));E(Se)}}catch(te){console.error("Error loading invoice items:",te)}},K=()=>{E([...j,{product_id:"",batch_id:"",quantity:0,unit_price:0}])},B=se=>{j.length>1&&E(j.filter((te,Ne)=>Ne!==se))},L=(se,te,Ne)=>{const Se=[...j];Se[se]={...Se[se],[te]:Ne},te==="product_id"&&(M(Ne),Se[se].batch_id=""),E(Se)},U=()=>{const se=j.reduce((Se,Ae)=>Se+Ae.quantity*Ae.unit_price,0),te=se*.11,Ne=se+te;return{subtotal:se,tax_amount:te,total_amount:Ne}},D=async se=>{if(se.preventDefault(),!_.customer_id||!_.reason||j.length===0){alert("Please complete all required fields");return}if(j.some(Ne=>!Ne.product_id||!Ne.batch_id||Ne.quantity<=0||Ne.unit_price<=0)){alert("Please complete all item details");return}try{const Ne=U(),{data:Se,error:Ae}=await ae.from("credit_notes").insert({..._,...Ne,created_by:t==null?void 0:t.id}).select().single();if(Ae)throw Ae;const ye=j.map(Re=>({...Re,credit_note_id:Se.id})),{error:Le}=await ae.from("credit_note_items").insert(ye);if(Le)throw Le;alert("Credit note created successfully. Stock has been added back to inventory."),c(!1),Z(),S()}catch(Ne){console.error("Error creating credit note:",Ne),alert(Ne.message||"Failed to create credit note. Please try again.")}},Q=async se=>{if(confirm("Approve this credit note? Stock will be adjusted accordingly."))try{const{error:te}=await ae.from("credit_notes").update({status:"approved",approved_by:t==null?void 0:t.id}).eq("id",se);if(te)throw te;alert("Credit note approved successfully"),S()}catch(te){console.error("Error approving credit note:",te),alert(te.message||"Failed to approve credit note")}},z=async se=>{const te=prompt("Enter reason for rejection:");if(te)try{const{error:Ne}=await ae.from("credit_notes").update({status:"rejected",approved_by:t==null?void 0:t.id,notes:te}).eq("id",se);if(Ne)throw Ne;alert("Credit note rejected"),S()}catch(Ne){console.error("Error rejecting credit note:",Ne),alert(Ne.message||"Failed to reject credit note")}},G=async se=>{if(confirm("Are you sure you want to delete this credit note? This will reverse the stock adjustment."))try{const{error:te}=await ae.from("credit_notes").delete().eq("id",se);if(te)throw te;alert("Credit note deleted successfully"),S()}catch(te){console.error("Error deleting credit note:",te),alert(te.message||"Failed to delete credit note")}},Z=()=>{C({credit_note_number:"",credit_note_date:new Date().toISOString().split("T")[0],customer_id:"",original_invoice_id:"",original_invoice_number:"",reason:"",notes:"",currency:"IDR"}),E([{product_id:"",batch_id:"",quantity:0,unit_price:0}])},R=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="sales"||(r==null?void 0:r.role)==="manager",le=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager",ee=[{key:"credit_note_number",label:"Credit Note #",render:se=>se.credit_note_number||"Pending"},{key:"credit_note_date",label:"Date",render:se=>new Date(se.credit_note_date).toLocaleDateString()},{key:"customer",label:"Customer",render:se=>{var te;return((te=se.customers)==null?void 0:te.company_name)||"N/A"}},{key:"original_invoice_number",label:"Original Invoice",render:se=>se.original_invoice_number||"N/A"},{key:"total_amount",label:"Amount",render:se=>`${se.currency} ${se.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2})}`},{key:"status",label:"Status",render:se=>{var te;return a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${se.status==="approved"?"bg-green-100 text-green-800":se.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:((te=se.status)==null?void 0:te.replace("_"," "))||"pending approval"})}},{key:"reason",label:"Reason",render:se=>a.jsx("span",{className:"text-sm text-gray-600 truncate max-w-xs block",children:se.reason})}],_e=U();return a.jsx(Zn,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Credit Notes"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage credit notes for returns and adjustments after invoicing"})]}),R&&a.jsxs("button",{onClick:()=>{Z(),c(!0)},className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition",children:[a.jsx(Rr,{className:"w-5 h-5"}),"Create Credit Note"]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex gap-3",children:[a.jsx(ea,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium",children:"When to use Credit Notes:"}),a.jsx("p",{className:"mt-1",children:"Use Credit Notes for goods returned or price adjustments AFTER an invoice has been issued and filed for tax purposes. For physical returns before invoicing, use Material Returns instead."})]})]}),a.jsx(ws,{columns:ee,data:n,loading:i,actions:se=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>P(se),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Credit Note",children:a.jsx(Kc,{className:"w-4 h-4"})}),le&&(!se.status||se.status==="pending_approval")&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Q(se.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Approve Credit Note",children:a.jsx(yn,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>z(se.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject Credit Note",children:a.jsx(un,{className:"w-4 h-4"})})]}),R&&(!se.status||se.status==="pending_approval")&&a.jsx("button",{onClick:()=>G(se.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Credit Note",children:a.jsx(nn,{className:"w-4 h-4"})})]})}),a.jsx(qt,{isOpen:l,onClose:()=>{c(!1),Z()},title:"Create Credit Note",children:a.jsxs("form",{onSubmit:D,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsxs("select",{value:_.customer_id,onChange:se=>J(se.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select Customer"}),m.map(se=>a.jsx("option",{value:se.id,children:se.company_name},se.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Original Invoice (Optional)"}),a.jsxs("select",{value:_.original_invoice_id,onChange:se=>H(se.target.value),disabled:!_.customer_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent disabled:bg-gray-100",children:[a.jsx("option",{value:"",children:"Select Invoice"}),w.map(se=>a.jsxs("option",{value:se.id,children:[se.invoice_number," - ",new Date(se.invoice_date).toLocaleDateString()," - Rp ",se.total_amount.toLocaleString("id-ID")]},se.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Note Date *"}),a.jsx("input",{type:"date",value:_.credit_note_date,onChange:se=>C({..._,credit_note_date:se.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),a.jsxs("select",{value:_.currency,onChange:se=>C({..._,currency:se.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[a.jsx("option",{value:"IDR",children:"IDR"}),a.jsx("option",{value:"USD",children:"USD"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Credit Note *"}),a.jsx("textarea",{value:_.reason,onChange:se=>C({..._,reason:se.target.value}),required:!0,rows:2,placeholder:"e.g., Goods returned due to quality issue, Price adjustment, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Items Being Credited"}),!_.original_invoice_id&&a.jsx("button",{type:"button",onClick:K,className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"+ Add Item"})]}),a.jsx("div",{className:"space-y-3",children:j.map((se,te)=>{var Ne;return a.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsxs("select",{value:se.product_id,onChange:Se=>L(te,"product_id",Se.target.value),required:!0,disabled:!!_.original_invoice_id,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg disabled:bg-gray-100",children:[a.jsx("option",{value:"",children:"Select Product"}),p.map(Se=>a.jsxs("option",{value:Se.id,children:[Se.product_name," (",Se.product_code,")"]},Se.id))]}),se.product_id&&p.find(Se=>Se.id===se.product_id)&&a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(Ne=p.find(Se=>Se.id===se.product_id))==null?void 0:Ne.product_name})]}),a.jsx("div",{children:a.jsxs("select",{value:se.batch_id,onChange:Se=>L(te,"batch_id",Se.target.value),required:!0,disabled:!se.product_id||!!_.original_invoice_id,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg disabled:bg-gray-100",children:[a.jsx("option",{value:"",children:"Select Batch"}),y.filter(Se=>Se.product_id===se.product_id).map(Se=>a.jsxs("option",{value:Se.id,children:[Se.batch_number," (Stock: ",Se.current_stock,")"]},Se.id))]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Quantity (Kg)"}),a.jsx("input",{type:"number",step:"0.001",placeholder:"Quantity in Kg",value:se.quantity||"",onChange:Se=>L(te,"quantity",parseFloat(Se.target.value)||0),required:!0,min:"0.001",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price (per Kg)"}),a.jsx("input",{type:"number",step:"0.01",placeholder:"Price per Kg",value:se.unit_price||"",onChange:Se=>L(te,"unit_price",parseFloat(Se.target.value)||0),required:!0,min:"0",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:["Line Total: ",a.jsxs("span",{className:"font-semibold",children:[_.currency," ",(se.quantity*se.unit_price).toLocaleString("id-ID",{minimumFractionDigits:2})]})]}),j.length>1&&a.jsx("button",{type:"button",onClick:()=>B(te),className:"text-red-600 hover:text-red-800",children:a.jsx(nn,{className:"w-4 h-4"})})]})]},te)})})]}),a.jsx("div",{className:"border-t pt-4",children:a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsxs("span",{className:"font-semibold",children:[_.currency," ",_e.subtotal.toLocaleString("id-ID",{minimumFractionDigits:2})]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[a.jsx("span",{children:"Total Credit:"}),a.jsxs("span",{className:"text-red-600",children:[_.currency," ",_e.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2})]})]})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),a.jsx("textarea",{value:_.notes,onChange:se=>C({..._,notes:se.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:()=>{c(!1),Z()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Create Credit Note"})]})]})}),u&&h&&a.jsx(hfe,{creditNote:h,items:A,onClose:()=>{d(!1),f(null),b([])}})]})})}function mfe(){const{profile:e}=jr(),{setCurrentPage:t}=Ho(),[r,n]=W.useState([]),[s,i]=W.useState(!1),[o,l]=W.useState(!1);W.useEffect(()=>{(e==null?void 0:e.role)==="admin"&&c()},[e]);const c=async()=>{try{const h=[],{data:f}=await ae.from("sales_orders").select(`
          id,
          so_number,
          so_date,
          total_amount,
          customers (company_name)
        `).eq("status","pending_approval").order("created_at",{ascending:!1}).limit(5);f&&f.forEach(b=>{var m;h.push({id:b.id,type:"sales_order",number:b.so_number,customer_name:((m=b.customers)==null?void 0:m.company_name)||"Unknown",amount:b.total_amount,date:b.so_date})});const{data:A}=await ae.from("delivery_challans").select(`
          id,
          challan_number,
          challan_date,
          customers (company_name)
        `).eq("approval_status","pending_approval").order("created_at",{ascending:!1}).limit(5);A&&A.forEach(b=>{var m;h.push({id:b.id,type:"delivery_challan",number:b.challan_number,customer_name:((m=b.customers)==null?void 0:m.company_name)||"Unknown",date:b.challan_date})}),n(h),h.length>0&&!o&&i(!0)}catch(h){console.error("Error loading pending approvals:",h)}},u=h=>{i(!1),l(!0),h.type==="sales_order"?t("sales-orders"):t("delivery-challan")},d=()=>{i(!1),l(!0)};return!s||r.length===0?null:a.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-96 max-h-[600px] overflow-hidden rounded-lg shadow-2xl bg-white border border-gray-200 animate-slide-up",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),a.jsx("h3",{className:"font-semibold",children:"Pending Approvals"}),a.jsx("span",{className:"bg-white/20 text-xs px-2 py-0.5 rounded-full",children:r.length})]}),a.jsx("button",{onClick:d,className:"text-white/80 hover:text-white transition",children:a.jsx(Kr,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:r.map((h,f)=>a.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition ${f===0?"bg-blue-50":""}`,onClick:()=>u(h),children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:`p-2 rounded-lg ${h.type==="sales_order"?"bg-blue-100 text-blue-600":"bg-green-100 text-green-600"}`,children:h.type==="sales_order"?a.jsx(sr,{className:"w-5 h-5"}):a.jsx(TF,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:h.type==="sales_order"?"Sales Order":"Delivery Challan"}),a.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:h.number})]}),a.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:new Date(h.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),a.jsx("p",{className:"text-sm text-gray-700 mt-1 truncate",children:h.customer_name}),h.amount&&a.jsxs("p",{className:"text-xs font-medium text-blue-600 mt-1",children:["Rp ",h.amount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),f===0&&a.jsx("div",{className:"flex items-center gap-2 mt-2",children:a.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"Click to review "})})]})]})},`${h.type}-${h.id}`))}),a.jsx("div",{className:"bg-gray-50 px-4 py-3 text-center",children:a.jsx("button",{onClick:()=>{d(),t("sales-orders")},className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All Pending Approvals"})}),a.jsx("style",{children:`
        @keyframes slide-up {
          from {
            transform: translateY(100%);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out;
        }
      `})]})}async function o5(e){try{const{error:t}=await ae.from("notifications").insert([{user_id:e.userId,type:e.type,title:e.title,message:e.message,reference_id:e.referenceId||null,reference_type:e.referenceType||null,is_read:!1}]);if(t)throw t}catch(t){console.error("Error creating notification:",t)}}async function Gk(){var e;try{const{data:t}=await ae.from("app_settings").select("low_stock_threshold").maybeSingle(),r=(t==null?void 0:t.low_stock_threshold)||100,{data:n}=await ae.from("batches").select("id, batch_number, current_stock, products(product_name)").eq("is_active",!0).lt("current_stock",r);if(n&&n.length>0){const{data:s}=await ae.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse"]);if(s)for(const i of s)(e=(await ae.from("notifications").select("id").eq("user_id",i.id).eq("type","low_stock").eq("is_read",!1).limit(1)).data)!=null&&e.length||await o5({userId:i.id,type:"low_stock",title:"Low Stock Alert",message:`${n.length} batch(es) are running low on stock.`})}}catch(t){console.error("Error checking low stock:",t)}}async function Wk(){var e;try{const{data:t}=await ae.from("app_settings").select("expiry_alert_days").maybeSingle(),r=(t==null?void 0:t.expiry_alert_days)||30,n=new Date;n.setDate(n.getDate()+r);const{data:s}=await ae.from("batches").select("id, batch_number, expiry_date, products(product_name)").eq("is_active",!0).not("expiry_date","is",null).lte("expiry_date",n.toISOString()).gte("expiry_date",new Date().toISOString());if(s&&s.length>0){const{data:i}=await ae.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse","sales"]);if(i)for(const o of i)(e=(await ae.from("notifications").select("id").eq("user_id",o.id).eq("type","near_expiry").eq("is_read",!1).limit(1)).data)!=null&&e.length||await o5({userId:o.id,type:"near_expiry",title:"Products Near Expiry",message:`${s.length} batch(es) will expire within ${r} days.`})}}catch(t){console.error("Error checking expiry dates:",t)}}async function zk(){try{const e=new Date().toISOString().split("T")[0],{data:t}=await ae.from("crm_activities").select("id, customer_id, activity_type, customers(company_name)").eq("is_completed",!1).not("follow_up_date","is",null).lte("follow_up_date",e);if(t&&t.length>0){const{data:r}=await ae.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","sales"]);if(r)for(const n of r)await o5({userId:n.id,type:"follow_up",title:"Follow-ups Due",message:`You have ${t.length} follow-up(s) due today.`})}}catch(e){console.error("Error checking follow-ups:",e)}}async function gfe(){await Gk(),await Wk(),await zk(),setInterval(async()=>{await Gk(),await Wk(),await zk()},3e5)}function xfe(){const{user:e,profile:t,loading:r}=jr(),{currentPage:n}=Ho();if(W.useEffect(()=>{e&&t&&gfe()},[e,t]),window.location.pathname==="/setup")return a.jsx(ofe,{});if(window.location.pathname==="/auth/gmail/callback")return a.jsx(lfe,{});if(r)return a.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});if(!e||!t)return a.jsx(z7,{});const s=()=>{switch(n){case"dashboard":return a.jsx(D4,{});case"products":return a.jsx(BR,{});case"stock":return a.jsx(ER,{});case"batches":return a.jsx(LR,{});case"inventory":return a.jsx(ZV,{});case"customers":return a.jsx(SR,{});case"sales-orders":return a.jsx(dfe,{});case"import-requirements":return a.jsx(ffe,{});case"crm":return a.jsx(NAe,{});case"command-center":return a.jsx(FAe,{});case"tasks":return a.jsx(IAe,{});case"delivery-challan":return a.jsx(UAe,{});case"sales":return a.jsx(RAe,{});case"credit-notes":return a.jsx(pfe,{});case"material-returns":return a.jsx(ET,{});case"finance":return a.jsx(tfe,{});case"settings":return a.jsx(ife,{});default:return a.jsx(D4,{})}};return a.jsxs(a.Fragment,{children:[s(),a.jsx(mfe,{})]})}function yfe(){return a.jsx($7,{children:a.jsx(G7,{children:a.jsx(W7,{children:a.jsx(xfe,{})})})})}uE(document.getElementById("root")).render(a.jsx(W.StrictMode,{children:a.jsx(yfe,{})}));export{Lr as _,ii as c,Xk as g};
